{
    "rows_returned": 95855,
    "query_name": "WITH MovieDetails AS (\n    SELECT \n        t.title AS movie_title,\n        t.production_year,\n        t.id AS movie_id,\n        COUNT(DISTINCT c.person_id) AS cast_count,\n        STRING_AGG(DISTINCT a.name, ', ') AS cast_names,\n        STRING_AGG(DISTINCT k.keyword, ', ') AS keywords\n    FROM \n        aka_title t\n    LEFT JOIN \n        movie_keyword mk ON t.id = mk.movie_id\n    LEFT JOIN \n        keyword k ON mk.keyword_id = k.id\n    LEFT JOIN \n        cast_info c ON t.id = c.movie_id\n    LEFT JOIN \n        aka_name a ON c.person_id = a.person_id\n    WHERE \n        t.production_year BETWEEN 2000 AND 2020\n    GROUP BY \n        t.title, t.production_year, t.id\n),\nCompanyStatistics AS (\n    SELECT \n        m.movie_id,\n        COUNT(DISTINCT mc.company_id) AS company_count,\n        STRING_AGG(DISTINCT co.name, ', ') AS company_names\n    FROM \n        movie_companies mc\n    JOIN \n        company_name co ON mc.company_id = co.id\n    JOIN \n        MovieDetails m ON mc.movie_id = m.movie_id\n    GROUP BY \n        m.movie_id\n)\nSELECT \n    md.movie_title,\n    md.production_year,\n    md.cast_count,\n    md.cast_names,\n    cs.company_count,\n    cs.company_names\nFROM \n    MovieDetails md\nLEFT JOIN \n    CompanyStatistics cs ON md.movie_id = cs.movie_id\nORDER BY \n    md.production_year DESC, \n    md.cast_count DESC",
    "blocked_thread_time": 0.0,
    "cpu_time": 17.988471386,
    "extra_info": {},
    "cumulative_cardinality": 22569158,
    "cumulative_rows_scanned": 1300631059,
    "result_set_size": 6901560,
    "latency": 1.339071755,
    "children": [
        {
            "operator_name": "ORDER_BY",
            "cpu_time": 17.988471386,
            "extra_info": {
                "Order By": [
                    "md.production_year DESC",
                    "md.cast_count DESC"
                ]
            },
            "cumulative_cardinality": 22569158,
            "operator_type": "ORDER_BY",
            "operator_cardinality": 95855,
            "cumulative_rows_scanned": 1300631059,
            "operator_rows_scanned": 0,
            "operator_timing": 0.1615373019999994,
            "result_set_size": 6901560,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 17.826934084,
                    "extra_info": {
                        "Projections": [
                            "movie_title",
                            "production_year",
                            "cast_count",
                            "cast_names",
                            "company_count",
                            "company_names"
                        ],
                        "Estimated Cardinality": "1304564"
                    },
                    "cumulative_cardinality": 22473303,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 95855,
                    "cumulative_rows_scanned": 1300631059,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.0001032719999999999,
                    "result_set_size": 6901560,
                    "children": [
                        {
                            "operator_name": "CTE",
                            "cpu_time": 17.826830812,
                            "extra_info": {
                                "CTE Name": "MovieDetails",
                                "Table Index": "0"
                            },
                            "cumulative_cardinality": 22377448,
                            "operator_type": "CTE",
                            "operator_cardinality": 0,
                            "cumulative_rows_scanned": 1300631059,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.015628336,
                            "result_set_size": 0,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 14.660537577000001,
                                    "extra_info": {
                                        "Projections": [
                                            "#0",
                                            "__internal_decompress_integral_bigint(#1, 2000)",
                                            "__internal_decompress_integral_bigint(#2, 1)",
                                            "#3",
                                            "#4",
                                            "#5"
                                        ],
                                        "Estimated Cardinality": "361472"
                                    },
                                    "cumulative_cardinality": 21234824,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 95855,
                                    "cumulative_rows_scanned": 1292568675,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.00023869900000000004,
                                    "result_set_size": 6901560,
                                    "children": [
                                        {
                                            "operator_name": "HASH_GROUP_BY",
                                            "cpu_time": 14.660298878,
                                            "extra_info": {
                                                "Groups": [
                                                    "#0",
                                                    "#1",
                                                    "#2"
                                                ],
                                                "Aggregates": [
                                                    "count(DISTINCT #3)",
                                                    "string_agg(DISTINCT #4)",
                                                    "string_agg(DISTINCT #5)"
                                                ],
                                                "Estimated Cardinality": "361472"
                                            },
                                            "cumulative_cardinality": 21138969,
                                            "operator_type": "HASH_GROUP_BY",
                                            "operator_cardinality": 95855,
                                            "cumulative_rows_scanned": 1292568675,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 3.956858689000001,
                                            "result_set_size": 5847155,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 10.703440189,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "title",
                                                            "production_year",
                                                            "id",
                                                            "person_id",
                                                            "name",
                                                            "keyword"
                                                        ],
                                                        "Estimated Cardinality": "36244344"
                                                    },
                                                    "cumulative_cardinality": 21043114,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 3902311,
                                                    "cumulative_rows_scanned": 1292568675,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.006728259,
                                                    "result_set_size": 238040971,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 10.69671193,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "#0",
                                                                    "__internal_compress_integral_uinteger(#1, 1)",
                                                                    "#2",
                                                                    "__internal_compress_integral_utinyint(#3, 2000)",
                                                                    "#4",
                                                                    "#5"
                                                                ],
                                                                "Estimated Cardinality": "36244344"
                                                            },
                                                            "cumulative_cardinality": 17140803,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 3902311,
                                                            "cumulative_rows_scanned": 1292568675,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.03768823100000001,
                                                            "result_set_size": 238040971,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 10.659023698999999,
                                                                    "extra_info": {
                                                                        "Join Type": "LEFT",
                                                                        "Conditions": "person_id = person_id",
                                                                        "Estimated Cardinality": "36244344"
                                                                    },
                                                                    "cumulative_cardinality": 13238492,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 3902311,
                                                                    "cumulative_rows_scanned": 1292568675,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.6721385130000004,
                                                                    "result_set_size": 280966392,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_JOIN",
                                                                            "cpu_time": 9.862509672999998,
                                                                            "extra_info": {
                                                                                "Join Type": "RIGHT",
                                                                                "Conditions": "movie_id = id",
                                                                                "Estimated Cardinality": "36244344"
                                                                            },
                                                                            "cumulative_cardinality": 8434838,
                                                                            "operator_type": "HASH_JOIN",
                                                                            "operator_cardinality": 2656136,
                                                                            "cumulative_rows_scanned": 1291667332,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.6719439519999999,
                                                                            "result_set_size": 148743616,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 9.017461341999999,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "person_id",
                                                                                            "movie_id"
                                                                                        ],
                                                                                        "Estimated Cardinality": "36244344"
                                                                                    },
                                                                                    "cumulative_cardinality": 5054952,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 5054952,
                                                                                    "cumulative_rows_scanned": 1268552040,
                                                                                    "operator_rows_scanned": 1268552040,
                                                                                    "operator_timing": 9.017461341999999,
                                                                                    "result_set_size": 80879232,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "operator_name": "HASH_JOIN",
                                                                                    "cpu_time": 0.17310437900000003,
                                                                                    "extra_info": {
                                                                                        "Join Type": "LEFT",
                                                                                        "Conditions": "keyword_id = id",
                                                                                        "Estimated Cardinality": "4523930"
                                                                                    },
                                                                                    "cumulative_cardinality": 723750,
                                                                                    "operator_type": "HASH_JOIN",
                                                                                    "operator_cardinality": 140221,
                                                                                    "cumulative_rows_scanned": 23115292,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.019435319,
                                                                                    "result_set_size": 6730608,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_JOIN",
                                                                                            "cpu_time": 0.13478440500000002,
                                                                                            "extra_info": {
                                                                                                "Join Type": "RIGHT",
                                                                                                "Conditions": "movie_id = id",
                                                                                                "Estimated Cardinality": "4523930"
                                                                                            },
                                                                                            "cumulative_cardinality": 449359,
                                                                                            "operator_type": "HASH_JOIN",
                                                                                            "operator_cardinality": 140221,
                                                                                            "cumulative_rows_scanned": 22981122,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.020048851,
                                                                                            "result_set_size": 5608840,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.038301103,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "movie_id",
                                                                                                            "keyword_id"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "4523930"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 213283,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 213283,
                                                                                                    "cumulative_rows_scanned": 22619650,
                                                                                                    "operator_rows_scanned": 22619650,
                                                                                                    "operator_timing": 0.038301103,
                                                                                                    "result_set_size": 3412528,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.07643445100000003,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "title",
                                                                                                            "production_year"
                                                                                                        ],
                                                                                                        "Filters": "production_year>=2000 AND production_year<=2020",
                                                                                                        "Estimated Cardinality": "72294"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 95855,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 95855,
                                                                                                    "cumulative_rows_scanned": 361472,
                                                                                                    "operator_rows_scanned": 361472,
                                                                                                    "operator_timing": 0.07643445100000003,
                                                                                                    "result_set_size": 3067360,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.018884655000000007,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "keyword"
                                                                                                ],
                                                                                                "Estimated Cardinality": "134170"
                                                                                            },
                                                                                            "cumulative_cardinality": 134170,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 134170,
                                                                                            "cumulative_rows_scanned": 134170,
                                                                                            "operator_rows_scanned": 134170,
                                                                                            "operator_timing": 0.018884655000000007,
                                                                                            "result_set_size": 3220080,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.12437551299999994,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "person_id",
                                                                                    "name"
                                                                                ],
                                                                                "Estimated Cardinality": "901343"
                                                                            },
                                                                            "cumulative_cardinality": 901343,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 901343,
                                                                            "cumulative_rows_scanned": 901343,
                                                                            "operator_rows_scanned": 901343,
                                                                            "operator_timing": 0.12437551299999994,
                                                                            "result_set_size": 21632232,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "operator_name": "HASH_JOIN",
                                    "cpu_time": 3.1506648989999997,
                                    "extra_info": {
                                        "Join Type": "RIGHT",
                                        "Conditions": "movie_id = movie_id",
                                        "Estimated Cardinality": "1304564"
                                    },
                                    "cumulative_cardinality": 1142624,
                                    "operator_type": "HASH_JOIN",
                                    "operator_cardinality": 95855,
                                    "cumulative_rows_scanned": 8062384,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 1.074417601,
                                    "result_set_size": 9968920,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 1.6883279050000002,
                                            "extra_info": {
                                                "Projections": [
                                                    "__internal_decompress_integral_bigint(#0, 2)",
                                                    "#1",
                                                    "#2"
                                                ],
                                                "Estimated Cardinality": "1304564"
                                            },
                                            "cumulative_cardinality": 950914,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 24168,
                                            "cumulative_rows_scanned": 8062384,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.000098694,
                                            "result_set_size": 773376,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_GROUP_BY",
                                                    "cpu_time": 1.6882292110000001,
                                                    "extra_info": {
                                                        "Groups": "#0",
                                                        "Aggregates": [
                                                            "count(DISTINCT #1)",
                                                            "string_agg(DISTINCT #2)"
                                                        ],
                                                        "Estimated Cardinality": "1304564"
                                                    },
                                                    "cumulative_cardinality": 926746,
                                                    "operator_type": "HASH_GROUP_BY",
                                                    "operator_cardinality": 24168,
                                                    "cumulative_rows_scanned": 8062384,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.035547859,
                                                    "result_set_size": 676704,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 1.652681352,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "movie_id",
                                                                    "company_id",
                                                                    "name"
                                                                ],
                                                                "Estimated Cardinality": "2609129"
                                                            },
                                                            "cumulative_cardinality": 902578,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 51794,
                                                            "cumulative_rows_scanned": 8062384,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.000024265999999999988,
                                                            "result_set_size": 1450232,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 1.652657086,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "__internal_compress_integral_uinteger(#0, 2)",
                                                                            "#1",
                                                                            "#2",
                                                                            "#3",
                                                                            "#4",
                                                                            "#5",
                                                                            "#6",
                                                                            "#7",
                                                                            "#8"
                                                                        ],
                                                                        "Estimated Cardinality": "2609129"
                                                                    },
                                                                    "cumulative_cardinality": 850784,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 51794,
                                                                    "cumulative_rows_scanned": 8062384,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.00019103300000000004,
                                                                    "result_set_size": 5179400,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_JOIN",
                                                                            "cpu_time": 1.6524660530000002,
                                                                            "extra_info": {
                                                                                "Join Type": "INNER",
                                                                                "Conditions": "movie_id = movie_id",
                                                                                "Estimated Cardinality": "2609129"
                                                                            },
                                                                            "cumulative_cardinality": 798990,
                                                                            "operator_type": "HASH_JOIN",
                                                                            "operator_cardinality": 51794,
                                                                            "cumulative_rows_scanned": 8062384,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 1.067699954,
                                                                            "result_set_size": 5386576,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "HASH_JOIN",
                                                                                    "cpu_time": 0.185412643,
                                                                                    "extra_info": {
                                                                                        "Join Type": "INNER",
                                                                                        "Conditions": "company_id = id",
                                                                                        "Estimated Cardinality": "2609129"
                                                                                    },
                                                                                    "cumulative_cardinality": 651341,
                                                                                    "operator_type": "HASH_JOIN",
                                                                                    "operator_cardinality": 208172,
                                                                                    "cumulative_rows_scanned": 8062384,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.021734223000000007,
                                                                                    "result_set_size": 6661504,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.11529214800000001,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "movie_id",
                                                                                                    "company_id"
                                                                                                ],
                                                                                                "Estimated Cardinality": "2609129"
                                                                                            },
                                                                                            "cumulative_cardinality": 208172,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 208172,
                                                                                            "cumulative_rows_scanned": 7827387,
                                                                                            "operator_rows_scanned": 7827387,
                                                                                            "operator_timing": 0.11529214800000001,
                                                                                            "result_set_size": 3330752,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.04838627199999997,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "name"
                                                                                                ],
                                                                                                "Estimated Cardinality": "234997"
                                                                                            },
                                                                                            "cumulative_cardinality": 234997,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 234997,
                                                                                            "cumulative_rows_scanned": 234997,
                                                                                            "operator_rows_scanned": 234997,
                                                                                            "operator_timing": 0.04838627199999997,
                                                                                            "result_set_size": 5639928,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "operator_name": "CTE_SCAN",
                                                                                    "cpu_time": 0.39935345600000005,
                                                                                    "extra_info": {
                                                                                        "CTE Index": "0",
                                                                                        "Estimated Cardinality": "361472"
                                                                                    },
                                                                                    "cumulative_cardinality": 95855,
                                                                                    "operator_type": "CTE_SCAN",
                                                                                    "operator_cardinality": 95855,
                                                                                    "cumulative_rows_scanned": 0,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.39935345600000005,
                                                                                    "result_set_size": 6901560,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "operator_name": "CTE_SCAN",
                                            "cpu_time": 0.38791939299999995,
                                            "extra_info": {
                                                "CTE Index": "0",
                                                "Estimated Cardinality": "361472"
                                            },
                                            "cumulative_cardinality": 95855,
                                            "operator_type": "CTE_SCAN",
                                            "operator_cardinality": 95855,
                                            "cumulative_rows_scanned": 0,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.38791939299999995,
                                            "result_set_size": 6901560,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}