{
    "rows_returned": 10,
    "query_name": "WITH UserReputation AS (\n    SELECT U.Id AS UserId,\n           U.DisplayName,\n           U.Reputation,\n           ROW_NUMBER() OVER (ORDER BY U.Reputation DESC) AS ReputationRank\n    FROM Users U\n    WHERE U.Reputation > 0\n),\nPostsSummary AS (\n    SELECT P.OwnerUserId,\n           COUNT(*) AS TotalPosts,\n           SUM(CASE WHEN P.PostTypeId = 1 THEN 1 ELSE 0 END) AS QuestionsCount,\n           SUM(CASE WHEN P.PostTypeId = 2 THEN 1 ELSE 0 END) AS AnswersCount,\n           SUM(P.ViewCount) AS TotalViews\n    FROM Posts P\n    GROUP BY P.OwnerUserId\n),\nVoteCounts AS (\n    SELECT V.UserId,\n           COUNT(*) AS TotalVotes,\n           SUM(CASE WHEN V.VoteTypeId IN (2, 3) THEN 1 ELSE 0 END) AS UpVotes,\n           SUM(CASE WHEN V.VoteTypeId IN (3) THEN 1 ELSE 0 END) AS DownVotes\n    FROM Votes V\n    GROUP BY V.UserId\n)\nSELECT U.DisplayName,\n       COALESCE(UR.Reputation, 0) AS Reputation,\n       COALESCE(PS.TotalPosts, 0) AS PostsCount,\n       COALESCE(PS.QuestionsCount, 0) AS QuestionsCount,\n       COALESCE(PS.AnswersCount, 0) AS AnswersCount,\n       COALESCE(PS.TotalViews, 0) AS TotalViews,\n       COALESCE(VC.TotalVotes, 0) AS TotalVotes,\n       COALESCE(VC.UpVotes, 0) AS UpVotes,\n       COALESCE(VC.DownVotes, 0) AS DownVotes\nFROM Users U\nLEFT JOIN UserReputation UR ON U.Id = UR.UserId\nLEFT JOIN PostsSummary PS ON U.Id = PS.OwnerUserId\nLEFT JOIN VoteCounts VC ON U.Id = VC.UserId\nWHERE U.Location IS NOT NULL\n  AND U.CreationDate < cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year'\nORDER BY Reputation DESC, TotalPosts DESC\nFETCH FIRST 10 ROWS ONLY;",
    "blocked_thread_time": 0.0,
    "cpu_time": 3.829084445999999,
    "extra_info": {},
    "cumulative_cardinality": 40734808,
    "cumulative_rows_scanned": 19115629,
    "result_set_size": 1160,
    "latency": 4.031477765,
    "children": [
        {
            "operator_name": "PROJECTION",
            "cpu_time": 3.829084445999999,
            "extra_info": {
                "Projections": [
                    "#0",
                    "#1",
                    "#2",
                    "#3",
                    "#4",
                    "#5",
                    "#6",
                    "#7",
                    "#8"
                ],
                "Estimated Cardinality": "10"
            },
            "cumulative_cardinality": 40734808,
            "operator_type": "PROJECTION",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 19115629,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001743,
            "result_set_size": 1160,
            "children": [
                {
                    "operator_name": "STREAMING_LIMIT",
                    "cpu_time": 3.829082702999999,
                    "extra_info": {},
                    "cumulative_cardinality": 40734798,
                    "operator_type": "STREAMING_LIMIT",
                    "operator_cardinality": 10,
                    "cumulative_rows_scanned": 19115629,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.000002254,
                    "result_set_size": 1240,
                    "children": [
                        {
                            "operator_name": "ORDER_BY",
                            "cpu_time": 3.829080448999999,
                            "extra_info": {
                                "Order By": [
                                    "COALESCE(UR.Reputation, 0) DESC",
                                    "#9 DESC"
                                ]
                            },
                            "cumulative_cardinality": 40734788,
                            "operator_type": "ORDER_BY",
                            "operator_cardinality": 4096,
                            "cumulative_rows_scanned": 19115629,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.015555304999999997,
                            "result_set_size": 507904,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 3.8135251439999993,
                                    "extra_info": {
                                        "Projections": [
                                            "displayname",
                                            "Reputation",
                                            "PostsCount",
                                            "QuestionsCount",
                                            "AnswersCount",
                                            "TotalViews",
                                            "TotalVotes",
                                            "UpVotes",
                                            "DownVotes",
                                            "TotalPosts"
                                        ],
                                        "Estimated Cardinality": "6372046"
                                    },
                                    "cumulative_cardinality": 40730692,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 173187,
                                    "cumulative_rows_scanned": 19115629,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.009921176,
                                    "result_set_size": 21475188,
                                    "children": [
                                        {
                                            "operator_name": "HASH_JOIN",
                                            "cpu_time": 3.803603967999999,
                                            "extra_info": {
                                                "Join Type": "RIGHT",
                                                "Conditions": "userid = id",
                                                "Estimated Cardinality": "6372046"
                                            },
                                            "cumulative_cardinality": 40557505,
                                            "operator_type": "HASH_JOIN",
                                            "operator_cardinality": 173187,
                                            "cumulative_rows_scanned": 19115629,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.022113113000000004,
                                            "result_set_size": 20089692,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_GROUP_BY",
                                                    "cpu_time": 1.9219005589999991,
                                                    "extra_info": {
                                                        "Groups": "#0",
                                                        "Aggregates": [
                                                            "count_star()",
                                                            "sum(#1)",
                                                            "sum(#2)"
                                                        ],
                                                        "Estimated Cardinality": "6372046"
                                                    },
                                                    "cumulative_cardinality": 25500329,
                                                    "operator_type": "HASH_GROUP_BY",
                                                    "operator_cardinality": 12143,
                                                    "cumulative_rows_scanned": 12744093,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.15510673599999966,
                                                    "result_set_size": 534292,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 1.7667938229999995,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "userid",
                                                                    "CASE  WHEN ((votetypeid IN (2, 3))) THEN (1) ELSE 0 END",
                                                                    "CASE  WHEN ((votetypeid IN (3))) THEN (1) ELSE 0 END"
                                                                ],
                                                                "Estimated Cardinality": "12744093"
                                                            },
                                                            "cumulative_cardinality": 25488186,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 12744093,
                                                            "cumulative_rows_scanned": 12744093,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.24047325500000025,
                                                            "result_set_size": 152929116,
                                                            "children": [
                                                                {
                                                                    "operator_name": "READ_PARQUET ",
                                                                    "cpu_time": 1.5263205679999994,
                                                                    "extra_info": {
                                                                        "Function": "READ_PARQUET",
                                                                        "Projections": [
                                                                            "votetypeid",
                                                                            "userid"
                                                                        ],
                                                                        "Estimated Cardinality": "12744093"
                                                                    },
                                                                    "cumulative_cardinality": 12744093,
                                                                    "operator_type": "TABLE_SCAN",
                                                                    "operator_cardinality": 12744093,
                                                                    "cumulative_rows_scanned": 12744093,
                                                                    "operator_rows_scanned": 12744093,
                                                                    "operator_timing": 1.5263205679999994,
                                                                    "result_set_size": 76464558,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "operator_name": "HASH_JOIN",
                                                    "cpu_time": 1.8595902959999997,
                                                    "extra_info": {
                                                        "Join Type": "RIGHT",
                                                        "Conditions": "owneruserid = id",
                                                        "Estimated Cardinality": "1925058"
                                                    },
                                                    "cumulative_cardinality": 14883989,
                                                    "operator_type": "HASH_JOIN",
                                                    "operator_cardinality": 173187,
                                                    "cumulative_rows_scanned": 6371536,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.027405571000000007,
                                                    "result_set_size": 13854960,
                                                    "children": [
                                                        {
                                                            "operator_name": "HASH_GROUP_BY",
                                                            "cpu_time": 0.36060124699999996,
                                                            "extra_info": {
                                                                "Groups": "#0",
                                                                "Aggregates": [
                                                                    "count_star()",
                                                                    "sum(#1)",
                                                                    "sum(#2)",
                                                                    "sum(#3)"
                                                                ],
                                                                "Estimated Cardinality": "1925058"
                                                            },
                                                            "cumulative_cardinality": 8071864,
                                                            "operator_type": "HASH_GROUP_BY",
                                                            "operator_cardinality": 371632,
                                                            "cumulative_rows_scanned": 3850116,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.21217792399999974,
                                                            "result_set_size": 22297920,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.14842332300000025,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "owneruserid",
                                                                            "CASE  WHEN ((posttypeid = 1)) THEN (1) ELSE 0 END",
                                                                            "CASE  WHEN ((posttypeid = 2)) THEN (1) ELSE 0 END",
                                                                            "viewcount"
                                                                        ],
                                                                        "Estimated Cardinality": "3850116"
                                                                    },
                                                                    "cumulative_cardinality": 7700232,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 3850116,
                                                                    "cumulative_rows_scanned": 3850116,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.0655592960000002,
                                                                    "result_set_size": 61601856,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.08286402700000005,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "posttypeid",
                                                                                    "viewcount",
                                                                                    "owneruserid"
                                                                                ],
                                                                                "Estimated Cardinality": "3850116"
                                                                            },
                                                                            "cumulative_cardinality": 3850116,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 3850116,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 3850116,
                                                                            "operator_timing": 0.08286402700000005,
                                                                            "result_set_size": 38501160,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "operator_name": "HASH_JOIN",
                                                            "cpu_time": 1.4715834779999997,
                                                            "extra_info": {
                                                                "Join Type": "RIGHT",
                                                                "Conditions": "UserId = id",
                                                                "Estimated Cardinality": "252142"
                                                            },
                                                            "cumulative_cardinality": 6638938,
                                                            "operator_type": "HASH_JOIN",
                                                            "operator_cardinality": 173187,
                                                            "cumulative_rows_scanned": 2521420,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.04122244900000002,
                                                            "result_set_size": 4156488,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.08236573400000004,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "UserId",
                                                                            "reputation"
                                                                        ],
                                                                        "Estimated Cardinality": "252142"
                                                                    },
                                                                    "cumulative_cardinality": 5042840,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 1260710,
                                                                    "cumulative_rows_scanned": 1260710,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.0001305839999999996,
                                                                    "result_set_size": 10085680,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 0.08223515000000003,
                                                                            "extra_info": {
                                                                                "Projections": [
                                                                                    "#0",
                                                                                    "#1",
                                                                                    "#2"
                                                                                ],
                                                                                "Estimated Cardinality": "252142"
                                                                            },
                                                                            "cumulative_cardinality": 3782130,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 1260710,
                                                                            "cumulative_rows_scanned": 1260710,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.00017300200000000014,
                                                                            "result_set_size": 20171360,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "WINDOW",
                                                                                    "cpu_time": 0.08206214800000003,
                                                                                    "extra_info": {
                                                                                        "Projections": "ROW_NUMBER() OVER (ORDER BY reputation DESC NULLS LAST)"
                                                                                    },
                                                                                    "cumulative_cardinality": 2521420,
                                                                                    "operator_type": "WINDOW",
                                                                                    "operator_cardinality": 1260710,
                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.06497434700000002,
                                                                                    "result_set_size": 20171360,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.017087801000000014,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "reputation"
                                                                                                ],
                                                                                                "Estimated Cardinality": "252142"
                                                                                            },
                                                                                            "cumulative_cardinality": 1260710,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 1260710,
                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                            "operator_rows_scanned": 1260710,
                                                                                            "operator_timing": 0.017087801000000014,
                                                                                            "result_set_size": 10085680,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 1.3479952949999996,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "#0",
                                                                            "#1"
                                                                        ],
                                                                        "Estimated Cardinality": "50428"
                                                                    },
                                                                    "cumulative_cardinality": 1422911,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 173187,
                                                                    "cumulative_rows_scanned": 1260710,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.00010983499999999971,
                                                                    "result_set_size": 3463740,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "FILTER",
                                                                            "cpu_time": 1.3478854599999996,
                                                                            "extra_info": {
                                                                                "Expression": "(location IS NOT NULL)",
                                                                                "Estimated Cardinality": "50428"
                                                                            },
                                                                            "cumulative_cardinality": 1249724,
                                                                            "operator_type": "FILTER",
                                                                            "operator_cardinality": 173187,
                                                                            "cumulative_rows_scanned": 1260710,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.006336991000000002,
                                                                            "result_set_size": 6234732,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 1.3415484689999997,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "displayname",
                                                                                            "location"
                                                                                        ],
                                                                                        "Filters": "creationdate<'2023-10-01 12:34:56'::TIMESTAMP",
                                                                                        "Estimated Cardinality": "252142"
                                                                                    },
                                                                                    "cumulative_cardinality": 1076537,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 1076537,
                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                    "operator_rows_scanned": 1260710,
                                                                                    "operator_timing": 1.3415484689999997,
                                                                                    "result_set_size": 38755332,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}