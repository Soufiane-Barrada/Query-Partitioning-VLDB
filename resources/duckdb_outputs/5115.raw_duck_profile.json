{
    "rows_returned": 10,
    "query_name": "WITH UserBadges AS (\n    SELECT \n        u.Id AS UserId,\n        u.DisplayName,\n        COUNT(b.Id) AS BadgeCount\n    FROM \n        Users u\n    LEFT JOIN \n        Badges b ON u.Id = b.UserId\n    GROUP BY \n        u.Id, u.DisplayName\n),\nPopularPosts AS (\n    SELECT\n        p.Id AS PostId,\n        p.OwnerUserId,\n        p.Title,\n        p.Score,\n        p.ViewCount,\n        COUNT(c.Id) AS CommentCount\n    FROM \n        Posts p\n    LEFT JOIN \n        Comments c ON p.Id = c.PostId\n    WHERE \n        p.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year'\n    GROUP BY \n        p.Id, p.OwnerUserId, p.Title, p.Score, p.ViewCount\n    HAVING \n        p.Score > 5 AND p.ViewCount > 100\n),\nActiveUsers AS (\n    SELECT\n        u.Id AS UserId,\n        u.DisplayName,\n        COUNT(DISTINCT p.Id) AS PostCount\n    FROM \n        Users u\n    JOIN \n        Posts p ON u.Id = p.OwnerUserId\n    WHERE \n        p.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '30 days'\n    GROUP BY \n        u.Id, u.DisplayName\n)\nSELECT \n    ub.DisplayName AS UserName,\n    ub.BadgeCount,\n    pp.Title AS PopularPost,\n    pp.Score AS PostScore,\n    pp.ViewCount,\n    au.PostCount AS RecentPostCount\nFROM \n    UserBadges ub\nJOIN \n    PopularPosts pp ON ub.UserId = pp.OwnerUserId\nJOIN \n    ActiveUsers au ON ub.UserId = au.UserId\nORDER BY \n    ub.BadgeCount DESC, pp.Score DESC, au.PostCount DESC\nLIMIT 10;",
    "blocked_thread_time": 0.0,
    "cpu_time": 0.8782622649999998,
    "extra_info": {},
    "cumulative_cardinality": 15578278,
    "cumulative_rows_scanned": 19785198,
    "result_set_size": 560,
    "latency": 0.926339213,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 0.8782622649999998,
            "extra_info": {},
            "cumulative_cardinality": 15578278,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 19785198,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001051,
            "result_set_size": 560,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 0.8782612139999998,
                    "extra_info": {
                        "Projections": [
                            "#0",
                            "#1",
                            "#2",
                            "__internal_decompress_integral_integer(#3, 5)",
                            "#4",
                            "#5"
                        ],
                        "Estimated Cardinality": "1175795"
                    },
                    "cumulative_cardinality": 15578268,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 956,
                    "cumulative_rows_scanned": 19785198,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.000001573,
                    "result_set_size": 53536,
                    "children": [
                        {
                            "operator_name": "ORDER_BY",
                            "cpu_time": 0.8782596409999998,
                            "extra_info": {
                                "Order By": [
                                    "ub.BadgeCount DESC",
                                    "pp.Score DESC",
                                    "au.PostCount DESC"
                                ]
                            },
                            "cumulative_cardinality": 15577312,
                            "operator_type": "ORDER_BY",
                            "operator_cardinality": 956,
                            "cumulative_rows_scanned": 19785198,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.000111688,
                            "result_set_size": 51624,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 0.8781479529999997,
                                    "extra_info": {
                                        "Projections": [
                                            "#0",
                                            "#1",
                                            "#2",
                                            "__internal_compress_integral_usmallint(#3, 5)",
                                            "#4",
                                            "#5"
                                        ],
                                        "Estimated Cardinality": "1175795"
                                    },
                                    "cumulative_cardinality": 15576356,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 956,
                                    "cumulative_rows_scanned": 19785198,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.000002285,
                                    "result_set_size": 51624,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 0.8781456679999997,
                                            "extra_info": {
                                                "Projections": [
                                                    "UserName",
                                                    "BadgeCount",
                                                    "PopularPost",
                                                    "PostScore",
                                                    "viewcount",
                                                    "RecentPostCount"
                                                ],
                                                "Estimated Cardinality": "1175795"
                                            },
                                            "cumulative_cardinality": 15575400,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 956,
                                            "cumulative_rows_scanned": 19785198,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.000001543,
                                            "result_set_size": 53536,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_JOIN",
                                                    "cpu_time": 0.8781441249999997,
                                                    "extra_info": {
                                                        "Join Type": "INNER",
                                                        "Conditions": "owneruserid = UserId",
                                                        "Estimated Cardinality": "1175795"
                                                    },
                                                    "cumulative_cardinality": 15574444,
                                                    "operator_type": "HASH_JOIN",
                                                    "operator_cardinality": 956,
                                                    "cumulative_rows_scanned": 19785198,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.0007275789999999999,
                                                    "result_set_size": 53536,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.08226426200000003,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "owneruserid",
                                                                    "title",
                                                                    "score",
                                                                    "viewcount"
                                                                ],
                                                                "Estimated Cardinality": "3850116"
                                                            },
                                                            "cumulative_cardinality": 326191,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 2166,
                                                            "cumulative_rows_scanned": 11091938,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 5e-7,
                                                            "result_set_size": 60648,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.08226376200000003,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "#0",
                                                                            "#1",
                                                                            "#2",
                                                                            "__internal_decompress_integral_integer(#3, 5)",
                                                                            "#4"
                                                                        ],
                                                                        "Estimated Cardinality": "3850116"
                                                                    },
                                                                    "cumulative_cardinality": 324025,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 2166,
                                                                    "cumulative_rows_scanned": 11091938,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.000002865,
                                                                    "result_set_size": 69312,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_GROUP_BY",
                                                                            "cpu_time": 0.08226089700000003,
                                                                            "extra_info": {
                                                                                "Groups": [
                                                                                    "#0",
                                                                                    "#1",
                                                                                    "#2",
                                                                                    "#3",
                                                                                    "#4"
                                                                                ],
                                                                                "Aggregates": "",
                                                                                "Estimated Cardinality": "3850116"
                                                                            },
                                                                            "cumulative_cardinality": 321859,
                                                                            "operator_type": "HASH_GROUP_BY",
                                                                            "operator_cardinality": 2166,
                                                                            "cumulative_rows_scanned": 11091938,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.0013026530000000002,
                                                                            "result_set_size": 64980,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 0.08095824400000003,
                                                                                    "extra_info": {
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "owneruserid",
                                                                                            "title",
                                                                                            "score",
                                                                                            "viewcount"
                                                                                        ],
                                                                                        "Estimated Cardinality": "7241822"
                                                                                    },
                                                                                    "cumulative_cardinality": 319693,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 10196,
                                                                                    "cumulative_rows_scanned": 11091938,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.00001854899999999999,
                                                                                    "result_set_size": 305880,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "PROJECTION",
                                                                                            "cpu_time": 0.08093969500000002,
                                                                                            "extra_info": {
                                                                                                "Projections": [
                                                                                                    "#0",
                                                                                                    "#1",
                                                                                                    "__internal_compress_integral_usmallint(#2, 5)",
                                                                                                    "#3",
                                                                                                    "#4",
                                                                                                    "#5"
                                                                                                ],
                                                                                                "Estimated Cardinality": "7241822"
                                                                                            },
                                                                                            "cumulative_cardinality": 309497,
                                                                                            "operator_type": "PROJECTION",
                                                                                            "operator_cardinality": 10196,
                                                                                            "cumulative_rows_scanned": 11091938,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.00004926799999999999,
                                                                                            "result_set_size": 346664,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                    "cpu_time": 0.08089042700000001,
                                                                                                    "extra_info": {
                                                                                                        "Join Type": "RIGHT",
                                                                                                        "Conditions": "postid = id",
                                                                                                        "Estimated Cardinality": "7241822"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 299301,
                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                    "operator_cardinality": 10196,
                                                                                                    "cumulative_rows_scanned": 11091938,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.003932939999999999,
                                                                                                    "result_set_size": 367056,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.00861821,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": "postid",
                                                                                                                "Estimated Cardinality": "7241822"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 286939,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 286939,
                                                                                                            "cumulative_rows_scanned": 7241822,
                                                                                                            "operator_rows_scanned": 7241822,
                                                                                                            "operator_timing": 0.00861821,
                                                                                                            "result_set_size": 1147756,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.06833927700000002,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "score",
                                                                                                                    "viewcount",
                                                                                                                    "owneruserid",
                                                                                                                    "title"
                                                                                                                ],
                                                                                                                "Filters": [
                                                                                                                    "score>5",
                                                                                                                    "viewcount>100",
                                                                                                                    "creationdate>='2023-10-01 12:34:56'::TIMESTAMP"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "770023"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 2166,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 2166,
                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                            "operator_rows_scanned": 3850116,
                                                                                                            "operator_timing": 0.06833927700000002,
                                                                                                            "result_set_size": 69312,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "operator_name": "HASH_JOIN",
                                                            "cpu_time": 0.7951522839999997,
                                                            "extra_info": {
                                                                "Join Type": "INNER",
                                                                "Conditions": "UserId = UserId",
                                                                "Estimated Cardinality": "385011"
                                                            },
                                                            "cumulative_cardinality": 15247297,
                                                            "operator_type": "HASH_JOIN",
                                                            "operator_cardinality": 4529,
                                                            "cumulative_rows_scanned": 8693260,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.009321913000000006,
                                                            "result_set_size": 163044,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_GROUP_BY",
                                                                    "cpu_time": 0.6681575119999996,
                                                                    "extra_info": {
                                                                        "Groups": [
                                                                            "#0",
                                                                            "#1"
                                                                        ],
                                                                        "Aggregates": "count(#2)",
                                                                        "Estimated Cardinality": "1260710"
                                                                    },
                                                                    "cumulative_cardinality": 13943290,
                                                                    "operator_type": "HASH_GROUP_BY",
                                                                    "operator_cardinality": 1260679,
                                                                    "cumulative_rows_scanned": 3582434,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.3320993419999999,
                                                                    "result_set_size": 35299012,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 0.33605816999999966,
                                                                            "extra_info": {
                                                                                "Projections": [
                                                                                    "id",
                                                                                    "displayname",
                                                                                    "id"
                                                                                ],
                                                                                "Estimated Cardinality": "2321724"
                                                                            },
                                                                            "cumulative_cardinality": 12682611,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 3033382,
                                                                            "cumulative_rows_scanned": 3582434,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.00037070299999999865,
                                                                            "result_set_size": 72801168,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "FILTER",
                                                                                    "cpu_time": 0.3356874669999997,
                                                                                    "extra_info": {
                                                                                        "Expression": "(id <= 1416539)",
                                                                                        "Estimated Cardinality": "2321724"
                                                                                    },
                                                                                    "cumulative_cardinality": 9649229,
                                                                                    "operator_type": "FILTER",
                                                                                    "operator_cardinality": 3033382,
                                                                                    "cumulative_rows_scanned": 3582434,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.003805905000000002,
                                                                                    "result_set_size": 72801168,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_JOIN",
                                                                                            "cpu_time": 0.3318815619999997,
                                                                                            "extra_info": {
                                                                                                "Join Type": "RIGHT",
                                                                                                "Conditions": "userid = id",
                                                                                                "Estimated Cardinality": "2321724"
                                                                                            },
                                                                                            "cumulative_cardinality": 6615847,
                                                                                            "operator_type": "HASH_JOIN",
                                                                                            "operator_cardinality": 3033413,
                                                                                            "cumulative_rows_scanned": 3582434,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.20603260299999973,
                                                                                            "result_set_size": 72801912,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.046340183999999965,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "userid"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "2321724"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 2321724,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 2321724,
                                                                                                    "cumulative_rows_scanned": 2321724,
                                                                                                    "operator_rows_scanned": 2321724,
                                                                                                    "operator_timing": 0.046340183999999965,
                                                                                                    "result_set_size": 18573792,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.07950877499999999,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "displayname"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "1260710"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 1260710,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 1260710,
                                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                                    "operator_rows_scanned": 1260710,
                                                                                                    "operator_timing": 0.07950877499999999,
                                                                                                    "result_set_size": 25214200,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.11767285900000012,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "UserId",
                                                                            "PostCount"
                                                                        ],
                                                                        "Estimated Cardinality": "385011"
                                                                    },
                                                                    "cumulative_cardinality": 1299478,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 4529,
                                                                    "cumulative_rows_scanned": 5110826,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 9.22e-7,
                                                                    "result_set_size": 54348,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_GROUP_BY",
                                                                            "cpu_time": 0.11767193700000012,
                                                                            "extra_info": {
                                                                                "Groups": [
                                                                                    "#0",
                                                                                    "#1"
                                                                                ],
                                                                                "Aggregates": "count(DISTINCT #2)",
                                                                                "Estimated Cardinality": "385011"
                                                                            },
                                                                            "cumulative_cardinality": 1294949,
                                                                            "operator_type": "HASH_GROUP_BY",
                                                                            "operator_cardinality": 4529,
                                                                            "cumulative_rows_scanned": 5110826,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.0006271820000000002,
                                                                            "result_set_size": 126812,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 0.11704475500000011,
                                                                                    "extra_info": {
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "displayname",
                                                                                            "id"
                                                                                        ],
                                                                                        "Estimated Cardinality": "770023"
                                                                                    },
                                                                                    "cumulative_cardinality": 1290420,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 9907,
                                                                                    "cumulative_rows_scanned": 5110826,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.000005506000000000001,
                                                                                    "result_set_size": 237768,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_JOIN",
                                                                                            "cpu_time": 0.11703924900000011,
                                                                                            "extra_info": {
                                                                                                "Join Type": "INNER",
                                                                                                "Conditions": "id = owneruserid",
                                                                                                "Estimated Cardinality": "770023"
                                                                                            },
                                                                                            "cumulative_cardinality": 1280513,
                                                                                            "operator_type": "HASH_JOIN",
                                                                                            "operator_cardinality": 9907,
                                                                                            "cumulative_rows_scanned": 5110826,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.014504156000000167,
                                                                                            "result_set_size": 237768,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.08463240199999994,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "displayname"
                                                                                                        ],
                                                                                                        "Filters": "id<=1416539",
                                                                                                        "Estimated Cardinality": "1260710"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 1260679,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 1260679,
                                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                                    "operator_rows_scanned": 1260710,
                                                                                                    "operator_timing": 0.08463240199999994,
                                                                                                    "result_set_size": 25213580,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.017902691,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "owneruserid"
                                                                                                        ],
                                                                                                        "Filters": "creationdate>='2024-09-01 12:34:56'::TIMESTAMP",
                                                                                                        "Estimated Cardinality": "770023"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 9927,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 9927,
                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                    "operator_rows_scanned": 3850116,
                                                                                                    "operator_timing": 0.017902691,
                                                                                                    "result_set_size": 79416,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}