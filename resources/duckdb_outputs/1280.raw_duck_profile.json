{
    "rows_returned": 100,
    "query_name": "WITH UserActivity AS (\n    SELECT \n        U.Id AS UserId,\n        U.DisplayName,\n        COALESCE(SUM(A.AnswerCount), 0) AS TotalAnswers,\n        COALESCE(SUM(Q.QuestionCount), 0) AS TotalQuestions,\n        COALESCE(SUM(C.CommentCount), 0) AS TotalComments,\n        RANK() OVER (ORDER BY COALESCE(SUM(A.AnswerCount), 0) DESC) AS AnswerRank\n    FROM Users U\n    LEFT JOIN (\n        SELECT \n            OwnerUserId,\n            COUNT(Id) AS AnswerCount\n        FROM Posts\n        WHERE PostTypeId = 2\n        GROUP BY OwnerUserId\n    ) A ON U.Id = A.OwnerUserId\n    LEFT JOIN (\n        SELECT \n            OwnerUserId,\n            COUNT(Id) AS QuestionCount\n        FROM Posts\n        WHERE PostTypeId = 1\n        GROUP BY OwnerUserId\n    ) Q ON U.Id = Q.OwnerUserId\n    LEFT JOIN (\n        SELECT \n            UserId,\n            COUNT(Id) AS CommentCount\n        FROM Comments\n        GROUP BY UserId\n    ) C ON U.Id = C.UserId\n    GROUP BY U.Id, U.DisplayName\n),\nHighActivityUsers AS (\n    SELECT \n        UserId, \n        DisplayName,\n        TotalAnswers,\n        TotalQuestions,\n        TotalComments,\n        AnswerRank\n    FROM UserActivity\n    WHERE TotalAnswers > 10 OR TotalQuestions > 10\n),\nRecentPosts AS (\n    SELECT \n        P.OwnerUserId,\n        COUNT(P.Id) AS RecentPostCount\n    FROM Posts P\n    WHERE P.CreationDate > cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '30 days'\n    GROUP BY P.OwnerUserId\n)\nSELECT \n    U.DisplayName,\n    U.TotalAnswers,\n    U.TotalQuestions,\n    U.TotalComments,\n    COALESCE(RP.RecentPostCount, 0) AS RecentPosts\nFROM HighActivityUsers U\nLEFT JOIN RecentPosts RP ON U.UserId = RP.OwnerUserId\nORDER BY U.TotalAnswers DESC, U.TotalQuestions DESC\nLIMIT 100;",
    "blocked_thread_time": 0.0,
    "cpu_time": 1.3922025950000005,
    "extra_info": {},
    "cumulative_cardinality": 33137988,
    "cumulative_rows_scanned": 20052880,
    "result_set_size": 7200,
    "latency": 1.678049676,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 1.3922025950000005,
            "extra_info": {},
            "cumulative_cardinality": 33137988,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 100,
            "cumulative_rows_scanned": 20052880,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001313,
            "result_set_size": 7200,
            "children": [
                {
                    "operator_name": "ORDER_BY",
                    "cpu_time": 1.3922012820000005,
                    "extra_info": {
                        "Order By": [
                            "U.TotalAnswers DESC",
                            "U.TotalQuestions DESC"
                        ]
                    },
                    "cumulative_cardinality": 33137888,
                    "operator_type": "ORDER_BY",
                    "operator_cardinality": 4096,
                    "cumulative_rows_scanned": 20052880,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.003179924,
                    "result_set_size": 294912,
                    "children": [
                        {
                            "operator_name": "PROJECTION",
                            "cpu_time": 1.3890213580000006,
                            "extra_info": {
                                "Projections": [
                                    "displayname",
                                    "TotalAnswers",
                                    "TotalQuestions",
                                    "TotalComments",
                                    "RecentPosts"
                                ],
                                "Estimated Cardinality": "385011"
                            },
                            "cumulative_cardinality": 33133792,
                            "operator_type": "PROJECTION",
                            "operator_cardinality": 33150,
                            "cumulative_rows_scanned": 20052880,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.0011151329999999993,
                            "result_set_size": 2386800,
                            "children": [
                                {
                                    "operator_name": "HASH_JOIN",
                                    "cpu_time": 1.3879062250000005,
                                    "extra_info": {
                                        "Join Type": "LEFT",
                                        "Conditions": "UserId = owneruserid",
                                        "Estimated Cardinality": "385011"
                                    },
                                    "cumulative_cardinality": 33100642,
                                    "operator_type": "HASH_JOIN",
                                    "operator_cardinality": 33150,
                                    "cumulative_rows_scanned": 20052880,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.002332678000000001,
                                    "result_set_size": 2652000,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 1.3647755250000007,
                                            "extra_info": {
                                                "Projections": [
                                                    "UserId",
                                                    "displayname",
                                                    "TotalAnswers",
                                                    "TotalQuestions",
                                                    "TotalComments"
                                                ],
                                                "Estimated Cardinality": "252142"
                                            },
                                            "cumulative_cardinality": 33043108,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 33150,
                                            "cumulative_rows_scanned": 16202764,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.0012287210000000003,
                                            "result_set_size": 2254200,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 1.3635468040000007,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "#0",
                                                            "#1",
                                                            "#2",
                                                            "#3",
                                                            "#4"
                                                        ],
                                                        "Estimated Cardinality": "252142"
                                                    },
                                                    "cumulative_cardinality": 33009958,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 33150,
                                                    "cumulative_rows_scanned": 16202764,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.00004203,
                                                    "result_set_size": 2254200,
                                                    "children": [
                                                        {
                                                            "operator_name": "FILTER",
                                                            "cpu_time": 1.3635047740000008,
                                                            "extra_info": {
                                                                "Expression": "((COALESCE(sum(AnswerCount), 0) > 10) OR (COALESCE(sum(QuestionCount), 0) > 10))",
                                                                "Estimated Cardinality": "252142"
                                                            },
                                                            "cumulative_cardinality": 32976808,
                                                            "operator_type": "FILTER",
                                                            "operator_cardinality": 33150,
                                                            "cumulative_rows_scanned": 16202764,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.018812861999999996,
                                                            "result_set_size": 2519400,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 1.3446919120000007,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "#0",
                                                                            "#1",
                                                                            "#2",
                                                                            "#3",
                                                                            "#4",
                                                                            "#5"
                                                                        ],
                                                                        "Estimated Cardinality": "1260710"
                                                                    },
                                                                    "cumulative_cardinality": 32943658,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 1260710,
                                                                    "cumulative_rows_scanned": 16202764,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.0001804840000000004,
                                                                    "result_set_size": 95813960,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "WINDOW",
                                                                            "cpu_time": 1.3445114280000008,
                                                                            "extra_info": {
                                                                                "Projections": "RANK() OVER (ORDER BY COALESCE(sum(AnswerCount), 0) DESC NULLS LAST)"
                                                                            },
                                                                            "cumulative_cardinality": 31682948,
                                                                            "operator_type": "WINDOW",
                                                                            "operator_cardinality": 1260710,
                                                                            "cumulative_rows_scanned": 16202764,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.11772869100000011,
                                                                            "result_set_size": 95813960,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "HASH_GROUP_BY",
                                                                                    "cpu_time": 1.2267827370000006,
                                                                                    "extra_info": {
                                                                                        "Groups": [
                                                                                            "#0",
                                                                                            "#1"
                                                                                        ],
                                                                                        "Aggregates": [
                                                                                            "sum(#2)",
                                                                                            "sum(#3)",
                                                                                            "sum(#4)"
                                                                                        ],
                                                                                        "Estimated Cardinality": "1260710"
                                                                                    },
                                                                                    "cumulative_cardinality": 30422238,
                                                                                    "operator_type": "HASH_GROUP_BY",
                                                                                    "operator_cardinality": 1260710,
                                                                                    "cumulative_rows_scanned": 16202764,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.36924491900000034,
                                                                                    "result_set_size": 85728280,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "PROJECTION",
                                                                                            "cpu_time": 0.8575378180000004,
                                                                                            "extra_info": {
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "displayname",
                                                                                                    "AnswerCount",
                                                                                                    "QuestionCount",
                                                                                                    "CommentCount"
                                                                                                ],
                                                                                                "Estimated Cardinality": "3620911"
                                                                                            },
                                                                                            "cumulative_cardinality": 29161528,
                                                                                            "operator_type": "PROJECTION",
                                                                                            "operator_cardinality": 1260710,
                                                                                            "cumulative_rows_scanned": 16202764,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.00024590099999999976,
                                                                                            "result_set_size": 55471240,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                    "cpu_time": 0.8572919170000004,
                                                                                                    "extra_info": {
                                                                                                        "Join Type": "RIGHT",
                                                                                                        "Conditions": "userid = id",
                                                                                                        "Estimated Cardinality": "3620911"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 27900818,
                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                    "operator_cardinality": 1260710,
                                                                                                    "cumulative_rows_scanned": 16202764,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.14465588499999998,
                                                                                                    "result_set_size": 55471240,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "HASH_GROUP_BY",
                                                                                                            "cpu_time": 0.18546561500000022,
                                                                                                            "extra_info": {
                                                                                                                "Groups": "#0",
                                                                                                                "Aggregates": "count_star()",
                                                                                                                "Estimated Cardinality": "3620911"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 14736736,
                                                                                                            "operator_type": "HASH_GROUP_BY",
                                                                                                            "operator_cardinality": 253092,
                                                                                                            "cumulative_rows_scanned": 7241822,
                                                                                                            "operator_rows_scanned": 0,
                                                                                                            "operator_timing": 0.11140806100000032,
                                                                                                            "result_set_size": 3037104,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "operator_name": "PROJECTION",
                                                                                                                    "cpu_time": 0.0740575539999999,
                                                                                                                    "extra_info": {
                                                                                                                        "Projections": "userid",
                                                                                                                        "Estimated Cardinality": "7241822"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 14483644,
                                                                                                                    "operator_type": "PROJECTION",
                                                                                                                    "operator_cardinality": 7241822,
                                                                                                                    "cumulative_rows_scanned": 7241822,
                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                    "operator_timing": 0.00037637200000000323,
                                                                                                                    "result_set_size": 28967288,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                            "cpu_time": 0.0736811819999999,
                                                                                                                            "extra_info": {
                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                "Projections": [
                                                                                                                                    "id",
                                                                                                                                    "userid"
                                                                                                                                ],
                                                                                                                                "Estimated Cardinality": "7241822"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 7241822,
                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                            "operator_cardinality": 7241822,
                                                                                                                            "cumulative_rows_scanned": 7241822,
                                                                                                                            "operator_rows_scanned": 7241822,
                                                                                                                            "operator_timing": 0.0736811819999999,
                                                                                                                            "result_set_size": 57934576,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "operator_name": "HASH_JOIN",
                                                                                                            "cpu_time": 0.5271704170000002,
                                                                                                            "extra_info": {
                                                                                                                "Join Type": "LEFT",
                                                                                                                "Conditions": "id = owneruserid",
                                                                                                                "Estimated Cardinality": "1260710"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 11903372,
                                                                                                            "operator_type": "HASH_JOIN",
                                                                                                            "operator_cardinality": 1260710,
                                                                                                            "cumulative_rows_scanned": 8960942,
                                                                                                            "operator_rows_scanned": 0,
                                                                                                            "operator_timing": 0.05691720799999998,
                                                                                                            "result_set_size": 45385560,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                                    "cpu_time": 0.291858273,
                                                                                                                    "extra_info": {
                                                                                                                        "Join Type": "LEFT",
                                                                                                                        "Conditions": "id = owneruserid",
                                                                                                                        "Estimated Cardinality": "1260710"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 6976860,
                                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                                    "operator_cardinality": 1260710,
                                                                                                                    "cumulative_rows_scanned": 5110826,
                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                    "operator_timing": 0.027642168999999977,
                                                                                                                    "result_set_size": 35299880,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                            "cpu_time": 0.08062280400000003,
                                                                                                                            "extra_info": {
                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                "Projections": [
                                                                                                                                    "id",
                                                                                                                                    "displayname"
                                                                                                                                ],
                                                                                                                                "Estimated Cardinality": "1260710"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 1260710,
                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                            "operator_cardinality": 1260710,
                                                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                                                            "operator_rows_scanned": 1260710,
                                                                                                                            "operator_timing": 0.08062280400000003,
                                                                                                                            "result_set_size": 25214200,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "operator_name": "HASH_GROUP_BY",
                                                                                                                            "cpu_time": 0.18359330000000001,
                                                                                                                            "extra_info": {
                                                                                                                                "Groups": "#0",
                                                                                                                                "Aggregates": "count_star()",
                                                                                                                                "Estimated Cardinality": "385011"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 4455440,
                                                                                                                            "operator_type": "HASH_GROUP_BY",
                                                                                                                            "operator_cardinality": 100854,
                                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                                            "operator_rows_scanned": 0,
                                                                                                                            "operator_timing": 0.03866865600000002,
                                                                                                                            "result_set_size": 1210248,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "operator_name": "PROJECTION",
                                                                                                                                    "cpu_time": 0.144924644,
                                                                                                                                    "extra_info": {
                                                                                                                                        "Projections": "owneruserid",
                                                                                                                                        "Estimated Cardinality": "770023"
                                                                                                                                    },
                                                                                                                                    "cumulative_cardinality": 4354586,
                                                                                                                                    "operator_type": "PROJECTION",
                                                                                                                                    "operator_cardinality": 2177293,
                                                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                                    "operator_timing": 0.000227593999999998,
                                                                                                                                    "result_set_size": 8709172,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                                            "cpu_time": 0.14469705,
                                                                                                                                            "extra_info": {
                                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                                "Projections": [
                                                                                                                                                    "id",
                                                                                                                                                    "owneruserid"
                                                                                                                                                ],
                                                                                                                                                "Filters": "posttypeid=2",
                                                                                                                                                "Estimated Cardinality": "770023"
                                                                                                                                            },
                                                                                                                                            "cumulative_cardinality": 2177293,
                                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                                            "operator_cardinality": 2177293,
                                                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                                                            "operator_rows_scanned": 3850116,
                                                                                                                                            "operator_timing": 0.14469705,
                                                                                                                                            "result_set_size": 17418344,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "operator_name": "HASH_GROUP_BY",
                                                                                                                    "cpu_time": 0.17839493600000017,
                                                                                                                    "extra_info": {
                                                                                                                        "Groups": "#0",
                                                                                                                        "Aggregates": "count_star()",
                                                                                                                        "Estimated Cardinality": "385011"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 3665802,
                                                                                                                    "operator_type": "HASH_GROUP_BY",
                                                                                                                    "operator_cardinality": 329474,
                                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                    "operator_timing": 0.04904098300000002,
                                                                                                                    "result_set_size": 3953688,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "operator_name": "PROJECTION",
                                                                                                                            "cpu_time": 0.12935395300000016,
                                                                                                                            "extra_info": {
                                                                                                                                "Projections": "owneruserid",
                                                                                                                                "Estimated Cardinality": "770023"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 3336328,
                                                                                                                            "operator_type": "PROJECTION",
                                                                                                                            "operator_cardinality": 1668164,
                                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                                            "operator_rows_scanned": 0,
                                                                                                                            "operator_timing": 0.00028100499999999867,
                                                                                                                            "result_set_size": 6672656,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                                                    "cpu_time": 0.12907294800000016,
                                                                                                                                    "extra_info": {
                                                                                                                                        "Function": "READ_PARQUET",
                                                                                                                                        "Projections": [
                                                                                                                                            "id",
                                                                                                                                            "owneruserid"
                                                                                                                                        ],
                                                                                                                                        "Filters": "posttypeid=1",
                                                                                                                                        "Estimated Cardinality": "770023"
                                                                                                                                    },
                                                                                                                                    "cumulative_cardinality": 1668164,
                                                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                                                    "operator_cardinality": 1668164,
                                                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                                                    "operator_rows_scanned": 3850116,
                                                                                                                                    "operator_timing": 0.12907294800000016,
                                                                                                                                    "result_set_size": 13345312,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "operator_name": "HASH_GROUP_BY",
                                            "cpu_time": 0.020798022,
                                            "extra_info": {
                                                "Groups": "#0",
                                                "Aggregates": "count_star()",
                                                "Estimated Cardinality": "385011"
                                            },
                                            "cumulative_cardinality": 24384,
                                            "operator_type": "HASH_GROUP_BY",
                                            "operator_cardinality": 4530,
                                            "cumulative_rows_scanned": 3850116,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.00030624199999999997,
                                            "result_set_size": 54360,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 0.020491779999999998,
                                                    "extra_info": {
                                                        "Projections": "owneruserid",
                                                        "Estimated Cardinality": "770023"
                                                    },
                                                    "cumulative_cardinality": 19854,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 9927,
                                                    "cumulative_rows_scanned": 3850116,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.000002023,
                                                    "result_set_size": 39708,
                                                    "children": [
                                                        {
                                                            "operator_name": "READ_PARQUET ",
                                                            "cpu_time": 0.020489756999999997,
                                                            "extra_info": {
                                                                "Function": "READ_PARQUET",
                                                                "Projections": [
                                                                    "id",
                                                                    "owneruserid"
                                                                ],
                                                                "Filters": "creationdate>'2024-09-01 12:34:56'::TIMESTAMP",
                                                                "Estimated Cardinality": "770023"
                                                            },
                                                            "cumulative_cardinality": 9927,
                                                            "operator_type": "TABLE_SCAN",
                                                            "operator_cardinality": 9927,
                                                            "cumulative_rows_scanned": 3850116,
                                                            "operator_rows_scanned": 3850116,
                                                            "operator_timing": 0.020489756999999997,
                                                            "result_set_size": 79416,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}