{
    "rows_returned": 10,
    "query_name": "WITH RankedPosts AS (\n    SELECT \n        p.Id AS PostId,\n        p.Title,\n        p.CreationDate,\n        p.Score,\n        p.ViewCount,\n        p.AnswerCount,\n        p.CommentCount,\n        U.DisplayName AS OwnerDisplayName,\n        RANK() OVER (PARTITION BY p.OwnerUserId ORDER BY p.Score DESC, p.CreationDate DESC) AS RankByScore\n    FROM \n        Posts p\n    JOIN \n        Users U ON p.OwnerUserId = U.Id\n    WHERE \n        p.PostTypeId = 1 \n        AND p.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year' \n),\nTopQuestions AS (\n    SELECT *\n    FROM RankedPosts\n    WHERE RankByScore = 1\n),\nUserScores AS (\n    SELECT \n        U.Id AS UserId,\n        U.DisplayName,\n        SUM(p.Score) AS TotalScore,\n        COUNT(DISTINCT p.Id) AS QuestionCount\n    FROM \n        Users U\n    JOIN \n        Posts p ON U.Id = p.OwnerUserId\n    WHERE \n        p.PostTypeId = 1 \n    GROUP BY \n        U.Id, U.DisplayName\n),\nBadgeCounts AS (\n    SELECT \n        B.UserId,\n        COUNT(B.Id) AS BadgeTotal\n    FROM \n        Badges B\n    WHERE \n        B.Class = 1 \n    GROUP BY \n        B.UserId\n)\nSELECT \n    U.DisplayName,\n    US.TotalScore,\n    US.QuestionCount,\n    COALESCE(BC.BadgeTotal, 0) AS GoldBadges,\n    COUNT(C.Id) AS CommentCount,\n    SUM(P.Score) AS TotalPostScore\nFROM \n    UserScores US\nJOIN \n    Users U ON US.UserId = U.Id\nLEFT JOIN \n    BadgeCounts BC ON U.Id = BC.UserId\nLEFT JOIN \n    Comments C ON C.UserId = U.Id\nLEFT JOIN \n    Posts P ON P.OwnerUserId = U.Id\nWHERE \n    U.Reputation >= 1000 \nGROUP BY \n    U.DisplayName, US.TotalScore, US.QuestionCount, BC.BadgeTotal\nORDER BY \n    TotalScore DESC, GoldBadges DESC, QuestionCount DESC\nLIMIT 10;",
    "blocked_thread_time": 0.0,
    "cpu_time": 415.03592428195435,
    "extra_info": {},
    "cumulative_cardinality": 26043104314,
    "cumulative_rows_scanned": 19785198,
    "result_set_size": 720,
    "latency": 454.391651696,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 415.03592428195435,
            "extra_info": {},
            "cumulative_cardinality": 26043104314,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 19785198,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001162,
            "result_set_size": 720,
            "children": [
                {
                    "operator_name": "ORDER_BY",
                    "cpu_time": 415.03592311995436,
                    "extra_info": {
                        "Order By": [
                            "US.TotalScore DESC",
                            "COALESCE(BC.BadgeTotal, 0) DESC",
                            "US.QuestionCount DESC"
                        ]
                    },
                    "cumulative_cardinality": 26043104304,
                    "operator_type": "ORDER_BY",
                    "operator_cardinality": 4096,
                    "cumulative_rows_scanned": 19785198,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.000640446,
                    "result_set_size": 294912,
                    "children": [
                        {
                            "operator_name": "PROJECTION",
                            "cpu_time": 415.0352826739544,
                            "extra_info": {
                                "Projections": [
                                    "displayname",
                                    "TotalScore",
                                    "QuestionCount",
                                    "GoldBadges",
                                    "CommentCount",
                                    "TotalPostScore"
                                ],
                                "Estimated Cardinality": "1260710"
                            },
                            "cumulative_cardinality": 26043100208,
                            "operator_type": "PROJECTION",
                            "operator_cardinality": 10353,
                            "cumulative_rows_scanned": 19785198,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.000089729,
                            "result_set_size": 745416,
                            "children": [
                                {
                                    "operator_name": "HASH_GROUP_BY",
                                    "cpu_time": 415.03519294495436,
                                    "extra_info": {
                                        "Groups": [
                                            "#0",
                                            "#1",
                                            "#2",
                                            "#3"
                                        ],
                                        "Aggregates": [
                                            "count(#4)",
                                            "sum(#5)"
                                        ],
                                        "Estimated Cardinality": "1260710"
                                    },
                                    "cumulative_cardinality": 26043089855,
                                    "operator_type": "HASH_GROUP_BY",
                                    "operator_cardinality": 10353,
                                    "cumulative_rows_scanned": 19785198,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 298.7933134409345,
                                    "result_set_size": 745416,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 116.24187950401982,
                                            "extra_info": {
                                                "Projections": [
                                                    "displayname",
                                                    "TotalScore",
                                                    "QuestionCount",
                                                    "BadgeTotal",
                                                    "id",
                                                    "score"
                                                ],
                                                "Estimated Cardinality": "7241822"
                                            },
                                            "cumulative_cardinality": 26043079502,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 8672326378,
                                            "cumulative_rows_scanned": 19785198,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 1.2289530099945403,
                                            "result_set_size": 485650277168,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 115.01292649402528,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "#2",
                                                            "#3",
                                                            "#4",
                                                            "#1",
                                                            "#0",
                                                            "__internal_decompress_integral_integer(#5, -72)"
                                                        ],
                                                        "Estimated Cardinality": "7241822"
                                                    },
                                                    "cumulative_cardinality": 17370753124,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 8672326378,
                                                    "cumulative_rows_scanned": 19785198,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 3.3102171920021575,
                                                    "result_set_size": 485650277168,
                                                    "children": [
                                                        {
                                                            "operator_name": "HASH_JOIN",
                                                            "cpu_time": 111.70270930202312,
                                                            "extra_info": {
                                                                "Join Type": "LEFT",
                                                                "Conditions": "id = owneruserid",
                                                                "Estimated Cardinality": "7241822"
                                                            },
                                                            "cumulative_cardinality": 8698426746,
                                                            "operator_type": "HASH_JOIN",
                                                            "operator_cardinality": 8672326378,
                                                            "cumulative_rows_scanned": 19785198,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 110.28055490002312,
                                                            "result_set_size": 468305624412,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 1.3792744009999982,
                                                                    "extra_info": {
                                                                        "Join Type": "RIGHT",
                                                                        "Conditions": "userid = id",
                                                                        "Estimated Cardinality": "7241822"
                                                                    },
                                                                    "cumulative_cardinality": 18400136,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 4624189,
                                                                    "cumulative_rows_scanned": 15935082,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.3393947449999988,
                                                                    "result_set_size": 258954584,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.23851145399999973,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "id",
                                                                                    "userid"
                                                                                ],
                                                                                "Estimated Cardinality": "7241822"
                                                                            },
                                                                            "cumulative_cardinality": 6926014,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 6926014,
                                                                            "cumulative_rows_scanned": 7241822,
                                                                            "operator_rows_scanned": 7241822,
                                                                            "operator_timing": 0.23851145399999973,
                                                                            "result_set_size": 55408112,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "operator_name": "HASH_JOIN",
                                                                            "cpu_time": 0.8013682019999997,
                                                                            "extra_info": {
                                                                                "Join Type": "RIGHT",
                                                                                "Conditions": "userid = id",
                                                                                "Estimated Cardinality": "232172"
                                                                            },
                                                                            "cumulative_cardinality": 6849933,
                                                                            "operator_type": "HASH_JOIN",
                                                                            "operator_cardinality": 10353,
                                                                            "cumulative_rows_scanned": 8693260,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.0018887679999999997,
                                                                            "result_set_size": 538356,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "HASH_GROUP_BY",
                                                                                    "cpu_time": 0.020492087999999995,
                                                                                    "extra_info": {
                                                                                        "Groups": "#0",
                                                                                        "Aggregates": "count_star()",
                                                                                        "Estimated Cardinality": "232172"
                                                                                    },
                                                                                    "cumulative_cardinality": 82981,
                                                                                    "operator_type": "HASH_GROUP_BY",
                                                                                    "operator_cardinality": 17659,
                                                                                    "cumulative_rows_scanned": 2321724,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.001029106,
                                                                                    "result_set_size": 211908,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "PROJECTION",
                                                                                            "cpu_time": 0.019462981999999997,
                                                                                            "extra_info": {
                                                                                                "Projections": "userid",
                                                                                                "Estimated Cardinality": "464344"
                                                                                            },
                                                                                            "cumulative_cardinality": 65322,
                                                                                            "operator_type": "PROJECTION",
                                                                                            "operator_cardinality": 32661,
                                                                                            "cumulative_rows_scanned": 2321724,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.000005116999999999999,
                                                                                            "result_set_size": 130644,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.019457864999999998,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "userid"
                                                                                                        ],
                                                                                                        "Filters": "class=1",
                                                                                                        "Estimated Cardinality": "464344"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 32661,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 32661,
                                                                                                    "cumulative_rows_scanned": 2321724,
                                                                                                    "operator_rows_scanned": 2321724,
                                                                                                    "operator_timing": 0.019457864999999998,
                                                                                                    "result_set_size": 261288,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "operator_name": "HASH_JOIN",
                                                                                    "cpu_time": 0.7789873459999997,
                                                                                    "extra_info": {
                                                                                        "Join Type": "INNER",
                                                                                        "Conditions": "UserId = id",
                                                                                        "Estimated Cardinality": "77002"
                                                                                    },
                                                                                    "cumulative_cardinality": 6756599,
                                                                                    "operator_type": "HASH_JOIN",
                                                                                    "operator_cardinality": 10353,
                                                                                    "cumulative_rows_scanned": 6371536,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.005334153999999998,
                                                                                    "result_set_size": 455532,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "PROJECTION",
                                                                                            "cpu_time": 0.7199173859999998,
                                                                                            "extra_info": {
                                                                                                "Projections": [
                                                                                                    "UserId",
                                                                                                    "TotalScore",
                                                                                                    "QuestionCount"
                                                                                                ],
                                                                                                "Estimated Cardinality": "385011"
                                                                                            },
                                                                                            "cumulative_cardinality": 6723806,
                                                                                            "operator_type": "PROJECTION",
                                                                                            "operator_cardinality": 328585,
                                                                                            "cumulative_rows_scanned": 5110826,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.00003420899999999999,
                                                                                            "result_set_size": 9200380,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_GROUP_BY",
                                                                                                    "cpu_time": 0.7198831769999998,
                                                                                                    "extra_info": {
                                                                                                        "Groups": [
                                                                                                            "#0",
                                                                                                            "#1"
                                                                                                        ],
                                                                                                        "Aggregates": [
                                                                                                            "sum(#2)",
                                                                                                            "count(DISTINCT #3)"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "385011"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 6395221,
                                                                                                    "operator_type": "HASH_GROUP_BY",
                                                                                                    "operator_cardinality": 328585,
                                                                                                    "cumulative_rows_scanned": 5110826,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.27698394299999973,
                                                                                                    "result_set_size": 14457740,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "PROJECTION",
                                                                                                            "cpu_time": 0.4428992340000001,
                                                                                                            "extra_info": {
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "displayname",
                                                                                                                    "score",
                                                                                                                    "id"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "770023"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 6066636,
                                                                                                            "operator_type": "PROJECTION",
                                                                                                            "operator_cardinality": 1588527,
                                                                                                            "cumulative_rows_scanned": 5110826,
                                                                                                            "operator_rows_scanned": 0,
                                                                                                            "operator_timing": 0.00040418599999999865,
                                                                                                            "result_set_size": 44478756,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                                    "cpu_time": 0.4424950480000001,
                                                                                                                    "extra_info": {
                                                                                                                        "Join Type": "INNER",
                                                                                                                        "Conditions": "id = owneruserid",
                                                                                                                        "Estimated Cardinality": "770023"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 4478109,
                                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                                    "operator_cardinality": 1588527,
                                                                                                                    "cumulative_rows_scanned": 5110826,
                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                    "operator_timing": 0.19354459599999982,
                                                                                                                    "result_set_size": 44478756,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                            "cpu_time": 0.09287515900000007,
                                                                                                                            "extra_info": {
                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                "Projections": [
                                                                                                                                    "id",
                                                                                                                                    "displayname"
                                                                                                                                ],
                                                                                                                                "Filters": "id<=1416539",
                                                                                                                                "Estimated Cardinality": "1260710"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 1221418,
                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                            "operator_cardinality": 1221418,
                                                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                                                            "operator_rows_scanned": 1260710,
                                                                                                                            "operator_timing": 0.09287515900000007,
                                                                                                                            "result_set_size": 24428360,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                            "cpu_time": 0.15607529300000023,
                                                                                                                            "extra_info": {
                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                "Projections": [
                                                                                                                                    "id",
                                                                                                                                    "score",
                                                                                                                                    "owneruserid"
                                                                                                                                ],
                                                                                                                                "Filters": "posttypeid=1",
                                                                                                                                "Estimated Cardinality": "770023"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 1668164,
                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                            "operator_cardinality": 1668164,
                                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                                            "operator_rows_scanned": 3850116,
                                                                                                                            "operator_timing": 0.15607529300000023,
                                                                                                                            "result_set_size": 20017968,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "operator_name": "FILTER",
                                                                                            "cpu_time": 0.05373580599999998,
                                                                                            "extra_info": {
                                                                                                "Expression": "(id <= 1416539)",
                                                                                                "Estimated Cardinality": "252142"
                                                                                            },
                                                                                            "cumulative_cardinality": 22440,
                                                                                            "operator_type": "FILTER",
                                                                                            "operator_cardinality": 11220,
                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.00053277,
                                                                                            "result_set_size": 224400,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.05320303599999998,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "id",
                                                                                                            "displayname"
                                                                                                        ],
                                                                                                        "Filters": "reputation>=1000",
                                                                                                        "Estimated Cardinality": "252142"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 11220,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 11220,
                                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                                    "operator_rows_scanned": 1260710,
                                                                                                    "operator_timing": 0.05320303599999998,
                                                                                                    "result_set_size": 224400,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.042880001000000036,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "__internal_compress_integral_usmallint(#0, -72)",
                                                                            "#1"
                                                                        ],
                                                                        "Estimated Cardinality": "3850116"
                                                                    },
                                                                    "cumulative_cardinality": 7700232,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 3850116,
                                                                    "cumulative_rows_scanned": 3850116,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.0011815870000000024,
                                                                    "result_set_size": 23100696,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.04169841400000003,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "score",
                                                                                    "owneruserid"
                                                                                ],
                                                                                "Estimated Cardinality": "3850116"
                                                                            },
                                                                            "cumulative_cardinality": 3850116,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 3850116,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 3850116,
                                                                            "operator_timing": 0.04169841400000003,
                                                                            "result_set_size": 30800928,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}