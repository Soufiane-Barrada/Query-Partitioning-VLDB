{
    "rows_returned": 10,
    "query_name": "\nWITH TagStatistics AS (\n    SELECT \n        t.TagName,\n        COUNT(p.Id) AS TotalPosts,\n        SUM(CASE WHEN p.PostTypeId = 1 THEN 1 ELSE 0 END) AS TotalQuestions,\n        SUM(CASE WHEN p.PostTypeId = 2 THEN 1 ELSE 0 END) AS TotalAnswers,\n        SUM(CASE WHEN c.Id IS NOT NULL THEN 1 ELSE 0 END) AS TotalComments\n    FROM \n        Tags t\n    LEFT JOIN \n        Posts p ON p.Tags LIKE '%' || t.TagName || '%'\n    LEFT JOIN \n        Comments c ON c.PostId = p.Id\n    GROUP BY \n        t.TagName\n),\nUserReputation AS (\n    SELECT \n        u.Id,\n        u.DisplayName,\n        SUM(b.Class) AS TotalBadgePoints,\n        SUM(v.BountyAmount) AS TotalBountyEarned\n    FROM \n        Users u\n    LEFT JOIN \n        Badges b ON b.UserId = u.Id\n    LEFT JOIN \n        Votes v ON v.UserId = u.Id AND v.VoteTypeId IN (8, 9) \n    WHERE \n        u.Reputation > 0\n    GROUP BY \n        u.Id, u.DisplayName\n)\nSELECT \n    ts.TagName,\n    ts.TotalPosts,\n    ts.TotalQuestions,\n    ts.TotalAnswers,\n    ts.TotalComments,\n    ur.DisplayName AS TopContributor,\n    ur.TotalBadgePoints,\n    ur.TotalBountyEarned\nFROM \n    TagStatistics ts\nJOIN \n    UserReputation ur ON ur.TotalBadgePoints = (SELECT MAX(TotalBadgePoints) FROM UserReputation)\nORDER BY \n    ts.TotalPosts DESC\nLIMIT 10;\n",
    "blocked_thread_time": 0.0,
    "cpu_time": 500.7708248029941,
    "extra_info": {},
    "cumulative_cardinality": 75337198,
    "cumulative_rows_scanned": 27420441,
    "result_set_size": 1200,
    "latency": 510.672725045,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 500.7708248029941,
            "extra_info": {},
            "cumulative_cardinality": 75337198,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 27420441,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001072,
            "result_set_size": 1200,
            "children": [
                {
                    "operator_name": "ORDER_BY",
                    "cpu_time": 500.77082373099415,
                    "extra_info": {
                        "Order By": "ts.TotalPosts DESC"
                    },
                    "cumulative_cardinality": 75337188,
                    "operator_type": "ORDER_BY",
                    "operator_cardinality": 1976,
                    "cumulative_rows_scanned": 27420441,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.00019071799999999999,
                    "result_set_size": 237120,
                    "children": [
                        {
                            "operator_name": "PROJECTION",
                            "cpu_time": 500.77063301299415,
                            "extra_info": {
                                "Projections": [
                                    "tagname",
                                    "TotalPosts",
                                    "TotalQuestions",
                                    "TotalAnswers",
                                    "TotalComments",
                                    "TopContributor",
                                    "TotalBadgePoints",
                                    "TotalBountyEarned"
                                ],
                                "Estimated Cardinality": "1260710"
                            },
                            "cumulative_cardinality": 75335212,
                            "operator_type": "PROJECTION",
                            "operator_cardinality": 1976,
                            "cumulative_rows_scanned": 27420441,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.000001894,
                            "result_set_size": 237120,
                            "children": [
                                {
                                    "operator_name": "CTE",
                                    "cpu_time": 500.7706311189942,
                                    "extra_info": {
                                        "CTE Name": "UserReputation",
                                        "Table Index": "0"
                                    },
                                    "cumulative_cardinality": 75333236,
                                    "operator_type": "CTE",
                                    "operator_cardinality": 0,
                                    "cumulative_rows_scanned": 27420441,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.019520641,
                                    "result_set_size": 0,
                                    "children": [
                                        {
                                            "operator_name": "HASH_GROUP_BY",
                                            "cpu_time": 1.164870410999999,
                                            "extra_info": {
                                                "Groups": [
                                                    "#0",
                                                    "#1"
                                                ],
                                                "Aggregates": [
                                                    "sum(#2)",
                                                    "sum(#3)"
                                                ],
                                                "Estimated Cardinality": "1260710"
                                            },
                                            "cumulative_cardinality": 26332207,
                                            "operator_type": "HASH_GROUP_BY",
                                            "operator_cardinality": 1260710,
                                            "cumulative_rows_scanned": 16326527,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.5257108019999993,
                                            "result_set_size": 65556920,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 0.6391596089999998,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "id",
                                                            "displayname",
                                                            "class",
                                                            "bountyamount"
                                                        ],
                                                        "Estimated Cardinality": "2548818"
                                                    },
                                                    "cumulative_cardinality": 25071497,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 6098518,
                                                    "cumulative_rows_scanned": 16326527,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.0010181530000000006,
                                                    "result_set_size": 158561468,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.6381414559999998,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "#0",
                                                                    "#1",
                                                                    "#2",
                                                                    "__internal_decompress_integral_integer(#3, 0)"
                                                                ],
                                                                "Estimated Cardinality": "2548818"
                                                            },
                                                            "cumulative_cardinality": 18972979,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 6098518,
                                                            "cumulative_rows_scanned": 16326527,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.00269660900000001,
                                                            "result_set_size": 158561468,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 0.6354448469999998,
                                                                    "extra_info": {
                                                                        "Join Type": "LEFT",
                                                                        "Conditions": "id = userid",
                                                                        "Estimated Cardinality": "2548818"
                                                                    },
                                                                    "cumulative_cardinality": 12874461,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 6098518,
                                                                    "cumulative_rows_scanned": 16326527,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.1044042160000003,
                                                                    "result_set_size": 146364432,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_JOIN",
                                                                            "cpu_time": 0.3515625679999998,
                                                                            "extra_info": {
                                                                                "Join Type": "RIGHT",
                                                                                "Conditions": "userid = id",
                                                                                "Estimated Cardinality": "2321724"
                                                                            },
                                                                            "cumulative_cardinality": 6615847,
                                                                            "operator_type": "HASH_JOIN",
                                                                            "operator_cardinality": 3033413,
                                                                            "cumulative_rows_scanned": 3582434,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.22274426599999972,
                                                                            "result_set_size": 66735086,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.043956842000000065,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "userid",
                                                                                            "class"
                                                                                        ],
                                                                                        "Estimated Cardinality": "2321724"
                                                                                    },
                                                                                    "cumulative_cardinality": 2321724,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 2321724,
                                                                                    "cumulative_rows_scanned": 2321724,
                                                                                    "operator_rows_scanned": 2321724,
                                                                                    "operator_timing": 0.043956842000000065,
                                                                                    "result_set_size": 13930344,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.08486145999999999,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "displayname"
                                                                                        ],
                                                                                        "Estimated Cardinality": "252142"
                                                                                    },
                                                                                    "cumulative_cardinality": 1260710,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 1260710,
                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                    "operator_rows_scanned": 1260710,
                                                                                    "operator_timing": 0.08486145999999999,
                                                                                    "result_set_size": 25214200,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 0.17947806299999963,
                                                                            "extra_info": {
                                                                                "Projections": [
                                                                                    "#0",
                                                                                    "__internal_compress_integral_usmallint(#1, 0)"
                                                                                ],
                                                                                "Estimated Cardinality": "2548818"
                                                                            },
                                                                            "cumulative_cardinality": 160096,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 80048,
                                                                            "cumulative_rows_scanned": 12744093,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.010995235999999834,
                                                                            "result_set_size": 480288,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.1684828269999998,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "userid",
                                                                                            "bountyamount"
                                                                                        ],
                                                                                        "Filters": "votetypeid>=8 AND votetypeid<=9",
                                                                                        "Estimated Cardinality": "2548818"
                                                                                    },
                                                                                    "cumulative_cardinality": 80048,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 80048,
                                                                                    "cumulative_rows_scanned": 12744093,
                                                                                    "operator_rows_scanned": 12744093,
                                                                                    "operator_timing": 0.1684828269999998,
                                                                                    "result_set_size": 640384,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "operator_name": "CROSS_PRODUCT",
                                            "cpu_time": 499.58624006699415,
                                            "extra_info": {},
                                            "cumulative_cardinality": 49001029,
                                            "operator_type": "CROSS_PRODUCT",
                                            "operator_cardinality": 1976,
                                            "cumulative_rows_scanned": 11093914,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.000042257999999999994,
                                            "result_set_size": 276640,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_GROUP_BY",
                                                    "cpu_time": 499.57456080099416,
                                                    "extra_info": {
                                                        "Groups": "#0",
                                                        "Aggregates": [
                                                            "count(#1)",
                                                            "sum(#2)",
                                                            "sum(#3)",
                                                            "sum(#4)"
                                                        ],
                                                        "Estimated Cardinality": "1976"
                                                    },
                                                    "cumulative_cardinality": 45216918,
                                                    "operator_type": "HASH_GROUP_BY",
                                                    "operator_cardinality": 1976,
                                                    "cumulative_rows_scanned": 11093914,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.48367187499999825,
                                                    "result_set_size": 142272,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 499.0908889259942,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "tagname",
                                                                    "id",
                                                                    "CASE  WHEN ((posttypeid = 1)) THEN (1) ELSE 0 END",
                                                                    "CASE  WHEN ((posttypeid = 2)) THEN (1) ELSE 0 END",
                                                                    "CASE  WHEN ((id IS NOT NULL)) THEN (1) ELSE 0 END"
                                                                ],
                                                                "Estimated Cardinality": "7241822"
                                                            },
                                                            "cumulative_cardinality": 45214942,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 14492699,
                                                            "cumulative_rows_scanned": 11093914,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.10811139700000034,
                                                            "result_set_size": 463766368,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 498.9827775289942,
                                                                    "extra_info": {
                                                                        "Join Type": "LEFT",
                                                                        "Conditions": "id = postid",
                                                                        "Estimated Cardinality": "7241822"
                                                                    },
                                                                    "cumulative_cardinality": 30722243,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 14492699,
                                                                    "cumulative_rows_scanned": 11093914,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.8165929569999923,
                                                                    "result_set_size": 376810174,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "BLOCKWISE_NL_JOIN",
                                                                            "cpu_time": 498.08715237099415,
                                                                            "extra_info": {
                                                                                "Join Type": "RIGHT",
                                                                                "Condition": "(tags ~~ (('%' || tagname) || '%'))"
                                                                            },
                                                                            "cumulative_cardinality": 8987722,
                                                                            "operator_type": "BLOCKWISE_NL_JOIN",
                                                                            "operator_cardinality": 5135630,
                                                                            "cumulative_rows_scanned": 3852092,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 497.86427615699415,
                                                                            "result_set_size": 195153940,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.22246758000000005,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "posttypeid",
                                                                                            "tags"
                                                                                        ],
                                                                                        "Estimated Cardinality": "3850116"
                                                                                    },
                                                                                    "cumulative_cardinality": 3850116,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 3850116,
                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                    "operator_rows_scanned": 3850116,
                                                                                    "operator_timing": 0.22246758000000005,
                                                                                    "result_set_size": 84702552,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.00040863399999999995,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": "tagname",
                                                                                        "Estimated Cardinality": "1976"
                                                                                    },
                                                                                    "cumulative_cardinality": 1976,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 1976,
                                                                                    "cumulative_rows_scanned": 1976,
                                                                                    "operator_rows_scanned": 1976,
                                                                                    "operator_timing": 0.00040863399999999995,
                                                                                    "result_set_size": 31616,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.07903220099999976,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "id",
                                                                                    "postid"
                                                                                ],
                                                                                "Estimated Cardinality": "7241822"
                                                                            },
                                                                            "cumulative_cardinality": 7241822,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 7241822,
                                                                            "cumulative_rows_scanned": 7241822,
                                                                            "operator_rows_scanned": 7241822,
                                                                            "operator_timing": 0.07903220099999976,
                                                                            "result_set_size": 57934576,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "operator_name": "HASH_JOIN",
                                                    "cpu_time": 0.011637007999999971,
                                                    "extra_info": {
                                                        "Join Type": "INNER",
                                                        "Conditions": "TotalBadgePoints = SUBQUERY",
                                                        "Estimated Cardinality": "1"
                                                    },
                                                    "cumulative_cardinality": 3782135,
                                                    "operator_type": "HASH_JOIN",
                                                    "operator_cardinality": 1,
                                                    "cumulative_rows_scanned": 0,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.004238910999999973,
                                                    "result_set_size": 68,
                                                    "children": [
                                                        {
                                                            "operator_name": "CTE_SCAN",
                                                            "cpu_time": 0.003152690000000002,
                                                            "extra_info": {
                                                                "CTE Index": "0",
                                                                "Estimated Cardinality": "1260710"
                                                            },
                                                            "cumulative_cardinality": 1260710,
                                                            "operator_type": "CTE_SCAN",
                                                            "operator_cardinality": 1260710,
                                                            "cumulative_rows_scanned": 0,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.003152690000000002,
                                                            "result_set_size": 65556920,
                                                            "children": []
                                                        },
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.004245406999999996,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "CASE  WHEN ((#1 > 1)) THEN (error('More than one row returned by a subquery used as an expression - scalar subqueries can only return a single row.",
                                                                    "Use \"SET scalar_subquery_error_on_multiple_rows=false\" to revert to previous behavior of returning a random row.')) ELSE #0 END"
                                                                ],
                                                                "Estimated Cardinality": "1"
                                                            },
                                                            "cumulative_cardinality": 2521424,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 1,
                                                            "cumulative_rows_scanned": 0,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.000004338,
                                                            "result_set_size": 16,
                                                            "children": [
                                                                {
                                                                    "operator_name": "UNGROUPED_AGGREGATE",
                                                                    "cpu_time": 0.004241068999999996,
                                                                    "extra_info": {
                                                                        "Aggregates": [
                                                                            "\"first\"(#0)",
                                                                            "count_star()"
                                                                        ]
                                                                    },
                                                                    "cumulative_cardinality": 2521423,
                                                                    "operator_type": "UNGROUPED_AGGREGATE",
                                                                    "operator_cardinality": 1,
                                                                    "cumulative_rows_scanned": 0,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.000002816,
                                                                    "result_set_size": 24,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 0.004238252999999996,
                                                                            "extra_info": {
                                                                                "Projections": "#0",
                                                                                "Estimated Cardinality": "1"
                                                                            },
                                                                            "cumulative_cardinality": 2521422,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 1,
                                                                            "cumulative_rows_scanned": 0,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 5.21e-7,
                                                                            "result_set_size": 16,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "UNGROUPED_AGGREGATE",
                                                                                    "cpu_time": 0.004237731999999996,
                                                                                    "extra_info": {
                                                                                        "Aggregates": "max(#0)"
                                                                                    },
                                                                                    "cumulative_cardinality": 2521421,
                                                                                    "operator_type": "UNGROUPED_AGGREGATE",
                                                                                    "operator_cardinality": 1,
                                                                                    "cumulative_rows_scanned": 0,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.0010406999999999973,
                                                                                    "result_set_size": 16,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "PROJECTION",
                                                                                            "cpu_time": 0.0031970319999999985,
                                                                                            "extra_info": {
                                                                                                "Projections": "TotalBadgePoints",
                                                                                                "Estimated Cardinality": "1260710"
                                                                                            },
                                                                                            "cumulative_cardinality": 2521420,
                                                                                            "operator_type": "PROJECTION",
                                                                                            "operator_cardinality": 1260710,
                                                                                            "cumulative_rows_scanned": 0,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.00005255099999999981,
                                                                                            "result_set_size": 20171360,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "CTE_SCAN",
                                                                                                    "cpu_time": 0.003144480999999999,
                                                                                                    "extra_info": {
                                                                                                        "CTE Index": "0",
                                                                                                        "Estimated Cardinality": "1260710"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 1260710,
                                                                                                    "operator_type": "CTE_SCAN",
                                                                                                    "operator_cardinality": 1260710,
                                                                                                    "cumulative_rows_scanned": 0,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.003144480999999999,
                                                                                                    "result_set_size": 65556920,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}