{
    "rows_returned": 100,
    "query_name": "WITH UserBadges AS (\n    SELECT\n        b.UserId,\n        COUNT(b.Id) AS BadgeCount,\n        STRING_AGG(b.Name, ', ') AS BadgeNames\n    FROM Badges b\n    GROUP BY b.UserId\n),\nPostStats AS (\n    SELECT\n        p.OwnerUserId,\n        COUNT(p.Id) AS PostCount,\n        COUNT(DISTINCT CASE WHEN p.PostTypeId = 1 THEN p.Id END) AS QuestionCount,\n        SUM(COALESCE(p.Score, 0)) AS TotalScore,\n        SUM(COALESCE(p.ViewCount, 0)) AS TotalViews\n    FROM Posts p\n    WHERE p.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year'\n    GROUP BY p.OwnerUserId\n),\nClosedPosts AS (\n    SELECT\n        ph.UserId,\n        ph.PostId,\n        ph.CreationDate,\n        MIN(CASE WHEN ph.PostHistoryTypeId = 10 THEN ph.CreationDate END) AS CloseDate\n    FROM PostHistory ph\n    WHERE ph.PostHistoryTypeId IN (10, 11) \n    GROUP BY ph.UserId, ph.PostId, ph.CreationDate\n),\nUserActivity AS (\n    SELECT\n        u.Id AS UserId,\n        u.DisplayName,\n        COALESCE(ub.BadgeCount, 0) AS BadgeCount,\n        COALESCE(ps.PostCount, 0) AS PostCount,\n        COALESCE(ps.QuestionCount, 0) AS QuestionCount,\n        COALESCE(ps.TotalScore, 0) AS TotalScore,\n        COALESCE(ps.TotalViews, 0) AS TotalViews,\n        COUNT(cp.PostId) AS ClosedPostCount,\n        MAX(cp.CloseDate) AS LastClosedDate\n    FROM Users u\n    LEFT JOIN UserBadges ub ON u.Id = ub.UserId\n    LEFT JOIN PostStats ps ON u.Id = ps.OwnerUserId\n    LEFT JOIN ClosedPosts cp ON u.Id = cp.UserId\n    GROUP BY u.Id, u.DisplayName, ub.BadgeCount, ps.PostCount, ps.QuestionCount, ps.TotalScore, ps.TotalViews\n)\nSELECT\n    ua.UserId,\n    ua.DisplayName,\n    ua.BadgeCount,\n    ua.PostCount,\n    ua.QuestionCount,\n    ua.TotalScore,\n    ua.TotalViews,\n    ua.ClosedPostCount,\n    ua.LastClosedDate,\n    CASE \n        WHEN ua.BadgeCount >= 10 THEN 'Gold'\n        WHEN ua.BadgeCount >= 5 THEN 'Silver'\n        ELSE 'Bronze'\n    END AS BadgeLevel,\n    CASE\n        WHEN ua.ClosedPostCount > 0 THEN 'Has Closed Posts'\n        ELSE 'No Closed Posts'\n    END AS PostClosureStatus\nFROM UserActivity ua\nWHERE ua.TotalViews > 1000 OR ua.QuestionCount > 5\nORDER BY ua.TotalScore DESC, ua.TotalViews DESC\nLIMIT 100;",
    "blocked_thread_time": 0.0,
    "cpu_time": 0.7619892,
    "extra_info": {},
    "cumulative_cardinality": 9809719,
    "cumulative_rows_scanned": 19227794,
    "result_set_size": 12400,
    "latency": 0.858144595,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 0.7619892,
            "extra_info": {},
            "cumulative_cardinality": 9809719,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 100,
            "cumulative_rows_scanned": 19227794,
            "operator_rows_scanned": 0,
            "operator_timing": 9.62e-7,
            "result_set_size": 12400,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 0.761988238,
                    "extra_info": {
                        "Projections": [
                            "#0",
                            "#1",
                            "#2",
                            "#3",
                            "#4",
                            "#5",
                            "#6",
                            "#7",
                            "#8",
                            "__internal_decompress_string(#9)",
                            "#10"
                        ],
                        "Estimated Cardinality": "589762"
                    },
                    "cumulative_cardinality": 9809619,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 2687,
                    "cumulative_rows_scanned": 19227794,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.000025156,
                    "result_set_size": 333188,
                    "children": [
                        {
                            "operator_name": "ORDER_BY",
                            "cpu_time": 0.7619630820000001,
                            "extra_info": {
                                "Order By": [
                                    "ua.TotalScore DESC",
                                    "ua.TotalViews DESC"
                                ]
                            },
                            "cumulative_cardinality": 9806932,
                            "operator_type": "ORDER_BY",
                            "operator_cardinality": 2687,
                            "cumulative_rows_scanned": 19227794,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.000252991,
                            "result_set_size": 311692,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 0.7617100910000001,
                                    "extra_info": {
                                        "Projections": [
                                            "#0",
                                            "#1",
                                            "#2",
                                            "#3",
                                            "#4",
                                            "#5",
                                            "#6",
                                            "#7",
                                            "#8",
                                            "__internal_compress_string_ubigint(#9)",
                                            "#10"
                                        ],
                                        "Estimated Cardinality": "589762"
                                    },
                                    "cumulative_cardinality": 9804245,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 2687,
                                    "cumulative_rows_scanned": 19227794,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.000024504999999999997,
                                    "result_set_size": 311692,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 0.7616855860000001,
                                            "extra_info": {
                                                "Projections": [
                                                    "UserId",
                                                    "displayname",
                                                    "BadgeCount",
                                                    "PostCount",
                                                    "QuestionCount",
                                                    "TotalScore",
                                                    "TotalViews",
                                                    "ClosedPostCount",
                                                    "LastClosedDate",
                                                    "BadgeLevel",
                                                    "PostClosureStatus"
                                                ],
                                                "Estimated Cardinality": "589762"
                                            },
                                            "cumulative_cardinality": 9801558,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 2687,
                                            "cumulative_rows_scanned": 19227794,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.000035155,
                                            "result_set_size": 333188,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 0.7616504310000002,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "UserId",
                                                            "displayname",
                                                            "BadgeCount",
                                                            "PostCount",
                                                            "QuestionCount",
                                                            "TotalScore",
                                                            "TotalViews",
                                                            "ClosedPostCount",
                                                            "LastClosedDate"
                                                        ],
                                                        "Estimated Cardinality": "589762"
                                                    },
                                                    "cumulative_cardinality": 9798871,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 2687,
                                                    "cumulative_rows_scanned": 19227794,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.000101019,
                                                    "result_set_size": 247204,
                                                    "children": [
                                                        {
                                                            "operator_name": "HASH_GROUP_BY",
                                                            "cpu_time": 0.7615494120000001,
                                                            "extra_info": {
                                                                "Groups": [
                                                                    "#0",
                                                                    "#1",
                                                                    "#2",
                                                                    "#3",
                                                                    "#4",
                                                                    "#5",
                                                                    "#6"
                                                                ],
                                                                "Aggregates": [
                                                                    "count(#7)",
                                                                    "max(#8)"
                                                                ],
                                                                "Estimated Cardinality": "589762"
                                                            },
                                                            "cumulative_cardinality": 9796184,
                                                            "operator_type": "HASH_GROUP_BY",
                                                            "operator_cardinality": 2687,
                                                            "cumulative_rows_scanned": 19227794,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.0006093489999999999,
                                                            "result_set_size": 247204,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.7609400630000002,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "id",
                                                                            "displayname",
                                                                            "BadgeCount",
                                                                            "PostCount",
                                                                            "QuestionCount",
                                                                            "TotalScore",
                                                                            "TotalViews",
                                                                            "postid",
                                                                            "CloseDate"
                                                                        ],
                                                                        "Estimated Cardinality": "1179524"
                                                                    },
                                                                    "cumulative_cardinality": 9793497,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 3381,
                                                                    "cumulative_rows_scanned": 19227794,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.000002093,
                                                                    "result_set_size": 297528,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_JOIN",
                                                                            "cpu_time": 0.7609379700000002,
                                                                            "extra_info": {
                                                                                "Join Type": "RIGHT",
                                                                                "Conditions": "userid = id",
                                                                                "Estimated Cardinality": "1179524"
                                                                            },
                                                                            "cumulative_cardinality": 9790116,
                                                                            "operator_type": "HASH_JOIN",
                                                                            "operator_cardinality": 3381,
                                                                            "cumulative_rows_scanned": 19227794,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.0012456900000000003,
                                                                            "result_set_size": 297528,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 0.45556544100000007,
                                                                                    "extra_info": {
                                                                                        "Projections": [
                                                                                            "userid",
                                                                                            "postid",
                                                                                            "CloseDate"
                                                                                        ],
                                                                                        "Estimated Cardinality": "1179524"
                                                                                    },
                                                                                    "cumulative_cardinality": 525896,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 131474,
                                                                                    "cumulative_rows_scanned": 11795244,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.000011313000000000007,
                                                                                    "result_set_size": 2103584,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_GROUP_BY",
                                                                                            "cpu_time": 0.45555412800000006,
                                                                                            "extra_info": {
                                                                                                "Groups": [
                                                                                                    "#0",
                                                                                                    "#1",
                                                                                                    "#2"
                                                                                                ],
                                                                                                "Aggregates": "min(#3)",
                                                                                                "Estimated Cardinality": "1179524"
                                                                                            },
                                                                                            "cumulative_cardinality": 394422,
                                                                                            "operator_type": "HASH_GROUP_BY",
                                                                                            "operator_cardinality": 131474,
                                                                                            "cumulative_rows_scanned": 11795244,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.03653952999999994,
                                                                                            "result_set_size": 3155376,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "PROJECTION",
                                                                                                    "cpu_time": 0.4190145980000001,
                                                                                                    "extra_info": {
                                                                                                        "Projections": [
                                                                                                            "userid",
                                                                                                            "postid",
                                                                                                            "creationdate",
                                                                                                            "CASE  WHEN ((posthistorytypeid = 10)) THEN (creationdate) ELSE NULL END"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "2359048"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 262948,
                                                                                                    "operator_type": "PROJECTION",
                                                                                                    "operator_cardinality": 131474,
                                                                                                    "cumulative_rows_scanned": 11795244,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.006413386999999973,
                                                                                                    "result_set_size": 3155376,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.41260121100000013,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "posthistorytypeid",
                                                                                                                    "postid",
                                                                                                                    "creationdate",
                                                                                                                    "userid"
                                                                                                                ],
                                                                                                                "Filters": "posthistorytypeid>=10 AND posthistorytypeid<=11",
                                                                                                                "Estimated Cardinality": "2359048"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 131474,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 131474,
                                                                                                            "cumulative_rows_scanned": 11795244,
                                                                                                            "operator_rows_scanned": 11795244,
                                                                                                            "operator_timing": 0.41260121100000013,
                                                                                                            "result_set_size": 2366532,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "operator_name": "HASH_JOIN",
                                                                                    "cpu_time": 0.3041268390000001,
                                                                                    "extra_info": {
                                                                                        "Join Type": "INNER",
                                                                                        "Conditions": "id = owneruserid",
                                                                                        "Estimated Cardinality": "77002"
                                                                                    },
                                                                                    "cumulative_cardinality": 9260839,
                                                                                    "operator_type": "HASH_JOIN",
                                                                                    "operator_cardinality": 2687,
                                                                                    "cumulative_rows_scanned": 7432550,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.02129618199999999,
                                                                                    "result_set_size": 204212,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "FILTER",
                                                                                            "cpu_time": 0.2335780690000001,
                                                                                            "extra_info": {
                                                                                                "Expression": "(id <= 1416539)",
                                                                                                "Estimated Cardinality": "1260710"
                                                                                            },
                                                                                            "cumulative_cardinality": 8931927,
                                                                                            "operator_type": "FILTER",
                                                                                            "operator_cardinality": 1246486,
                                                                                            "cumulative_rows_scanned": 3582434,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.0024779289999999994,
                                                                                            "result_set_size": 34901608,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                    "cpu_time": 0.23110014000000012,
                                                                                                    "extra_info": {
                                                                                                        "Join Type": "LEFT",
                                                                                                        "Conditions": "id = userid",
                                                                                                        "Estimated Cardinality": "1260710"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 7685441,
                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                    "operator_cardinality": 1246486,
                                                                                                    "cumulative_rows_scanned": 3582434,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.06124054400000006,
                                                                                                    "result_set_size": 34901608,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.08405141499999999,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "displayname"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "1260710"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 1246486,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 1246486,
                                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                                            "operator_rows_scanned": 1260710,
                                                                                                            "operator_timing": 0.08405141499999999,
                                                                                                            "result_set_size": 24929720,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "operator_name": "HASH_GROUP_BY",
                                                                                                            "cpu_time": 0.08580818100000008,
                                                                                                            "extra_info": {
                                                                                                                "Groups": "#0",
                                                                                                                "Aggregates": "count_star()",
                                                                                                                "Estimated Cardinality": "1160862"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 5192469,
                                                                                                            "operator_type": "HASH_GROUP_BY",
                                                                                                            "operator_cardinality": 549021,
                                                                                                            "cumulative_rows_scanned": 2321724,
                                                                                                            "operator_rows_scanned": 0,
                                                                                                            "operator_timing": 0.060793761000000106,
                                                                                                            "result_set_size": 6588252,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "operator_name": "PROJECTION",
                                                                                                                    "cpu_time": 0.025014419999999978,
                                                                                                                    "extra_info": {
                                                                                                                        "Projections": "userid",
                                                                                                                        "Estimated Cardinality": "2321724"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 4643448,
                                                                                                                    "operator_type": "PROJECTION",
                                                                                                                    "operator_cardinality": 2321724,
                                                                                                                    "cumulative_rows_scanned": 2321724,
                                                                                                                    "operator_rows_scanned": 0,
                                                                                                                    "operator_timing": 0.0001781309999999994,
                                                                                                                    "result_set_size": 9286896,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                                            "cpu_time": 0.02483628899999998,
                                                                                                                            "extra_info": {
                                                                                                                                "Function": "READ_PARQUET",
                                                                                                                                "Projections": [
                                                                                                                                    "id",
                                                                                                                                    "userid"
                                                                                                                                ],
                                                                                                                                "Estimated Cardinality": "2321724"
                                                                                                                            },
                                                                                                                            "cumulative_cardinality": 2321724,
                                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                                            "operator_cardinality": 2321724,
                                                                                                                            "cumulative_rows_scanned": 2321724,
                                                                                                                            "operator_rows_scanned": 2321724,
                                                                                                                            "operator_timing": 0.02483628899999998,
                                                                                                                            "result_set_size": 18573792,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "operator_name": "FILTER",
                                                                                            "cpu_time": 0.04925258800000001,
                                                                                            "extra_info": {
                                                                                                "Expression": "((COALESCE(TotalViews, 0) > 1000) OR (COALESCE(QuestionCount, 0) > 5))",
                                                                                                "Estimated Cardinality": "77002"
                                                                                            },
                                                                                            "cumulative_cardinality": 326225,
                                                                                            "operator_type": "FILTER",
                                                                                            "operator_cardinality": 2688,
                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 0.0006738280000000001,
                                                                                            "result_set_size": 139776,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_GROUP_BY",
                                                                                                    "cpu_time": 0.048578760000000006,
                                                                                                    "extra_info": {
                                                                                                        "Groups": "#0",
                                                                                                        "Aggregates": [
                                                                                                            "count_star()",
                                                                                                            "count(DISTINCT #1)",
                                                                                                            "sum(#2)",
                                                                                                            "sum(#3)"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "385011"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 323537,
                                                                                                    "operator_type": "HASH_GROUP_BY",
                                                                                                    "operator_cardinality": 32453,
                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.013244065,
                                                                                                    "result_set_size": 1687556,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "PROJECTION",
                                                                                                            "cpu_time": 0.035334695000000006,
                                                                                                            "extra_info": {
                                                                                                                "Projections": [
                                                                                                                    "owneruserid",
                                                                                                                    "CASE  WHEN ((posttypeid = 1)) THEN (id) ELSE NULL END",
                                                                                                                    "score",
                                                                                                                    "COALESCE(viewcount, 0)"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "770023"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 291084,
                                                                                                            "operator_type": "PROJECTION",
                                                                                                            "operator_cardinality": 145542,
                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                            "operator_rows_scanned": 0,
                                                                                                            "operator_timing": 0.0028642850000000007,
                                                                                                            "result_set_size": 2328672,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                                    "cpu_time": 0.032470410000000005,
                                                                                                                    "extra_info": {
                                                                                                                        "Function": "READ_PARQUET",
                                                                                                                        "Projections": [
                                                                                                                            "id",
                                                                                                                            "posttypeid",
                                                                                                                            "score",
                                                                                                                            "viewcount",
                                                                                                                            "owneruserid"
                                                                                                                        ],
                                                                                                                        "Filters": "creationdate>='2023-10-01 12:34:56'::TIMESTAMP",
                                                                                                                        "Estimated Cardinality": "770023"
                                                                                                                    },
                                                                                                                    "cumulative_cardinality": 145542,
                                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                                    "operator_cardinality": 145542,
                                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                                    "operator_rows_scanned": 3850116,
                                                                                                                    "operator_timing": 0.032470410000000005,
                                                                                                                    "result_set_size": 2619756,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}