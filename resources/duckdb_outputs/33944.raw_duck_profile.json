{
    "rows_returned": 10,
    "query_name": "WITH RECURSIVE UserReputationCTE AS (\n    SELECT \n        Id,\n        Reputation,\n        CreationDate,\n        1 AS Level\n    FROM \n        Users\n    WHERE \n        Reputation > 1000\n    \n    UNION ALL\n    \n    SELECT \n        u.Id,\n        u.Reputation,\n        u.CreationDate,\n        ur.Level + 1\n    FROM \n        Users u\n    INNER JOIN UserReputationCTE ur ON u.Reputation > ur.Reputation\n    WHERE \n        ur.Level < 3\n),\nMostActiveUsers AS (\n    SELECT \n        u.Id,\n        u.DisplayName,\n        COUNT(c.Id) AS CommentCount,\n        SUM(p.ViewCount) AS TotalViews\n    FROM \n        Users u\n    LEFT JOIN \n        Comments c ON u.Id = c.UserId\n    LEFT JOIN \n        Posts p ON u.Id = p.OwnerUserId\n    WHERE \n        u.Reputation > 500\n    GROUP BY \n        u.Id, u.DisplayName\n),\nTopPosts AS (\n    SELECT \n        p.Id,\n        p.Title,\n        p.Score,\n        ROW_NUMBER() OVER (ORDER BY p.Score DESC) AS Rank\n    FROM \n        Posts p\n    WHERE \n        p.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year'\n)\nSELECT \n    u.DisplayName AS UserName,\n    u.Reputation AS UserReputation,\n    COALESCE(ua.CommentCount, 0) AS TotalComments,\n    COALESCE(ua.TotalViews, 0) AS TotalViews,\n    tp.Title AS TopPostTitle,\n    tp.Score AS TopPostScore\nFROM \n    Users u\nLEFT JOIN \n    MostActiveUsers ua ON u.Id = ua.Id\nLEFT JOIN \n    TopPosts tp ON u.Id = tp.Id\nWHERE \n    u.CreationDate < cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '30 days'\nAND \n    (u.Location IS NOT NULL OR u.WebsiteUrl IS NOT NULL)\nORDER BY \n    UserReputation DESC,\n    TotalViews DESC\nLIMIT 10;",
    "blocked_thread_time": 0.0,
    "cpu_time": 375.2098256740091,
    "extra_info": {},
    "cumulative_cardinality": 21500895350,
    "cumulative_rows_scanned": 17463474,
    "result_set_size": 640,
    "latency": 403.810715002,
    "children": [
        {
            "operator_name": "STREAMING_LIMIT",
            "cpu_time": 375.2098256740091,
            "extra_info": {},
            "cumulative_cardinality": 21500895350,
            "operator_type": "STREAMING_LIMIT",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 17463474,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000001624,
            "result_set_size": 640,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 375.2098240500091,
                    "extra_info": {
                        "Projections": [
                            "#0",
                            "#1",
                            "#2",
                            "#3",
                            "#4",
                            "__internal_decompress_integral_integer(#5, -72)"
                        ],
                        "Estimated Cardinality": "1260710"
                    },
                    "cumulative_cardinality": 21500895340,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 4096,
                    "cumulative_rows_scanned": 17463474,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.000007435,
                    "result_set_size": 262144,
                    "children": [
                        {
                            "operator_name": "ORDER_BY",
                            "cpu_time": 375.2098166150091,
                            "extra_info": {
                                "Order By": [
                                    "u.Reputation DESC",
                                    "COALESCE(ua.TotalViews, 0) DESC"
                                ]
                            },
                            "cumulative_cardinality": 21500891244,
                            "operator_type": "ORDER_BY",
                            "operator_cardinality": 4096,
                            "cumulative_rows_scanned": 17463474,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.019042975000000004,
                            "result_set_size": 253952,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 375.1907736400091,
                                    "extra_info": {
                                        "Projections": [
                                            "#0",
                                            "#1",
                                            "#2",
                                            "#3",
                                            "#4",
                                            "__internal_compress_integral_usmallint(#5, -72)"
                                        ],
                                        "Estimated Cardinality": "1260710"
                                    },
                                    "cumulative_cardinality": 21500887148,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 230301,
                                    "cumulative_rows_scanned": 17463474,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.00008920800000000003,
                                    "result_set_size": 14278662,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 375.1906844320091,
                                            "extra_info": {
                                                "Projections": [
                                                    "UserName",
                                                    "UserReputation",
                                                    "TotalComments",
                                                    "TotalViews",
                                                    "TopPostTitle",
                                                    "TopPostScore"
                                                ],
                                                "Estimated Cardinality": "1260710"
                                            },
                                            "cumulative_cardinality": 21500656847,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 230301,
                                            "cumulative_rows_scanned": 17463474,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.003031855,
                                            "result_set_size": 14739264,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_JOIN",
                                                    "cpu_time": 375.1876525770091,
                                                    "extra_info": {
                                                        "Join Type": "LEFT",
                                                        "Conditions": "id = id",
                                                        "Estimated Cardinality": "1260710"
                                                    },
                                                    "cumulative_cardinality": 21500426546,
                                                    "operator_type": "HASH_JOIN",
                                                    "operator_cardinality": 230301,
                                                    "cumulative_rows_scanned": 17463474,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.020907634,
                                                    "result_set_size": 14739264,
                                                    "children": [
                                                        {
                                                            "operator_name": "HASH_JOIN",
                                                            "cpu_time": 375.0935531880091,
                                                            "extra_info": {
                                                                "Join Type": "RIGHT",
                                                                "Conditions": "id = id",
                                                                "Estimated Cardinality": "1260710"
                                                            },
                                                            "cumulative_cardinality": 21499614077,
                                                            "operator_type": "HASH_JOIN",
                                                            "operator_cardinality": 230301,
                                                            "cumulative_rows_scanned": 13613358,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.02654062099999999,
                                                            "result_set_size": 11054448,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 374.9215958990091,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "id",
                                                                            "CommentCount",
                                                                            "TotalViews"
                                                                        ],
                                                                        "Estimated Cardinality": "1260710"
                                                                    },
                                                                    "cumulative_cardinality": 21497691694,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 21377,
                                                                    "cumulative_rows_scanned": 12352648,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.000005339999999999999,
                                                                    "result_set_size": 598556,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_GROUP_BY",
                                                                            "cpu_time": 374.92159055900913,
                                                                            "extra_info": {
                                                                                "Groups": [
                                                                                    "#0",
                                                                                    "#1"
                                                                                ],
                                                                                "Aggregates": [
                                                                                    "count(#2)",
                                                                                    "sum(#3)"
                                                                                ],
                                                                                "Estimated Cardinality": "1260710"
                                                                            },
                                                                            "cumulative_cardinality": 21497670317,
                                                                            "operator_type": "HASH_GROUP_BY",
                                                                            "operator_cardinality": 21377,
                                                                            "cumulative_rows_scanned": 12352648,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 231.00978060896867,
                                                                            "result_set_size": 940588,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 143.91180995004044,
                                                                                    "extra_info": {
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "displayname",
                                                                                            "id",
                                                                                            "viewcount"
                                                                                        ],
                                                                                        "Estimated Cardinality": "7241822"
                                                                                    },
                                                                                    "cumulative_cardinality": 21497648940,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 10740622869,
                                                                                    "cumulative_rows_scanned": 12352648,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 1.0838695740033675,
                                                                                    "result_set_size": 300737440332,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_JOIN",
                                                                                            "cpu_time": 142.82794037603708,
                                                                                            "extra_info": {
                                                                                                "Join Type": "LEFT",
                                                                                                "Conditions": "id = owneruserid",
                                                                                                "Estimated Cardinality": "7241822"
                                                                                            },
                                                                                            "cumulative_cardinality": 10757026071,
                                                                                            "operator_type": "HASH_JOIN",
                                                                                            "operator_cardinality": 10740622869,
                                                                                            "cumulative_rows_scanned": 12352648,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 142.12009717703708,
                                                                                            "result_set_size": 300737440332,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                    "cpu_time": 0.6591305840000008,
                                                                                                    "extra_info": {
                                                                                                        "Join Type": "RIGHT",
                                                                                                        "Conditions": "userid = id",
                                                                                                        "Estimated Cardinality": "7241822"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 12553086,
                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                    "operator_cardinality": 5605482,
                                                                                                    "cumulative_rows_scanned": 8502532,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.3494062650000003,
                                                                                                    "result_set_size": 134531568,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.25618067400000044,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "userid"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "7241822"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 6926227,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 6926227,
                                                                                                            "cumulative_rows_scanned": 7241822,
                                                                                                            "operator_rows_scanned": 7241822,
                                                                                                            "operator_timing": 0.25618067400000044,
                                                                                                            "result_set_size": 55409816,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.05354364500000003,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "displayname"
                                                                                                                ],
                                                                                                                "Filters": "reputation>500",
                                                                                                                "Estimated Cardinality": "252142"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 21377,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 21377,
                                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                                            "operator_rows_scanned": 1260710,
                                                                                                            "operator_timing": 0.05354364500000003,
                                                                                                            "result_set_size": 427540,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.04871261500000001,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "viewcount",
                                                                                                            "owneruserid"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "3850116"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 3850116,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 3850116,
                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                    "operator_rows_scanned": 3850116,
                                                                                                    "operator_timing": 0.04871261500000001,
                                                                                                    "result_set_size": 30800928,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.14541666800000003,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "#0",
                                                                            "#1",
                                                                            "#2"
                                                                        ],
                                                                        "Estimated Cardinality": "50428"
                                                                    },
                                                                    "cumulative_cardinality": 1692082,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 230301,
                                                                    "cumulative_rows_scanned": 1260710,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.00012867599999999993,
                                                                    "result_set_size": 5527224,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "FILTER",
                                                                            "cpu_time": 0.14528799200000003,
                                                                            "extra_info": {
                                                                                "Expression": "((location IS NOT NULL) OR (websiteurl IS NOT NULL))",
                                                                                "Estimated Cardinality": "50428"
                                                                            },
                                                                            "cumulative_cardinality": 1461781,
                                                                            "operator_type": "FILTER",
                                                                            "operator_cardinality": 230301,
                                                                            "cumulative_rows_scanned": 1260710,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.01232259899999999,
                                                                            "result_set_size": 12896856,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.13296539300000004,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "reputation",
                                                                                            "displayname",
                                                                                            "websiteurl",
                                                                                            "location"
                                                                                        ],
                                                                                        "Filters": "creationdate<'2024-09-01 12:34:56'::TIMESTAMP",
                                                                                        "Estimated Cardinality": "252142"
                                                                                    },
                                                                                    "cumulative_cardinality": 1231480,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 1231480,
                                                                                    "cumulative_rows_scanned": 1260710,
                                                                                    "operator_rows_scanned": 1260710,
                                                                                    "operator_timing": 0.13296539300000004,
                                                                                    "result_set_size": 68962880,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.073191755,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "id",
                                                                    "title",
                                                                    "score"
                                                                ],
                                                                "Estimated Cardinality": "770023"
                                                            },
                                                            "cumulative_cardinality": 582168,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 145542,
                                                            "cumulative_rows_scanned": 3850116,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.00001197100000000001,
                                                            "result_set_size": 3493008,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 0.073179784,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "#0",
                                                                            "#1",
                                                                            "#2",
                                                                            "#3"
                                                                        ],
                                                                        "Estimated Cardinality": "770023"
                                                                    },
                                                                    "cumulative_cardinality": 436626,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 145542,
                                                                    "cumulative_rows_scanned": 3850116,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.000017597999999999986,
                                                                    "result_set_size": 4657344,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "WINDOW",
                                                                            "cpu_time": 0.073162186,
                                                                            "extra_info": {
                                                                                "Projections": "ROW_NUMBER() OVER (ORDER BY score DESC NULLS LAST)"
                                                                            },
                                                                            "cumulative_cardinality": 291084,
                                                                            "operator_type": "WINDOW",
                                                                            "operator_cardinality": 145542,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.009884737,
                                                                            "result_set_size": 4657344,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "READ_PARQUET ",
                                                                                    "cpu_time": 0.063277449,
                                                                                    "extra_info": {
                                                                                        "Function": "READ_PARQUET",
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "score",
                                                                                            "title"
                                                                                        ],
                                                                                        "Filters": "creationdate>='2023-10-01 12:34:56'::TIMESTAMP",
                                                                                        "Estimated Cardinality": "770023"
                                                                                    },
                                                                                    "cumulative_cardinality": 145542,
                                                                                    "operator_type": "TABLE_SCAN",
                                                                                    "operator_cardinality": 145542,
                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                    "operator_rows_scanned": 3850116,
                                                                                    "operator_timing": 0.063277449,
                                                                                    "result_set_size": 3493008,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}