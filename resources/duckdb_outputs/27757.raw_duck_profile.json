{
    "rows_returned": 10,
    "query_name": "WITH FrequentTags AS (\n    SELECT \n        TRIM(UNNEST(string_to_array(SUBSTRING(Tags FROM 2 FOR LENGTH(Tags) - 2), '><'))) AS Tag\n    FROM \n        Posts\n    WHERE \n        PostTypeId = 1  \n),\nTagUsage AS (\n    SELECT \n        Tag, \n        COUNT(*) AS UsageCount\n    FROM \n        FrequentTags\n    GROUP BY \n        Tag\n    ORDER BY \n        UsageCount DESC\n    LIMIT 10  \n),\nUserReputation AS (\n    SELECT \n        u.Id AS UserId,\n        u.Reputation,\n        COUNT(DISTINCT p.Id) AS PostCount\n    FROM \n        Users u\n    JOIN \n        Posts p ON u.Id = p.OwnerUserId\n    WHERE \n        p.PostTypeId IN (1, 2)  \n    GROUP BY \n        u.Id, u.Reputation\n),\nCombinedData AS (\n    SELECT \n        tr.Tag,\n        ur.UserId,\n        ur.Reputation,\n        ur.PostCount\n    FROM \n        TagUsage tr\n    CROSS JOIN \n        UserReputation ur\n)\nSELECT \n    Tag,\n    COUNT(DISTINCT UserId) AS UserCount,\n    AVG(Reputation) AS AverageReputation,\n    SUM(PostCount) AS TotalPosts\nFROM \n    CombinedData\nGROUP BY \n    Tag\nORDER BY \n    UserCount DESC;",
    "blocked_thread_time": 0.0,
    "cpu_time": 6.104659912001042,
    "extra_info": {},
    "cumulative_cardinality": 37794877,
    "cumulative_rows_scanned": 8960942,
    "result_set_size": 480,
    "latency": 11.938790721,
    "children": [
        {
            "operator_name": "ORDER_BY",
            "cpu_time": 6.104659912001042,
            "extra_info": {
                "Order By": "count(DISTINCT CombinedData.UserId) DESC"
            },
            "cumulative_cardinality": 37794877,
            "operator_type": "ORDER_BY",
            "operator_cardinality": 10,
            "cumulative_rows_scanned": 8960942,
            "operator_rows_scanned": 0,
            "operator_timing": 0.000035377,
            "result_set_size": 480,
            "children": [
                {
                    "operator_name": "HASH_GROUP_BY",
                    "cpu_time": 6.104624535001042,
                    "extra_info": {
                        "Groups": "#0",
                        "Aggregates": [
                            "count(DISTINCT #1)",
                            "avg(#2)",
                            "sum(#3)"
                        ],
                        "Estimated Cardinality": "1925055"
                    },
                    "cumulative_cardinality": 37794867,
                    "operator_type": "HASH_GROUP_BY",
                    "operator_cardinality": 10,
                    "cumulative_rows_scanned": 8960942,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.5011355639999997,
                    "result_set_size": 480,
                    "children": [
                        {
                            "operator_name": "PROJECTION",
                            "cpu_time": 5.603488971001043,
                            "extra_info": {
                                "Projections": [
                                    "Tag",
                                    "UserId",
                                    "reputation",
                                    "PostCount"
                                ],
                                "Estimated Cardinality": "3850110"
                            },
                            "cumulative_cardinality": 37794857,
                            "operator_type": "PROJECTION",
                            "operator_cardinality": 3716240,
                            "cumulative_rows_scanned": 8960942,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.0005293710000000033,
                            "result_set_size": 118919680,
                            "children": [
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 5.602959600001043,
                                    "extra_info": {
                                        "Projections": [
                                            "Tag",
                                            "UserId",
                                            "reputation",
                                            "PostCount"
                                        ],
                                        "Estimated Cardinality": "3850110"
                                    },
                                    "cumulative_cardinality": 34078617,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 3716240,
                                    "cumulative_rows_scanned": 8960942,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.0005315510000000035,
                                    "result_set_size": 118919680,
                                    "children": [
                                        {
                                            "operator_name": "CROSS_PRODUCT",
                                            "cpu_time": 5.602428049001043,
                                            "extra_info": {},
                                            "cumulative_cardinality": 30362377,
                                            "operator_type": "CROSS_PRODUCT",
                                            "operator_cardinality": 3716240,
                                            "cumulative_rows_scanned": 8960942,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.0025326959999999996,
                                            "result_set_size": 148649600,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_GROUP_BY",
                                                    "cpu_time": 1.4804114000000022,
                                                    "extra_info": {
                                                        "Groups": [
                                                            "#0",
                                                            "#1"
                                                        ],
                                                        "Aggregates": "count(DISTINCT #2)",
                                                        "Estimated Cardinality": "385011"
                                                    },
                                                    "cumulative_cardinality": 12839716,
                                                    "operator_type": "HASH_GROUP_BY",
                                                    "operator_cardinality": 371624,
                                                    "cumulative_rows_scanned": 5110826,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.5488844100000005,
                                                    "result_set_size": 5945984,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.9315269900000015,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "id",
                                                                    "reputation",
                                                                    "id"
                                                                ],
                                                                "Estimated Cardinality": "770023"
                                                            },
                                                            "cumulative_cardinality": 12468092,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 3680979,
                                                            "cumulative_rows_scanned": 5110826,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.0007275019999999974,
                                                            "result_set_size": 44171748,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 0.9307994880000015,
                                                                    "extra_info": {
                                                                        "Join Type": "INNER",
                                                                        "Conditions": "id = owneruserid",
                                                                        "Estimated Cardinality": "770023"
                                                                    },
                                                                    "cumulative_cardinality": 8787113,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 3680979,
                                                                    "cumulative_rows_scanned": 5110826,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.41772927900000023,
                                                                    "result_set_size": 44171748,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.028788262999999963,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "id",
                                                                                    "reputation"
                                                                                ],
                                                                                "Filters": "id<=1416539",
                                                                                "Estimated Cardinality": "1260710"
                                                                            },
                                                                            "cumulative_cardinality": 1260677,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 1260677,
                                                                            "cumulative_rows_scanned": 1260710,
                                                                            "operator_rows_scanned": 1260710,
                                                                            "operator_timing": 0.028788262999999963,
                                                                            "result_set_size": 10085416,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.4842819460000012,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "id",
                                                                                    "owneruserid"
                                                                                ],
                                                                                "Filters": "posttypeid>=1 AND posttypeid<=2",
                                                                                "Estimated Cardinality": "770023"
                                                                            },
                                                                            "cumulative_cardinality": 3845457,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 3845457,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 3850116,
                                                                            "operator_timing": 0.4842819460000012,
                                                                            "result_set_size": 30763656,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "operator_name": "STREAMING_LIMIT",
                                                    "cpu_time": 4.1194839530010405,
                                                    "extra_info": {},
                                                    "cumulative_cardinality": 13806421,
                                                    "operator_type": "STREAMING_LIMIT",
                                                    "operator_cardinality": 10,
                                                    "cumulative_rows_scanned": 3850116,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 9.82e-7,
                                                    "result_set_size": 240,
                                                    "children": [
                                                        {
                                                            "operator_name": "ORDER_BY",
                                                            "cpu_time": 4.11948297100104,
                                                            "extra_info": {
                                                                "Order By": "count_star() DESC"
                                                            },
                                                            "cumulative_cardinality": 13806411,
                                                            "operator_type": "ORDER_BY",
                                                            "operator_cardinality": 1976,
                                                            "cumulative_rows_scanned": 3850116,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.00008866499999999999,
                                                            "result_set_size": 47424,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_GROUP_BY",
                                                                    "cpu_time": 4.11939430600104,
                                                                    "extra_info": {
                                                                        "Groups": "#0",
                                                                        "Aggregates": "count_star()",
                                                                        "Estimated Cardinality": "385011"
                                                                    },
                                                                    "cumulative_cardinality": 13804435,
                                                                    "operator_type": "HASH_GROUP_BY",
                                                                    "operator_cardinality": 1976,
                                                                    "cumulative_rows_scanned": 3850116,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 1.1974454979997864,
                                                                    "result_set_size": 47424,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 2.921948808001254,
                                                                            "extra_info": {
                                                                                "Projections": "Tag",
                                                                                "Estimated Cardinality": "770023"
                                                                            },
                                                                            "cumulative_cardinality": 13802459,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 4044765,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.17934202800222362,
                                                                            "result_set_size": 64716240,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 2.74260677999903,
                                                                                    "extra_info": {
                                                                                        "Projections": "Tag",
                                                                                        "Estimated Cardinality": "770023"
                                                                                    },
                                                                                    "cumulative_cardinality": 9757694,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 4044765,
                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.8919494870002177,
                                                                                    "result_set_size": 64716240,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "UNNEST",
                                                                                            "cpu_time": 1.8506572929988123,
                                                                                            "extra_info": {},
                                                                                            "cumulative_cardinality": 5712929,
                                                                                            "operator_type": "UNNEST",
                                                                                            "operator_cardinality": 4044765,
                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 1.0667404159988128,
                                                                                            "result_set_size": 129432480,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 0.7839168769999996,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": "tags",
                                                                                                        "Filters": "posttypeid=1",
                                                                                                        "Estimated Cardinality": "770023"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 1668164,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 1668164,
                                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                                    "operator_rows_scanned": 3850116,
                                                                                                    "operator_timing": 0.7839168769999996,
                                                                                                    "result_set_size": 26690624,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}