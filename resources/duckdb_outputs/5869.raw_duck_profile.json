{
    "rows_returned": 145542,
    "query_name": "WITH PostStats AS (\n    SELECT \n        P.Id AS PostId,\n        COUNT(CASE WHEN PH.PostHistoryTypeId = 10 THEN 1 END) AS CloseCount,\n        COUNT(CASE WHEN PH.PostHistoryTypeId IN (1, 2, 4, 5) THEN 1 END) AS EditCount,\n        COUNT(CASE WHEN V.VoteTypeId = 2 THEN 1 END) AS UpvoteCount,\n        COUNT(CASE WHEN V.VoteTypeId = 3 THEN 1 END) AS DownvoteCount,\n        COUNT(CASE WHEN B.UserId IS NOT NULL THEN 1 END) AS BadgeCount\n    FROM \n        Posts P\n    LEFT JOIN \n        PostHistory PH ON P.Id = PH.PostId\n    LEFT JOIN \n        Votes V ON P.Id = V.PostId\n    LEFT JOIN \n        Badges B ON P.OwnerUserId = B.UserId\n    WHERE \n        P.CreationDate >= cast('2024-10-01 12:34:56' as timestamp) - INTERVAL '1 year'\n    GROUP BY \n        P.Id\n),\nMaxStats AS (\n    SELECT \n        MAX(CloseCount) AS MaxCloseCount,\n        MAX(EditCount) AS MaxEditCount,\n        MAX(UpvoteCount) AS MaxUpvoteCount,\n        MAX(DownvoteCount) AS MaxDownvoteCount,\n        MAX(BadgeCount) AS MaxBadgeCount\n    FROM \n        PostStats\n)\nSELECT \n    PS.PostId,\n    PS.CloseCount,\n    PS.EditCount,\n    PS.UpvoteCount,\n    PS.DownvoteCount,\n    PS.BadgeCount,\n    CASE \n        WHEN PS.CloseCount = MS.MaxCloseCount THEN 'Highest Close Count' \n        ELSE NULL \n    END AS CloseCountRank,\n    CASE \n        WHEN PS.EditCount = MS.MaxEditCount THEN 'Highest Edit Count' \n        ELSE NULL \n    END AS EditCountRank,\n    CASE \n        WHEN PS.UpvoteCount = MS.MaxUpvoteCount THEN 'Highest Upvote Count' \n        ELSE NULL \n    END AS UpvoteCountRank,\n    CASE \n        WHEN PS.DownvoteCount = MS.MaxDownvoteCount THEN 'Highest Downvote Count' \n        ELSE NULL \n    END AS DownvoteCountRank,\n    CASE \n        WHEN PS.BadgeCount = MS.MaxBadgeCount THEN 'Highest Badge Count' \n        ELSE NULL \n    END AS BadgeCountRank\nFROM \n    PostStats PS, MaxStats MS\nORDER BY \n    PS.PostId;",
    "blocked_thread_time": 0.0,
    "cpu_time": 5.46497300300001,
    "extra_info": {},
    "cumulative_cardinality": 220586017,
    "cumulative_rows_scanned": 30711177,
    "result_set_size": 18047208,
    "latency": 6.462561766,
    "children": [
        {
            "operator_name": "ORDER_BY",
            "cpu_time": 5.46497300300001,
            "extra_info": {
                "Order By": "PS.PostId ASC"
            },
            "cumulative_cardinality": 220586017,
            "operator_type": "ORDER_BY",
            "operator_cardinality": 145542,
            "cumulative_rows_scanned": 30711177,
            "operator_rows_scanned": 0,
            "operator_timing": 0.013255232000000002,
            "result_set_size": 18047208,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 5.45171777100001,
                    "extra_info": {
                        "Projections": [
                            "PostId",
                            "CloseCount",
                            "EditCount",
                            "UpvoteCount",
                            "DownvoteCount",
                            "BadgeCount",
                            "CloseCountRank",
                            "EditCountRank",
                            "UpvoteCountRank",
                            "DownvoteCountRank",
                            "BadgeCountRank"
                        ],
                        "Estimated Cardinality": "3850116"
                    },
                    "cumulative_cardinality": 220440475,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 145542,
                    "cumulative_rows_scanned": 30711177,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.0013785230000000006,
                    "result_set_size": 18047208,
                    "children": [
                        {
                            "operator_name": "CTE",
                            "cpu_time": 5.45033924800001,
                            "extra_info": {
                                "CTE Name": "PostStats",
                                "Table Index": "0"
                            },
                            "cumulative_cardinality": 220294933,
                            "operator_type": "CTE",
                            "operator_cardinality": 0,
                            "cumulative_rows_scanned": 30711177,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.0010449930000000001,
                            "result_set_size": 0,
                            "children": [
                                {
                                    "operator_name": "HASH_GROUP_BY",
                                    "cpu_time": 5.448400050000011,
                                    "extra_info": {
                                        "Groups": "#0",
                                        "Aggregates": [
                                            "count(#1)",
                                            "count(#2)",
                                            "count(#3)",
                                            "count(#4)",
                                            "count(#5)"
                                        ],
                                        "Estimated Cardinality": "3850116"
                                    },
                                    "cumulative_cardinality": 219712764,
                                    "operator_type": "HASH_GROUP_BY",
                                    "operator_cardinality": 145542,
                                    "cumulative_rows_scanned": 30711177,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 1.777988752000012,
                                    "result_set_size": 6403848,
                                    "children": [
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 3.670411297999999,
                                            "extra_info": {
                                                "Projections": [
                                                    "id",
                                                    "CASE  WHEN ((posthistorytypeid = 10)) THEN (1) ELSE NULL END",
                                                    "CASE  WHEN ((posthistorytypeid IN (1, 2, 4, 5))) THEN (1) ELSE NULL END",
                                                    "CASE  WHEN ((votetypeid = 2)) THEN (1) ELSE NULL END",
                                                    "CASE  WHEN ((votetypeid = 3)) THEN (1) ELSE NULL END",
                                                    "CASE  WHEN ((userid IS NOT NULL)) THEN (1) ELSE NULL END"
                                                ],
                                                "Estimated Cardinality": "12744093"
                                            },
                                            "cumulative_cardinality": 219567222,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 106298545,
                                            "cumulative_rows_scanned": 30711177,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 2.494125508999997,
                                            "result_set_size": 2551165080,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_JOIN",
                                                    "cpu_time": 1.1762857890000018,
                                                    "extra_info": {
                                                        "Join Type": "LEFT",
                                                        "Conditions": "owneruserid = userid",
                                                        "Estimated Cardinality": "12744093"
                                                    },
                                                    "cumulative_cardinality": 113268677,
                                                    "operator_type": "HASH_JOIN",
                                                    "operator_cardinality": 106298545,
                                                    "cumulative_rows_scanned": 30711177,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 1.0274936460000017,
                                                    "result_set_size": 1275582540,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 0.13602531299999998,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "#0",
                                                                    "__internal_decompress_integral_smallint(#1, 1)",
                                                                    "#2",
                                                                    "#3"
                                                                ],
                                                                "Estimated Cardinality": "12744093"
                                                            },
                                                            "cumulative_cardinality": 4648408,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 1300060,
                                                            "cumulative_rows_scanned": 28389453,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.0006828849999999989,
                                                            "result_set_size": 15600720,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 0.135342428,
                                                                    "extra_info": {
                                                                        "Join Type": "RIGHT",
                                                                        "Conditions": "postid = id",
                                                                        "Estimated Cardinality": "12744093"
                                                                    },
                                                                    "cumulative_cardinality": 3348348,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 1300060,
                                                                    "cumulative_rows_scanned": 28389453,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.060371366999999995,
                                                                    "result_set_size": 14300660,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.018377826000000014,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": [
                                                                                    "postid",
                                                                                    "votetypeid"
                                                                                ],
                                                                                "Estimated Cardinality": "12744093"
                                                                            },
                                                                            "cumulative_cardinality": 442526,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 442526,
                                                                            "cumulative_rows_scanned": 12744093,
                                                                            "operator_rows_scanned": 12744093,
                                                                            "operator_timing": 0.018377826000000014,
                                                                            "result_set_size": 2655156,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 0.056593234999999985,
                                                                            "extra_info": {
                                                                                "Projections": [
                                                                                    "__internal_compress_integral_utinyint(#0, 1)",
                                                                                    "#1",
                                                                                    "#2"
                                                                                ],
                                                                                "Estimated Cardinality": "11795244"
                                                                            },
                                                                            "cumulative_cardinality": 1605762,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 486732,
                                                                            "cumulative_rows_scanned": 15645360,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.00020598699999999987,
                                                                            "result_set_size": 4380588,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "HASH_JOIN",
                                                                                    "cpu_time": 0.05638724799999999,
                                                                                    "extra_info": {
                                                                                        "Join Type": "RIGHT",
                                                                                        "Conditions": "postid = id",
                                                                                        "Estimated Cardinality": "11795244"
                                                                                    },
                                                                                    "cumulative_cardinality": 1119030,
                                                                                    "operator_type": "HASH_JOIN",
                                                                                    "operator_cardinality": 486732,
                                                                                    "cumulative_rows_scanned": 15645360,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.015792688999999978,
                                                                                    "result_set_size": 4867320,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.021193156999999997,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "posthistorytypeid",
                                                                                                    "postid"
                                                                                                ],
                                                                                                "Estimated Cardinality": "11795244"
                                                                                            },
                                                                                            "cumulative_cardinality": 486756,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 486756,
                                                                                            "cumulative_rows_scanned": 11795244,
                                                                                            "operator_rows_scanned": 11795244,
                                                                                            "operator_timing": 0.021193156999999997,
                                                                                            "result_set_size": 2920536,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.019401402000000015,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "owneruserid"
                                                                                                ],
                                                                                                "Filters": "creationdate>='2023-10-01 12:34:56'::TIMESTAMP",
                                                                                                "Estimated Cardinality": "770023"
                                                                                            },
                                                                                            "cumulative_cardinality": 145542,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 145542,
                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                            "operator_rows_scanned": 3850116,
                                                                                            "operator_timing": 0.019401402000000015,
                                                                                            "result_set_size": 1164336,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "operator_name": "READ_PARQUET ",
                                                            "cpu_time": 0.012766830000000009,
                                                            "extra_info": {
                                                                "Function": "READ_PARQUET",
                                                                "Projections": "userid",
                                                                "Estimated Cardinality": "2321724"
                                                            },
                                                            "cumulative_cardinality": 2321724,
                                                            "operator_type": "TABLE_SCAN",
                                                            "operator_cardinality": 2321724,
                                                            "cumulative_rows_scanned": 2321724,
                                                            "operator_rows_scanned": 2321724,
                                                            "operator_timing": 0.012766830000000009,
                                                            "result_set_size": 9286896,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "operator_name": "CROSS_PRODUCT",
                                    "cpu_time": 0.0008942050000000001,
                                    "extra_info": {},
                                    "cumulative_cardinality": 582169,
                                    "operator_type": "CROSS_PRODUCT",
                                    "operator_cardinality": 145542,
                                    "cumulative_rows_scanned": 0,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.00020358800000000007,
                                    "result_set_size": 12225528,
                                    "children": [
                                        {
                                            "operator_name": "CTE_SCAN",
                                            "cpu_time": 0.00007998400000000001,
                                            "extra_info": {
                                                "CTE Index": "0",
                                                "Estimated Cardinality": "3850116"
                                            },
                                            "cumulative_cardinality": 145542,
                                            "operator_type": "CTE_SCAN",
                                            "operator_cardinality": 145542,
                                            "cumulative_rows_scanned": 0,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.00007998400000000001,
                                            "result_set_size": 6403848,
                                            "children": []
                                        },
                                        {
                                            "operator_name": "UNGROUPED_AGGREGATE",
                                            "cpu_time": 0.0006106330000000001,
                                            "extra_info": {
                                                "Aggregates": [
                                                    "max(#0)",
                                                    "max(#1)",
                                                    "max(#2)",
                                                    "max(#3)",
                                                    "max(#4)"
                                                ]
                                            },
                                            "cumulative_cardinality": 291085,
                                            "operator_type": "UNGROUPED_AGGREGATE",
                                            "operator_cardinality": 1,
                                            "cumulative_rows_scanned": 0,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.0005349220000000001,
                                            "result_set_size": 40,
                                            "children": [
                                                {
                                                    "operator_name": "PROJECTION",
                                                    "cpu_time": 0.00007571099999999998,
                                                    "extra_info": {
                                                        "Projections": [
                                                            "CloseCount",
                                                            "EditCount",
                                                            "UpvoteCount",
                                                            "DownvoteCount",
                                                            "BadgeCount"
                                                        ],
                                                        "Estimated Cardinality": "3850116"
                                                    },
                                                    "cumulative_cardinality": 291084,
                                                    "operator_type": "PROJECTION",
                                                    "operator_cardinality": 145542,
                                                    "cumulative_rows_scanned": 0,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.000014261000000000013,
                                                    "result_set_size": 5821680,
                                                    "children": [
                                                        {
                                                            "operator_name": "CTE_SCAN",
                                                            "cpu_time": 0.00006144999999999996,
                                                            "extra_info": {
                                                                "CTE Index": "0",
                                                                "Estimated Cardinality": "3850116"
                                                            },
                                                            "cumulative_cardinality": 145542,
                                                            "operator_type": "CTE_SCAN",
                                                            "operator_cardinality": 145542,
                                                            "cumulative_rows_scanned": 0,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.00006144999999999996,
                                                            "result_set_size": 6403848,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}