{
    "rows_returned": 19360,
    "query_name": "\nWITH PostTags AS (\n    SELECT \n        p.Id AS PostId, \n        unnest(string_to_array(substring(p.Tags, 2, length(p.Tags) - 2), '><')) AS Tag\n    FROM \n        Posts p\n    WHERE \n        p.PostTypeId = 1 \n),\nPopularTags AS (\n    SELECT \n        Tag, \n        COUNT(*) AS TagUsage\n    FROM \n        PostTags\n    GROUP BY \n        Tag\n    HAVING \n        COUNT(*) > 5 \n),\nTopUsers AS (\n    SELECT \n        u.Id AS UserId, \n        u.DisplayName, \n        SUM(CASE WHEN v.VoteTypeId = 2 THEN 1 ELSE 0 END) AS TotalUpvotes,\n        SUM(CASE WHEN v.VoteTypeId = 3 THEN 1 ELSE 0 END) AS TotalDownvotes,\n        COUNT(DISTINCT p.Id) AS TotalPosts\n    FROM \n        Users u\n    LEFT JOIN \n        Posts p ON u.Id = p.OwnerUserId\n    LEFT JOIN \n        Votes v ON p.Id = v.PostId\n    GROUP BY \n        u.Id, u.DisplayName\n    ORDER BY \n        TotalUpvotes DESC\n    LIMIT 10\n),\nTagPostCounts AS (\n    SELECT \n        pt.Tag, \n        COUNT(DISTINCT p.Id) AS PostCount\n    FROM \n        PostTags pt\n    JOIN \n        Posts p ON pt.PostId = p.Id\n    GROUP BY \n        pt.Tag\n    ORDER BY \n        PostCount DESC\n)\nSELECT \n    u.DisplayName AS TopUser, \n    u.TotalUpvotes, \n    u.TotalDownvotes, \n    tg.Tag, \n    tg.PostCount\nFROM \n    TopUsers u\nJOIN \n    TagPostCounts tg ON u.TotalPosts > 1 \nWHERE \n    tg.Tag IN (SELECT Tag FROM PopularTags)\nORDER BY \n    u.TotalUpvotes DESC, \n    tg.PostCount DESC;\n",
    "blocked_thread_time": 0.0,
    "cpu_time": 17.998348789999003,
    "extra_info": {},
    "cumulative_cardinality": 83839525,
    "cumulative_rows_scanned": 29405267,
    "result_set_size": 1393920,
    "latency": 30.681564921,
    "children": [
        {
            "operator_name": "ORDER_BY",
            "cpu_time": 17.998348789999003,
            "extra_info": {
                "Order By": [
                    "u.TotalUpvotes DESC",
                    "tg.PostCount DESC"
                ]
            },
            "cumulative_cardinality": 83839525,
            "operator_type": "ORDER_BY",
            "operator_cardinality": 19360,
            "cumulative_rows_scanned": 29405267,
            "operator_rows_scanned": 0,
            "operator_timing": 0.0014995600000000003,
            "result_set_size": 1393920,
            "children": [
                {
                    "operator_name": "PROJECTION",
                    "cpu_time": 17.996849229999004,
                    "extra_info": {
                        "Projections": [
                            "TopUser",
                            "TotalUpvotes",
                            "TotalDownvotes",
                            "Tag",
                            "PostCount"
                        ],
                        "Estimated Cardinality": "77002"
                    },
                    "cumulative_cardinality": 83820165,
                    "operator_type": "PROJECTION",
                    "operator_cardinality": 19360,
                    "cumulative_rows_scanned": 29405267,
                    "operator_rows_scanned": 0,
                    "operator_timing": 0.0000026530000000000003,
                    "result_set_size": 1393920,
                    "children": [
                        {
                            "operator_name": "CROSS_PRODUCT",
                            "cpu_time": 17.996846576999005,
                            "extra_info": {},
                            "cumulative_cardinality": 83800805,
                            "operator_type": "CROSS_PRODUCT",
                            "operator_cardinality": 19360,
                            "cumulative_rows_scanned": 29405267,
                            "operator_rows_scanned": 0,
                            "operator_timing": 0.000063189,
                            "result_set_size": 1393920,
                            "children": [
                                {
                                    "operator_name": "HASH_JOIN",
                                    "cpu_time": 9.999467627999007,
                                    "extra_info": {
                                        "Join Type": "SEMI",
                                        "Conditions": "Tag = #0",
                                        "Estimated Cardinality": "77002"
                                    },
                                    "cumulative_cardinality": 35511535,
                                    "operator_type": "HASH_JOIN",
                                    "operator_cardinality": 1936,
                                    "cumulative_rows_scanned": 11550348,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 0.000656456,
                                    "result_set_size": 46464,
                                    "children": [
                                        {
                                            "operator_name": "ORDER_BY",
                                            "cpu_time": 7.477582975997479,
                                            "extra_info": {
                                                "Order By": "count(DISTINCT p.Id) DESC"
                                            },
                                            "cumulative_cardinality": 21701292,
                                            "operator_type": "ORDER_BY",
                                            "operator_cardinality": 1976,
                                            "cumulative_rows_scanned": 7700232,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.000117069,
                                            "result_set_size": 47424,
                                            "children": [
                                                {
                                                    "operator_name": "HASH_GROUP_BY",
                                                    "cpu_time": 7.477465906997479,
                                                    "extra_info": {
                                                        "Groups": "#0",
                                                        "Aggregates": "count(DISTINCT #1)",
                                                        "Estimated Cardinality": "385011"
                                                    },
                                                    "cumulative_cardinality": 21699316,
                                                    "operator_type": "HASH_GROUP_BY",
                                                    "operator_cardinality": 1976,
                                                    "cumulative_rows_scanned": 7700232,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.6305577539999996,
                                                    "result_set_size": 47424,
                                                    "children": [
                                                        {
                                                            "operator_name": "PROJECTION",
                                                            "cpu_time": 6.84690815299748,
                                                            "extra_info": {
                                                                "Projections": [
                                                                    "Tag",
                                                                    "id"
                                                                ],
                                                                "Estimated Cardinality": "770023"
                                                            },
                                                            "cumulative_cardinality": 21697340,
                                                            "operator_type": "PROJECTION",
                                                            "operator_cardinality": 4044765,
                                                            "cumulative_rows_scanned": 7700232,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.0007474930000000032,
                                                            "result_set_size": 80895300,
                                                            "children": [
                                                                {
                                                                    "operator_name": "HASH_JOIN",
                                                                    "cpu_time": 6.846160659997479,
                                                                    "extra_info": {
                                                                        "Join Type": "INNER",
                                                                        "Conditions": "id = PostId",
                                                                        "Estimated Cardinality": "770023"
                                                                    },
                                                                    "cumulative_cardinality": 17652575,
                                                                    "operator_type": "HASH_JOIN",
                                                                    "operator_cardinality": 4044765,
                                                                    "cumulative_rows_scanned": 7700232,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 2.818686088999215,
                                                                    "result_set_size": 97074360,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "READ_PARQUET ",
                                                                            "cpu_time": 0.04575923000000001,
                                                                            "extra_info": {
                                                                                "Function": "READ_PARQUET",
                                                                                "Projections": "id",
                                                                                "Estimated Cardinality": "3850116"
                                                                            },
                                                                            "cumulative_cardinality": 3850116,
                                                                            "operator_type": "TABLE_SCAN",
                                                                            "operator_cardinality": 3850116,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 3850116,
                                                                            "operator_timing": 0.04575923000000001,
                                                                            "result_set_size": 15400464,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 3.981715340998264,
                                                                            "extra_info": {
                                                                                "Projections": [
                                                                                    "PostId",
                                                                                    "Tag"
                                                                                ],
                                                                                "Estimated Cardinality": "770023"
                                                                            },
                                                                            "cumulative_cardinality": 9757694,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 4044765,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.19147540399758042,
                                                                            "result_set_size": 80895300,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "UNNEST",
                                                                                    "cpu_time": 3.790239937000684,
                                                                                    "extra_info": {},
                                                                                    "cumulative_cardinality": 5712929,
                                                                                    "operator_type": "UNNEST",
                                                                                    "operator_cardinality": 4044765,
                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 3.488993427000684,
                                                                                    "result_set_size": 145611540,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.30124650999999997,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": [
                                                                                                    "id",
                                                                                                    "tags"
                                                                                                ],
                                                                                                "Filters": "posttypeid=1",
                                                                                                "Estimated Cardinality": "770023"
                                                                                            },
                                                                                            "cumulative_cardinality": 1668164,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 1668164,
                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                            "operator_rows_scanned": 3850116,
                                                                                            "operator_timing": 0.30124650999999997,
                                                                                            "result_set_size": 33363280,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "operator_name": "PROJECTION",
                                            "cpu_time": 2.5212281960015286,
                                            "extra_info": {
                                                "Projections": "#0",
                                                "Estimated Cardinality": "77002"
                                            },
                                            "cumulative_cardinality": 13808307,
                                            "operator_type": "PROJECTION",
                                            "operator_cardinality": 1936,
                                            "cumulative_rows_scanned": 3850116,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 2.01e-7,
                                            "result_set_size": 30976,
                                            "children": [
                                                {
                                                    "operator_name": "FILTER",
                                                    "cpu_time": 2.5212279950015284,
                                                    "extra_info": {
                                                        "Expression": "(count_star() > 5)",
                                                        "Estimated Cardinality": "77002"
                                                    },
                                                    "cumulative_cardinality": 13806371,
                                                    "operator_type": "FILTER",
                                                    "operator_cardinality": 1936,
                                                    "cumulative_rows_scanned": 3850116,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.000013295,
                                                    "result_set_size": 46464,
                                                    "children": [
                                                        {
                                                            "operator_name": "HASH_GROUP_BY",
                                                            "cpu_time": 2.5212147000015284,
                                                            "extra_info": {
                                                                "Groups": "#0",
                                                                "Aggregates": "count_star()",
                                                                "Estimated Cardinality": "385011"
                                                            },
                                                            "cumulative_cardinality": 13804435,
                                                            "operator_type": "HASH_GROUP_BY",
                                                            "operator_cardinality": 1976,
                                                            "cumulative_rows_scanned": 3850116,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 1.0061834349996355,
                                                            "result_set_size": 47424,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 1.5150312650018927,
                                                                    "extra_info": {
                                                                        "Projections": "Tag",
                                                                        "Estimated Cardinality": "770023"
                                                                    },
                                                                    "cumulative_cardinality": 13802459,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 4044765,
                                                                    "cumulative_rows_scanned": 3850116,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.13557149300015187,
                                                                    "result_set_size": 64716240,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "PROJECTION",
                                                                            "cpu_time": 1.3794597720017407,
                                                                            "extra_info": {
                                                                                "Projections": "Tag",
                                                                                "Estimated Cardinality": "770023"
                                                                            },
                                                                            "cumulative_cardinality": 9757694,
                                                                            "operator_type": "PROJECTION",
                                                                            "operator_cardinality": 4044765,
                                                                            "cumulative_rows_scanned": 3850116,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 0.14714973599984324,
                                                                            "result_set_size": 64716240,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "UNNEST",
                                                                                    "cpu_time": 1.2323100360018975,
                                                                                    "extra_info": {},
                                                                                    "cumulative_cardinality": 5712929,
                                                                                    "operator_type": "UNNEST",
                                                                                    "operator_cardinality": 4044765,
                                                                                    "cumulative_rows_scanned": 3850116,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 1.0057822960018978,
                                                                                    "result_set_size": 129432480,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "READ_PARQUET ",
                                                                                            "cpu_time": 0.2265277399999996,
                                                                                            "extra_info": {
                                                                                                "Function": "READ_PARQUET",
                                                                                                "Projections": "tags",
                                                                                                "Filters": "posttypeid=1",
                                                                                                "Estimated Cardinality": "770023"
                                                                                            },
                                                                                            "cumulative_cardinality": 1668164,
                                                                                            "operator_type": "TABLE_SCAN",
                                                                                            "operator_cardinality": 1668164,
                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                            "operator_rows_scanned": 3850116,
                                                                                            "operator_timing": 0.2265277399999996,
                                                                                            "result_set_size": 26690624,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "operator_name": "PROJECTION",
                                    "cpu_time": 7.997315759999998,
                                    "extra_info": {
                                        "Projections": [
                                            "#0",
                                            "#1",
                                            "#2"
                                        ],
                                        "Estimated Cardinality": "10"
                                    },
                                    "cumulative_cardinality": 48269910,
                                    "operator_type": "PROJECTION",
                                    "operator_cardinality": 10,
                                    "cumulative_rows_scanned": 17854919,
                                    "operator_rows_scanned": 0,
                                    "operator_timing": 4.31e-7,
                                    "result_set_size": 480,
                                    "children": [
                                        {
                                            "operator_name": "FILTER",
                                            "cpu_time": 7.997315328999998,
                                            "extra_info": {
                                                "Expression": "(TotalPosts > 1)",
                                                "Estimated Cardinality": "10"
                                            },
                                            "cumulative_cardinality": 48269900,
                                            "operator_type": "FILTER",
                                            "operator_cardinality": 10,
                                            "cumulative_rows_scanned": 17854919,
                                            "operator_rows_scanned": 0,
                                            "operator_timing": 0.0000059,
                                            "result_set_size": 560,
                                            "children": [
                                                {
                                                    "operator_name": "STREAMING_LIMIT",
                                                    "cpu_time": 7.997309428999999,
                                                    "extra_info": {},
                                                    "cumulative_cardinality": 48269890,
                                                    "operator_type": "STREAMING_LIMIT",
                                                    "operator_cardinality": 10,
                                                    "cumulative_rows_scanned": 17854919,
                                                    "operator_rows_scanned": 0,
                                                    "operator_timing": 0.000002164,
                                                    "result_set_size": 560,
                                                    "children": [
                                                        {
                                                            "operator_name": "ORDER_BY",
                                                            "cpu_time": 7.997307264999999,
                                                            "extra_info": {
                                                                "Order By": "sum(CASE  WHEN ((v.VoteTypeId = 2)) THEN (1) ELSE 0 END) DESC"
                                                            },
                                                            "cumulative_cardinality": 48269880,
                                                            "operator_type": "ORDER_BY",
                                                            "operator_cardinality": 4096,
                                                            "cumulative_rows_scanned": 17854919,
                                                            "operator_rows_scanned": 0,
                                                            "operator_timing": 0.054035245000000016,
                                                            "result_set_size": 229376,
                                                            "children": [
                                                                {
                                                                    "operator_name": "PROJECTION",
                                                                    "cpu_time": 7.943272019999999,
                                                                    "extra_info": {
                                                                        "Projections": [
                                                                            "displayname",
                                                                            "TotalUpvotes",
                                                                            "TotalDownvotes",
                                                                            "TotalPosts"
                                                                        ],
                                                                        "Estimated Cardinality": "1260710"
                                                                    },
                                                                    "cumulative_cardinality": 48265784,
                                                                    "operator_type": "PROJECTION",
                                                                    "operator_cardinality": 1260710,
                                                                    "cumulative_rows_scanned": 17854919,
                                                                    "operator_rows_scanned": 0,
                                                                    "operator_timing": 0.00014013600000000012,
                                                                    "result_set_size": 70599760,
                                                                    "children": [
                                                                        {
                                                                            "operator_name": "HASH_GROUP_BY",
                                                                            "cpu_time": 7.943131884,
                                                                            "extra_info": {
                                                                                "Groups": [
                                                                                    "#0",
                                                                                    "#1"
                                                                                ],
                                                                                "Aggregates": [
                                                                                    "sum(#2)",
                                                                                    "sum(#3)",
                                                                                    "count(DISTINCT #4)"
                                                                                ],
                                                                                "Estimated Cardinality": "1260710"
                                                                            },
                                                                            "cumulative_cardinality": 47005074,
                                                                            "operator_type": "HASH_GROUP_BY",
                                                                            "operator_cardinality": 1260710,
                                                                            "cumulative_rows_scanned": 17854919,
                                                                            "operator_rows_scanned": 0,
                                                                            "operator_timing": 2.529551478999993,
                                                                            "result_set_size": 75642600,
                                                                            "children": [
                                                                                {
                                                                                    "operator_name": "PROJECTION",
                                                                                    "cpu_time": 5.4135804050000065,
                                                                                    "extra_info": {
                                                                                        "Projections": [
                                                                                            "id",
                                                                                            "displayname",
                                                                                            "CASE  WHEN ((votetypeid = 2)) THEN (1) ELSE 0 END",
                                                                                            "CASE  WHEN ((votetypeid = 3)) THEN (1) ELSE 0 END",
                                                                                            "id"
                                                                                        ],
                                                                                        "Estimated Cardinality": "12744093"
                                                                                    },
                                                                                    "cumulative_cardinality": 45744364,
                                                                                    "operator_type": "PROJECTION",
                                                                                    "operator_cardinality": 11739825,
                                                                                    "cumulative_rows_scanned": 17854919,
                                                                                    "operator_rows_scanned": 0,
                                                                                    "operator_timing": 0.1353936529999998,
                                                                                    "result_set_size": 375674400,
                                                                                    "children": [
                                                                                        {
                                                                                            "operator_name": "HASH_JOIN",
                                                                                            "cpu_time": 5.278186752000007,
                                                                                            "extra_info": {
                                                                                                "Join Type": "RIGHT",
                                                                                                "Conditions": "postid = id",
                                                                                                "Estimated Cardinality": "12744093"
                                                                                            },
                                                                                            "cumulative_cardinality": 34004539,
                                                                                            "operator_type": "HASH_JOIN",
                                                                                            "operator_cardinality": 11739825,
                                                                                            "cumulative_rows_scanned": 17854919,
                                                                                            "operator_rows_scanned": 0,
                                                                                            "operator_timing": 1.2998679379999996,
                                                                                            "result_set_size": 305235450,
                                                                                            "children": [
                                                                                                {
                                                                                                    "operator_name": "READ_PARQUET ",
                                                                                                    "cpu_time": 2.4539355680000057,
                                                                                                    "extra_info": {
                                                                                                        "Function": "READ_PARQUET",
                                                                                                        "Projections": [
                                                                                                            "postid",
                                                                                                            "votetypeid"
                                                                                                        ],
                                                                                                        "Estimated Cardinality": "12744093"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 12744093,
                                                                                                    "operator_type": "TABLE_SCAN",
                                                                                                    "operator_cardinality": 12744093,
                                                                                                    "cumulative_rows_scanned": 12744093,
                                                                                                    "operator_rows_scanned": 12744093,
                                                                                                    "operator_timing": 2.4539355680000057,
                                                                                                    "result_set_size": 76464558,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "operator_name": "HASH_JOIN",
                                                                                                    "cpu_time": 1.5243832460000015,
                                                                                                    "extra_info": {
                                                                                                        "Join Type": "RIGHT",
                                                                                                        "Conditions": "owneruserid = id",
                                                                                                        "Estimated Cardinality": "3850116"
                                                                                                    },
                                                                                                    "cumulative_cardinality": 9520621,
                                                                                                    "operator_type": "HASH_JOIN",
                                                                                                    "operator_cardinality": 4574495,
                                                                                                    "cumulative_rows_scanned": 5110826,
                                                                                                    "operator_rows_scanned": 0,
                                                                                                    "operator_timing": 0.4009401850000008,
                                                                                                    "result_set_size": 109787880,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.18613070300000056,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "owneruserid"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "3850116"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 3685416,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 3685416,
                                                                                                            "cumulative_rows_scanned": 3850116,
                                                                                                            "operator_rows_scanned": 3850116,
                                                                                                            "operator_timing": 0.18613070300000056,
                                                                                                            "result_set_size": 29483328,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "operator_name": "READ_PARQUET ",
                                                                                                            "cpu_time": 0.9373123580000002,
                                                                                                            "extra_info": {
                                                                                                                "Function": "READ_PARQUET",
                                                                                                                "Projections": [
                                                                                                                    "id",
                                                                                                                    "displayname"
                                                                                                                ],
                                                                                                                "Estimated Cardinality": "1260710"
                                                                                                            },
                                                                                                            "cumulative_cardinality": 1260710,
                                                                                                            "operator_type": "TABLE_SCAN",
                                                                                                            "operator_cardinality": 1260710,
                                                                                                            "cumulative_rows_scanned": 1260710,
                                                                                                            "operator_rows_scanned": 1260710,
                                                                                                            "operator_timing": 0.9373123580000002,
                                                                                                            "result_set_size": 25214200,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}