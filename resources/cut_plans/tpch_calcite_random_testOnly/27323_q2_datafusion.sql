SELECT COALESCE("t7"."COMBINED_NAME", "t7"."COMBINED_NAME") AS "COMBINED_NAME", "t7"."SUPPLIER_COUNT", "t7"."PART_SUPPLIER_COUNT", "t7"."DETAILED_INFO", "t7"."NATION_NAME", "t7"."PART_NAME"
FROM (SELECT CONCAT("t2"."NATION_NAME", ' | ', "t5"."PART_NAME") AS "COMBINED_NAME", "t2"."SUPPLIER_COUNT", "t5"."PART_SUPPLIER_COUNT", CONCAT('Nation: ', "t2"."NATION_NAME", ', Suppliers: ', CAST("t2"."SUPPLIER_COUNT" AS VARCHAR CHARACTER SET "ISO-8859-1"), ', Part: ', "t5"."PART_NAME", ', Part Suppliers: ', CAST("t5"."PART_SUPPLIER_COUNT" AS VARCHAR CHARACTER SET "ISO-8859-1")) AS "DETAILED_INFO", "t2"."NATION_NAME", "t5"."PART_NAME"
FROM (SELECT ANY_VALUE("nation"."n_name") AS "NATION_NAME", COUNT(*) AS "SUPPLIER_COUNT", SUM("supplier"."s_acctbal") AS "TOTAL_ACCTBAL"
FROM "TPCH"."nation"
INNER JOIN "TPCH"."supplier" ON "nation"."n_nationkey" = "supplier"."s_nationkey"
GROUP BY "nation"."n_name"
HAVING COUNT(*) > 5) AS "t2"
INNER JOIN (SELECT ANY_VALUE("p_name") AS "PART_NAME", COUNT(*) AS "PART_SUPPLIER_COUNT"
FROM "s1"
GROUP BY "p_name"
HAVING COUNT(*) > 3) AS "t5" ON "t2"."NATION_NAME" LIKE '%land%' OR "t5"."PART_NAME" LIKE '%brass%'
ORDER BY "t2"."NATION_NAME", "t5"."PART_NAME") AS "t7"