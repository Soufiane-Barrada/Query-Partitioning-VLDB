SELECT COALESCE("REGION_NAME", "REGION_NAME") AS "REGION_NAME", "NATION_NAME", "SUPPLIER_NAME", "TOTAL_AVAILABLE_QUANTITY", "AVERAGE_SUPPLY_COST", "CUSTOMER_NAME", "TOTAL_ORDERS", "TOTAL_SPENT", "ALL_PART_NAMES"
FROM (SELECT ANY_VALUE("r_name") AS "REGION_NAME", ANY_VALUE("n_name") AS "NATION_NAME", ANY_VALUE("S_NAME") AS "SUPPLIER_NAME", "TOTAL_AVAILABLE_QUANTITY", "AVERAGE_SUPPLY_COST", ANY_VALUE("C_NAME") AS "CUSTOMER_NAME", "TOTAL_ORDERS", "TOTAL_SPENT", LISTAGG(DISTINCT "PART_NAMES", "FD_COL_9") AS "ALL_PART_NAMES"
FROM "s1"
GROUP BY "r_name", "n_name", "S_NAME", "TOTAL_AVAILABLE_QUANTITY", "AVERAGE_SUPPLY_COST", "C_NAME", "TOTAL_ORDERS", "TOTAL_SPENT"
ORDER BY "TOTAL_SPENT" DESC NULLS FIRST, "TOTAL_ORDERS" DESC NULLS FIRST) AS "t8"