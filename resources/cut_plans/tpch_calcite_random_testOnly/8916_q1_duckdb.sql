SELECT COALESCE("t0"."O_ORDERKEY", "t0"."O_ORDERKEY") AS "O_ORDERKEY", "t0"."O_ORDERDATE", "t0"."TOTAL_REVENUE", "t3"."PS_SUPPKEY", "t3"."l_orderkey0"
FROM (SELECT "orders"."o_orderkey" AS "O_ORDERKEY", "orders"."o_orderdate" AS "O_ORDERDATE", SUM("lineitem"."l_extendedprice" * (1 - "lineitem"."l_discount")) AS "TOTAL_REVENUE"
FROM "TPCH"."orders"
INNER JOIN "TPCH"."lineitem" ON "orders"."o_orderkey" = "lineitem"."l_orderkey"
GROUP BY "orders"."o_orderkey", "orders"."o_orderdate") AS "t0"
LEFT JOIN (SELECT FIRST_VALUE("partsupp"."ps_suppkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "PS_SUPPKEY", "lineitem0"."l_orderkey" AS "l_orderkey0"
FROM "TPCH"."lineitem" AS "lineitem0"
INNER JOIN "TPCH"."partsupp" ON "lineitem0"."l_partkey" = "partsupp"."ps_partkey"
GROUP BY FIRST_VALUE("lineitem0"."l_orderkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_partkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_suppkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_linenumber") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_quantity") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_extendedprice") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_discount") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_tax") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_returnflag") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_linestatus") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_shipdate") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_commitdate") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_receiptdate") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_shipinstruct") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_shipmode") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("lineitem0"."l_comment") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("partsupp"."ps_partkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("partsupp"."ps_suppkey") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("partsupp"."ps_availqty") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("partsupp"."ps_supplycost") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("partsupp"."ps_comment") OVER (PARTITION BY "lineitem0"."l_orderkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), "lineitem0"."l_orderkey") AS "t3" ON "t0"."O_ORDERKEY" = "t3"."l_orderkey0"