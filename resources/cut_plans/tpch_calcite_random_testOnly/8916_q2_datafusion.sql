SELECT COALESCE("t15"."REGION_NAME", "t15"."REGION_NAME") AS "REGION_NAME", "t15"."NATION_NAME", "t15"."SUPPLIER_NAME", "t15"."TOTAL_REVENUE", "t15"."O_ORDERDATE"
FROM (SELECT "t5"."R_NAME" AS "REGION_NAME", "t5"."N_NAME" AS "NATION_NAME", "t10"."S_NAME" AS "SUPPLIER_NAME", "t10"."TOTAL_REVENUE", "t10"."O_ORDERDATE"
FROM (SELECT "nation"."n_nationkey" AS "N_NATIONKEY", "nation"."n_name" AS "N_NAME", "region"."r_regionkey" AS "R_REGIONKEY", "region"."r_name" AS "R_NAME"
FROM "TPCH"."region"
INNER JOIN "TPCH"."nation" ON "region"."r_regionkey" = "nation"."n_regionkey") AS "t5"
INNER JOIN ((SELECT *
FROM (SELECT "s1"."O_ORDERKEY", "s1"."O_ORDERDATE", "s1"."TOTAL_REVENUE", "t8"."S_SUPPKEY", "t8"."S_NAME", "t8"."TOTAL_SUPPLY_COST"
FROM (SELECT "supplier"."s_suppkey" AS "S_SUPPKEY", "supplier"."s_name" AS "S_NAME", SUM("partsupp0"."ps_supplycost" * "partsupp0"."ps_availqty") AS "TOTAL_SUPPLY_COST"
FROM "TPCH"."supplier"
INNER JOIN "TPCH"."partsupp" AS "partsupp0" ON "supplier"."s_suppkey" = "partsupp0"."ps_suppkey"
GROUP BY "supplier"."s_suppkey", "supplier"."s_name"
ORDER BY 3 DESC NULLS FIRST
FETCH NEXT 10 ROWS ONLY) AS "t8"
INNER JOIN "s1" ON "t8"."S_SUPPKEY" = "s1"."PS_SUPPKEY") AS "t9"
WHERE "t9"."TOTAL_REVENUE" > 10000.0000) AS "t10" INNER JOIN "TPCH"."lineitem" AS "lineitem1" ON "t10"."O_ORDERKEY" = "lineitem1"."l_orderkey" LEFT JOIN (SELECT FIRST_VALUE("c_nationkey") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS "C_NATIONKEY", "c_custkey" AS "c_custkey0"
FROM "TPCH"."customer"
GROUP BY FIRST_VALUE("c_custkey") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_name") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_address") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_nationkey") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_phone") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_acctbal") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_mktsegment") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), FIRST_VALUE("c_comment") OVER (PARTITION BY "c_custkey" RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING), "c_custkey") AS "t13" ON "t10"."O_ORDERKEY" = "t13"."c_custkey0") ON "t5"."N_NATIONKEY" = "t13"."C_NATIONKEY"
ORDER BY "t5"."R_NAME", "t10"."TOTAL_REVENUE" DESC NULLS FIRST) AS "t15"