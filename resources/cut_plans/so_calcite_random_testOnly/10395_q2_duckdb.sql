SELECT COALESCE("t5"."USERID", "t5"."USERID") AS "USERID", "t5"."DISPLAYNAME", "t5"."POSTCOUNT", "t5"."COMMENTCOUNT", "t5"."VOTECOUNT"
FROM (SELECT "Users0"."Id" AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", "t3"."POSTCOUNT", "t3"."COMMENTCOUNT", "t3"."VOTECOUNT"
FROM "STACK"."Users" AS "Users0"
LEFT JOIN (SELECT ANY_VALUE("s1"."Id") AS "USERID", COUNT(DISTINCT "s1"."Id0") AS "POSTCOUNT", COUNT(DISTINCT "s1"."Id1") AS "COMMENTCOUNT", COUNT(DISTINCT "Votes"."Id") AS "VOTECOUNT"
FROM "s1"
LEFT JOIN "STACK"."Votes" ON "s1"."Id0" = "Votes"."PostId"
GROUP BY "s1"."Id") AS "t3" ON "Users0"."Id" = "t3"."USERID"
ORDER BY "t3"."POSTCOUNT" DESC NULLS FIRST, "t3"."COMMENTCOUNT" DESC NULLS FIRST, "t3"."VOTECOUNT" DESC NULLS FIRST) AS "t5"