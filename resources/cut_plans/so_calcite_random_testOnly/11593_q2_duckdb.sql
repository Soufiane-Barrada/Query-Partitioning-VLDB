SELECT COALESCE("t10"."POSTID", "t10"."POSTID") AS "POSTID", "t10"."TITLE", "t10"."SCORE", "t10"."VIEWCOUNT", "t10"."ANSWERCOUNT", "t10"."COMMENTCOUNT", "t10"."TOTALCOMMENTS", "t10"."TOTALVOTES", "t10"."USERID", "t10"."DISPLAYNAME", "t10"."TOTALPOSTS", "t10"."TOTALSCORE", "t10"."USERTOTALCOMMENTS", "t10"."USERTOTALVOTES"
FROM (SELECT "t6"."POSTID", "t6"."TITLE", "t6"."SCORE", "t6"."VIEWCOUNT", "t6"."ANSWERCOUNT", "t6"."COMMENTCOUNT", "t6"."TOTALCOMMENTS", "t6"."TOTALVOTES", "t8"."USERID", "t8"."DISPLAYNAME", "t8"."TOTALPOSTS", "t8"."TOTALSCORE", "t8"."TOTALCOMMENTS" AS "USERTOTALCOMMENTS", "t8"."TOTALVOTES" AS "USERTOTALVOTES"
FROM (SELECT ANY_VALUE("t3"."Id") AS "POSTID", "t3"."Title" AS "TITLE", "t3"."Score" AS "SCORE", "t3"."ViewCount" AS "VIEWCOUNT", "t3"."AnswerCount" AS "ANSWERCOUNT", "t3"."CommentCount" AS "COMMENTCOUNT", "t3"."CreationDate" AS "CREATIONDATE", COUNT("t3"."Id0") AS "TOTALCOMMENTS", COUNT("Votes0"."Id") AS "TOTALVOTES", CAST(ANY_VALUE("t3"."Id") AS BIGINT) AS "POSTID0"
FROM "STACK"."Votes" AS "Votes0"
RIGHT JOIN (SELECT "Posts0"."Id", "Posts0"."PostTypeId", "Posts0"."AcceptedAnswerId", "Posts0"."ParentId", "Posts0"."CreationDate", "Posts0"."Score", "Posts0"."ViewCount", "Posts0"."Body", "Posts0"."OwnerUserId", "Posts0"."OwnerDisplayName", "Posts0"."LastEditorUserId", "Posts0"."LastEditorDisplayName", "Posts0"."LastEditDate", "Posts0"."LastActivityDate", "Posts0"."Title", "Posts0"."Tags", "Posts0"."AnswerCount", "Posts0"."CommentCount", "Posts0"."FavoriteCount", "Posts0"."ClosedDate", "Posts0"."CommunityOwnedDate", "Posts0"."ContentLicense", "Comments0"."Id" AS "Id0", "Comments0"."PostId", "Comments0"."Score" AS "Score0", "Comments0"."Text", "Comments0"."CreationDate" AS "CreationDate0", "Comments0"."UserDisplayName", "Comments0"."UserId", "Comments0"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments" AS "Comments0"
RIGHT JOIN "STACK"."Posts" AS "Posts0" ON "Comments0"."PostId" = "Posts0"."Id") AS "t3" ON "Votes0"."PostId" = "t3"."Id"
GROUP BY "t3"."Id", "t3"."CreationDate", "t3"."Score", "t3"."ViewCount", "t3"."Title", "t3"."AnswerCount", "t3"."CommentCount") AS "t6"
INNER JOIN (SELECT ANY_VALUE("Id") AS "USERID", "DISPLAYNAME", COUNT("Id0") AS "TOTALPOSTS", SUM("FD_COL_3") AS "TOTALSCORE", SUM("FD_COL_4") AS "TOTALCOMMENTS", SUM("FD_COL_5") AS "TOTALVOTES"
FROM "s1"
GROUP BY "Id", "DISPLAYNAME") AS "t8" ON "t6"."POSTID0" = "t8"."TOTALPOSTS"
ORDER BY "t6"."SCORE" DESC NULLS FIRST, "t6"."VIEWCOUNT" DESC NULLS FIRST) AS "t10"