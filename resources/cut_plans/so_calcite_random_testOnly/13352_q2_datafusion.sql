SELECT COALESCE("t1"."POSTTYPE", "t1"."POSTTYPE") AS "POSTTYPE", "t1"."POSTCOUNT", "t1"."USERCOUNT", "t1"."VOTECOUNT", "t1"."COMMENTCOUNT", "t1"."AVGSCORE", "t1"."AVGVIEWCOUNT"
FROM (SELECT "s1"."Name", ANY_VALUE("s1"."Name") AS "POSTTYPE", COUNT(*) AS "POSTCOUNT", COUNT(DISTINCT "s1"."Id1") AS "USERCOUNT", COUNT("Votes"."Id") AS "VOTECOUNT", COUNT("Comments"."Id") AS "COMMENTCOUNT", AVG("s1"."Score") AS "AVGSCORE", AVG("s1"."ViewCount") AS "AVGVIEWCOUNT"
FROM "s1"
LEFT JOIN "STACK"."Votes" ON "s1"."Id" = "Votes"."PostId"
LEFT JOIN "STACK"."Comments" ON "s1"."Id" = "Comments"."PostId"
GROUP BY "s1"."Name"
ORDER BY 3 DESC NULLS FIRST) AS "t1"