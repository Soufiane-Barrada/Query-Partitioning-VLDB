SELECT COALESCE("t6"."USERID", "t6"."USERID") AS "USERID", "t6"."REPUTATION", "t6"."DISPLAYNAME", "t6"."POSTCOUNT", "t6"."QUESTIONCOUNT", "t6"."ANSWERCOUNT", "t6"."TOTALCOMMENTS", "t6"."TOTALVOTES"
FROM (SELECT ANY_VALUE("s1"."Id") AS "USERID", "s1"."Reputation" AS "REPUTATION", "s1"."DisplayName" AS "DISPLAYNAME", COUNT("s1"."Id0") AS "POSTCOUNT", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONCOUNT", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERCOUNT", CASE WHEN SUM("s1"."COMMENTCOUNT_") IS NOT NULL THEN CAST(SUM("s1"."COMMENTCOUNT_") AS BIGINT) ELSE 0 END AS "TOTALCOMMENTS", CASE WHEN SUM("t2"."VOTECOUNT") IS NOT NULL THEN CAST(SUM("t2"."VOTECOUNT") AS BIGINT) ELSE 0 END AS "TOTALVOTES"
FROM "s1"
LEFT JOIN (SELECT "PostId", COUNT(*) AS "VOTECOUNT"
FROM "STACK"."Votes"
GROUP BY "PostId") AS "t2" ON "s1"."Id0" = "t2"."PostId"
GROUP BY "s1"."Id", "s1"."Reputation", "s1"."DisplayName"
ORDER BY "s1"."Reputation" DESC NULLS FIRST) AS "t6"