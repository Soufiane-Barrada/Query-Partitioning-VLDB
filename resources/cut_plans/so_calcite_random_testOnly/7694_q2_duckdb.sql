SELECT COALESCE("t10"."USERID", "t10"."USERID") AS "USERID", "t10"."DISPLAYNAME", "t10"."TOTALPOSTS", "t10"."TOTALQUESTIONS", "t10"."TOTALANSWERS", "t10"."AVERAGEREPUTATION", "t10"."TOTALUPVOTES", "t10"."TOTALDOWNVOTES", "t10"."POSTID", "t10"."TITLE", "t10"."CREATIONDATE", "t10"."COMMENTCOUNT", "t10"."RELATEDPOSTLINKS", "t10"."CLOSEDDATE", "t10"."REOPENEDDATE", "t10"."POSTSTATUS"
FROM (SELECT "s1"."USERID", "s1"."DISPLAYNAME", "s1"."TOTALPOSTS", "s1"."TOTALQUESTIONS", "s1"."TOTALANSWERS", "s1"."AVERAGEREPUTATION", "s1"."TOTALUPVOTES", "s1"."TOTALDOWNVOTES", "t8"."POSTID", "t8"."TITLE", "t8"."CREATIONDATE", "t8"."COMMENTCOUNT", "t8"."RELATEDPOSTLINKS", "t8"."CLOSEDDATE", "t8"."REOPENEDDATE", CASE WHEN "t8"."CLOSEDDATE" IS NOT NULL THEN 'Closed  ' WHEN "t8"."REOPENEDDATE" IS NOT NULL THEN 'Reopened' ELSE 'Active  ' END AS "POSTSTATUS"
FROM "s1"
INNER JOIN (SELECT ANY_VALUE("t5"."Id") AS "POSTID", "t5"."Title" AS "TITLE", "t5"."CreationDate" AS "CREATIONDATE", COUNT("t5"."Id0") AS "COMMENTCOUNT", COUNT("PostLinks"."RelatedPostId") AS "RELATEDPOSTLINKS", MAX(CASE WHEN CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) = 10 THEN "PostHistory"."CreationDate" ELSE NULL END) AS "CLOSEDDATE", MAX(CASE WHEN CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) = 11 THEN "PostHistory"."CreationDate" ELSE NULL END) AS "REOPENEDDATE"
FROM (SELECT "Posts0"."Id", "Posts0"."PostTypeId", "Posts0"."AcceptedAnswerId", "Posts0"."ParentId", "Posts0"."CreationDate", "Posts0"."Score", "Posts0"."ViewCount", "Posts0"."Body", "Posts0"."OwnerUserId", "Posts0"."OwnerDisplayName", "Posts0"."LastEditorUserId", "Posts0"."LastEditorDisplayName", "Posts0"."LastEditDate", "Posts0"."LastActivityDate", "Posts0"."Title", "Posts0"."Tags", "Posts0"."AnswerCount", "Posts0"."CommentCount", "Posts0"."FavoriteCount", "Posts0"."ClosedDate", "Posts0"."CommunityOwnedDate", "Posts0"."ContentLicense", "Comments"."Id" AS "Id0", "Comments"."PostId", "Comments"."Score" AS "Score0", "Comments"."Text", "Comments"."CreationDate" AS "CreationDate0", "Comments"."UserDisplayName", "Comments"."UserId", "Comments"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments"
RIGHT JOIN "STACK"."Posts" AS "Posts0" ON "Comments"."PostId" = "Posts0"."Id") AS "t5"
LEFT JOIN "STACK"."PostLinks" ON "t5"."Id" = "PostLinks"."PostId"
LEFT JOIN "STACK"."PostHistory" ON "t5"."Id" = "PostHistory"."PostId"
GROUP BY "t5"."Id", "t5"."Title", "t5"."CreationDate") AS "t8" ON "s1"."USERID" = "t8"."POSTID"
ORDER BY "s1"."TOTALPOSTS" DESC NULLS FIRST, "s1"."AVERAGEREPUTATION" DESC NULLS FIRST
FETCH NEXT 50 ROWS ONLY) AS "t10"