SELECT COALESCE("t10"."USERID", "t10"."USERID") AS "USERID", "t10"."DISPLAYNAME", "t10"."TOTALPOSTS", "t10"."TOTALVOTES", "t10"."TOTALUPVOTES", "t10"."TOTALDOWNVOTES", "t10"."TOTALBADGES", "t10"."HIGHESTBADGELEVEL", "t10"."BADGELEVELDESCRIPTION"
FROM (SELECT "t8"."USERID", "t8"."DISPLAYNAME", "t8"."POSTCOUNT" AS "TOTALPOSTS", CASE WHEN "t8"."VOTECOUNT" IS NOT NULL THEN CAST("t8"."VOTECOUNT" AS BIGINT) ELSE 0 END AS "TOTALVOTES", CASE WHEN "t8"."UPVOTES" IS NOT NULL THEN CAST("t8"."UPVOTES" AS INTEGER) ELSE 0 END AS "TOTALUPVOTES", CASE WHEN "t8"."DOWNVOTES" IS NOT NULL THEN CAST("t8"."DOWNVOTES" AS INTEGER) ELSE 0 END AS "TOTALDOWNVOTES", CASE WHEN "t4"."BADGECOUNT" IS NOT NULL THEN CAST("t4"."BADGECOUNT" AS BIGINT) ELSE 0 END AS "TOTALBADGES", CASE WHEN "t4"."HIGHESTBADGELEVEL" IS NOT NULL THEN CAST("t4"."HIGHESTBADGELEVEL" AS INTEGER) ELSE 0 END AS "HIGHESTBADGELEVEL", CASE WHEN CAST("t4"."HIGHESTBADGELEVEL" AS INTEGER) = 1 THEN 'Gold    ' WHEN CAST("t4"."HIGHESTBADGELEVEL" AS INTEGER) = 2 THEN 'Silver  ' WHEN CAST("t4"."HIGHESTBADGELEVEL" AS INTEGER) = 3 THEN 'Bronze  ' ELSE 'No Badge' END AS "BADGELEVELDESCRIPTION"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", COUNT("Badges"."Id") AS "BADGECOUNT", MAX("Badges"."Class") AS "HIGHESTBADGELEVEL"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id"
GROUP BY "Users"."Id") AS "t4"
RIGHT JOIN (SELECT "t7"."USERID", "t7"."DISPLAYNAME", "t7"."POSTCOUNT", "t7"."USERRANK", "s1"."POSTID", "s1"."VOTECOUNT", "s1"."UPVOTES", "s1"."DOWNVOTES"
FROM "s1"
RIGHT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", COUNT("Posts0"."Id") AS "POSTCOUNT", RANK() OVER (ORDER BY COUNT("Posts0"."Id") DESC NULLS FIRST) AS "USERRANK"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Posts0"."OwnerUserId" = "Users0"."Id"
GROUP BY "Users0"."Id", "Users0"."DisplayName"
HAVING COUNT("Posts0"."Id") > 0) AS "t7" ON "s1"."POSTID" = "t7"."USERID") AS "t8" ON "t4"."USERID" = "t8"."USERID"
ORDER BY "t8"."POSTCOUNT" DESC NULLS FIRST, 4 DESC NULLS FIRST
FETCH NEXT 10 ROWS ONLY) AS "t10"