SELECT COALESCE("t1"."USERID", "t1"."USERID") AS "USERID", "t1"."TOTALBADGES", "t1"."GOLDBADGES", "t1"."SILVERBADGES", "t1"."BRONZEBADGES", CAST("t5"."TOTALPOSTS" AS BIGINT) AS "TOTALPOSTS", CAST("t5"."QUESTIONS" AS INTEGER) AS "QUESTIONS", CAST("t5"."ANSWERS" AS INTEGER) AS "ANSWERS", CAST("t5"."TOTALVIEWS" AS INTEGER) AS "TOTALVIEWS", CAST("t5"."TOTALSCORE" AS INTEGER) AS "TOTALSCORE"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", COUNT("Badges"."Id") AS "TOTALBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id"
GROUP BY "Users"."Id") AS "t1"
INNER JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(*) AS "TOTALPOSTS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERS", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)
GROUP BY "OwnerUserId"
HAVING COUNT(*) > 5) AS "t5" ON "t1"."USERID" = "t5"."OWNERUSERID"