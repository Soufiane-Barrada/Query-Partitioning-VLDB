SELECT COALESCE("t3"."POSTID", "t3"."POSTID") AS "POSTID", "t3"."REVISIONCOUNT", "t3"."FIRSTREVISIONDATE", "t3"."LASTREVISIONDATE", "t3"."POSTTITLES", "t3"."COMMENTCOUNT", "t3"."VOTECOUNT", "t3"."UPVOTECOUNT", "t3"."DOWNVOTECOUNT"
FROM (SELECT "s1"."PostId" AS "POSTID", COUNT(*) AS "REVISIONCOUNT", MIN("s1"."CreationDate") AS "FIRSTREVISIONDATE", MAX("s1"."CreationDate") AS "LASTREVISIONDATE", LISTAGG(DISTINCT "s1"."Title", ', ') AS "POSTTITLES", COUNT(DISTINCT "s1"."Id1") AS "COMMENTCOUNT", COUNT(DISTINCT "Votes"."Id") AS "VOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTECOUNT"
FROM "s1"
LEFT JOIN "STACK"."Votes" ON "s1"."Id0" = "Votes"."PostId"
GROUP BY "s1"."PostId"
ORDER BY 2 DESC NULLS FIRST) AS "t3"