SELECT COALESCE("Users"."Id", "Users"."Id") AS "Id", "Users"."DisplayName", "Users"."Reputation" AS "REPUTATION", ANY_VALUE("Users"."Id") AS "USERID", ANY_VALUE("Users"."DisplayName") AS "USERNAME", COUNT("Posts"."Id") AS "TOTALPOSTS", COUNT(CASE WHEN CAST("Posts"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "TOTALQUESTIONS", COUNT(CASE WHEN CAST("Posts"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "TOTALANSWERS", SUM(CASE WHEN "Posts"."Score" IS NOT NULL THEN CAST("Posts"."Score" AS INTEGER) ELSE 0 END) AS "TOTALSCORE", SUM(CASE WHEN "Posts"."ViewCount" IS NOT NULL THEN CAST("Posts"."ViewCount" AS INTEGER) ELSE 0 END) AS "TOTALVIEWS", AVG(CASE WHEN "Posts"."Score" IS NOT NULL THEN CAST("Posts"."Score" AS INTEGER) ELSE 0 END) AS "AVERAGESCORE", AVG(CASE WHEN "Posts"."ViewCount" IS NOT NULL THEN CAST("Posts"."ViewCount" AS INTEGER) ELSE 0 END) AS "AVERAGEVIEWS"
FROM "STACK"."Posts"
RIGHT JOIN "STACK"."Users" ON "Posts"."OwnerUserId" = "Users"."Id"
GROUP BY "Users"."Id", "Users"."DisplayName", "Users"."Reputation"