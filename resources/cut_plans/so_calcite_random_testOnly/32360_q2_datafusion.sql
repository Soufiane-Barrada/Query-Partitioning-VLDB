SELECT COALESCE("t10"."POSTID", "t10"."POSTID") AS "POSTID", "t10"."TITLE", "t10"."SCORE", "t10"."VIEWCOUNT", "t10"."ANSWERCOUNT", "t10"."CLOSEREOPENCOUNT", "t10"."DELETEUNDELETECOUNT", "t10"."LASTEDITED", "t10"."CLOSURESTATUS"
FROM (SELECT "t6"."POSTID", "t6"."TITLE", "t6"."SCORE", "t6"."VIEWCOUNT", "t6"."ANSWERCOUNT", "t8"."CLOSEREOPENCOUNT", "t8"."DELETEUNDELETECOUNT", "t8"."LASTEDITED", CASE WHEN "t8"."CLOSEREOPENCOUNT" > 2 THEN 'Frequently Closed/Reopened' ELSE 'Rarely Closed/Reopened    ' END AS "CLOSURESTATUS"
FROM (SELECT "t5"."POSTID", "t5"."TITLE", "t5"."SCORE", "t5"."VIEWCOUNT", "t5"."ANSWERCOUNT", "s1"."BADGECOUNT"
FROM (SELECT *
FROM (SELECT "Id" AS "POSTID", "Title" AS "TITLE", "CreationDate" AS "CREATIONDATE", "Score" AS "SCORE", "ViewCount" AS "VIEWCOUNT", "AnswerCount" AS "ANSWERCOUNT", "OwnerUserId" AS "OWNERUSERID", ROW_NUMBER() OVER (PARTITION BY "OwnerUserId" ORDER BY "CreationDate" DESC NULLS FIRST) AS "RN"
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '30' DAY)) AS "t4"
WHERE "SCORE" > 10) AS "t5"
INNER JOIN "s1" ON "t5"."OWNERUSERID" = "s1"."USERID") AS "t6"
INNER JOIN (SELECT "PostId" AS "POSTID", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (10, 11) THEN 1 ELSE NULL END) AS "CLOSEREOPENCOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (12, 13) THEN 1 ELSE NULL END) AS "DELETEUNDELETECOUNT", MAX("CreationDate") AS "LASTEDITED"
FROM "STACK"."PostHistory"
GROUP BY "PostId") AS "t8" ON "t6"."POSTID" = "t8"."POSTID"
ORDER BY "t6"."SCORE" DESC NULLS FIRST, "t6"."VIEWCOUNT" DESC NULLS FIRST) AS "t10"