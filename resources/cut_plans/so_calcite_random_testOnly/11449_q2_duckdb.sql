SELECT COALESCE("t9"."DISPLAYNAME", "t9"."DISPLAYNAME") AS "DISPLAYNAME", "t9"."TOTALPOSTS", "t9"."QUESTIONS", "t9"."ANSWERS", "t9"."UPVOTEDPOSTS", "t9"."POSTID", "t9"."TITLE", "t9"."COMMENTCOUNT", "t9"."UPVOTES", "t9"."DOWNVOTES"
FROM (SELECT "t4"."DISPLAYNAME", "t4"."TOTALPOSTS", "t4"."QUESTIONS", "t4"."ANSWERS", "t4"."UPVOTEDPOSTS", "t7"."POSTID", "t7"."TITLE", "t7"."COMMENTCOUNT", "t7"."UPVOTES", "t7"."DOWNVOTES"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", "Users"."DisplayName" AS "DISPLAYNAME", COUNT("Posts0"."Id") AS "TOTALPOSTS", SUM(CASE WHEN CAST("Posts0"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONS", SUM(CASE WHEN CAST("Posts0"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERS", SUM(CASE WHEN "Posts0"."Score" > 0 THEN 1 ELSE 0 END) AS "UPVOTEDPOSTS"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" ON "Posts0"."OwnerUserId" = "Users"."Id"
GROUP BY "Users"."Id", "Users"."DisplayName"
HAVING COUNT("Posts0"."Id") > 0) AS "t4"
INNER JOIN (SELECT ANY_VALUE("s1"."Id") AS "POSTID", "s1"."Title" AS "TITLE", COUNT("s1"."Id0") AS "COMMENTCOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."Votes"
RIGHT JOIN "s1" ON "Votes"."PostId" = "s1"."Id"
GROUP BY "s1"."Id", "s1"."Title") AS "t7" ON "t4"."USERID" = "t7"."POSTID"
ORDER BY "t4"."TOTALPOSTS" DESC NULLS FIRST, "t7"."UPVOTES" DESC NULLS FIRST
FETCH NEXT 50 ROWS ONLY) AS "t9"