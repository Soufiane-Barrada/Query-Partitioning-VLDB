SELECT COALESCE("t7"."POSTID", "t7"."POSTID") AS "POSTID", "t7"."POSTTYPEID", "t7"."COMMENTCOUNT", "t7"."VOTECOUNT", "t7"."UPVOTES", "t7"."DOWNVOTES", "t7"."OFFENSIVEVOTES", "t7"."LASTACTIVITYDATE", "t7"."USERID", "t7"."BADGECOUNT", "t7"."TOTALUPVOTES", "t7"."TOTALDOWNVOTES", "t7"."TOTALVIEWS"
FROM (SELECT "t5"."POSTID", "t5"."POSTTYPEID", "t5"."COMMENTCOUNT", "t5"."VOTECOUNT", "t5"."UPVOTES", "t5"."DOWNVOTES", "t5"."OFFENSIVEVOTES", "t5"."LASTACTIVITYDATE", "t3"."USERID", "t3"."BADGECOUNT", "t3"."TOTALUPVOTES", "t3"."TOTALDOWNVOTES", "t3"."TOTALVIEWS"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", COUNT("Badges"."Id") AS "BADGECOUNT", SUM("Users"."UpVotes") AS "TOTALUPVOTES", SUM("Users"."DownVotes") AS "TOTALDOWNVOTES", SUM("Users"."Views") AS "TOTALVIEWS"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id"
GROUP BY "Users"."Id") AS "t3"
INNER JOIN (SELECT ANY_VALUE("Id") AS "POSTID", "POSTTYPEID", COUNT("Id0") AS "COMMENTCOUNT", COUNT("Id1") AS "VOTECOUNT", SUM("FD_COL_4") AS "UPVOTES", SUM("FD_COL_5") AS "DOWNVOTES", SUM("FD_COL_6") AS "OFFENSIVEVOTES", MAX("CreationDate") AS "LASTACTIVITYDATE", CAST("POSTTYPEID" AS INTEGER) AS "POSTTYPEID0"
FROM "s1"
GROUP BY "Id", "POSTTYPEID") AS "t5" ON "t3"."USERID" = "t5"."POSTTYPEID0"
ORDER BY "t5"."LASTACTIVITYDATE" DESC NULLS FIRST) AS "t7"