SELECT COALESCE("t5"."POSTID", "t5"."POSTID") AS "POSTID", "t5"."TITLE", "t5"."CREATIONDATE", "t5"."SCORE", "t5"."VIEWCOUNT", "t5"."OWNERDISPLAYNAME", "t5"."VOTECOUNT", "t5"."COMMENTCOUNT", "t5"."UPVOTES", "t5"."DOWNVOTES"
FROM (SELECT ANY_VALUE("s1"."Id") AS "POSTID", "s1"."Title" AS "TITLE", "s1"."CreationDate" AS "CREATIONDATE", "s1"."Score" AS "SCORE", "s1"."ViewCount" AS "VIEWCOUNT", ANY_VALUE("s1"."DisplayName") AS "OWNERDISPLAYNAME", COUNT("s1"."Id1") AS "VOTECOUNT", COUNT("Comments"."Id") AS "COMMENTCOUNT", CASE WHEN CASE WHEN ROUND(AVG(CASE WHEN "s1"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) = 0 THEN FALSE ELSE ROUND(AVG(CASE WHEN "s1"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) IS NOT NULL END THEN CAST(CASE WHEN ROUND(AVG(CASE WHEN "s1"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) = 0 THEN NULL ELSE ROUND(AVG(CASE WHEN "s1"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) END AS INTEGER) ELSE 0 END AS "UPVOTES", CASE WHEN CASE WHEN ROUND(AVG(CASE WHEN "s1"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) = 0 THEN FALSE ELSE ROUND(AVG(CASE WHEN "s1"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) IS NOT NULL END THEN CAST(CASE WHEN ROUND(AVG(CASE WHEN "s1"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) = 0 THEN NULL ELSE ROUND(AVG(CASE WHEN "s1"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) END AS INTEGER) ELSE 0 END AS "DOWNVOTES"
FROM "s1"
LEFT JOIN "STACK"."Comments" ON "s1"."Id" = "Comments"."PostId"
GROUP BY "s1"."Id", "s1"."Title", "s1"."CreationDate", "s1"."Score", "s1"."ViewCount", "s1"."DisplayName"
ORDER BY "s1"."CreationDate" DESC NULLS FIRST) AS "t5"