SELECT COALESCE("POSTTYPE", "POSTTYPE") AS "POSTTYPE", "TOTALPOSTS", "$f3" AS "AVGVIEWCOUNT", "TOTALUPVOTES", "TOTALDOWNVOTES"
FROM (SELECT "Name", ANY_VALUE("Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", AVG("ViewCount") AS "$f3", SUM("FD_COL_2") AS "TOTALUPVOTES", SUM("FD_COL_3") AS "TOTALDOWNVOTES"
FROM "s1"
GROUP BY "Name"
ORDER BY 3 DESC NULLS FIRST) AS "t2"