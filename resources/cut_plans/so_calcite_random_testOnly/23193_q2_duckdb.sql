SELECT COALESCE("t17"."DISPLAYNAME", "t17"."DISPLAYNAME") AS "DISPLAYNAME", "t17"."ID", "t17"."REPUTATION", "t17"."TOTALPOSTS", "t17"."QUESTIONSCOUNT", "t17"."ANSWERSCOUNT", "t17"."GOLDBADGES", "t17"."SILVERBADGES", "t17"."BRONZEBADGES", "t17"."QUESTIONRATIO", "t17"."ANSWERRATIO", "t17"."RECENTVOTECOUNT", "t17"."REPUTATION0"
FROM (SELECT "Users1"."DisplayName" AS "DISPLAYNAME", "Users1"."Id" AS "ID", "Users1"."Reputation" AS "REPUTATION", "t14"."TOTALPOSTS", "t14"."QUESTIONSCOUNT", "t14"."ANSWERSCOUNT", "t14"."GOLDBADGES", "t14"."SILVERBADGES", "t14"."BRONZEBADGES", "t14"."QUESTIONRATIO", "t14"."ANSWERRATIO", CASE WHEN "s1"."FD_COL_1" IS NULL THEN 0 ELSE "s1"."FD_COL_1" END AS "RECENTVOTECOUNT", "t14"."REPUTATION" AS "REPUTATION0"
FROM "STACK"."Users" AS "Users1"
INNER JOIN (SELECT ANY_VALUE("t10"."Id") AS "USERID", "t10"."Reputation" AS "REPUTATION", COUNT(DISTINCT "t10"."Id0") AS "TOTALPOSTS", SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONSCOUNT", SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERSCOUNT", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES", CASE WHEN COUNT(DISTINCT "t10"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t10"."Id0") END AS "QUESTIONRATIO", CASE WHEN COUNT(DISTINCT "t10"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t10"."Id0") END AS "ANSWERRATIO"
FROM (SELECT "Users2"."Id", "Users2"."Reputation", "Users2"."CreationDate", "Users2"."DisplayName", "Users2"."LastAccessDate", "Users2"."WebsiteUrl", "Users2"."Location", "Users2"."AboutMe", "Users2"."Views", "Users2"."UpVotes", "Users2"."DownVotes", "Users2"."ProfileImageUrl", "Users2"."AccountId", "Posts0"."Id" AS "Id0", "Posts0"."PostTypeId", "Posts0"."AcceptedAnswerId", "Posts0"."ParentId", "Posts0"."CreationDate" AS "CreationDate0", "Posts0"."Score", "Posts0"."ViewCount", "Posts0"."Body", "Posts0"."OwnerUserId", "Posts0"."OwnerDisplayName", "Posts0"."LastEditorUserId", "Posts0"."LastEditorDisplayName", "Posts0"."LastEditDate", "Posts0"."LastActivityDate", "Posts0"."Title", "Posts0"."Tags", "Posts0"."AnswerCount", "Posts0"."CommentCount", "Posts0"."FavoriteCount", "Posts0"."ClosedDate", "Posts0"."CommunityOwnedDate", "Posts0"."ContentLicense"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" AS "Users2" ON "Posts0"."OwnerUserId" = "Users2"."Id") AS "t10"
LEFT JOIN "STACK"."Badges" AS "Badges0" ON "t10"."Id" = "Badges0"."UserId"
GROUP BY "t10"."Id", "t10"."Reputation"
HAVING (CASE WHEN COUNT(DISTINCT "t10"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t10"."Id0") END > 5E-1 OR CASE WHEN COUNT(DISTINCT "t10"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t10"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t10"."Id0") END > 5E-1) AND SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) > 0) AS "t14" ON "Users1"."Id" = "t14"."USERID"
LEFT JOIN "s1" ON "Users1"."Id" = "s1"."UserId"
ORDER BY "t14"."REPUTATION" DESC NULLS FIRST, "Users1"."DisplayName"
FETCH NEXT 10 ROWS ONLY) AS "t17"