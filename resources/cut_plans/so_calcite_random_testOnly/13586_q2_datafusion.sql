SELECT COALESCE("t9"."POSTID", "t9"."POSTID") AS "POSTID", "t9"."POSTTYPEID", "t9"."CREATIONDATE", "t9"."SCORE", "t9"."VIEWCOUNT", "t9"."COMMENTCOUNT", "t9"."ANSWERCOUNT", "t9"."VOTECOUNT", "t9"."USERID", "t9"."GOLDBADGES", "t9"."SILVERBADGES", "t9"."BRONZEBADGES", "t9"."AVGREPUTATION"
FROM (SELECT "t7"."POSTID", "t7"."POSTTYPEID", "t7"."CREATIONDATE", "t7"."SCORE", "t7"."VIEWCOUNT", "t7"."COMMENTCOUNT", "t7"."ANSWERCOUNT", "t7"."VOTECOUNT", "s1"."USERID", "s1"."GOLDBADGES", "s1"."SILVERBADGES", "s1"."BRONZEBADGES", "s1"."AVGREPUTATION"
FROM "s1"
INNER JOIN (SELECT "t6"."POSTID", "t6"."POSTTYPEID", "t6"."CREATIONDATE", "t6"."SCORE", "t6"."VIEWCOUNT", "t6"."COMMENTCOUNT", "t6"."ANSWERCOUNT", "t6"."VOTECOUNT", "Users0"."Id", "Users0"."Reputation", "Users0"."CreationDate", "Users0"."DisplayName", "Users0"."LastAccessDate", "Users0"."WebsiteUrl", "Users0"."Location", "Users0"."AboutMe", "Users0"."Views", "Users0"."UpVotes", "Users0"."DownVotes", "Users0"."ProfileImageUrl", "Users0"."AccountId"
FROM "STACK"."Users" AS "Users0"
INNER JOIN (SELECT ANY_VALUE("t3"."Id") AS "POSTID", "t3"."PostTypeId" AS "POSTTYPEID", "t3"."CreationDate" AS "CREATIONDATE", "t3"."Score" AS "SCORE", "t3"."ViewCount" AS "VIEWCOUNT", COUNT(CASE WHEN "t3"."Id0" IS NOT NULL THEN 1 ELSE NULL END) AS "COMMENTCOUNT", COUNT(CASE WHEN "Posts0"."Id" IS NOT NULL THEN 1 ELSE NULL END) AS "ANSWERCOUNT", COUNT(DISTINCT "Votes"."Id") AS "VOTECOUNT", CAST("t3"."PostTypeId" AS INTEGER) AS "POSTTYPEID0"
FROM (SELECT "Posts"."Id", "Posts"."PostTypeId", "Posts"."AcceptedAnswerId", "Posts"."ParentId", "Posts"."CreationDate", "Posts"."Score", "Posts"."ViewCount", "Posts"."Body", "Posts"."OwnerUserId", "Posts"."OwnerDisplayName", "Posts"."LastEditorUserId", "Posts"."LastEditorDisplayName", "Posts"."LastEditDate", "Posts"."LastActivityDate", "Posts"."Title", "Posts"."Tags", "Posts"."AnswerCount", "Posts"."CommentCount", "Posts"."FavoriteCount", "Posts"."ClosedDate", "Posts"."CommunityOwnedDate", "Posts"."ContentLicense", "Comments"."Id" AS "Id0", "Comments"."PostId", "Comments"."Score" AS "Score0", "Comments"."Text", "Comments"."CreationDate" AS "CreationDate0", "Comments"."UserDisplayName", "Comments"."UserId", "Comments"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments"
RIGHT JOIN "STACK"."Posts" ON "Comments"."PostId" = "Posts"."Id") AS "t3"
LEFT JOIN "STACK"."Posts" AS "Posts0" ON "t3"."Id" = "Posts0"."ParentId"
LEFT JOIN "STACK"."Votes" ON "t3"."Id" = "Votes"."PostId"
GROUP BY "t3"."Id", "t3"."PostTypeId", "t3"."CreationDate", "t3"."Score", "t3"."ViewCount") AS "t6" ON "Users0"."AccountId" = "t6"."POSTTYPEID0") AS "t7" ON "s1"."USERID" = "t7"."Id"
ORDER BY "t7"."VIEWCOUNT" DESC NULLS FIRST, "t7"."SCORE" DESC NULLS FIRST) AS "t9"