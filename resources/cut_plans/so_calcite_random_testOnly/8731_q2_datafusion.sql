SELECT COALESCE("t8"."DISPLAYNAME", "t8"."DISPLAYNAME") AS "DISPLAYNAME", "t8"."REPUTATION", "t8"."BADGECOUNT", "t8"."POSTCOUNT", "t8"."QUESTIONCOUNT", "t8"."ANSWERCOUNT", "t8"."TOTALVIEWS", "t8"."EDITCOUNT", "t8"."TITLEANDBODYEDITS"
FROM (SELECT "t2"."DisplayName" AS "DISPLAYNAME", "t2"."Reputation" AS "REPUTATION", "t4"."BADGECOUNT", "s1"."POSTCOUNT", "s1"."QUESTIONCOUNT", "s1"."ANSWERCOUNT", "s1"."TOTALVIEWS", "t6"."EDITCOUNT", "t6"."TITLEANDBODYEDITS"
FROM (SELECT *
FROM "STACK"."Users"
WHERE "Reputation" > 1000) AS "t2"
LEFT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", COUNT("Badges"."Id") AS "BADGECOUNT"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Badges"."UserId" = "Users0"."Id"
GROUP BY "Users0"."Id") AS "t4" ON "t2"."Id" = "t4"."USERID"
LEFT JOIN "s1" ON "t2"."Id" = "s1"."OWNERUSERID"
LEFT JOIN (SELECT "UserId" AS "USERID", COUNT(*) AS "EDITCOUNT", SUM(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (4, 5, 6) THEN 1 ELSE 0 END) AS "TITLEANDBODYEDITS"
FROM "STACK"."PostHistory"
GROUP BY "UserId") AS "t6" ON "t2"."Id" = "t6"."USERID"
ORDER BY "t4"."BADGECOUNT" DESC NULLS FIRST, "s1"."TOTALVIEWS" DESC NULLS FIRST
FETCH NEXT 100 ROWS ONLY) AS "t8"