SELECT COALESCE("t15"."USERID", "t15"."USERID") AS "USERID", "t15"."DISPLAYNAME", "t15"."POSITIVECONTRIBUTIONS", "t15"."NEGATIVECONTRIBUTIONS", "t15"."CONTRIBUTINGPOSTS", "t15"."POSTTITLES", "t15"."CONTRIBUTIONTYPE"
FROM (SELECT "t13"."USERID", "Users0"."DisplayName" AS "DISPLAYNAME", "t13"."POSITIVECONTRIBUTIONS", "t13"."NEGATIVECONTRIBUTIONS", "t13"."CONTRIBUTINGPOSTS", "t13"."POSTTITLES", CASE WHEN "t13"."POSITIVECONTRIBUTIONS" > "t13"."NEGATIVECONTRIBUTIONS" THEN 'Overall Positive Contributor' WHEN "t13"."NEGATIVECONTRIBUTIONS" > "t13"."POSITIVECONTRIBUTIONS" THEN 'Overall Negative Contributor' ELSE 'Neutral Contributor         ' END AS "CONTRIBUTIONTYPE"
FROM "STACK"."Users" AS "Users0"
INNER JOIN (SELECT "USERID", SUM("FD_COL_1") AS "POSITIVECONTRIBUTIONS", SUM("FD_COL_2") AS "NEGATIVECONTRIBUTIONS", COUNT(DISTINCT "POSTID") AS "CONTRIBUTINGPOSTS", LISTAGG("TITLE", "FD_COL_5") AS "POSTTITLES"
FROM "s1"
GROUP BY "USERID"
HAVING COUNT(DISTINCT "POSTID") > 0) AS "t13" ON "Users0"."Id" = "t13"."USERID"
ORDER BY "t13"."POSITIVECONTRIBUTIONS" DESC NULLS FIRST, "t13"."NEGATIVECONTRIBUTIONS") AS "t15"