SELECT COALESCE("t3"."POSTTYPEID", "t3"."POSTTYPEID") AS "POSTTYPEID", "t3"."POSTTYPENAME", "t3"."TOTALPOSTS", "t3"."TOTALSCORE", "t3"."TOTALVIEWCOUNT", "t3"."AVGVIEWCOUNT", "t3"."TOTALQUESTIONS", "t3"."TOTALANSWERS", "t3"."TOTALWIKIS", "t3"."UNIQUEUSERS", "t3"."TOTALREPUTATION", "t3"."TOTALCOMMENTS", "t3"."TOTALVOTES"
FROM (SELECT "s1"."PostTypeId" AS "POSTTYPEID", ANY_VALUE("s1"."Name") AS "POSTTYPENAME", COUNT(*) AS "TOTALPOSTS", SUM("s1"."Score") AS "TOTALSCORE", SUM("s1"."ViewCount") AS "TOTALVIEWCOUNT", AVG("s1"."ViewCount") AS "AVGVIEWCOUNT", CASE WHEN SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) IS NOT NULL THEN CAST(SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS INTEGER) ELSE 0 END AS "TOTALQUESTIONS", CASE WHEN SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) IS NOT NULL THEN CAST(SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS INTEGER) ELSE 0 END AS "TOTALANSWERS", CASE WHEN SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 3 THEN 1 ELSE NULL END) IS NOT NULL THEN CAST(SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 3 THEN 1 ELSE NULL END) AS INTEGER) ELSE 0 END AS "TOTALWIKIS", COUNT(DISTINCT "s1"."OwnerUserId") AS "UNIQUEUSERS", SUM("s1"."Reputation") AS "TOTALREPUTATION", COUNT(DISTINCT "s1"."Id2") AS "TOTALCOMMENTS", COUNT(DISTINCT "Votes"."Id") AS "TOTALVOTES"
FROM "s1"
LEFT JOIN "STACK"."Votes" ON "s1"."Id" = "Votes"."PostId"
GROUP BY "s1"."PostTypeId", "s1"."Name"
ORDER BY "s1"."PostTypeId") AS "t3"