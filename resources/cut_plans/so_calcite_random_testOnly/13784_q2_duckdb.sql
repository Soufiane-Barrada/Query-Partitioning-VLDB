SELECT COALESCE("t5"."POSTID", "t5"."POSTID") AS "POSTID", "t5"."POSTTITLE", "t5"."POSTCREATIONDATE", "t5"."COMMENTCOUNT", "t5"."VOTECOUNT", "t5"."UPVOTECOUNT", "t5"."DOWNVOTECOUNT", "t5"."BADGECOUNT", "t5"."USERREPUTATION", "t5"."USERDISPLAYNAME"
FROM (SELECT "s1"."Id", "s1"."Title", "s1"."CreationDate", "s1"."Id2", "s1"."Reputation", "s1"."DisplayName", ANY_VALUE("s1"."Id") AS "POSTID", ANY_VALUE("s1"."Title") AS "POSTTITLE", ANY_VALUE("s1"."CreationDate") AS "POSTCREATIONDATE", COUNT("s1"."Id0") AS "COMMENTCOUNT", COUNT("s1"."Id1") AS "VOTECOUNT", SUM(CASE WHEN CAST("s1"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTECOUNT", SUM(CASE WHEN CAST("s1"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTECOUNT", COUNT(DISTINCT "Badges"."Id") AS "BADGECOUNT", ANY_VALUE("s1"."Reputation") AS "USERREPUTATION", ANY_VALUE("s1"."DisplayName") AS "USERDISPLAYNAME"
FROM "s1"
LEFT JOIN "STACK"."Badges" ON "s1"."Id2" = "Badges"."UserId"
GROUP BY "s1"."Id", "s1"."Title", "s1"."CreationDate", "s1"."Id2", "s1"."Reputation", "s1"."DisplayName"
ORDER BY 11 DESC NULLS FIRST, 10 DESC NULLS FIRST) AS "t5"