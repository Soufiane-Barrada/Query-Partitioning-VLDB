SELECT COALESCE("t3"."ID", "t3"."ID") AS "ID", "t3"."DISPLAYNAME", "t3"."REPUTATION", CAST("t6"."OWNERUSERID" AS INTEGER) AS "OWNERUSERID", CAST("t6"."QUESTIONCOUNT" AS BIGINT) AS "QUESTIONCOUNT", CAST("t6"."ANSWERCOUNT" AS BIGINT) AS "ANSWERCOUNT", CAST("t6"."TOTALVIEWS" AS INTEGER) AS "TOTALVIEWS", CAST("t6"."TOTALSCORE" AS INTEGER) AS "TOTALSCORE"
FROM (SELECT "t2"."ID", "t2"."DISPLAYNAME", "t2"."REPUTATION"
FROM (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) + COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) > 10) AS "t1"
INNER JOIN (SELECT "Id" AS "ID", "DisplayName" AS "DISPLAYNAME", "Reputation" AS "REPUTATION", ROW_NUMBER() OVER (ORDER BY "Reputation" DESC NULLS FIRST) AS "RANKING"
FROM "STACK"."Users") AS "t2" ON "t1"."OWNERUSERID" = "t2"."ID") AS "t3"
INNER JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING SUM("ViewCount") > 1000) AS "t6" ON "t3"."ID" = "t6"."OWNERUSERID"