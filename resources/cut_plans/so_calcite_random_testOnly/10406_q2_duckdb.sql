SELECT COALESCE("t7"."POSTID", "t7"."POSTID") AS "POSTID", "t7"."TITLE", "t7"."CREATIONDATE", "t7"."VIEWCOUNT", "t7"."SCORE", "t7"."ANSWERCOUNT", "t7"."COMMENTCOUNT", "t7"."OWNERDISPLAYNAME", "t7"."OWNERREPUTATION", "t7"."POSTSCREATED", "t7"."QUESTIONSCREATED", "t7"."ANSWERSCREATED", "t7"."VOTESCOUNT", "t7"."UPVOTES", "t7"."DOWNVOTES"
FROM (SELECT "s1"."POSTID", "s1"."TITLE", "s1"."CREATIONDATE", "s1"."VIEWCOUNT", "s1"."SCORE", "s1"."ANSWERCOUNT", "s1"."COMMENTCOUNT", "s1"."OWNERDISPLAYNAME", "s1"."OWNERREPUTATION", "t3"."POSTSCREATED", "t3"."QUESTIONSCREATED", "t3"."ANSWERSCREATED", "t5"."VOTESCOUNT", "t5"."UPVOTES", "t5"."DOWNVOTES"
FROM "s1"
LEFT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", COUNT("Posts0"."Id") AS "POSTSCREATED", SUM(CASE WHEN CAST("Posts0"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONSCREATED", SUM(CASE WHEN CAST("Posts0"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERSCREATED"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Posts0"."OwnerUserId" = "Users0"."Id"
GROUP BY "Users0"."Id", "Users0"."DisplayName") AS "t3" ON "s1"."OWNERDISPLAYNAME" = "t3"."DISPLAYNAME"
LEFT JOIN (SELECT "Votes"."UserId" AS "USERID", COUNT(*) AS "VOTESCOUNT", SUM(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."VoteTypes"
INNER JOIN "STACK"."Votes" ON "VoteTypes"."Id" = "Votes"."VoteTypeId"
GROUP BY "Votes"."UserId") AS "t5" ON "t3"."USERID" = "t5"."USERID"
ORDER BY "s1"."CREATIONDATE" DESC NULLS FIRST) AS "t7"