SELECT COALESCE("t15"."USERNAME", "t15"."USERNAME") AS "USERNAME", "t15"."QUESTIONCOUNT", "t15"."ANSWERCOUNT", "t15"."TOTALVIEWS", "t15"."TOTALSCORE", "t15"."RECENTPOSTTITLE", "t15"."POSTSTATUS", "t15"."CLOSEREASON", "t15"."CLOSEDATE", "t15"."CLOSEDBY"
FROM (SELECT "t13"."DISPLAYNAME" AS "USERNAME", "t13"."QUESTIONCOUNT", "t13"."ANSWERCOUNT", "t13"."TOTALVIEWS", "t13"."TOTALSCORE", "t13"."TITLE" AS "RECENTPOSTTITLE", "t13"."POSTSTATUS", "t10"."CLOSEREASON", "t10"."CLOSEDATE", "t10"."CLOSEDBY"
FROM (SELECT "t9"."PostId" AS "POSTID", "t9"."Comment" AS "CLOSEREASON", "t9"."CreationDate" AS "CLOSEDATE", "Users0"."DisplayName" AS "CLOSEDBY"
FROM (SELECT *
FROM "STACK"."PostHistory"
WHERE CAST("PostHistoryTypeId" AS INTEGER) = 10) AS "t9"
INNER JOIN "STACK"."Users" AS "Users0" ON "t9"."UserId" = "Users0"."Id") AS "t10"
RIGHT JOIN (SELECT "s1"."ID", "s1"."DISPLAYNAME", "s1"."REPUTATION", "s1"."OWNERUSERID", "s1"."QUESTIONCOUNT", "s1"."ANSWERCOUNT", "s1"."TOTALVIEWS", "s1"."TOTALSCORE", "t12"."ID" AS "ID0", "t12"."TITLE", "t12"."CREATIONDATE", "t12"."POSTSTATUS"
FROM (SELECT "Id" AS "ID", "Title" AS "TITLE", "CreationDate" AS "CREATIONDATE", 'Closed' AS "POSTSTATUS"
FROM "STACK"."Posts"
WHERE "CreationDate" > (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '30' DAY)) AS "t12"
RIGHT JOIN "s1" ON "t12"."ID" = "s1"."OWNERUSERID") AS "t13" ON "t10"."POSTID" = "t13"."ID0"
ORDER BY "t13"."TOTALSCORE" DESC NULLS FIRST, "t13"."TOTALVIEWS" DESC NULLS FIRST) AS "t15"