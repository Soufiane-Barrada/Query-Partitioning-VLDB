SELECT COALESCE("t9"."POSTID", "t9"."POSTID") AS "POSTID", "t9"."POSTTYPEID", "t9"."TOTALCOMMENTS", "t9"."TOTALVOTES", "t9"."UPVOTES", "t9"."DOWNVOTES", "t9"."DELETIONVOTES", "t9"."USERID", "t9"."TOTALPOSTVIEWS", "t9"."POSTSCREATED"
FROM (SELECT "t7"."POSTID", "t7"."POSTTYPEID", "t7"."TOTALCOMMENTS", "t7"."TOTALVOTES", "t7"."UPVOTES", "t7"."DOWNVOTES", "t7"."DELETIONVOTES", "t5"."USERID", "t5"."TOTALPOSTVIEWS", "t5"."POSTSCREATED"
FROM (SELECT ANY_VALUE("t3"."Id") AS "USERID", SUM("Posts0"."ViewCount") AS "TOTALPOSTVIEWS", COUNT(DISTINCT "Posts0"."Id") AS "POSTSCREATED"
FROM (SELECT *
FROM "STACK"."Users"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS "t3"
INNER JOIN "STACK"."Posts" AS "Posts0" ON "t3"."Id" = "Posts0"."OwnerUserId"
GROUP BY "t3"."Id") AS "t5"
INNER JOIN (SELECT ANY_VALUE("Id") AS "POSTID", "POSTTYPEID", COUNT("Id0") AS "TOTALCOMMENTS", COUNT("Id1") AS "TOTALVOTES", SUM("FD_COL_4") AS "UPVOTES", SUM("FD_COL_5") AS "DOWNVOTES", SUM("FD_COL_6") AS "DELETIONVOTES"
FROM "s1"
GROUP BY "Id", "POSTTYPEID") AS "t7" ON "t5"."USERID" = "t7"."POSTID"
ORDER BY "t7"."TOTALVOTES" DESC NULLS FIRST, "t7"."TOTALCOMMENTS" DESC NULLS FIRST) AS "t9"