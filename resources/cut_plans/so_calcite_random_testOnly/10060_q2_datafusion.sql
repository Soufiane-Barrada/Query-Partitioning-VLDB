SELECT COALESCE("t10"."POSTID", "t10"."POSTID") AS "POSTID", "t10"."TITLE", "t10"."CREATIONDATE", "t10"."SCORE", "t10"."VIEWCOUNT", "t10"."ANSWERCOUNT", "t10"."COMMENTCOUNT", "t10"."OWNERDISPLAYNAME", "t10"."LASTACTIVITYDATE", "t10"."POSTTYPE", "t10"."UPVOTES", "t10"."DOWNVOTES", "t10"."BADGECOUNT"
FROM (SELECT "t8"."POSTID", "t8"."TITLE", "t8"."CREATIONDATE", "t8"."SCORE", "t8"."VIEWCOUNT", "t8"."ANSWERCOUNT", "t8"."COMMENTCOUNT", "t8"."OWNERDISPLAYNAME", "t8"."LASTACTIVITYDATE", "t8"."POSTTYPE", "t8"."UPVOTES", "t8"."DOWNVOTES", "s1"."BADGECOUNT"
FROM (SELECT "t7"."POSTID", "t7"."TITLE", "t7"."CREATIONDATE", "t7"."SCORE", "t7"."VIEWCOUNT", "t7"."ANSWERCOUNT", "t7"."COMMENTCOUNT", "t7"."OWNERDISPLAYNAME", "t7"."LASTACTIVITYDATE", "t7"."POSTTYPE", "t6"."POSTID" AS "POSTID0", "t6"."UPVOTES", "t6"."DOWNVOTES"
FROM (SELECT "PostId" AS "POSTID", COUNT(CASE WHEN CAST("VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "UPVOTES", COUNT(CASE WHEN CAST("VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE NULL END) AS "DOWNVOTES"
FROM "STACK"."Votes"
GROUP BY "PostId") AS "t6"
RIGHT JOIN (SELECT "Posts"."Id" AS "POSTID", "Posts"."Title" AS "TITLE", "Posts"."CreationDate" AS "CREATIONDATE", "Posts"."Score" AS "SCORE", "Posts"."ViewCount" AS "VIEWCOUNT", "Posts"."AnswerCount" AS "ANSWERCOUNT", "Posts"."CommentCount" AS "COMMENTCOUNT", "Users0"."DisplayName" AS "OWNERDISPLAYNAME", "Posts"."LastActivityDate" AS "LASTACTIVITYDATE", "PostTypes"."Name" AS "POSTTYPE"
FROM "STACK"."PostTypes"
INNER JOIN ("STACK"."Users" AS "Users0" INNER JOIN "STACK"."Posts" ON "Users0"."Id" = "Posts"."OwnerUserId") ON "PostTypes"."Id" = "Posts"."PostTypeId") AS "t7" ON "t6"."POSTID" = "t7"."POSTID") AS "t8"
LEFT JOIN "s1" ON "t8"."OWNERDISPLAYNAME" = "s1"."FD_COL_2"
ORDER BY "t8"."LASTACTIVITYDATE" DESC NULLS FIRST
FETCH NEXT 100 ROWS ONLY) AS "t10"