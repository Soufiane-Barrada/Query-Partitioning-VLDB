SELECT COALESCE("t10"."USERDISPLAYNAME", "t10"."USERDISPLAYNAME") AS "USERDISPLAYNAME", "t10"."REPUTATION", "t10"."USERCREATIONDATE", "t10"."UPVOTES", "t10"."DOWNVOTES", "t10"."POSTID", "t10"."TITLE", "t10"."POSTCREATIONDATE", "t10"."COMMENTCOUNT", "t10"."VOTECOUNT", "t10"."UPVOTECOUNT", "t10"."DOWNVOTECOUNT"
FROM (SELECT "Users0"."DisplayName" AS "USERDISPLAYNAME", "Users0"."Reputation" AS "REPUTATION", "Users0"."CreationDate" AS "USERCREATIONDATE", "t8"."UPVOTES", "t8"."DOWNVOTES", "t4"."POSTID", "t4"."TITLE", "t4"."CREATIONDATE" AS "POSTCREATIONDATE", "t4"."COMMENTCOUNT", "t4"."VOTECOUNT", "t4"."UPVOTECOUNT", "t4"."DOWNVOTECOUNT"
FROM (SELECT ANY_VALUE("t1"."Id") AS "POSTID", "t1"."Title" AS "TITLE", "t1"."CreationDate" AS "CREATIONDATE", COUNT(DISTINCT "t1"."Id0") AS "COMMENTCOUNT", COUNT(DISTINCT "Votes"."Id") AS "VOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTECOUNT"
FROM "STACK"."Votes"
RIGHT JOIN (SELECT "Posts"."Id", "Posts"."PostTypeId", "Posts"."AcceptedAnswerId", "Posts"."ParentId", "Posts"."CreationDate", "Posts"."Score", "Posts"."ViewCount", "Posts"."Body", "Posts"."OwnerUserId", "Posts"."OwnerDisplayName", "Posts"."LastEditorUserId", "Posts"."LastEditorDisplayName", "Posts"."LastEditDate", "Posts"."LastActivityDate", "Posts"."Title", "Posts"."Tags", "Posts"."AnswerCount", "Posts"."CommentCount", "Posts"."FavoriteCount", "Posts"."ClosedDate", "Posts"."CommunityOwnedDate", "Posts"."ContentLicense", "Comments"."Id" AS "Id0", "Comments"."PostId", "Comments"."Score" AS "Score0", "Comments"."Text", "Comments"."CreationDate" AS "CreationDate0", "Comments"."UserDisplayName", "Comments"."UserId", "Comments"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments"
RIGHT JOIN "STACK"."Posts" ON "Comments"."PostId" = "Posts"."Id") AS "t1" ON "Votes"."PostId" = "t1"."Id"
GROUP BY "t1"."Id", "t1"."Title", "t1"."CreationDate") AS "t4"
INNER JOIN ("STACK"."Users" AS "Users0" INNER JOIN (SELECT ANY_VALUE("t5"."Id") AS "USERID", SUM(CASE WHEN CAST("t5"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("t5"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES", COUNT(DISTINCT "Posts0"."Id") AS "POSTCOUNT"
FROM (SELECT "s1"."Id", "s1"."Reputation", "s1"."CreationDate", "s1"."DisplayName", "s1"."LastAccessDate", "s1"."WebsiteUrl", "s1"."Location", "s1"."AboutMe", "s1"."Views", "s1"."UpVotes", "s1"."DownVotes", "s1"."ProfileImageUrl", "s1"."AccountId", "Votes0"."Id" AS "Id0", "Votes0"."PostId", "Votes0"."VoteTypeId", "Votes0"."UserId", "Votes0"."CreationDate" AS "CreationDate0", "Votes0"."BountyAmount"
FROM "STACK"."Votes" AS "Votes0"
RIGHT JOIN "s1" ON "Votes0"."UserId" = "s1"."Id") AS "t5"
LEFT JOIN "STACK"."Posts" AS "Posts0" ON "t5"."PostId" = "Posts0"."Id"
GROUP BY "t5"."Id") AS "t8" ON "Users0"."Id" = "t8"."USERID") ON "t4"."POSTID" = "Users0"."Id"
ORDER BY "Users0"."Reputation" DESC NULLS FIRST, "t4"."VOTECOUNT" DESC NULLS FIRST) AS "t10"