SELECT COALESCE("t11"."POSTID", "t11"."POSTID") AS "POSTID", "t11"."TITLE", "t11"."CREATIONDATE", "t11"."COMMENTCOUNT", "t11"."TOTALBOUNTY", "t11"."TAGS", "t11"."DISPLAYNAME", "t11"."BADGECOUNT", "t11"."TOTALREPUTATION", "t11"."HISTORYCOUNT", "t11"."LASTHISTORYDATE"
FROM (SELECT "s1"."POSTID", "s1"."TITLE", "s1"."CREATIONDATE_" AS "CREATIONDATE", "s1"."COMMENTCOUNT", "s1"."TOTALBOUNTY", "s1"."TAGS", "s1"."DISPLAYNAME_" AS "DISPLAYNAME", "s1"."BADGECOUNT", "s1"."TOTALREPUTATION", "t9"."HISTORYCOUNT", "t9"."LASTHISTORYDATE"
FROM (SELECT ANY_VALUE("Posts0"."Id") AS "POSTID", COUNT("PostHistory"."Id") AS "HISTORYCOUNT", MAX("PostHistory"."CreationDate") AS "LASTHISTORYDATE"
FROM "STACK"."PostHistory"
RIGHT JOIN "STACK"."Posts" AS "Posts0" ON "PostHistory"."PostId" = "Posts0"."Id"
GROUP BY "Posts0"."Id") AS "t9"
INNER JOIN "s1" ON "t9"."POSTID" = "s1"."POSTID"
ORDER BY "s1"."COMMENTCOUNT" DESC NULLS FIRST, "s1"."TOTALREPUTATION" DESC NULLS FIRST) AS "t11"