SELECT COALESCE("t9"."USERID", "t9"."USERID") AS "USERID", "t9"."DISPLAYNAME", "t9"."REPUTATION", "t9"."POSTCOUNT", "t9"."QUESTIONCOUNT", "t9"."ANSWERCOUNT", "t9"."COMMENTCOUNT", "t9"."POSTID", "t9"."POSTTITLE", "t9"."POSTCREATIONDATE", "t9"."POSTSCORE", "t9"."POSTVIEWCOUNT", "t9"."POSTTYPE", "t9"."HISTORYCOUNT"
FROM (SELECT "t5"."USERID", "t5"."DISPLAYNAME", "t5"."REPUTATION", "t5"."POSTCOUNT", "t5"."QUESTIONCOUNT", "t5"."ANSWERCOUNT", "t5"."COMMENTCOUNT", "t1"."POSTID", ANY_VALUE("t1"."TITLE") AS "POSTTITLE", ANY_VALUE("t1"."CREATIONDATE") AS "POSTCREATIONDATE", ANY_VALUE("t1"."SCORE") AS "POSTSCORE", ANY_VALUE("t1"."VIEWCOUNT") AS "POSTVIEWCOUNT", "t1"."POSTTYPE", COUNT("t1"."HISTORYDATE") AS "HISTORYCOUNT"
FROM (SELECT "Posts"."Id" AS "POSTID", "Posts"."Title" AS "TITLE", "Posts"."CreationDate" AS "CREATIONDATE", "Posts"."Score" AS "SCORE", "Posts"."ViewCount" AS "VIEWCOUNT", "PostTypes"."Name" AS "POSTTYPE", "PostHistory"."CreationDate" AS "HISTORYDATE", "Posts"."OwnerUserId" AS "OWNERUSERID"
FROM "STACK"."PostHistory"
RIGHT JOIN ("STACK"."Posts" INNER JOIN "STACK"."PostTypes" ON "Posts"."PostTypeId" = "PostTypes"."Id") ON "PostHistory"."PostId" = "Posts"."Id") AS "t1"
RIGHT JOIN (SELECT ANY_VALUE("t2"."Id") AS "USERID", "t2"."DisplayName" AS "DISPLAYNAME", "t2"."Reputation" AS "REPUTATION", COUNT(DISTINCT "t2"."Id0") AS "POSTCOUNT", SUM(CASE WHEN CAST("t2"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONCOUNT", SUM(CASE WHEN CAST("t2"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERCOUNT", SUM(CASE WHEN "Comments"."Id" IS NOT NULL THEN 1 ELSE 0 END) AS "COMMENTCOUNT"
FROM "STACK"."Comments"
RIGHT JOIN (SELECT "s1"."Id", "s1"."Reputation", "s1"."CreationDate", "s1"."DisplayName", "s1"."LastAccessDate", "s1"."WebsiteUrl", "s1"."Location", "s1"."AboutMe", "s1"."Views", "s1"."UpVotes", "s1"."DownVotes", "s1"."ProfileImageUrl", "s1"."AccountId", "Posts0"."Id" AS "Id0", "Posts0"."PostTypeId", "Posts0"."AcceptedAnswerId", "Posts0"."ParentId", "Posts0"."CreationDate" AS "CreationDate0", "Posts0"."Score", "Posts0"."ViewCount", "Posts0"."Body", "Posts0"."OwnerUserId", "Posts0"."OwnerDisplayName", "Posts0"."LastEditorUserId", "Posts0"."LastEditorDisplayName", "Posts0"."LastEditDate", "Posts0"."LastActivityDate", "Posts0"."Title", "Posts0"."Tags", "Posts0"."AnswerCount", "Posts0"."CommentCount", "Posts0"."FavoriteCount", "Posts0"."ClosedDate", "Posts0"."CommunityOwnedDate", "Posts0"."ContentLicense"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "s1" ON "Posts0"."OwnerUserId" = "s1"."Id") AS "t2" ON "Comments"."PostId" = "t2"."Id0"
GROUP BY "t2"."Id", "t2"."DisplayName", "t2"."Reputation") AS "t5" ON "t1"."OWNERUSERID" = "t5"."USERID"
GROUP BY "t1"."POSTID", "t1"."TITLE", "t1"."CREATIONDATE", "t1"."SCORE", "t1"."VIEWCOUNT", "t1"."POSTTYPE", "t5"."USERID", "t5"."DISPLAYNAME", "t5"."REPUTATION", "t5"."POSTCOUNT", "t5"."QUESTIONCOUNT", "t5"."ANSWERCOUNT", "t5"."COMMENTCOUNT"
ORDER BY "t5"."REPUTATION" DESC NULLS FIRST, "t5"."POSTCOUNT" DESC NULLS FIRST) AS "t9"