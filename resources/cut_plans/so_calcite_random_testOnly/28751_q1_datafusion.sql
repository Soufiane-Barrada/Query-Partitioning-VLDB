SELECT COALESCE("t6"."POSTID", "t6"."POSTID") AS "POSTID", "t6"."TITLE", "t6"."VIEWCOUNT", "t6"."DISPLAYNAME", "t6"."REPUTATIONLEVEL", "t6"."ANSWERCOUNT", SUM(CASE WHEN CAST("t0"."VOTETYPEID" AS INTEGER) = 2 THEN "t0"."VOTECOUNT" ELSE 0 END) AS "FD_COL_6", SUM(CASE WHEN CAST("t0"."VOTETYPEID" AS INTEGER) = 3 THEN "t0"."VOTECOUNT" ELSE 0 END) AS "FD_COL_7", SUM(CASE WHEN CAST("t0"."VOTETYPEID" AS INTEGER) = 6 THEN "t0"."VOTECOUNT" ELSE 0 END) AS "FD_COL_8"
FROM (SELECT ANY_VALUE("Posts"."Id") AS "POSTID", "Votes"."VoteTypeId" AS "VOTETYPEID", COUNT(*) AS "VOTECOUNT"
FROM "STACK"."Posts"
INNER JOIN "STACK"."Votes" ON "Posts"."Id" = "Votes"."PostId"
GROUP BY "Posts"."Id", "Votes"."VoteTypeId") AS "t0"
RIGHT JOIN (SELECT "t3"."POSTID", "t3"."TITLE", "t3"."VIEWCOUNT", "t1"."DISPLAYNAME", "t1"."REPUTATIONLEVEL", COUNT("Posts0"."Id") AS "ANSWERCOUNT"
FROM (SELECT "Id" AS "USERID", "DisplayName" AS "DISPLAYNAME", "Reputation" AS "REPUTATION", CASE WHEN "Reputation" > 1000 THEN 'High  ' WHEN "Reputation" >= 500 AND "Reputation" <= 1000 THEN 'Medium' ELSE 'Low   ' END AS "REPUTATIONLEVEL"
FROM "STACK"."Users") AS "t1"
INNER JOIN ("STACK"."Posts" AS "Posts0" RIGHT JOIN (SELECT "Id" AS "POSTID", "Title" AS "TITLE", "Body" AS "BODY", "ViewCount" AS "VIEWCOUNT", "CreationDate" AS "CREATIONDATE", "OwnerUserId" AS "OWNERUSERID", "AcceptedAnswerId" AS "ACCEPTEDANSWERID", ROW_NUMBER() OVER (PARTITION BY "OwnerUserId" ORDER BY "CreationDate" DESC NULLS FIRST) AS "USERPOSTRANK"
FROM "STACK"."Posts"
WHERE CAST("PostTypeId" AS INTEGER) = 1) AS "t3" ON "Posts0"."ParentId" = "t3"."POSTID") ON "t1"."USERID" = "t3"."OWNERUSERID"
GROUP BY "t1"."DISPLAYNAME", "t1"."REPUTATIONLEVEL", "t3"."POSTID", "t3"."TITLE", "t3"."VIEWCOUNT"
ORDER BY "t3"."VIEWCOUNT" DESC NULLS FIRST
FETCH NEXT 10 ROWS ONLY) AS "t6" ON "t0"."POSTID" = "t6"."POSTID"
GROUP BY "t6"."POSTID", "t6"."TITLE", "t6"."VIEWCOUNT", "t6"."DISPLAYNAME", "t6"."REPUTATIONLEVEL", "t6"."ANSWERCOUNT"