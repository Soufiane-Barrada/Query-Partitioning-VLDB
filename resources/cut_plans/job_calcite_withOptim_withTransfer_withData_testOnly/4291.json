{
  "queryId" : "4291",
  "originalSql" : "WITH RankedMovies AS (\n    SELECT \n        t.id AS movie_id,\n        t.title,\n        t.production_year,\n        ROW_NUMBER() OVER (PARTITION BY t.production_year ORDER BY t.id) AS Ran\n    FROM \n        aka_title t\n    WHERE \n        t.production_year IS NOT NULL\n),\nMovieDetails AS (\n    SELECT \n        m.movie_id,\n        m.title,\n        COALESCE(c.count, 0) AS cast_count,\n        COALESCE(k.keywords, '') AS movie_keywords,\n        m.production_year\n    FROM \n        RankedMovies m\n    LEFT JOIN (\n        SELECT \n            movie_id,\n            COUNT(*) AS count\n        FROM \n            cast_info\n        GROUP BY \n            movie_id\n    ) c ON m.movie_id = c.movie_id\n    LEFT JOIN (\n        SELECT \n            mk.movie_id,\n            STRING_AGG(k.keyword, ', ') AS keywords\n        FROM \n            movie_keyword mk\n        JOIN \n            keyword k ON mk.keyword_id = k.id\n        GROUP BY \n            mk.movie_id\n    ) k ON m.movie_id = k.movie_id\n)\nSELECT \n    md.movie_id,\n    md.title,\n    md.production_year,\n    md.cast_count,\n    md.movie_keywords,\n    (SELECT AVG(cast_count) \n     FROM MovieDetails \n     WHERE production_year = md.production_year) AS avg_cast_count,\n    (SELECT COUNT(DISTINCT p.id) \n     FROM person_info p \n     JOIN cast_info ci ON ci.person_id = p.person_id \n     WHERE ci.movie_id = md.movie_id) AS unique_actors\nFROM \n    MovieDetails md\nWHERE \n    md.cast_count > (SELECT AVG(cast_count) \n                     FROM MovieDetails)\nORDER BY \n    md.production_year DESC, \n    md.cast_count DESC\nLIMIT 100",
  "dpSummary" : {
    "hasCut" : true,
    "cutNodeId" : 61968,
    "q1Engine" : "duckdb",
    "q2Engine" : "datafusion",
    "costAllDuckdb" : 2.9048627700424284E7,
    "costAllDatafusion" : 4741578.591467028,
    "chosenCost" : 1289816.5796516081
  },
  "analysis" : {
    "pipeline" : {
      "runId" : "job_optim_withTransfer",
      "doOptimize" : true,
      "metadataProvider" : "custom",
      "dpMode" : "MAX",
      "transferExtraConstantMs" : 0.0,
      "transferCoeffs" : {
        "duckdb" : {
          "aMs" : 62.297202312292534,
          "bMsPerRow" : 1.9855075008663652E-4,
          "cMsPerRowSizeByte" : 0.0,
          "dMsPerOutputByte" : 9.37543642726493E-7
        },
        "datafusion" : {
          "aMs" : 72.934497671158,
          "bMsPerRow" : 8.296144368777564E-5,
          "cMsPerRowSizeByte" : 0.0010951149669102135,
          "dMsPerOutputByte" : 3.7986948397307897E-7
        }
      },
      "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
      "cutPolicy" : "DP",
      "randomSeed" : 1770194764338,
      "schemaName" : "IMDB"
    },
    "planStats" : {
      "totalNodes" : 176,
      "maxDepth" : 21,
      "operatorKindCounts" : {
        "OTHER" : 67,
        "AGGREGATE" : 30,
        "JOIN" : 41,
        "SORT" : 1
      },
      "rootOutputRows" : 100.0,
      "rootRowSizeOutBytes" : 270.3786296033994
    },
    "cut" : {
      "cutDepth" : 6,
      "cutNodeOperatorKind" : "AGGREGATE",
      "cutOutputRows" : 306595.9684718538,
      "cutRowSizeOutBytes" : 8.0,
      "cutOutputBytes" : 2452767.7477748306,
      "transferEstimatedMs" : 99.31063438282304,
      "q1Stats" : {
        "engine" : "duckdb",
        "nodeCount" : 67,
        "maxDepth" : 16,
        "operatorKindCounts" : {
          "AGGREGATE" : 15,
          "OTHER" : 33,
          "JOIN" : 19
        }
      },
      "q2Stats" : {
        "engine" : "datafusion",
        "nodeCount" : 72,
        "maxDepth" : 19,
        "operatorKindCounts" : {
          "OTHER" : 34,
          "AGGREGATE" : 15,
          "JOIN" : 22,
          "SORT" : 1
        }
      }
    }
  },
  "dag" : {
    "finalNodeId" : "q2",
    "nodes" : [ {
      "id" : "q1",
      "engine" : "duckdb",
      "sql" : "SELECT COALESCE(\"t14\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"MOVIE_ID\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\"\nGROUP BY \"t14\".\"MOVIE_ID\"",
      "inputs" : { },
      "schema" : [ {
        "name" : "MOVIE_ID",
        "type" : "INTEGER"
      } ]
    }, {
      "id" : "q2",
      "engine" : "datafusion",
      "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t86\".\"MOVIE_ID\", \"t86\".\"TITLE\", \"t86\".\"PRODUCTION_YEAR\", \"t86\".\"CAST_COUNT\", \"t86\".\"MOVIE_KEYWORDS\", \"t86\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\", \"t85\".\"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t76\".\"PRODUCTION_YEAR\", \"t84\".\"EXPR$0\"\nFROM (SELECT \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\"\nGROUP BY \"t74\".\"PRODUCTION_YEAR\") AS \"t76\"\nLEFT JOIN (SELECT \"t80\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t80\".\"COUNT\" IS NOT NULL THEN CAST(\"t80\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"MOVIE_ID\", \"t79\".\"TITLE\", \"t79\".\"PRODUCTION_YEAR\", \"t79\".\"RAN\", \"t78\".\"movie_id\" AS \"MOVIE_ID0\", \"t78\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t78\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t79\" ON \"t78\".\"movie_id\" = \"t79\".\"MOVIE_ID\") AS \"t80\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t82\" ON \"t80\".\"MOVIE_ID\" = \"t82\".\"MOVIE_ID\"\nGROUP BY \"t80\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t76\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t84\".\"PRODUCTION_YEAR\") AS \"t85\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t85\".\"PRODUCTION_YEAR\") AS \"t86\"\nLEFT JOIN (SELECT \"s1\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"s1\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t86\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t86\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t86\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
      "inputs" : {
        "s1" : "q1"
      },
      "schema" : [ {
        "name" : "MOVIE_ID",
        "type" : "INTEGER"
      }, {
        "name" : "TITLE",
        "type" : "VARCHAR"
      }, {
        "name" : "PRODUCTION_YEAR",
        "type" : "INTEGER"
      }, {
        "name" : "CAST_COUNT",
        "type" : "BIGINT"
      }, {
        "name" : "MOVIE_KEYWORDS",
        "type" : "VARCHAR"
      }, {
        "name" : "AVG_CAST_COUNT",
        "type" : "BIGINT"
      }, {
        "name" : "UNIQUE_ACTORS",
        "type" : "BIGINT"
      } ]
    } ]
  },
  "cutPlans" : [ {
    "planId" : "cut_61988",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61988,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 0,
        "cutNodeOperatorKind" : "SORT",
        "cutOutputRows" : 100.0,
        "cutRowSizeOutBytes" : 270.3786296033994,
        "cutOutputBytes" : 27037.862960339942,
        "transferEstimatedMs" : 73.24916035858861,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 139,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 67,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 0,
          "maxDepth" : 1,
          "operatorKindCounts" : { }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t91\".\"MOVIE_ID\", \"t91\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t91\".\"TITLE\", \"t91\".\"PRODUCTION_YEAR\", \"t91\".\"CAST_COUNT\", \"t91\".\"MOVIE_KEYWORDS\", \"t91\".\"AVG_CAST_COUNT\", \"t91\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t41\".\"MOVIE_ID\", \"t41\".\"TITLE\", \"t41\".\"PRODUCTION_YEAR\", \"t41\".\"CAST_COUNT\", \"t41\".\"MOVIE_KEYWORDS\", \"t41\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t88\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t88\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\") AS \"t41\"\nLEFT JOIN (SELECT \"t85\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t87\".\"EXPR$0\" IS NOT NULL THEN \"t87\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t57\".\"MOVIE_ID\"\nFROM (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", \"t56\".\"CAST_COUNT\", \"t56\".\"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t45\".\"COUNT\" IS NOT NULL THEN CAST(\"t45\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"RAN\", \"t43\".\"movie_id\" AS \"MOVIE_ID0\", \"t43\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t43\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t44\" ON \"t43\".\"movie_id\" = \"t44\".\"MOVIE_ID\") AS \"t45\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t47\" ON \"t45\".\"MOVIE_ID\" = \"t47\".\"MOVIE_ID\") AS \"t49\"\nINNER JOIN (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t55\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t55\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t53\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t56\" ON \"t49\".\"EXPR$0\" < \"t56\".\"CAST_COUNT\") AS \"t57\"\nLEFT JOIN (SELECT \"t74\".\"PRODUCTION_YEAR\", \"t82\".\"EXPR$0\"\nFROM (SELECT \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t61\".\"COUNT\" IS NOT NULL THEN CAST(\"t61\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\", \"t60\".\"TITLE\", \"t60\".\"PRODUCTION_YEAR\", \"t60\".\"RAN\", \"t59\".\"movie_id\" AS \"MOVIE_ID0\", \"t59\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t59\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t60\" ON \"t59\".\"movie_id\" = \"t60\".\"MOVIE_ID\") AS \"t61\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t63\" ON \"t61\".\"MOVIE_ID\" = \"t63\".\"MOVIE_ID\") AS \"t65\"\nINNER JOIN (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", CASE WHEN \"t69\".\"COUNT\" IS NOT NULL THEN CAST(\"t69\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t71\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t71\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t69\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t68\".\"MOVIE_ID\", \"t68\".\"TITLE\", \"t68\".\"PRODUCTION_YEAR\", \"t68\".\"RAN\", \"t67\".\"movie_id\" AS \"MOVIE_ID0\", \"t67\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t67\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t68\" ON \"t67\".\"movie_id\" = \"t68\".\"MOVIE_ID\") AS \"t69\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t71\" ON \"t69\".\"MOVIE_ID\" = \"t71\".\"MOVIE_ID\") AS \"t72\" ON \"t65\".\"EXPR$0\" < \"t72\".\"CAST_COUNT\"\nGROUP BY \"t72\".\"PRODUCTION_YEAR\") AS \"t74\"\nLEFT JOIN (SELECT \"t78\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t78\".\"COUNT\" IS NOT NULL THEN CAST(\"t78\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"MOVIE_ID\", \"t77\".\"TITLE\", \"t77\".\"PRODUCTION_YEAR\", \"t77\".\"RAN\", \"t76\".\"movie_id\" AS \"MOVIE_ID0\", \"t76\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t76\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t77\" ON \"t76\".\"movie_id\" = \"t77\".\"MOVIE_ID\") AS \"t78\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t80\" ON \"t78\".\"MOVIE_ID\" = \"t80\".\"MOVIE_ID\"\nGROUP BY \"t78\".\"PRODUCTION_YEAR\") AS \"t82\" ON \"t74\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t82\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t57\".\"PRODUCTION_YEAR\" = \"t83\".\"PRODUCTION_YEAR\"\nGROUP BY \"t57\".\"MOVIE_ID\") AS \"t85\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t87\" ON \"t85\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t87\".\"movie_id\") AS \"t88\" ON \"t41\".\"MOVIE_ID\" = \"t88\".\"movie_id\"\nORDER BY \"t41\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t41\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t91\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"MOVIE_ID\", \"MOVIE_ID\") AS \"MOVIE_ID\", \"TITLE\", \"PRODUCTION_YEAR\", \"CAST_COUNT\", \"MOVIE_KEYWORDS\", \"AVG_CAST_COUNT\", \"UNIQUE_ACTORS\"\nFROM \"s1\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61984",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61984,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 2,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4.348574573533603E14,
        "cutRowSizeOutBytes" : 270.3786296033994,
        "cutOutputBytes" : 1.1757616339202027E17,
        "transferEstimatedMs" : 8.073999904892184E10,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 137,
          "maxDepth" : 20,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "AGGREGATE" : 30,
            "JOIN" : 41
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 2,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "SORT" : 1,
            "OTHER" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t41\".\"MOVIE_ID\", \"t41\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t41\".\"TITLE\", \"t41\".\"CAST_COUNT\", \"t41\".\"MOVIE_KEYWORDS\", \"t41\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\" AS \"FD_COL_5\", CASE WHEN \"t88\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t88\".\"EXPR$0\" END AS \"FD_COL_6\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\") AS \"t41\"\nLEFT JOIN (SELECT \"t85\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t87\".\"EXPR$0\" IS NOT NULL THEN \"t87\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t57\".\"MOVIE_ID\"\nFROM (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", \"t56\".\"CAST_COUNT\", \"t56\".\"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t45\".\"COUNT\" IS NOT NULL THEN CAST(\"t45\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"RAN\", \"t43\".\"movie_id\" AS \"MOVIE_ID0\", \"t43\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t43\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t44\" ON \"t43\".\"movie_id\" = \"t44\".\"MOVIE_ID\") AS \"t45\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t47\" ON \"t45\".\"MOVIE_ID\" = \"t47\".\"MOVIE_ID\") AS \"t49\"\nINNER JOIN (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t55\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t55\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t53\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t56\" ON \"t49\".\"EXPR$0\" < \"t56\".\"CAST_COUNT\") AS \"t57\"\nLEFT JOIN (SELECT \"t74\".\"PRODUCTION_YEAR\", \"t82\".\"EXPR$0\"\nFROM (SELECT \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t61\".\"COUNT\" IS NOT NULL THEN CAST(\"t61\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\", \"t60\".\"TITLE\", \"t60\".\"PRODUCTION_YEAR\", \"t60\".\"RAN\", \"t59\".\"movie_id\" AS \"MOVIE_ID0\", \"t59\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t59\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t60\" ON \"t59\".\"movie_id\" = \"t60\".\"MOVIE_ID\") AS \"t61\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t63\" ON \"t61\".\"MOVIE_ID\" = \"t63\".\"MOVIE_ID\") AS \"t65\"\nINNER JOIN (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", CASE WHEN \"t69\".\"COUNT\" IS NOT NULL THEN CAST(\"t69\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t71\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t71\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t69\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t68\".\"MOVIE_ID\", \"t68\".\"TITLE\", \"t68\".\"PRODUCTION_YEAR\", \"t68\".\"RAN\", \"t67\".\"movie_id\" AS \"MOVIE_ID0\", \"t67\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t67\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t68\" ON \"t67\".\"movie_id\" = \"t68\".\"MOVIE_ID\") AS \"t69\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t71\" ON \"t69\".\"MOVIE_ID\" = \"t71\".\"MOVIE_ID\") AS \"t72\" ON \"t65\".\"EXPR$0\" < \"t72\".\"CAST_COUNT\"\nGROUP BY \"t72\".\"PRODUCTION_YEAR\") AS \"t74\"\nLEFT JOIN (SELECT \"t78\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t78\".\"COUNT\" IS NOT NULL THEN CAST(\"t78\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"MOVIE_ID\", \"t77\".\"TITLE\", \"t77\".\"PRODUCTION_YEAR\", \"t77\".\"RAN\", \"t76\".\"movie_id\" AS \"MOVIE_ID0\", \"t76\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t76\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t77\" ON \"t76\".\"movie_id\" = \"t77\".\"MOVIE_ID\") AS \"t78\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t80\" ON \"t78\".\"MOVIE_ID\" = \"t80\".\"MOVIE_ID\"\nGROUP BY \"t78\".\"PRODUCTION_YEAR\") AS \"t82\" ON \"t74\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t82\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t57\".\"PRODUCTION_YEAR\" = \"t83\".\"PRODUCTION_YEAR\"\nGROUP BY \"t57\".\"MOVIE_ID\") AS \"t85\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t87\" ON \"t85\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t87\".\"movie_id\") AS \"t88\" ON \"t41\".\"MOVIE_ID\" = \"t88\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_5",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"MOVIE_ID\", \"MOVIE_ID\") AS \"MOVIE_ID\", \"TITLE\", \"PRODUCTION_YEAR\", \"CAST_COUNT\", \"MOVIE_KEYWORDS\", \"AVG_CAST_COUNT\", \"UNIQUE_ACTORS\"\nFROM (SELECT \"MOVIE_ID\", \"TITLE\", \"PRODUCTION_YEAR\", \"CAST_COUNT\", \"MOVIE_KEYWORDS\", \"FD_COL_5\" AS \"AVG_CAST_COUNT\", \"FD_COL_6\" AS \"UNIQUE_ACTORS\"\nFROM \"s1\"\nORDER BY \"PRODUCTION_YEAR\" DESC NULLS FIRST, \"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61822",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61822,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 4,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.8650802040369546E8,
        "cutRowSizeOutBytes" : 246.37862960339945,
        "cutOutputBytes" : 4.5951590477105354E10,
        "transferEstimatedMs" : 33001.785904915916,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 66,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "OTHER" : 33,
            "AGGREGATE" : 14,
            "JOIN" : 19
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 73,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 16,
            "JOIN" : 22,
            "OTHER" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t14\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\" AS \"FD_COL_5\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_5",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"CAST_COUNT\", \"s1\".\"MOVIE_KEYWORDS\", \"s1\".\"FD_COL_5\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"s1\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"s1\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"s1\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61732",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61732,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 222.37862960339945,
        "cutOutputBytes" : 3.215341858390971E8,
        "transferEstimatedMs" : 315.2718574580108,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 27,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "AGGREGATE" : 5,
            "JOIN" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 112,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 25,
            "JOIN" : 34,
            "OTHER" : 52,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"CAST_COUNT\", \"s1\".\"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"s1\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61704",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61704,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 72.94334459129283,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 3,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "OTHER" : 58,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END), AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END)) AS \"FD_COL_0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"s1\".\"FD_COL_0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61702",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61702,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "OTHER" : 58,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END, CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61690",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61690,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"s1\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61683",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61683,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"s1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61681",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61681,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"t1\".\"movie_id\" AS \"MOVIE_ID0\", \"t1\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"t1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_55436",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 55436,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 138,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"person_id\", \"movie_id\", \"person_role_id\", \"note\", \"nr_order\", \"role_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"t1\".\"movie_id\" AS \"MOVIE_ID0\", \"t1\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"t1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"s19\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"s1\" AS \"s19\"\nINNER JOIN \"person_info\" ON \"s19\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"s19\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61686",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61686,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN \"s1\" ON \"t2\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61940",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61940,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t76\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\"\nGROUP BY \"t74\".\"PRODUCTION_YEAR\") AS \"t76\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t78\".\"movie_id\" AS \"MOVIE_ID0\", \"t78\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t78\"\nRIGHT JOIN \"s1\" ON \"t78\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t76\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61698",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61698,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "OTHER" : 64,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN \"s1\" ON \"t5\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61696",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61696,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "OTHER" : 64,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t5\" ON \"t4\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_59347",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 59347,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 134170.0,
        "cutRowSizeOutBytes" : 55.16042520682716,
        "cutOutputBytes" : 7400874.250000001,
        "transferEstimatedMs" : 86.93720786026913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 138,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"keyword\", \"phonetic_code\"\nFROM \"keyword\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"t1\".\"movie_id\" AS \"MOVIE_ID0\", \"t1\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"t1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\"\nINNER JOIN \"movie_keyword\" ON \"s1\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s10\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s10\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"s10\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s11\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s11\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"s11\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s12\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s12\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"s12\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s13\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s13\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"s13\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s14\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s14\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"s14\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s15\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s15\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"s15\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s16\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s16\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"s16\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s17\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s17\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"s17\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"s18\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"s1\" AS \"s18\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"s18\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_59346",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 59346,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.0857432E8,
        "transferEstimatedMs" : 489.51661528393066,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 138,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"movie_id\", \"keyword_id\"\nFROM \"movie_keyword\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"t1\".\"movie_id\" AS \"MOVIE_ID0\", \"t1\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"t1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"s1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"s1\" ON \"keyword\".\"id\" = \"s1\".\"keyword_id\"\nGROUP BY \"s1\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"s10\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"s1\" AS \"s10\" ON \"keyword0\".\"id\" = \"s10\".\"keyword_id\"\nGROUP BY \"s10\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"s11\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"s1\" AS \"s11\" ON \"keyword1\".\"id\" = \"s11\".\"keyword_id\"\nGROUP BY \"s11\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"s12\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"s1\" AS \"s12\" ON \"keyword2\".\"id\" = \"s12\".\"keyword_id\"\nGROUP BY \"s12\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"s13\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"s1\" AS \"s13\" ON \"keyword3\".\"id\" = \"s13\".\"keyword_id\"\nGROUP BY \"s13\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"s14\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"s1\" AS \"s14\" ON \"keyword4\".\"id\" = \"s14\".\"keyword_id\"\nGROUP BY \"s14\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"s15\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"s1\" AS \"s15\" ON \"keyword5\".\"id\" = \"s15\".\"keyword_id\"\nGROUP BY \"s15\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"s16\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"s1\" AS \"s16\" ON \"keyword6\".\"id\" = \"s16\".\"keyword_id\"\nGROUP BY \"s16\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"s17\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"s1\" AS \"s17\" ON \"keyword7\".\"id\" = \"s17\".\"keyword_id\"\nGROUP BY \"s17\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"s18\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"s1\" AS \"s18\" ON \"keyword8\".\"id\" = \"s18\".\"keyword_id\"\nGROUP BY \"s18\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61728",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61728,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"MOVIE_ID\", \"t2\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t2\".\"TITLE\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t4\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t4\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t2\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"CAST_COUNT\", \"s1\".\"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN \"s1\" ON \"t14\".\"EXPR$0\" < \"s1\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61716",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61716,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"s1\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t11\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61709",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61709,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"s1\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t9\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61707",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61707,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t8\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61712",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61712,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN \"s1\" ON \"t10\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t8\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61724",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61724,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"s1\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"s1\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN \"s1\" ON \"t13\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t14\" ON \"t9\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61722",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61722,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t13\" ON \"t12\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t8\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61818",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61818,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 16384.0,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 393216.0,
        "transferEstimatedMs" : 74.4693914827543,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 41,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "OTHER" : 21,
            "AGGREGATE" : 9,
            "JOIN" : 11
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 98,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 46,
            "AGGREGATE" : 21,
            "JOIN" : 30,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t15\".\"PRODUCTION_YEAR\", \"t15\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", \"t23\".\"EXPR$0\" AS \"FD_COL_1\"\nFROM (SELECT \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"\nGROUP BY \"t13\".\"PRODUCTION_YEAR\") AS \"t15\"\nLEFT JOIN (SELECT \"t19\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\"\nGROUP BY \"t19\".\"PRODUCTION_YEAR\") AS \"t23\" ON \"t15\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t23\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t41\".\"MOVIE_ID\", \"t41\".\"TITLE\", \"t41\".\"CAST_COUNT\", \"t41\".\"MOVIE_KEYWORDS\", \"t41\".\"PRODUCTION_YEAR\", \"s1\".\"FD_COL_1\" AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"MOVIE_ID\", \"t40\".\"TITLE\", \"t40\".\"CAST_COUNT\", \"t40\".\"MOVIE_KEYWORDS\", \"t40\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t33\"\nINNER JOIN (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t39\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t39\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\") AS \"t40\" ON \"t33\".\"EXPR$0\" < \"t40\".\"CAST_COUNT\") AS \"t41\"\nLEFT JOIN \"s1\" ON \"t41\".\"PRODUCTION_YEAR\" = \"s1\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61788",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61788,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 128.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 1024.0,
        "transferEstimatedMs" : 72.95426664203691,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 28,
          "maxDepth" : 11,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "AGGREGATE" : 6,
            "JOIN" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 111,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 52,
            "AGGREGATE" : 24,
            "JOIN" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"PRODUCTION_YEAR\", \"t13\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"\nGROUP BY \"t13\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t32\".\"MOVIE_ID\", \"t32\".\"TITLE\", \"t32\".\"CAST_COUNT\", \"t32\".\"MOVIE_KEYWORDS\", \"t32\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", \"t31\".\"CAST_COUNT\", \"t31\".\"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\") AS \"t32\"\nLEFT JOIN (SELECT \"s1\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"s1\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t32\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61786",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61786,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 222.37862960339945,
        "cutOutputBytes" : 3.215341858390971E8,
        "transferEstimatedMs" : 315.2718574580108,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 27,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "AGGREGATE" : 5,
            "JOIN" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 112,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 52,
            "AGGREGATE" : 25,
            "JOIN" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"PRODUCTION_YEAR\", \"t13\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", \"t31\".\"CAST_COUNT\", \"t31\".\"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"CAST_COUNT\", \"t30\".\"MOVIE_KEYWORDS\", \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\") AS \"t31\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"PRODUCTION_YEAR\"\nFROM \"s1\"\nGROUP BY \"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t31\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61758",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61758,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 72.94334459129283,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 3,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END), AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END)) AS \"FD_COL_0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t23\".\"MOVIE_ID\", \"t23\".\"TITLE\", \"t23\".\"CAST_COUNT\", \"t23\".\"MOVIE_KEYWORDS\", \"t23\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t15\"\nINNER JOIN (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t21\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t21\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t22\" ON \"t15\".\"EXPR$0\" < \"t22\".\"CAST_COUNT\") AS \"t23\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"s1\".\"FD_COL_0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t23\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61756",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61756,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END, CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61744",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61744,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"s1\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61737",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61737,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"s1\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61735",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61735,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61740",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61740,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN \"s1\" ON \"t18\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61752",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61752,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN \"s1\" ON \"t21\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61750",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61750,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t21\" ON \"t20\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61782",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61782,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"MOVIE_ID\", \"t2\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t2\".\"TITLE\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t4\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t4\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t2\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"s1\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN \"s1\" ON \"t30\".\"EXPR$0\" < \"s1\".\"CAST_COUNT\"\nGROUP BY \"s1\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61770",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61770,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"s1\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t27\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61763",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61763,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"s1\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t25\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61761",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61761,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t24\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61766",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61766,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN \"s1\" ON \"t26\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t24\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61778",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61778,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"s1\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"s1\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN \"s1\" ON \"t29\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t30\" ON \"t25\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61776",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61776,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t29\" ON \"t28\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t24\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61814",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61814,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 128.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 2048.0,
        "transferEstimatedMs" : 72.96341654812377,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "AGGREGATE" : 3,
            "OTHER" : 9,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"PRODUCTION_YEAR\", \"t2\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"FD_COL_1\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\nGROUP BY \"t2\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t23\".\"MOVIE_ID\", \"t23\".\"TITLE\", \"t23\".\"CAST_COUNT\", \"t23\".\"MOVIE_KEYWORDS\", \"t23\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t15\"\nINNER JOIN (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t21\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t21\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t22\" ON \"t15\".\"EXPR$0\" < \"t22\".\"CAST_COUNT\") AS \"t23\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", \"s1\".\"FD_COL_1\" AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t31\"\nINNER JOIN (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t37\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t37\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t35\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t38\" ON \"t31\".\"EXPR$0\" < \"t38\".\"CAST_COUNT\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t40\"\nLEFT JOIN \"s1\" ON \"t40\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"s1\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t23\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61812",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61812,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "AGGREGATE" : 2,
            "OTHER" : 9,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"PRODUCTION_YEAR\", \"t2\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"PRODUCTION_YEAR\", AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"PRODUCTION_YEAR\") AS \"t40\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61800",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61800,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 5,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"s1\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"s1\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"s1\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61793",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61793,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"s1\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61791",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61791,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61796",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61796,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN \"s1\" ON \"t35\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61808",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61808,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN \"s1\" ON \"t38\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61806",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61806,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t38\" ON \"t37\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61980",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61980,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 4,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 7.148512209472737E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.7156429302734568E13,
        "transferEstimatedMs" : 6.582236621858573E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 73,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "AGGREGATE" : 16,
            "OTHER" : 36,
            "JOIN" : 21
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 66,
          "maxDepth" : 19,
          "operatorKindCounts" : {
            "OTHER" : 31,
            "AGGREGATE" : 14,
            "JOIN" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t42\".\"MOVIE_ID\", \"t42\".\"MOVIE_ID\") AS \"movie_id\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t14\".\"MOVIE_ID\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\"\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t42\"\nLEFT JOIN (SELECT \"cast_info4\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info4\"\nINNER JOIN \"person_info\" ON \"cast_info4\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info4\".\"movie_id\") AS \"t44\" ON \"t42\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t44\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t89\".\"MOVIE_ID\", \"t89\".\"TITLE\", \"t89\".\"PRODUCTION_YEAR\", \"t89\".\"CAST_COUNT\", \"t89\".\"MOVIE_KEYWORDS\", \"t89\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"CAST_COUNT\", \"t62\".\"MOVIE_KEYWORDS\", \"t62\".\"PRODUCTION_YEAR\", \"t88\".\"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"CAST_COUNT\", \"t61\".\"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t50\".\"COUNT\" IS NOT NULL THEN CAST(\"t50\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"RAN\", \"t48\".\"movie_id\" AS \"MOVIE_ID0\", \"t48\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t48\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t49\" ON \"t48\".\"movie_id\" = \"t49\".\"MOVIE_ID\") AS \"t50\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t52\" ON \"t50\".\"MOVIE_ID\" = \"t52\".\"MOVIE_ID\") AS \"t54\"\nINNER JOIN (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", CASE WHEN \"t58\".\"COUNT\" IS NOT NULL THEN CAST(\"t58\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t60\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t60\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"PRODUCTION_YEAR\", \"t57\".\"RAN\", \"t56\".\"movie_id\" AS \"MOVIE_ID0\", \"t56\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t56\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t57\" ON \"t56\".\"movie_id\" = \"t57\".\"MOVIE_ID\") AS \"t58\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t60\" ON \"t58\".\"MOVIE_ID\" = \"t60\".\"MOVIE_ID\") AS \"t61\" ON \"t54\".\"EXPR$0\" < \"t61\".\"CAST_COUNT\") AS \"t62\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", \"t87\".\"EXPR$0\"\nFROM (SELECT \"t77\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t66\".\"COUNT\" IS NOT NULL THEN CAST(\"t66\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\", \"t65\".\"TITLE\", \"t65\".\"PRODUCTION_YEAR\", \"t65\".\"RAN\", \"t64\".\"movie_id\" AS \"MOVIE_ID0\", \"t64\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t64\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t65\" ON \"t64\".\"movie_id\" = \"t65\".\"MOVIE_ID\") AS \"t66\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t68\" ON \"t66\".\"MOVIE_ID\" = \"t68\".\"MOVIE_ID\") AS \"t70\"\nINNER JOIN (SELECT \"t74\".\"MOVIE_ID\", \"t74\".\"TITLE\", CASE WHEN \"t74\".\"COUNT\" IS NOT NULL THEN CAST(\"t74\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t76\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t76\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t73\".\"MOVIE_ID\", \"t73\".\"TITLE\", \"t73\".\"PRODUCTION_YEAR\", \"t73\".\"RAN\", \"t72\".\"movie_id\" AS \"MOVIE_ID0\", \"t72\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t72\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t73\" ON \"t72\".\"movie_id\" = \"t73\".\"MOVIE_ID\") AS \"t74\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t76\" ON \"t74\".\"MOVIE_ID\" = \"t76\".\"MOVIE_ID\") AS \"t77\" ON \"t70\".\"EXPR$0\" < \"t77\".\"CAST_COUNT\"\nGROUP BY \"t77\".\"PRODUCTION_YEAR\") AS \"t79\"\nLEFT JOIN (SELECT \"t83\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t83\".\"COUNT\" IS NOT NULL THEN CAST(\"t83\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t82\".\"MOVIE_ID\", \"t82\".\"TITLE\", \"t82\".\"PRODUCTION_YEAR\", \"t82\".\"RAN\", \"t81\".\"movie_id\" AS \"MOVIE_ID0\", \"t81\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t81\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t82\" ON \"t81\".\"movie_id\" = \"t82\".\"MOVIE_ID\") AS \"t83\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t85\" ON \"t83\".\"MOVIE_ID\" = \"t85\".\"MOVIE_ID\"\nGROUP BY \"t83\".\"PRODUCTION_YEAR\") AS \"t87\" ON \"t79\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t87\".\"PRODUCTION_YEAR\") AS \"t88\" ON \"t62\".\"PRODUCTION_YEAR\" = \"t88\".\"PRODUCTION_YEAR\") AS \"t89\"\nLEFT JOIN \"s1\" ON \"t89\".\"MOVIE_ID\" = \"s1\".\"movie_id\"\nORDER BY \"t89\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t89\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61966",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61966,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 7,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.8650802040369546E8,
        "cutRowSizeOutBytes" : 246.37862960339945,
        "cutOutputBytes" : 4.5951590477105354E10,
        "transferEstimatedMs" : 33001.785904915916,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 66,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "AGGREGATE" : 14,
            "OTHER" : 33,
            "JOIN" : 19
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 73,
          "maxDepth" : 19,
          "operatorKindCounts" : {
            "OTHER" : 34,
            "AGGREGATE" : 16,
            "JOIN" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t14\".\"MOVIE_ID\", \"t14\".\"MOVIE_ID\") AS \"MOVIE_ID\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\") AS \"t14\"\nLEFT JOIN (SELECT \"t31\".\"PRODUCTION_YEAR\", \"t39\".\"EXPR$0\"\nFROM (SELECT \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t22\"\nINNER JOIN (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t28\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t28\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t26\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t29\" ON \"t22\".\"EXPR$0\" < \"t29\".\"CAST_COUNT\"\nGROUP BY \"t29\".\"PRODUCTION_YEAR\") AS \"t31\"\nLEFT JOIN (SELECT \"t35\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\"\nGROUP BY \"t35\".\"PRODUCTION_YEAR\") AS \"t39\" ON \"t31\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t39\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t14\".\"PRODUCTION_YEAR\" = \"t40\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t85\".\"MOVIE_ID\", \"t85\".\"TITLE\", \"t85\".\"PRODUCTION_YEAR\", \"t85\".\"CAST_COUNT\", \"t85\".\"MOVIE_KEYWORDS\", \"t85\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\", \"t84\".\"EXPR$0\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\") AS \"t85\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"MOVIE_ID\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t85\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t85\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t85\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61876",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61876,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 222.37862960339945,
        "cutOutputBytes" : 3.215341858390971E8,
        "transferEstimatedMs" : 315.2718574580108,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 27,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "AGGREGATE" : 5,
            "JOIN" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 112,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 52,
            "AGGREGATE" : 25,
            "JOIN" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"MOVIE_ID\", \"t13\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"CAST_COUNT\", \"t13\".\"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"PRODUCTION_YEAR\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", \"t31\".\"CAST_COUNT\", \"t31\".\"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\", \"t57\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"CAST_COUNT\", \"t30\".\"MOVIE_KEYWORDS\", \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\") AS \"t31\"\nLEFT JOIN (SELECT \"t48\".\"PRODUCTION_YEAR\", \"t56\".\"EXPR$0\"\nFROM (SELECT \"t46\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t39\"\nINNER JOIN (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t45\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t45\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t43\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\") AS \"t46\" ON \"t39\".\"EXPR$0\" < \"t46\".\"CAST_COUNT\"\nGROUP BY \"t46\".\"PRODUCTION_YEAR\") AS \"t48\"\nLEFT JOIN (SELECT \"t52\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t52\".\"COUNT\" IS NOT NULL THEN CAST(\"t52\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t51\".\"MOVIE_ID\", \"t51\".\"TITLE\", \"t51\".\"PRODUCTION_YEAR\", \"t51\".\"RAN\", \"t50\".\"movie_id\" AS \"MOVIE_ID0\", \"t50\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t50\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t51\" ON \"t50\".\"movie_id\" = \"t51\".\"MOVIE_ID\") AS \"t52\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t54\" ON \"t52\".\"MOVIE_ID\" = \"t54\".\"MOVIE_ID\"\nGROUP BY \"t52\".\"PRODUCTION_YEAR\") AS \"t56\" ON \"t48\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t56\".\"PRODUCTION_YEAR\") AS \"t57\" ON \"t31\".\"PRODUCTION_YEAR\" = \"t57\".\"PRODUCTION_YEAR\") AS \"t58\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"s1\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"s1\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t58\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t58\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t58\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61848",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61848,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 72.94334459129283,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 3,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END), AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END)) AS \"FD_COL_0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t50\".\"MOVIE_ID\", \"t50\".\"TITLE\", \"t50\".\"PRODUCTION_YEAR\", \"t50\".\"CAST_COUNT\", \"t50\".\"MOVIE_KEYWORDS\", \"t50\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t23\".\"MOVIE_ID\", \"t23\".\"TITLE\", \"t23\".\"CAST_COUNT\", \"t23\".\"MOVIE_KEYWORDS\", \"t23\".\"PRODUCTION_YEAR\", \"t49\".\"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t15\"\nINNER JOIN (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t21\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t21\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t22\" ON \"t15\".\"EXPR$0\" < \"t22\".\"CAST_COUNT\") AS \"t23\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t38\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t31\"\nINNER JOIN (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t37\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t37\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t35\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t38\" ON \"t31\".\"EXPR$0\" < \"t38\".\"CAST_COUNT\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t40\"\nLEFT JOIN (SELECT \"t44\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t44\".\"COUNT\" IS NOT NULL THEN CAST(\"t44\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"RAN\", \"t42\".\"movie_id\" AS \"MOVIE_ID0\", \"t42\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t42\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t43\" ON \"t42\".\"movie_id\" = \"t43\".\"MOVIE_ID\") AS \"t44\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t46\" ON \"t44\".\"MOVIE_ID\" = \"t46\".\"MOVIE_ID\"\nGROUP BY \"t44\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t40\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t48\".\"PRODUCTION_YEAR\") AS \"t49\" ON \"t23\".\"PRODUCTION_YEAR\" = \"t49\".\"PRODUCTION_YEAR\") AS \"t50\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"s1\".\"FD_COL_0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t50\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t50\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t50\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61846",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61846,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END, CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"CAST_COUNT\", \"t49\".\"MOVIE_KEYWORDS\", \"t49\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t47\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"t43\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\"\nGROUP BY \"t43\".\"PRODUCTION_YEAR\") AS \"t47\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t47\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t48\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t49\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t49\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t49\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61834",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61834,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"CAST_COUNT\", \"t46\".\"MOVIE_KEYWORDS\", \"t46\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t45\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t44\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t40\".\"COUNT\" IS NOT NULL THEN CAST(\"t40\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"MOVIE_ID\", \"t39\".\"TITLE\", \"t39\".\"PRODUCTION_YEAR\", \"t39\".\"RAN\", \"t38\".\"movie_id\" AS \"MOVIE_ID0\", \"t38\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t38\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t39\" ON \"t38\".\"movie_id\" = \"t39\".\"MOVIE_ID\") AS \"t40\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t42\" ON \"t40\".\"MOVIE_ID\" = \"t42\".\"MOVIE_ID\"\nGROUP BY \"t40\".\"PRODUCTION_YEAR\") AS \"t44\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t44\".\"PRODUCTION_YEAR\") AS \"t45\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t45\".\"PRODUCTION_YEAR\") AS \"t46\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"s1\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t46\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t46\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t46\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61827",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61827,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"s1\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61825",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61825,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61830",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61830,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN \"s1\" ON \"t45\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61842",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61842,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN \"s1\" ON \"t48\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61840",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61840,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t48\" ON \"t47\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61872",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61872,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "JOIN" : 3,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"MOVIE_ID\", \"t2\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t2\".\"TITLE\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t4\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t4\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t2\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"CAST_COUNT\", \"t49\".\"MOVIE_KEYWORDS\", \"t49\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t47\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"t43\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\"\nGROUP BY \"t43\".\"PRODUCTION_YEAR\") AS \"t47\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t47\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t48\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"CAST_COUNT\", \"s1\".\"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t57\"\nINNER JOIN \"s1\" ON \"t57\".\"EXPR$0\" < \"s1\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t49\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t49\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t49\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61860",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61860,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"CAST_COUNT\", \"t46\".\"MOVIE_KEYWORDS\", \"t46\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t45\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t44\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t40\".\"COUNT\" IS NOT NULL THEN CAST(\"t40\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"MOVIE_ID\", \"t39\".\"TITLE\", \"t39\".\"PRODUCTION_YEAR\", \"t39\".\"RAN\", \"t38\".\"movie_id\" AS \"MOVIE_ID0\", \"t38\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t38\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t39\" ON \"t38\".\"movie_id\" = \"t39\".\"MOVIE_ID\") AS \"t40\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t42\" ON \"t40\".\"MOVIE_ID\" = \"t42\".\"MOVIE_ID\"\nGROUP BY \"t40\".\"PRODUCTION_YEAR\") AS \"t44\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t44\".\"PRODUCTION_YEAR\") AS \"t45\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t45\".\"PRODUCTION_YEAR\") AS \"t46\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t50\".\"COUNT\" IS NOT NULL THEN CAST(\"t50\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"RAN\", \"t48\".\"movie_id\" AS \"MOVIE_ID0\", \"t48\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t48\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t49\" ON \"t48\".\"movie_id\" = \"t49\".\"MOVIE_ID\") AS \"t50\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t52\" ON \"t50\".\"MOVIE_ID\" = \"t52\".\"MOVIE_ID\") AS \"t54\"\nINNER JOIN (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"s1\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t54\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t46\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t46\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t46\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61853",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61853,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"s1\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t52\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61851",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61851,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t51\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61856",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61856,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN \"s1\" ON \"t53\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t51\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61868",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61868,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"s1\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"s1\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN \"s1\" ON \"t56\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t57\" ON \"t52\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61866",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61866,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t56\" ON \"t55\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t51\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61962",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61962,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 16384.0,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 393216.0,
        "transferEstimatedMs" : 74.4693914827543,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 41,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "OTHER" : 21,
            "AGGREGATE" : 9,
            "JOIN" : 11
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 98,
          "maxDepth" : 19,
          "operatorKindCounts" : {
            "OTHER" : 46,
            "AGGREGATE" : 21,
            "JOIN" : 30,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t15\".\"PRODUCTION_YEAR\", \"t15\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", \"t23\".\"EXPR$0\" AS \"FD_COL_1\"\nFROM (SELECT \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"\nGROUP BY \"t13\".\"PRODUCTION_YEAR\") AS \"t15\"\nLEFT JOIN (SELECT \"t19\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\"\nGROUP BY \"t19\".\"PRODUCTION_YEAR\") AS \"t23\" ON \"t15\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t23\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t68\".\"MOVIE_ID\", \"t68\".\"TITLE\", \"t68\".\"PRODUCTION_YEAR\", \"t68\".\"CAST_COUNT\", \"t68\".\"MOVIE_KEYWORDS\", \"t68\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t41\".\"MOVIE_ID\", \"t41\".\"TITLE\", \"t41\".\"CAST_COUNT\", \"t41\".\"MOVIE_KEYWORDS\", \"t41\".\"PRODUCTION_YEAR\", \"t67\".\"EXPR$0\"\nFROM (SELECT \"t40\".\"MOVIE_ID\", \"t40\".\"TITLE\", \"t40\".\"CAST_COUNT\", \"t40\".\"MOVIE_KEYWORDS\", \"t40\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t33\"\nINNER JOIN (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t39\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t39\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\") AS \"t40\" ON \"t33\".\"EXPR$0\" < \"t40\".\"CAST_COUNT\") AS \"t41\"\nLEFT JOIN (SELECT \"t58\".\"PRODUCTION_YEAR\", \"t66\".\"EXPR$0\"\nFROM (SELECT \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t45\".\"COUNT\" IS NOT NULL THEN CAST(\"t45\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"RAN\", \"t43\".\"movie_id\" AS \"MOVIE_ID0\", \"t43\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t43\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t44\" ON \"t43\".\"movie_id\" = \"t44\".\"MOVIE_ID\") AS \"t45\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t47\" ON \"t45\".\"MOVIE_ID\" = \"t47\".\"MOVIE_ID\") AS \"t49\"\nINNER JOIN (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t55\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t55\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t53\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t56\" ON \"t49\".\"EXPR$0\" < \"t56\".\"CAST_COUNT\"\nGROUP BY \"t56\".\"PRODUCTION_YEAR\") AS \"t58\"\nLEFT JOIN (SELECT \"t62\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\"\nGROUP BY \"t62\".\"PRODUCTION_YEAR\") AS \"t66\" ON \"t58\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t66\".\"PRODUCTION_YEAR\") AS \"t67\" ON \"t41\".\"PRODUCTION_YEAR\" = \"t67\".\"PRODUCTION_YEAR\") AS \"t68\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t84\".\"MOVIE_ID\"\nFROM (SELECT \"t83\".\"MOVIE_ID\", \"t83\".\"TITLE\", \"t83\".\"CAST_COUNT\", \"t83\".\"MOVIE_KEYWORDS\", \"t83\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t72\".\"COUNT\" IS NOT NULL THEN CAST(\"t72\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", \"t71\".\"PRODUCTION_YEAR\", \"t71\".\"RAN\", \"t70\".\"movie_id\" AS \"MOVIE_ID0\", \"t70\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t70\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t71\" ON \"t70\".\"movie_id\" = \"t71\".\"MOVIE_ID\") AS \"t72\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t74\" ON \"t72\".\"MOVIE_ID\" = \"t74\".\"MOVIE_ID\") AS \"t76\"\nINNER JOIN (SELECT \"t80\".\"MOVIE_ID\", \"t80\".\"TITLE\", CASE WHEN \"t80\".\"COUNT\" IS NOT NULL THEN CAST(\"t80\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t82\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t82\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t80\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t79\".\"MOVIE_ID\", \"t79\".\"TITLE\", \"t79\".\"PRODUCTION_YEAR\", \"t79\".\"RAN\", \"t78\".\"movie_id\" AS \"MOVIE_ID0\", \"t78\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t78\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t79\" ON \"t78\".\"movie_id\" = \"t79\".\"MOVIE_ID\") AS \"t80\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t82\" ON \"t80\".\"MOVIE_ID\" = \"t82\".\"MOVIE_ID\") AS \"t83\" ON \"t76\".\"EXPR$0\" < \"t83\".\"CAST_COUNT\") AS \"t84\"\nLEFT JOIN \"s1\" ON \"t84\".\"PRODUCTION_YEAR\" = \"s1\".\"PRODUCTION_YEAR\"\nGROUP BY \"t84\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t68\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t68\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t68\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61932",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61932,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 128.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 1024.0,
        "transferEstimatedMs" : 72.95426664203691,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 28,
          "maxDepth" : 11,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "JOIN" : 7,
            "AGGREGATE" : 6
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 111,
          "maxDepth" : 19,
          "operatorKindCounts" : {
            "OTHER" : 52,
            "AGGREGATE" : 24,
            "JOIN" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"PRODUCTION_YEAR\", \"t13\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"\nGROUP BY \"t13\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"PRODUCTION_YEAR\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t32\".\"MOVIE_ID\", \"t32\".\"TITLE\", \"t32\".\"CAST_COUNT\", \"t32\".\"MOVIE_KEYWORDS\", \"t32\".\"PRODUCTION_YEAR\", \"t58\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", \"t31\".\"CAST_COUNT\", \"t31\".\"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\") AS \"t32\"\nLEFT JOIN (SELECT \"t49\".\"PRODUCTION_YEAR\", \"t57\".\"EXPR$0\"\nFROM (SELECT \"t47\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\") AS \"t40\"\nINNER JOIN (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", CASE WHEN \"t44\".\"COUNT\" IS NOT NULL THEN CAST(\"t44\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t46\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t46\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t44\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"RAN\", \"t42\".\"movie_id\" AS \"MOVIE_ID0\", \"t42\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t42\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t43\" ON \"t42\".\"movie_id\" = \"t43\".\"MOVIE_ID\") AS \"t44\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t46\" ON \"t44\".\"MOVIE_ID\" = \"t46\".\"MOVIE_ID\") AS \"t47\" ON \"t40\".\"EXPR$0\" < \"t47\".\"CAST_COUNT\"\nGROUP BY \"t47\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t53\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\"\nGROUP BY \"t53\".\"PRODUCTION_YEAR\") AS \"t57\" ON \"t49\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t57\".\"PRODUCTION_YEAR\") AS \"t58\" ON \"t32\".\"PRODUCTION_YEAR\" = \"t58\".\"PRODUCTION_YEAR\") AS \"t59\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t75\".\"MOVIE_ID\"\nFROM (SELECT \"t74\".\"MOVIE_ID\", \"t74\".\"TITLE\", \"t74\".\"CAST_COUNT\", \"t74\".\"MOVIE_KEYWORDS\", \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\") AS \"t75\"\nLEFT JOIN (SELECT \"s1\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"s1\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t75\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t75\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t59\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t59\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t59\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61930",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61930,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 222.37862960339945,
        "cutOutputBytes" : 3.215341858390971E8,
        "transferEstimatedMs" : 315.2718574580108,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 27,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 15,
            "JOIN" : 7,
            "AGGREGATE" : 5
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 112,
          "maxDepth" : 19,
          "operatorKindCounts" : {
            "OTHER" : 52,
            "AGGREGATE" : 25,
            "JOIN" : 34,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t13\".\"PRODUCTION_YEAR\", \"t13\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\") AS \"t6\"\nINNER JOIN (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t12\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t10\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t13\" ON \"t6\".\"EXPR$0\" < \"t13\".\"CAST_COUNT\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"PRODUCTION_YEAR\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", \"t31\".\"CAST_COUNT\", \"t31\".\"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\", \"t57\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"CAST_COUNT\", \"t30\".\"MOVIE_KEYWORDS\", \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\") AS \"t31\"\nLEFT JOIN (SELECT \"t48\".\"PRODUCTION_YEAR\", \"t56\".\"EXPR$0\"\nFROM (SELECT \"t46\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t39\"\nINNER JOIN (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t45\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t45\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t43\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\") AS \"t46\" ON \"t39\".\"EXPR$0\" < \"t46\".\"CAST_COUNT\"\nGROUP BY \"t46\".\"PRODUCTION_YEAR\") AS \"t48\"\nLEFT JOIN (SELECT \"t52\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t52\".\"COUNT\" IS NOT NULL THEN CAST(\"t52\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t51\".\"MOVIE_ID\", \"t51\".\"TITLE\", \"t51\".\"PRODUCTION_YEAR\", \"t51\".\"RAN\", \"t50\".\"movie_id\" AS \"MOVIE_ID0\", \"t50\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t50\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t51\" ON \"t50\".\"movie_id\" = \"t51\".\"MOVIE_ID\") AS \"t52\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t54\" ON \"t52\".\"MOVIE_ID\" = \"t54\".\"MOVIE_ID\"\nGROUP BY \"t52\".\"PRODUCTION_YEAR\") AS \"t56\" ON \"t48\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t56\".\"PRODUCTION_YEAR\") AS \"t57\" ON \"t31\".\"PRODUCTION_YEAR\" = \"t57\".\"PRODUCTION_YEAR\") AS \"t58\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t74\".\"MOVIE_ID\"\nFROM (SELECT \"t73\".\"MOVIE_ID\", \"t73\".\"TITLE\", \"t73\".\"CAST_COUNT\", \"t73\".\"MOVIE_KEYWORDS\", \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\") AS \"t74\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"PRODUCTION_YEAR\"\nFROM \"s1\"\nGROUP BY \"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t74\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t74\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t58\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t58\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t58\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61902",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61902,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 72.94334459129283,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "JOIN" : 3,
            "AGGREGATE" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 21,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END), AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END)) AS \"FD_COL_0\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t50\".\"MOVIE_ID\", \"t50\".\"TITLE\", \"t50\".\"PRODUCTION_YEAR\", \"t50\".\"CAST_COUNT\", \"t50\".\"MOVIE_KEYWORDS\", \"t50\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t23\".\"MOVIE_ID\", \"t23\".\"TITLE\", \"t23\".\"CAST_COUNT\", \"t23\".\"MOVIE_KEYWORDS\", \"t23\".\"PRODUCTION_YEAR\", \"t49\".\"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t15\"\nINNER JOIN (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t21\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t21\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t22\" ON \"t15\".\"EXPR$0\" < \"t22\".\"CAST_COUNT\") AS \"t23\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t38\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t31\"\nINNER JOIN (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t37\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t37\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t35\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t38\" ON \"t31\".\"EXPR$0\" < \"t38\".\"CAST_COUNT\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t40\"\nLEFT JOIN (SELECT \"t44\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t44\".\"COUNT\" IS NOT NULL THEN CAST(\"t44\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"RAN\", \"t42\".\"movie_id\" AS \"MOVIE_ID0\", \"t42\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t42\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t43\" ON \"t42\".\"movie_id\" = \"t43\".\"MOVIE_ID\") AS \"t44\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t46\" ON \"t44\".\"MOVIE_ID\" = \"t46\".\"MOVIE_ID\"\nGROUP BY \"t44\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t40\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t48\".\"PRODUCTION_YEAR\") AS \"t49\" ON \"t23\".\"PRODUCTION_YEAR\" = \"t49\".\"PRODUCTION_YEAR\") AS \"t50\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t66\".\"MOVIE_ID\"\nFROM (SELECT \"t65\".\"MOVIE_ID\", \"t65\".\"TITLE\", \"t65\".\"CAST_COUNT\", \"t65\".\"MOVIE_KEYWORDS\", \"t65\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t58\"\nINNER JOIN (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t64\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t64\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t62\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t65\" ON \"t58\".\"EXPR$0\" < \"t65\".\"CAST_COUNT\") AS \"t66\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"s1\".\"FD_COL_0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t66\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t66\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t50\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t50\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t50\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61900",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61900,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "JOIN" : 3,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 21,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END, CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"CAST_COUNT\", \"t49\".\"MOVIE_KEYWORDS\", \"t49\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t47\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"t43\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\"\nGROUP BY \"t43\".\"PRODUCTION_YEAR\") AS \"t47\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t47\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t48\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\"\nFROM (SELECT \"t64\".\"MOVIE_ID\", \"t64\".\"TITLE\", \"t64\".\"CAST_COUNT\", \"t64\".\"MOVIE_KEYWORDS\", \"t64\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t57\"\nINNER JOIN (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", CASE WHEN \"t61\".\"COUNT\" IS NOT NULL THEN CAST(\"t61\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t63\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t63\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t60\".\"MOVIE_ID\", \"t60\".\"TITLE\", \"t60\".\"PRODUCTION_YEAR\", \"t60\".\"RAN\", \"t59\".\"movie_id\" AS \"MOVIE_ID0\", \"t59\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t59\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t60\" ON \"t59\".\"movie_id\" = \"t60\".\"MOVIE_ID\") AS \"t61\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t63\" ON \"t61\".\"MOVIE_ID\" = \"t63\".\"MOVIE_ID\") AS \"t64\" ON \"t57\".\"EXPR$0\" < \"t64\".\"CAST_COUNT\") AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t65\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t65\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t49\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t49\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t49\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61888",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61888,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 21,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"CAST_COUNT\", \"t46\".\"MOVIE_KEYWORDS\", \"t46\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t45\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t44\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t40\".\"COUNT\" IS NOT NULL THEN CAST(\"t40\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"MOVIE_ID\", \"t39\".\"TITLE\", \"t39\".\"PRODUCTION_YEAR\", \"t39\".\"RAN\", \"t38\".\"movie_id\" AS \"MOVIE_ID0\", \"t38\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t38\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t39\" ON \"t38\".\"movie_id\" = \"t39\".\"MOVIE_ID\") AS \"t40\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t42\" ON \"t40\".\"MOVIE_ID\" = \"t42\".\"MOVIE_ID\"\nGROUP BY \"t40\".\"PRODUCTION_YEAR\") AS \"t44\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t44\".\"PRODUCTION_YEAR\") AS \"t45\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t45\".\"PRODUCTION_YEAR\") AS \"t46\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"CAST_COUNT\", \"t61\".\"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t50\".\"COUNT\" IS NOT NULL THEN CAST(\"t50\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"RAN\", \"t48\".\"movie_id\" AS \"MOVIE_ID0\", \"t48\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t48\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t49\" ON \"t48\".\"movie_id\" = \"t49\".\"MOVIE_ID\") AS \"t50\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t52\" ON \"t50\".\"MOVIE_ID\" = \"t52\".\"MOVIE_ID\") AS \"t54\"\nINNER JOIN (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", CASE WHEN \"t58\".\"COUNT\" IS NOT NULL THEN CAST(\"t58\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t60\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t60\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"PRODUCTION_YEAR\", \"t57\".\"RAN\", \"t56\".\"movie_id\" AS \"MOVIE_ID0\", \"t56\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t56\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t57\" ON \"t56\".\"movie_id\" = \"t57\".\"MOVIE_ID\") AS \"t58\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t60\" ON \"t58\".\"MOVIE_ID\" = \"t60\".\"MOVIE_ID\") AS \"t61\" ON \"t54\".\"EXPR$0\" < \"t61\".\"CAST_COUNT\") AS \"t62\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"s1\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t62\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t62\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t46\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t46\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t46\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61881",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61881,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 21,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"s1\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61879",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61879,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 21,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61884",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61884,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN \"s1\" ON \"t61\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61896",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61896,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN \"s1\" ON \"t64\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61894",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61894,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t64\" ON \"t63\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61926",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61926,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 9,
            "AGGREGATE" : 2,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"MOVIE_ID\", \"t2\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t2\".\"TITLE\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t4\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t4\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t2\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"CAST_COUNT\", \"t49\".\"MOVIE_KEYWORDS\", \"t49\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t47\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"t43\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\"\nGROUP BY \"t43\".\"PRODUCTION_YEAR\") AS \"t47\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t47\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t48\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\"\nFROM (SELECT \"t64\".\"MOVIE_ID\", \"t64\".\"TITLE\", \"t64\".\"CAST_COUNT\", \"t64\".\"MOVIE_KEYWORDS\", \"t64\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t57\"\nINNER JOIN (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", CASE WHEN \"t61\".\"COUNT\" IS NOT NULL THEN CAST(\"t61\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t63\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t63\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t60\".\"MOVIE_ID\", \"t60\".\"TITLE\", \"t60\".\"PRODUCTION_YEAR\", \"t60\".\"RAN\", \"t59\".\"movie_id\" AS \"MOVIE_ID0\", \"t59\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t59\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t60\" ON \"t59\".\"movie_id\" = \"t60\".\"MOVIE_ID\") AS \"t61\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t63\" ON \"t61\".\"MOVIE_ID\" = \"t63\".\"MOVIE_ID\") AS \"t64\" ON \"t57\".\"EXPR$0\" < \"t64\".\"CAST_COUNT\") AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"s1\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t69\".\"COUNT\" IS NOT NULL THEN CAST(\"t69\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t68\".\"MOVIE_ID\", \"t68\".\"TITLE\", \"t68\".\"PRODUCTION_YEAR\", \"t68\".\"RAN\", \"t67\".\"movie_id\" AS \"MOVIE_ID0\", \"t67\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t67\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t68\" ON \"t67\".\"movie_id\" = \"t68\".\"MOVIE_ID\") AS \"t69\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t71\" ON \"t69\".\"MOVIE_ID\" = \"t71\".\"MOVIE_ID\") AS \"t73\"\nINNER JOIN \"s1\" ON \"t73\".\"EXPR$0\" < \"s1\".\"CAST_COUNT\"\nGROUP BY \"s1\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t65\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t65\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t49\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t49\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t49\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61914",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61914,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 5,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"CAST_COUNT\", \"t46\".\"MOVIE_KEYWORDS\", \"t46\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t45\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t44\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t40\".\"COUNT\" IS NOT NULL THEN CAST(\"t40\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"MOVIE_ID\", \"t39\".\"TITLE\", \"t39\".\"PRODUCTION_YEAR\", \"t39\".\"RAN\", \"t38\".\"movie_id\" AS \"MOVIE_ID0\", \"t38\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t38\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t39\" ON \"t38\".\"movie_id\" = \"t39\".\"MOVIE_ID\") AS \"t40\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t42\" ON \"t40\".\"MOVIE_ID\" = \"t42\".\"MOVIE_ID\"\nGROUP BY \"t40\".\"PRODUCTION_YEAR\") AS \"t44\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t44\".\"PRODUCTION_YEAR\") AS \"t45\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t45\".\"PRODUCTION_YEAR\") AS \"t46\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"CAST_COUNT\", \"t61\".\"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t50\".\"COUNT\" IS NOT NULL THEN CAST(\"t50\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"RAN\", \"t48\".\"movie_id\" AS \"MOVIE_ID0\", \"t48\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t48\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t49\" ON \"t48\".\"movie_id\" = \"t49\".\"MOVIE_ID\") AS \"t50\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t52\" ON \"t50\".\"MOVIE_ID\" = \"t52\".\"MOVIE_ID\") AS \"t54\"\nINNER JOIN (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", CASE WHEN \"t58\".\"COUNT\" IS NOT NULL THEN CAST(\"t58\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t60\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t60\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"PRODUCTION_YEAR\", \"t57\".\"RAN\", \"t56\".\"movie_id\" AS \"MOVIE_ID0\", \"t56\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t56\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t57\" ON \"t56\".\"movie_id\" = \"t57\".\"MOVIE_ID\") AS \"t58\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t60\" ON \"t58\".\"MOVIE_ID\" = \"t60\".\"MOVIE_ID\") AS \"t61\" ON \"t54\".\"EXPR$0\" < \"t61\".\"CAST_COUNT\") AS \"t62\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t66\".\"COUNT\" IS NOT NULL THEN CAST(\"t66\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\", \"t65\".\"TITLE\", \"t65\".\"PRODUCTION_YEAR\", \"t65\".\"RAN\", \"t64\".\"movie_id\" AS \"MOVIE_ID0\", \"t64\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t64\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t65\" ON \"t64\".\"movie_id\" = \"t65\".\"MOVIE_ID\") AS \"t66\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t68\" ON \"t66\".\"MOVIE_ID\" = \"t68\".\"MOVIE_ID\") AS \"t70\"\nINNER JOIN (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"s1\".\"PRODUCTION_YEAR\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"s1\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t70\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t62\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t62\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t46\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t46\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t46\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61907",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61907,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t66\" ON \"t64\".\"MOVIE_ID\" = \"t66\".\"MOVIE_ID\") AS \"t68\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"s1\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t68\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61905",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61905,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t67\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61910",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61910,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 128.16526981199385,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN \"s1\" ON \"t69\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t67\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61922",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61922,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "AGGREGATE" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t66\" ON \"t64\".\"MOVIE_ID\" = \"t66\".\"MOVIE_ID\") AS \"t68\"\nINNER JOIN (SELECT \"t72\".\"MOVIE_ID\", \"t72\".\"TITLE\", CASE WHEN \"t72\".\"COUNT\" IS NOT NULL THEN CAST(\"t72\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"s1\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"s1\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", \"t71\".\"PRODUCTION_YEAR\", \"t71\".\"RAN\", \"t70\".\"movie_id\" AS \"MOVIE_ID0\", \"t70\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t70\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t71\" ON \"t70\".\"movie_id\" = \"t71\".\"MOVIE_ID\") AS \"t72\"\nLEFT JOIN \"s1\" ON \"t72\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\") AS \"t73\" ON \"t68\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61920",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61920,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t72\" ON \"t71\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t67\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61958",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61958,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 128.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 2048.0,
        "transferEstimatedMs" : 72.96341654812377,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 8,
          "operatorKindCounts" : {
            "AGGREGATE" : 3,
            "JOIN" : 3,
            "OTHER" : 9
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 124,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 27,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"PRODUCTION_YEAR\", \"t2\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", AVG(CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"FD_COL_1\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"\nGROUP BY \"t2\".\"PRODUCTION_YEAR\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t50\".\"MOVIE_ID\", \"t50\".\"TITLE\", \"t50\".\"PRODUCTION_YEAR\", \"t50\".\"CAST_COUNT\", \"t50\".\"MOVIE_KEYWORDS\", \"t50\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t23\".\"MOVIE_ID\", \"t23\".\"TITLE\", \"t23\".\"CAST_COUNT\", \"t23\".\"MOVIE_KEYWORDS\", \"t23\".\"PRODUCTION_YEAR\", \"t49\".\"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t15\"\nINNER JOIN (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t21\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t21\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t22\" ON \"t15\".\"EXPR$0\" < \"t22\".\"CAST_COUNT\") AS \"t23\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t38\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t31\"\nINNER JOIN (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", CASE WHEN \"t35\".\"COUNT\" IS NOT NULL THEN CAST(\"t35\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t37\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t37\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t35\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", \"t34\".\"PRODUCTION_YEAR\", \"t34\".\"RAN\", \"t33\".\"movie_id\" AS \"MOVIE_ID0\", \"t33\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t33\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t34\" ON \"t33\".\"movie_id\" = \"t34\".\"MOVIE_ID\") AS \"t35\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t37\" ON \"t35\".\"MOVIE_ID\" = \"t37\".\"MOVIE_ID\") AS \"t38\" ON \"t31\".\"EXPR$0\" < \"t38\".\"CAST_COUNT\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t40\"\nLEFT JOIN (SELECT \"t44\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t44\".\"COUNT\" IS NOT NULL THEN CAST(\"t44\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"RAN\", \"t42\".\"movie_id\" AS \"MOVIE_ID0\", \"t42\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t42\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t43\" ON \"t42\".\"movie_id\" = \"t43\".\"MOVIE_ID\") AS \"t44\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t46\" ON \"t44\".\"MOVIE_ID\" = \"t46\".\"MOVIE_ID\"\nGROUP BY \"t44\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t40\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t48\".\"PRODUCTION_YEAR\") AS \"t49\" ON \"t23\".\"PRODUCTION_YEAR\" = \"t49\".\"PRODUCTION_YEAR\") AS \"t50\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t66\".\"MOVIE_ID\"\nFROM (SELECT \"t65\".\"MOVIE_ID\", \"t65\".\"TITLE\", \"t65\".\"CAST_COUNT\", \"t65\".\"MOVIE_KEYWORDS\", \"t65\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t58\"\nINNER JOIN (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t64\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t64\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t62\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t65\" ON \"t58\".\"EXPR$0\" < \"t65\".\"CAST_COUNT\") AS \"t66\"\nLEFT JOIN (SELECT \"t83\".\"PRODUCTION_YEAR\", \"s1\".\"FD_COL_1\" AS \"EXPR$0\"\nFROM (SELECT \"t81\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t74\"\nINNER JOIN (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", CASE WHEN \"t78\".\"COUNT\" IS NOT NULL THEN CAST(\"t78\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t80\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t80\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t78\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t77\".\"MOVIE_ID\", \"t77\".\"TITLE\", \"t77\".\"PRODUCTION_YEAR\", \"t77\".\"RAN\", \"t76\".\"movie_id\" AS \"MOVIE_ID0\", \"t76\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t76\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t77\" ON \"t76\".\"movie_id\" = \"t77\".\"MOVIE_ID\") AS \"t78\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t80\" ON \"t78\".\"MOVIE_ID\" = \"t80\".\"MOVIE_ID\") AS \"t81\" ON \"t74\".\"EXPR$0\" < \"t81\".\"CAST_COUNT\"\nGROUP BY \"t81\".\"PRODUCTION_YEAR\") AS \"t83\"\nLEFT JOIN \"s1\" ON \"t83\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"s1\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t66\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t66\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t50\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t50\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t50\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61956",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61956,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1445886.173561445,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 3.099670964506055E8,
        "transferEstimatedMs" : 310.8691122611987,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 14,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "AGGREGATE" : 2,
            "JOIN" : 3,
            "OTHER" : 9
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 125,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "JOIN" : 38,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t2\".\"PRODUCTION_YEAR\", \"t2\".\"PRODUCTION_YEAR\") AS \"PRODUCTION_YEAR\", CASE WHEN \"t2\".\"COUNT\" IS NOT NULL THEN CAST(\"t2\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t4\" ON \"t2\".\"MOVIE_ID\" = \"t4\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"CAST_COUNT\", \"t49\".\"MOVIE_KEYWORDS\", \"t49\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"CAST_COUNT\", \"t22\".\"MOVIE_KEYWORDS\", \"t22\".\"PRODUCTION_YEAR\", \"t48\".\"EXPR$0\"\nFROM (SELECT \"t21\".\"MOVIE_ID\", \"t21\".\"TITLE\", \"t21\".\"CAST_COUNT\", \"t21\".\"MOVIE_KEYWORDS\", \"t21\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t10\".\"COUNT\" IS NOT NULL THEN CAST(\"t10\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"t8\".\"movie_id\" AS \"MOVIE_ID0\", \"t8\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t8\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" ON \"t8\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t12\" ON \"t10\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\") AS \"t14\"\nINNER JOIN (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", CASE WHEN \"t18\".\"COUNT\" IS NOT NULL THEN CAST(\"t18\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t20\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", \"t17\".\"RAN\", \"t16\".\"movie_id\" AS \"MOVIE_ID0\", \"t16\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t16\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t17\" ON \"t16\".\"movie_id\" = \"t17\".\"MOVIE_ID\") AS \"t18\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t20\" ON \"t18\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\") AS \"t21\" ON \"t14\".\"EXPR$0\" < \"t21\".\"CAST_COUNT\") AS \"t22\"\nLEFT JOIN (SELECT \"t39\".\"PRODUCTION_YEAR\", \"t47\".\"EXPR$0\"\nFROM (SELECT \"t37\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t26\".\"COUNT\" IS NOT NULL THEN CAST(\"t26\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t25\".\"MOVIE_ID\", \"t25\".\"TITLE\", \"t25\".\"PRODUCTION_YEAR\", \"t25\".\"RAN\", \"t24\".\"movie_id\" AS \"MOVIE_ID0\", \"t24\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t24\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t25\" ON \"t24\".\"movie_id\" = \"t25\".\"MOVIE_ID\") AS \"t26\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t28\" ON \"t26\".\"MOVIE_ID\" = \"t28\".\"MOVIE_ID\") AS \"t30\"\nINNER JOIN (SELECT \"t34\".\"MOVIE_ID\", \"t34\".\"TITLE\", CASE WHEN \"t34\".\"COUNT\" IS NOT NULL THEN CAST(\"t34\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t36\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t36\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t33\".\"MOVIE_ID\", \"t33\".\"TITLE\", \"t33\".\"PRODUCTION_YEAR\", \"t33\".\"RAN\", \"t32\".\"movie_id\" AS \"MOVIE_ID0\", \"t32\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t32\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t33\" ON \"t32\".\"movie_id\" = \"t33\".\"MOVIE_ID\") AS \"t34\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t36\" ON \"t34\".\"MOVIE_ID\" = \"t36\".\"MOVIE_ID\") AS \"t37\" ON \"t30\".\"EXPR$0\" < \"t37\".\"CAST_COUNT\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t39\"\nLEFT JOIN (SELECT \"t43\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t43\".\"COUNT\" IS NOT NULL THEN CAST(\"t43\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"RAN\", \"t41\".\"movie_id\" AS \"MOVIE_ID0\", \"t41\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t41\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t42\" ON \"t41\".\"movie_id\" = \"t42\".\"MOVIE_ID\") AS \"t43\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t45\" ON \"t43\".\"MOVIE_ID\" = \"t45\".\"MOVIE_ID\"\nGROUP BY \"t43\".\"PRODUCTION_YEAR\") AS \"t47\" ON \"t39\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t47\".\"PRODUCTION_YEAR\") AS \"t48\" ON \"t22\".\"PRODUCTION_YEAR\" = \"t48\".\"PRODUCTION_YEAR\") AS \"t49\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\"\nFROM (SELECT \"t64\".\"MOVIE_ID\", \"t64\".\"TITLE\", \"t64\".\"CAST_COUNT\", \"t64\".\"MOVIE_KEYWORDS\", \"t64\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t53\".\"COUNT\" IS NOT NULL THEN CAST(\"t53\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t52\".\"MOVIE_ID\", \"t52\".\"TITLE\", \"t52\".\"PRODUCTION_YEAR\", \"t52\".\"RAN\", \"t51\".\"movie_id\" AS \"MOVIE_ID0\", \"t51\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t51\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t52\" ON \"t51\".\"movie_id\" = \"t52\".\"MOVIE_ID\") AS \"t53\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t55\" ON \"t53\".\"MOVIE_ID\" = \"t55\".\"MOVIE_ID\") AS \"t57\"\nINNER JOIN (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", CASE WHEN \"t61\".\"COUNT\" IS NOT NULL THEN CAST(\"t61\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t63\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t63\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t60\".\"MOVIE_ID\", \"t60\".\"TITLE\", \"t60\".\"PRODUCTION_YEAR\", \"t60\".\"RAN\", \"t59\".\"movie_id\" AS \"MOVIE_ID0\", \"t59\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t59\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t60\" ON \"t59\".\"movie_id\" = \"t60\".\"MOVIE_ID\") AS \"t61\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t63\" ON \"t61\".\"MOVIE_ID\" = \"t63\".\"MOVIE_ID\") AS \"t64\" ON \"t57\".\"EXPR$0\" < \"t64\".\"CAST_COUNT\") AS \"t65\"\nLEFT JOIN (SELECT \"t82\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t80\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t69\".\"COUNT\" IS NOT NULL THEN CAST(\"t69\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t68\".\"MOVIE_ID\", \"t68\".\"TITLE\", \"t68\".\"PRODUCTION_YEAR\", \"t68\".\"RAN\", \"t67\".\"movie_id\" AS \"MOVIE_ID0\", \"t67\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t67\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t68\" ON \"t67\".\"movie_id\" = \"t68\".\"MOVIE_ID\") AS \"t69\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t71\" ON \"t69\".\"MOVIE_ID\" = \"t71\".\"MOVIE_ID\") AS \"t73\"\nINNER JOIN (SELECT \"t77\".\"MOVIE_ID\", \"t77\".\"TITLE\", CASE WHEN \"t77\".\"COUNT\" IS NOT NULL THEN CAST(\"t77\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t79\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t79\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t77\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t76\".\"MOVIE_ID\", \"t76\".\"TITLE\", \"t76\".\"PRODUCTION_YEAR\", \"t76\".\"RAN\", \"t75\".\"movie_id\" AS \"MOVIE_ID0\", \"t75\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t75\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t76\" ON \"t75\".\"movie_id\" = \"t76\".\"MOVIE_ID\") AS \"t77\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t79\" ON \"t77\".\"MOVIE_ID\" = \"t79\".\"MOVIE_ID\") AS \"t80\" ON \"t73\".\"EXPR$0\" < \"t80\".\"CAST_COUNT\"\nGROUP BY \"t80\".\"PRODUCTION_YEAR\") AS \"t82\"\nLEFT JOIN (SELECT \"PRODUCTION_YEAR\", AVG(\"CAST_COUNT\") AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"PRODUCTION_YEAR\") AS \"t83\" ON \"t82\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t65\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t65\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t49\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t49\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t49\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61944",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61944,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722943.8449683287,
        "cutRowSizeOutBytes" : 198.37862960339945,
        "cutOutputBytes" : 1.434166092450295E8,
        "transferEstimatedMs" : 187.60780350839389,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 5,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 132,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"MOVIE_ID\", \"t1\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"t0\".\"movie_id\" AS \"MOVIE_ID0\", \"t0\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t0\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" ON \"t0\".\"movie_id\" = \"t1\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"CAST_COUNT\", \"t46\".\"MOVIE_KEYWORDS\", \"t46\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"CAST_COUNT\", \"t19\".\"MOVIE_KEYWORDS\", \"t19\".\"PRODUCTION_YEAR\", \"t45\".\"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"CAST_COUNT\", \"t18\".\"MOVIE_KEYWORDS\", \"t18\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t7\".\"COUNT\" IS NOT NULL THEN CAST(\"t7\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t6\".\"MOVIE_ID\", \"t6\".\"TITLE\", \"t6\".\"PRODUCTION_YEAR\", \"t6\".\"RAN\", \"t5\".\"movie_id\" AS \"MOVIE_ID0\", \"t5\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t5\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t6\" ON \"t5\".\"movie_id\" = \"t6\".\"MOVIE_ID\") AS \"t7\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t9\" ON \"t7\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\") AS \"t11\"\nINNER JOIN (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", CASE WHEN \"t15\".\"COUNT\" IS NOT NULL THEN CAST(\"t15\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t17\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"t13\".\"movie_id\" AS \"MOVIE_ID0\", \"t13\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t13\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" ON \"t13\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t17\" ON \"t15\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"EXPR$0\" < \"t18\".\"CAST_COUNT\") AS \"t19\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", \"t44\".\"EXPR$0\"\nFROM (SELECT \"t34\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t23\".\"COUNT\" IS NOT NULL THEN CAST(\"t23\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"MOVIE_ID\", \"t22\".\"TITLE\", \"t22\".\"PRODUCTION_YEAR\", \"t22\".\"RAN\", \"t21\".\"movie_id\" AS \"MOVIE_ID0\", \"t21\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t21\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t22\" ON \"t21\".\"movie_id\" = \"t22\".\"MOVIE_ID\") AS \"t23\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t25\" ON \"t23\".\"MOVIE_ID\" = \"t25\".\"MOVIE_ID\") AS \"t27\"\nINNER JOIN (SELECT \"t31\".\"MOVIE_ID\", \"t31\".\"TITLE\", CASE WHEN \"t31\".\"COUNT\" IS NOT NULL THEN CAST(\"t31\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t33\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t33\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t30\".\"MOVIE_ID\", \"t30\".\"TITLE\", \"t30\".\"PRODUCTION_YEAR\", \"t30\".\"RAN\", \"t29\".\"movie_id\" AS \"MOVIE_ID0\", \"t29\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t29\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t30\" ON \"t29\".\"movie_id\" = \"t30\".\"MOVIE_ID\") AS \"t31\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t33\" ON \"t31\".\"MOVIE_ID\" = \"t33\".\"MOVIE_ID\") AS \"t34\" ON \"t27\".\"EXPR$0\" < \"t34\".\"CAST_COUNT\"\nGROUP BY \"t34\".\"PRODUCTION_YEAR\") AS \"t36\"\nLEFT JOIN (SELECT \"t40\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t40\".\"COUNT\" IS NOT NULL THEN CAST(\"t40\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"MOVIE_ID\", \"t39\".\"TITLE\", \"t39\".\"PRODUCTION_YEAR\", \"t39\".\"RAN\", \"t38\".\"movie_id\" AS \"MOVIE_ID0\", \"t38\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t38\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t39\" ON \"t38\".\"movie_id\" = \"t39\".\"MOVIE_ID\") AS \"t40\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t42\" ON \"t40\".\"MOVIE_ID\" = \"t42\".\"MOVIE_ID\"\nGROUP BY \"t40\".\"PRODUCTION_YEAR\") AS \"t44\" ON \"t36\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t44\".\"PRODUCTION_YEAR\") AS \"t45\" ON \"t19\".\"PRODUCTION_YEAR\" = \"t45\".\"PRODUCTION_YEAR\") AS \"t46\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"CAST_COUNT\", \"t61\".\"MOVIE_KEYWORDS\", \"t61\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t50\".\"COUNT\" IS NOT NULL THEN CAST(\"t50\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t49\".\"MOVIE_ID\", \"t49\".\"TITLE\", \"t49\".\"PRODUCTION_YEAR\", \"t49\".\"RAN\", \"t48\".\"movie_id\" AS \"MOVIE_ID0\", \"t48\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t48\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t49\" ON \"t48\".\"movie_id\" = \"t49\".\"MOVIE_ID\") AS \"t50\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t52\" ON \"t50\".\"MOVIE_ID\" = \"t52\".\"MOVIE_ID\") AS \"t54\"\nINNER JOIN (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", CASE WHEN \"t58\".\"COUNT\" IS NOT NULL THEN CAST(\"t58\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t60\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t60\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"PRODUCTION_YEAR\", \"t57\".\"RAN\", \"t56\".\"movie_id\" AS \"MOVIE_ID0\", \"t56\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t56\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t57\" ON \"t56\".\"movie_id\" = \"t57\".\"MOVIE_ID\") AS \"t58\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t60\" ON \"t58\".\"MOVIE_ID\" = \"t60\".\"MOVIE_ID\") AS \"t61\" ON \"t54\".\"EXPR$0\" < \"t61\".\"CAST_COUNT\") AS \"t62\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t77\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t66\".\"COUNT\" IS NOT NULL THEN CAST(\"t66\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"MOVIE_ID\", \"t65\".\"TITLE\", \"t65\".\"PRODUCTION_YEAR\", \"t65\".\"RAN\", \"t64\".\"movie_id\" AS \"MOVIE_ID0\", \"t64\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t64\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t65\" ON \"t64\".\"movie_id\" = \"t65\".\"MOVIE_ID\") AS \"t66\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t68\" ON \"t66\".\"MOVIE_ID\" = \"t68\".\"MOVIE_ID\") AS \"t70\"\nINNER JOIN (SELECT \"t74\".\"MOVIE_ID\", \"t74\".\"TITLE\", CASE WHEN \"t74\".\"COUNT\" IS NOT NULL THEN CAST(\"t74\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t76\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t76\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t73\".\"MOVIE_ID\", \"t73\".\"TITLE\", \"t73\".\"PRODUCTION_YEAR\", \"t73\".\"RAN\", \"t72\".\"movie_id\" AS \"MOVIE_ID0\", \"t72\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t72\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t73\" ON \"t72\".\"movie_id\" = \"t73\".\"MOVIE_ID\") AS \"t74\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t76\" ON \"t74\".\"MOVIE_ID\" = \"t76\".\"MOVIE_ID\") AS \"t77\" ON \"t70\".\"EXPR$0\" < \"t77\".\"CAST_COUNT\"\nGROUP BY \"t77\".\"PRODUCTION_YEAR\") AS \"t79\"\nLEFT JOIN (SELECT \"s1\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"s1\".\"COUNT\" IS NOT NULL THEN CAST(\"s1\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"s1\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"s1\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t79\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t62\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t62\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t46\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t46\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t46\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61937",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61937,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331601.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.7305616E7,
        "transferEstimatedMs" : 280.55626967370785,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 29,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "COUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t77\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t75\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t66\" ON \"t64\".\"MOVIE_ID\" = \"t66\".\"MOVIE_ID\") AS \"t68\"\nINNER JOIN (SELECT \"t72\".\"MOVIE_ID\", \"t72\".\"TITLE\", CASE WHEN \"t72\".\"COUNT\" IS NOT NULL THEN CAST(\"t72\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t74\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t74\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", \"t71\".\"PRODUCTION_YEAR\", \"t71\".\"RAN\", \"t70\".\"movie_id\" AS \"MOVIE_ID0\", \"t70\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t70\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t71\" ON \"t70\".\"movie_id\" = \"t71\".\"MOVIE_ID\") AS \"t72\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t74\" ON \"t72\".\"MOVIE_ID\" = \"t74\".\"MOVIE_ID\") AS \"t75\" ON \"t68\".\"EXPR$0\" < \"t75\".\"CAST_COUNT\"\nGROUP BY \"t75\".\"PRODUCTION_YEAR\") AS \"t77\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"s1\".\"movie_id\" AS \"MOVIE_ID0\", \"s1\".\"COUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"s1\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t77\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61935",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61935,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 3952.555892314364,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 137,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_id\", \"movie_id\") AS \"movie_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t76\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\"\nGROUP BY \"t74\".\"PRODUCTION_YEAR\") AS \"t76\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t76\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61952",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61952,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 476757.8888298323,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 7628126.221277317,
        "transferEstimatedMs" : 115.40223462884562,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "KEYWORDS",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t77\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t75\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t66\" ON \"t64\".\"MOVIE_ID\" = \"t66\".\"MOVIE_ID\") AS \"t68\"\nINNER JOIN (SELECT \"t72\".\"MOVIE_ID\", \"t72\".\"TITLE\", CASE WHEN \"t72\".\"COUNT\" IS NOT NULL THEN CAST(\"t72\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t74\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t74\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", \"t71\".\"PRODUCTION_YEAR\", \"t71\".\"RAN\", \"t70\".\"movie_id\" AS \"MOVIE_ID0\", \"t70\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t70\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t71\" ON \"t70\".\"movie_id\" = \"t71\".\"MOVIE_ID\") AS \"t72\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t74\" ON \"t72\".\"MOVIE_ID\" = \"t74\".\"MOVIE_ID\") AS \"t75\" ON \"t68\".\"EXPR$0\" < \"t75\".\"CAST_COUNT\"\nGROUP BY \"t75\".\"PRODUCTION_YEAR\") AS \"t77\"\nLEFT JOIN (SELECT \"t81\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t81\".\"COUNT\" IS NOT NULL THEN CAST(\"t81\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"MOVIE_ID\", \"t80\".\"TITLE\", \"t80\".\"PRODUCTION_YEAR\", \"t80\".\"RAN\", \"t79\".\"movie_id\" AS \"MOVIE_ID0\", \"t79\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t79\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t80\" ON \"t79\".\"movie_id\" = \"t80\".\"MOVIE_ID\") AS \"t81\"\nLEFT JOIN \"s1\" ON \"t81\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\"\nGROUP BY \"t81\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t77\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61950",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61950,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 79.16042520682717,
        "cutOutputBytes" : 3.5811622240592164E8,
        "transferEstimatedMs" : 584.3703759877537,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"movie_keyword\".\"movie_id\", \"movie_keyword\".\"movie_id\") AS \"MOVIE_ID\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_2\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_2",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t76\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\"\nGROUP BY \"t74\".\"PRODUCTION_YEAR\") AS \"t76\"\nLEFT JOIN (SELECT \"t80\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t80\".\"COUNT\" IS NOT NULL THEN CAST(\"t80\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"MOVIE_ID\", \"t79\".\"TITLE\", \"t79\".\"PRODUCTION_YEAR\", \"t79\".\"RAN\", \"t78\".\"movie_id\" AS \"MOVIE_ID0\", \"t78\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t78\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t79\" ON \"t78\".\"movie_id\" = \"t79\".\"MOVIE_ID\") AS \"t80\"\nLEFT JOIN (SELECT \"MOVIE_ID\", LISTAGG(\"keyword\", \"FD_COL_2\") AS \"KEYWORDS\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t81\" ON \"t80\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t80\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t76\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"person_info\" ON \"cast_info9\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61976",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61976,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2331574.1055248044,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.730518568839687E7,
        "transferEstimatedMs" : 280.55387500697174,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 5,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 134,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 29,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"cast_info\".\"movie_id\", \"cast_info\".\"movie_id\") AS \"movie_id\", COUNT(DISTINCT \"person_info\".\"id\") AS \"FD_COL_1\"\nFROM \"cast_info\"\nINNER JOIN \"person_info\" ON \"cast_info\".\"person_id\" = \"person_info\".\"person_id\"\nGROUP BY \"cast_info\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t44\".\"MOVIE_ID\", \"t44\".\"TITLE\", \"t44\".\"PRODUCTION_YEAR\", \"t44\".\"CAST_COUNT\", \"t44\".\"MOVIE_KEYWORDS\", \"t44\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t17\".\"MOVIE_ID\", \"t17\".\"TITLE\", \"t17\".\"CAST_COUNT\", \"t17\".\"MOVIE_KEYWORDS\", \"t17\".\"PRODUCTION_YEAR\", \"t43\".\"EXPR$0\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t5\".\"COUNT\" IS NOT NULL THEN CAST(\"t5\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"t3\".\"movie_id\" AS \"MOVIE_ID0\", \"t3\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t3\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" ON \"t3\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t7\" ON \"t5\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\") AS \"t9\"\nINNER JOIN (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", CASE WHEN \"t13\".\"COUNT\" IS NOT NULL THEN CAST(\"t13\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t15\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t15\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t13\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"t11\".\"movie_id\" AS \"MOVIE_ID0\", \"t11\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t11\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" ON \"t11\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t15\" ON \"t13\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\") AS \"t16\" ON \"t9\".\"EXPR$0\" < \"t16\".\"CAST_COUNT\") AS \"t17\"\nLEFT JOIN (SELECT \"t34\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t32\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t21\".\"COUNT\" IS NOT NULL THEN CAST(\"t21\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"MOVIE_ID\", \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", \"t20\".\"RAN\", \"t19\".\"movie_id\" AS \"MOVIE_ID0\", \"t19\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t19\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t20\" ON \"t19\".\"movie_id\" = \"t20\".\"MOVIE_ID\") AS \"t21\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t23\" ON \"t21\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\") AS \"t25\"\nINNER JOIN (SELECT \"t29\".\"MOVIE_ID\", \"t29\".\"TITLE\", CASE WHEN \"t29\".\"COUNT\" IS NOT NULL THEN CAST(\"t29\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t31\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t31\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t29\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", \"t28\".\"PRODUCTION_YEAR\", \"t28\".\"RAN\", \"t27\".\"movie_id\" AS \"MOVIE_ID0\", \"t27\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t27\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t28\" ON \"t27\".\"movie_id\" = \"t28\".\"MOVIE_ID\") AS \"t29\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t31\" ON \"t29\".\"MOVIE_ID\" = \"t31\".\"MOVIE_ID\") AS \"t32\" ON \"t25\".\"EXPR$0\" < \"t32\".\"CAST_COUNT\"\nGROUP BY \"t32\".\"PRODUCTION_YEAR\") AS \"t34\"\nLEFT JOIN (SELECT \"t38\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t38\".\"COUNT\" IS NOT NULL THEN CAST(\"t38\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"MOVIE_ID\", \"t37\".\"TITLE\", \"t37\".\"PRODUCTION_YEAR\", \"t37\".\"RAN\", \"t36\".\"movie_id\" AS \"MOVIE_ID0\", \"t36\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t36\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t37\" ON \"t36\".\"movie_id\" = \"t37\".\"MOVIE_ID\") AS \"t38\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t40\" ON \"t38\".\"MOVIE_ID\" = \"t40\".\"MOVIE_ID\"\nGROUP BY \"t38\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t34\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t42\".\"PRODUCTION_YEAR\") AS \"t43\" ON \"t17\".\"PRODUCTION_YEAR\" = \"t43\".\"PRODUCTION_YEAR\") AS \"t44\"\nLEFT JOIN (SELECT \"t88\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t60\".\"MOVIE_ID\"\nFROM (SELECT \"t59\".\"MOVIE_ID\", \"t59\".\"TITLE\", \"t59\".\"CAST_COUNT\", \"t59\".\"MOVIE_KEYWORDS\", \"t59\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t48\".\"COUNT\" IS NOT NULL THEN CAST(\"t48\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"MOVIE_ID\", \"t47\".\"TITLE\", \"t47\".\"PRODUCTION_YEAR\", \"t47\".\"RAN\", \"t46\".\"movie_id\" AS \"MOVIE_ID0\", \"t46\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t46\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t47\" ON \"t46\".\"movie_id\" = \"t47\".\"MOVIE_ID\") AS \"t48\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t50\" ON \"t48\".\"MOVIE_ID\" = \"t50\".\"MOVIE_ID\") AS \"t52\"\nINNER JOIN (SELECT \"t56\".\"MOVIE_ID\", \"t56\".\"TITLE\", CASE WHEN \"t56\".\"COUNT\" IS NOT NULL THEN CAST(\"t56\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t58\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t58\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t56\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", \"t55\".\"PRODUCTION_YEAR\", \"t55\".\"RAN\", \"t54\".\"movie_id\" AS \"MOVIE_ID0\", \"t54\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t54\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t55\" ON \"t54\".\"movie_id\" = \"t55\".\"MOVIE_ID\") AS \"t56\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t58\" ON \"t56\".\"MOVIE_ID\" = \"t58\".\"MOVIE_ID\") AS \"t59\" ON \"t52\".\"EXPR$0\" < \"t59\".\"CAST_COUNT\") AS \"t60\"\nLEFT JOIN (SELECT \"t77\".\"PRODUCTION_YEAR\", \"t85\".\"EXPR$0\"\nFROM (SELECT \"t75\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t64\".\"COUNT\" IS NOT NULL THEN CAST(\"t64\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t63\".\"MOVIE_ID\", \"t63\".\"TITLE\", \"t63\".\"PRODUCTION_YEAR\", \"t63\".\"RAN\", \"t62\".\"movie_id\" AS \"MOVIE_ID0\", \"t62\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t62\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t63\" ON \"t62\".\"movie_id\" = \"t63\".\"MOVIE_ID\") AS \"t64\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t66\" ON \"t64\".\"MOVIE_ID\" = \"t66\".\"MOVIE_ID\") AS \"t68\"\nINNER JOIN (SELECT \"t72\".\"MOVIE_ID\", \"t72\".\"TITLE\", CASE WHEN \"t72\".\"COUNT\" IS NOT NULL THEN CAST(\"t72\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t74\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t74\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t72\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", \"t71\".\"PRODUCTION_YEAR\", \"t71\".\"RAN\", \"t70\".\"movie_id\" AS \"MOVIE_ID0\", \"t70\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t70\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t71\" ON \"t70\".\"movie_id\" = \"t71\".\"MOVIE_ID\") AS \"t72\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t74\" ON \"t72\".\"MOVIE_ID\" = \"t74\".\"MOVIE_ID\") AS \"t75\" ON \"t68\".\"EXPR$0\" < \"t75\".\"CAST_COUNT\"\nGROUP BY \"t75\".\"PRODUCTION_YEAR\") AS \"t77\"\nLEFT JOIN (SELECT \"t81\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t81\".\"COUNT\" IS NOT NULL THEN CAST(\"t81\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"MOVIE_ID\", \"t80\".\"TITLE\", \"t80\".\"PRODUCTION_YEAR\", \"t80\".\"RAN\", \"t79\".\"movie_id\" AS \"MOVIE_ID0\", \"t79\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t79\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t80\" ON \"t79\".\"movie_id\" = \"t80\".\"MOVIE_ID\") AS \"t81\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t83\" ON \"t81\".\"MOVIE_ID\" = \"t83\".\"MOVIE_ID\"\nGROUP BY \"t81\".\"PRODUCTION_YEAR\") AS \"t85\" ON \"t77\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t85\".\"PRODUCTION_YEAR\") AS \"t86\" ON \"t60\".\"PRODUCTION_YEAR\" = \"t86\".\"PRODUCTION_YEAR\"\nGROUP BY \"t60\".\"MOVIE_ID\") AS \"t88\"\nLEFT JOIN \"s1\" ON \"t88\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"s1\".\"movie_id\") AS \"t89\" ON \"t44\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t44\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t44\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61974",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61974,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 7,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.651063537441687E7,
        "cutRowSizeOutBytes" : 227.8321465069293,
        "cutOutputBytes" : 6.039974962615927E9,
        "transferEstimatedMs" : 4566.946756065809,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 135,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "AGGREGATE" : 30,
            "JOIN" : 40,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"cast_info\".\"movie_id\", \"cast_info\".\"movie_id\") AS \"movie_id\", \"person_info\".\"id\" AS \"id0\"\nFROM \"cast_info\"\nINNER JOIN \"person_info\" ON \"cast_info\".\"person_id\" = \"person_info\".\"person_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t43\".\"MOVIE_ID\", \"t43\".\"TITLE\", \"t43\".\"PRODUCTION_YEAR\", \"t43\".\"CAST_COUNT\", \"t43\".\"MOVIE_KEYWORDS\", \"t43\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"CAST_COUNT\", \"t16\".\"MOVIE_KEYWORDS\", \"t16\".\"PRODUCTION_YEAR\", \"t42\".\"EXPR$0\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t4\".\"COUNT\" IS NOT NULL THEN CAST(\"t4\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"t2\".\"movie_id\" AS \"MOVIE_ID0\", \"t2\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t2\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" ON \"t2\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t6\" ON \"t4\".\"MOVIE_ID\" = \"t6\".\"MOVIE_ID\") AS \"t8\"\nINNER JOIN (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", CASE WHEN \"t12\".\"COUNT\" IS NOT NULL THEN CAST(\"t12\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t14\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t14\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t12\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"t10\".\"movie_id\" AS \"MOVIE_ID0\", \"t10\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t10\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" ON \"t10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t14\" ON \"t12\".\"MOVIE_ID\" = \"t14\".\"MOVIE_ID\") AS \"t15\" ON \"t8\".\"EXPR$0\" < \"t15\".\"CAST_COUNT\") AS \"t16\"\nLEFT JOIN (SELECT \"t33\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t31\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t20\".\"COUNT\" IS NOT NULL THEN CAST(\"t20\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"MOVIE_ID\", \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", \"t19\".\"RAN\", \"t18\".\"movie_id\" AS \"MOVIE_ID0\", \"t18\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t18\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t19\" ON \"t18\".\"movie_id\" = \"t19\".\"MOVIE_ID\") AS \"t20\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t22\" ON \"t20\".\"MOVIE_ID\" = \"t22\".\"MOVIE_ID\") AS \"t24\"\nINNER JOIN (SELECT \"t28\".\"MOVIE_ID\", \"t28\".\"TITLE\", CASE WHEN \"t28\".\"COUNT\" IS NOT NULL THEN CAST(\"t28\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t30\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t30\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t28\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", \"t27\".\"PRODUCTION_YEAR\", \"t27\".\"RAN\", \"t26\".\"movie_id\" AS \"MOVIE_ID0\", \"t26\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t26\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t27\" ON \"t26\".\"movie_id\" = \"t27\".\"MOVIE_ID\") AS \"t28\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t30\" ON \"t28\".\"MOVIE_ID\" = \"t30\".\"MOVIE_ID\") AS \"t31\" ON \"t24\".\"EXPR$0\" < \"t31\".\"CAST_COUNT\"\nGROUP BY \"t31\".\"PRODUCTION_YEAR\") AS \"t33\"\nLEFT JOIN (SELECT \"t37\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t37\".\"COUNT\" IS NOT NULL THEN CAST(\"t37\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"MOVIE_ID\", \"t36\".\"TITLE\", \"t36\".\"PRODUCTION_YEAR\", \"t36\".\"RAN\", \"t35\".\"movie_id\" AS \"MOVIE_ID0\", \"t35\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t35\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t36\" ON \"t35\".\"movie_id\" = \"t36\".\"MOVIE_ID\") AS \"t37\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t39\" ON \"t37\".\"MOVIE_ID\" = \"t39\".\"MOVIE_ID\"\nGROUP BY \"t37\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t33\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t41\".\"PRODUCTION_YEAR\") AS \"t42\" ON \"t16\".\"PRODUCTION_YEAR\" = \"t42\".\"PRODUCTION_YEAR\") AS \"t43\"\nLEFT JOIN (SELECT \"t87\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t59\".\"MOVIE_ID\"\nFROM (SELECT \"t58\".\"MOVIE_ID\", \"t58\".\"TITLE\", \"t58\".\"CAST_COUNT\", \"t58\".\"MOVIE_KEYWORDS\", \"t58\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t47\".\"COUNT\" IS NOT NULL THEN CAST(\"t47\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"MOVIE_ID\", \"t46\".\"TITLE\", \"t46\".\"PRODUCTION_YEAR\", \"t46\".\"RAN\", \"t45\".\"movie_id\" AS \"MOVIE_ID0\", \"t45\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t45\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t46\" ON \"t45\".\"movie_id\" = \"t46\".\"MOVIE_ID\") AS \"t47\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t49\" ON \"t47\".\"MOVIE_ID\" = \"t49\".\"MOVIE_ID\") AS \"t51\"\nINNER JOIN (SELECT \"t55\".\"MOVIE_ID\", \"t55\".\"TITLE\", CASE WHEN \"t55\".\"COUNT\" IS NOT NULL THEN CAST(\"t55\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t57\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t57\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t55\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", \"t54\".\"PRODUCTION_YEAR\", \"t54\".\"RAN\", \"t53\".\"movie_id\" AS \"MOVIE_ID0\", \"t53\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t53\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t54\" ON \"t53\".\"movie_id\" = \"t54\".\"MOVIE_ID\") AS \"t55\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t57\" ON \"t55\".\"MOVIE_ID\" = \"t57\".\"MOVIE_ID\") AS \"t58\" ON \"t51\".\"EXPR$0\" < \"t58\".\"CAST_COUNT\") AS \"t59\"\nLEFT JOIN (SELECT \"t76\".\"PRODUCTION_YEAR\", \"t84\".\"EXPR$0\"\nFROM (SELECT \"t74\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t63\".\"COUNT\" IS NOT NULL THEN CAST(\"t63\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t62\".\"MOVIE_ID\", \"t62\".\"TITLE\", \"t62\".\"PRODUCTION_YEAR\", \"t62\".\"RAN\", \"t61\".\"movie_id\" AS \"MOVIE_ID0\", \"t61\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t61\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t62\" ON \"t61\".\"movie_id\" = \"t62\".\"MOVIE_ID\") AS \"t63\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t65\" ON \"t63\".\"MOVIE_ID\" = \"t65\".\"MOVIE_ID\") AS \"t67\"\nINNER JOIN (SELECT \"t71\".\"MOVIE_ID\", \"t71\".\"TITLE\", CASE WHEN \"t71\".\"COUNT\" IS NOT NULL THEN CAST(\"t71\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t73\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t73\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t71\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", \"t70\".\"PRODUCTION_YEAR\", \"t70\".\"RAN\", \"t69\".\"movie_id\" AS \"MOVIE_ID0\", \"t69\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t69\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t70\" ON \"t69\".\"movie_id\" = \"t70\".\"MOVIE_ID\") AS \"t71\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t73\" ON \"t71\".\"MOVIE_ID\" = \"t73\".\"MOVIE_ID\") AS \"t74\" ON \"t67\".\"EXPR$0\" < \"t74\".\"CAST_COUNT\"\nGROUP BY \"t74\".\"PRODUCTION_YEAR\") AS \"t76\"\nLEFT JOIN (SELECT \"t80\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t80\".\"COUNT\" IS NOT NULL THEN CAST(\"t80\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"MOVIE_ID\", \"t79\".\"TITLE\", \"t79\".\"PRODUCTION_YEAR\", \"t79\".\"RAN\", \"t78\".\"movie_id\" AS \"MOVIE_ID0\", \"t78\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t78\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t79\" ON \"t78\".\"movie_id\" = \"t79\".\"MOVIE_ID\") AS \"t80\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t82\" ON \"t80\".\"MOVIE_ID\" = \"t82\".\"MOVIE_ID\"\nGROUP BY \"t80\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t76\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t84\".\"PRODUCTION_YEAR\") AS \"t85\" ON \"t59\".\"PRODUCTION_YEAR\" = \"t85\".\"PRODUCTION_YEAR\"\nGROUP BY \"t59\".\"MOVIE_ID\") AS \"t87\"\nLEFT JOIN (SELECT \"movie_id\", COUNT(DISTINCT \"id0\") AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"movie_id\") AS \"t88\" ON \"t87\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t43\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t43\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t43\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_61249",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 61249,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.9048627700424284E7,
      "costAllDatafusion" : 4741578.591467028,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "3afe353edd12726f19ece3f786a9fef24c088a246d597bbac1a325de1e355e62",
        "cutPolicy" : "DP",
        "randomSeed" : 1770194764338,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 176,
        "maxDepth" : 21,
        "operatorKindCounts" : {
          "OTHER" : 67,
          "AGGREGATE" : 30,
          "JOIN" : 41,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 270.3786296033994
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 2963664.0,
        "cutRowSizeOutBytes" : 164.4488477776158,
        "cutOutputBytes" : 4.8737113E8,
        "transferEstimatedMs" : 504.12185176761477,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 138,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "AGGREGATE" : 30,
            "JOIN" : 41,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"person_id\", \"info_type_id\", \"info\", \"note\"\nFROM \"person_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "info_type_id",
          "type" : "INTEGER"
        }, {
          "name" : "info",
          "type" : "VARCHAR"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t92\".\"MOVIE_ID\", \"t92\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t92\".\"TITLE\", \"t92\".\"PRODUCTION_YEAR\", \"t92\".\"CAST_COUNT\", \"t92\".\"MOVIE_KEYWORDS\", \"t92\".\"AVG_CAST_COUNT\", \"t92\".\"UNIQUE_ACTORS\"\nFROM (SELECT \"t42\".\"MOVIE_ID\", \"t42\".\"TITLE\", \"t42\".\"PRODUCTION_YEAR\", \"t42\".\"CAST_COUNT\", \"t42\".\"MOVIE_KEYWORDS\", \"t42\".\"EXPR$0\" AS \"AVG_CAST_COUNT\", CASE WHEN \"t89\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t89\".\"EXPR$0\" END AS \"UNIQUE_ACTORS\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"CAST_COUNT\", \"t15\".\"MOVIE_KEYWORDS\", \"t15\".\"PRODUCTION_YEAR\", \"t41\".\"EXPR$0\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"CAST_COUNT\", \"t14\".\"MOVIE_KEYWORDS\", \"t14\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t3\".\"COUNT\" IS NOT NULL THEN CAST(\"t3\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"t1\".\"movie_id\" AS \"MOVIE_ID0\", \"t1\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t1\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" ON \"t1\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN (SELECT \"movie_keyword\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\"\nINNER JOIN \"movie_keyword\" ON \"keyword\".\"id\" = \"movie_keyword\".\"keyword_id\"\nGROUP BY \"movie_keyword\".\"movie_id\") AS \"t5\" ON \"t3\".\"MOVIE_ID\" = \"t5\".\"MOVIE_ID\") AS \"t7\"\nINNER JOIN (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", CASE WHEN \"t11\".\"COUNT\" IS NOT NULL THEN CAST(\"t11\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t13\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t11\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"t9\".\"movie_id\" AS \"MOVIE_ID0\", \"t9\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t9\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" ON \"t9\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN (SELECT \"movie_keyword0\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword0\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword0\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword0\" ON \"keyword0\".\"id\" = \"movie_keyword0\".\"keyword_id\"\nGROUP BY \"movie_keyword0\".\"movie_id\") AS \"t13\" ON \"t11\".\"MOVIE_ID\" = \"t13\".\"MOVIE_ID\") AS \"t14\" ON \"t7\".\"EXPR$0\" < \"t14\".\"CAST_COUNT\") AS \"t15\"\nLEFT JOIN (SELECT \"t32\".\"PRODUCTION_YEAR\", \"t40\".\"EXPR$0\"\nFROM (SELECT \"t30\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t19\".\"COUNT\" IS NOT NULL THEN CAST(\"t19\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"MOVIE_ID\", \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", \"t18\".\"RAN\", \"t17\".\"movie_id\" AS \"MOVIE_ID0\", \"t17\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t17\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t18\" ON \"t17\".\"movie_id\" = \"t18\".\"MOVIE_ID\") AS \"t19\"\nLEFT JOIN (SELECT \"movie_keyword1\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword1\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword1\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword1\" ON \"keyword1\".\"id\" = \"movie_keyword1\".\"keyword_id\"\nGROUP BY \"movie_keyword1\".\"movie_id\") AS \"t21\" ON \"t19\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\") AS \"t23\"\nINNER JOIN (SELECT \"t27\".\"MOVIE_ID\", \"t27\".\"TITLE\", CASE WHEN \"t27\".\"COUNT\" IS NOT NULL THEN CAST(\"t27\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t29\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t29\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t27\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t26\".\"MOVIE_ID\", \"t26\".\"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"RAN\", \"t25\".\"movie_id\" AS \"MOVIE_ID0\", \"t25\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t25\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t26\" ON \"t25\".\"movie_id\" = \"t26\".\"MOVIE_ID\") AS \"t27\"\nLEFT JOIN (SELECT \"movie_keyword2\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword2\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword2\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword2\" ON \"keyword2\".\"id\" = \"movie_keyword2\".\"keyword_id\"\nGROUP BY \"movie_keyword2\".\"movie_id\") AS \"t29\" ON \"t27\".\"MOVIE_ID\" = \"t29\".\"MOVIE_ID\") AS \"t30\" ON \"t23\".\"EXPR$0\" < \"t30\".\"CAST_COUNT\"\nGROUP BY \"t30\".\"PRODUCTION_YEAR\") AS \"t32\"\nLEFT JOIN (SELECT \"t36\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t36\".\"COUNT\" IS NOT NULL THEN CAST(\"t36\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"MOVIE_ID\", \"t35\".\"TITLE\", \"t35\".\"PRODUCTION_YEAR\", \"t35\".\"RAN\", \"t34\".\"movie_id\" AS \"MOVIE_ID0\", \"t34\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t34\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t35\" ON \"t34\".\"movie_id\" = \"t35\".\"MOVIE_ID\") AS \"t36\"\nLEFT JOIN (SELECT \"movie_keyword3\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword3\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword3\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword3\" ON \"keyword3\".\"id\" = \"movie_keyword3\".\"keyword_id\"\nGROUP BY \"movie_keyword3\".\"movie_id\") AS \"t38\" ON \"t36\".\"MOVIE_ID\" = \"t38\".\"MOVIE_ID\"\nGROUP BY \"t36\".\"PRODUCTION_YEAR\") AS \"t40\" ON \"t32\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t40\".\"PRODUCTION_YEAR\") AS \"t41\" ON \"t15\".\"PRODUCTION_YEAR\" = \"t41\".\"PRODUCTION_YEAR\") AS \"t42\"\nLEFT JOIN (SELECT \"t86\".\"MOVIE_ID\" AS \"movie_id\", CASE WHEN \"t88\".\"EXPR$0\" IS NOT NULL THEN \"t88\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t58\".\"MOVIE_ID\"\nFROM (SELECT \"t57\".\"MOVIE_ID\", \"t57\".\"TITLE\", \"t57\".\"CAST_COUNT\", \"t57\".\"MOVIE_KEYWORDS\", \"t57\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t46\".\"COUNT\" IS NOT NULL THEN CAST(\"t46\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"MOVIE_ID\", \"t45\".\"TITLE\", \"t45\".\"PRODUCTION_YEAR\", \"t45\".\"RAN\", \"t44\".\"movie_id\" AS \"MOVIE_ID0\", \"t44\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t44\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t45\" ON \"t44\".\"movie_id\" = \"t45\".\"MOVIE_ID\") AS \"t46\"\nLEFT JOIN (SELECT \"movie_keyword4\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword4\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword4\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword4\" ON \"keyword4\".\"id\" = \"movie_keyword4\".\"keyword_id\"\nGROUP BY \"movie_keyword4\".\"movie_id\") AS \"t48\" ON \"t46\".\"MOVIE_ID\" = \"t48\".\"MOVIE_ID\") AS \"t50\"\nINNER JOIN (SELECT \"t54\".\"MOVIE_ID\", \"t54\".\"TITLE\", CASE WHEN \"t54\".\"COUNT\" IS NOT NULL THEN CAST(\"t54\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t56\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t56\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t54\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t53\".\"MOVIE_ID\", \"t53\".\"TITLE\", \"t53\".\"PRODUCTION_YEAR\", \"t53\".\"RAN\", \"t52\".\"movie_id\" AS \"MOVIE_ID0\", \"t52\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t52\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t53\" ON \"t52\".\"movie_id\" = \"t53\".\"MOVIE_ID\") AS \"t54\"\nLEFT JOIN (SELECT \"movie_keyword5\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword5\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword5\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword5\" ON \"keyword5\".\"id\" = \"movie_keyword5\".\"keyword_id\"\nGROUP BY \"movie_keyword5\".\"movie_id\") AS \"t56\" ON \"t54\".\"MOVIE_ID\" = \"t56\".\"MOVIE_ID\") AS \"t57\" ON \"t50\".\"EXPR$0\" < \"t57\".\"CAST_COUNT\") AS \"t58\"\nLEFT JOIN (SELECT \"t75\".\"PRODUCTION_YEAR\", \"t83\".\"EXPR$0\"\nFROM (SELECT \"t73\".\"PRODUCTION_YEAR\"\nFROM (SELECT AVG(CASE WHEN \"t62\".\"COUNT\" IS NOT NULL THEN CAST(\"t62\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"MOVIE_ID\", \"t61\".\"TITLE\", \"t61\".\"PRODUCTION_YEAR\", \"t61\".\"RAN\", \"t60\".\"movie_id\" AS \"MOVIE_ID0\", \"t60\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t60\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t61\" ON \"t60\".\"movie_id\" = \"t61\".\"MOVIE_ID\") AS \"t62\"\nLEFT JOIN (SELECT \"movie_keyword6\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword6\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword6\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword6\" ON \"keyword6\".\"id\" = \"movie_keyword6\".\"keyword_id\"\nGROUP BY \"movie_keyword6\".\"movie_id\") AS \"t64\" ON \"t62\".\"MOVIE_ID\" = \"t64\".\"MOVIE_ID\") AS \"t66\"\nINNER JOIN (SELECT \"t70\".\"MOVIE_ID\", \"t70\".\"TITLE\", CASE WHEN \"t70\".\"COUNT\" IS NOT NULL THEN CAST(\"t70\".\"COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t72\".\"KEYWORDS\" IS NOT NULL THEN CAST(\"t72\".\"KEYWORDS\" AS VARCHAR) ELSE '' END AS \"MOVIE_KEYWORDS\", \"t70\".\"PRODUCTION_YEAR\"\nFROM (SELECT \"t69\".\"MOVIE_ID\", \"t69\".\"TITLE\", \"t69\".\"PRODUCTION_YEAR\", \"t69\".\"RAN\", \"t68\".\"movie_id\" AS \"MOVIE_ID0\", \"t68\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t68\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t69\" ON \"t68\".\"movie_id\" = \"t69\".\"MOVIE_ID\") AS \"t70\"\nLEFT JOIN (SELECT \"movie_keyword7\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword7\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword7\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword7\" ON \"keyword7\".\"id\" = \"movie_keyword7\".\"keyword_id\"\nGROUP BY \"movie_keyword7\".\"movie_id\") AS \"t72\" ON \"t70\".\"MOVIE_ID\" = \"t72\".\"MOVIE_ID\") AS \"t73\" ON \"t66\".\"EXPR$0\" < \"t73\".\"CAST_COUNT\"\nGROUP BY \"t73\".\"PRODUCTION_YEAR\") AS \"t75\"\nLEFT JOIN (SELECT \"t79\".\"PRODUCTION_YEAR\", AVG(CASE WHEN \"t79\".\"COUNT\" IS NOT NULL THEN CAST(\"t79\".\"COUNT\" AS BIGINT) ELSE 0 END) AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"MOVIE_ID\", \"t78\".\"TITLE\", \"t78\".\"PRODUCTION_YEAR\", \"t78\".\"RAN\", \"t77\".\"movie_id\" AS \"MOVIE_ID0\", \"t77\".\"COUNT\"\nFROM (SELECT \"movie_id\", COUNT(*) AS \"COUNT\"\nFROM \"cast_info\"\nGROUP BY \"movie_id\") AS \"t77\"\nRIGHT JOIN (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"id\") AS \"RAN\"\nFROM \"aka_title\") AS \"t78\" ON \"t77\".\"movie_id\" = \"t78\".\"MOVIE_ID\") AS \"t79\"\nLEFT JOIN (SELECT \"movie_keyword8\".\"movie_id\" AS \"MOVIE_ID\", LISTAGG(\"keyword8\".\"keyword\", ', ') AS \"KEYWORDS\"\nFROM \"keyword\" AS \"keyword8\"\nINNER JOIN \"movie_keyword\" AS \"movie_keyword8\" ON \"keyword8\".\"id\" = \"movie_keyword8\".\"keyword_id\"\nGROUP BY \"movie_keyword8\".\"movie_id\") AS \"t81\" ON \"t79\".\"MOVIE_ID\" = \"t81\".\"MOVIE_ID\"\nGROUP BY \"t79\".\"PRODUCTION_YEAR\") AS \"t83\" ON \"t75\".\"PRODUCTION_YEAR\" IS NOT DISTINCT FROM \"t83\".\"PRODUCTION_YEAR\") AS \"t84\" ON \"t58\".\"PRODUCTION_YEAR\" = \"t84\".\"PRODUCTION_YEAR\"\nGROUP BY \"t58\".\"MOVIE_ID\") AS \"t86\"\nLEFT JOIN (SELECT \"cast_info9\".\"movie_id\", COUNT(DISTINCT \"s1\".\"id\") AS \"EXPR$0\"\nFROM \"cast_info\" AS \"cast_info9\"\nINNER JOIN \"s1\" ON \"cast_info9\".\"person_id\" = \"s1\".\"person_id\"\nGROUP BY \"cast_info9\".\"movie_id\") AS \"t88\" ON \"t86\".\"MOVIE_ID\" IS NOT DISTINCT FROM \"t88\".\"movie_id\") AS \"t89\" ON \"t42\".\"MOVIE_ID\" = \"t89\".\"movie_id\"\nORDER BY \"t42\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, \"t42\".\"CAST_COUNT\" DESC NULLS FIRST\nLIMIT 100) AS \"t92\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_KEYWORDS",
          "type" : "VARCHAR"
        }, {
          "name" : "AVG_CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "UNIQUE_ACTORS",
          "type" : "BIGINT"
        } ]
      } ]
    }
  } ]
}