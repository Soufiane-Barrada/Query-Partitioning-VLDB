SELECT COALESCE("t8"."MOVIE_ID", "t8"."MOVIE_ID") AS "MOVIE_ID", "t8"."MOVIE_TITLE", "t8"."PRODUCTION_YEAR", "t8"."KEYWORD", "t8"."CAST_NAMES", "t8"."COMPANY_NAME", "t8"."COMPANY_TYPE", "t8"."TOTAL_COMPANIES"
FROM (SELECT "s1"."MOVIE_ID", "s1"."MOVIE_TITLE", "s1"."PRODUCTION_YEAR", "s1"."KEYWORD", "s1"."CAST_NAMES", CASE WHEN "t5"."COMPANY_NAME" IS NOT NULL THEN CAST("t5"."COMPANY_NAME" AS VARCHAR CHARACTER SET "ISO-8859-1") ELSE 'Unknown' END AS "COMPANY_NAME", CASE WHEN "t5"."COMPANY_TYPE" IS NOT NULL THEN CAST("t5"."COMPANY_TYPE" AS VARCHAR CHARACTER SET "ISO-8859-1") ELSE 'Unknown' END AS "COMPANY_TYPE", CASE WHEN "t5"."TOTAL_COMPANIES" IS NOT NULL THEN CAST("t5"."TOTAL_COMPANIES" AS BIGINT) ELSE 0 END AS "TOTAL_COMPANIES"
FROM (SELECT "movie_companies"."movie_id" AS "MOVIE_ID", ANY_VALUE("company_name"."name") AS "COMPANY_NAME", ANY_VALUE("company_type"."kind") AS "COMPANY_TYPE", COUNT(*) AS "TOTAL_COMPANIES"
FROM "IMDB"."company_type"
INNER JOIN ("IMDB"."company_name" INNER JOIN "IMDB"."movie_companies" ON "company_name"."id" = "movie_companies"."company_id") ON "company_type"."id" = "movie_companies"."company_type_id"
GROUP BY "company_type"."kind", "company_name"."name", "movie_companies"."movie_id") AS "t5"
RIGHT JOIN "s1" ON "t5"."MOVIE_ID" = "s1"."MOVIE_ID"
WHERE "s1"."PRODUCTION_YEAR" >= 2000 AND "s1"."PRODUCTION_YEAR" <= 2023
ORDER BY "s1"."PRODUCTION_YEAR" DESC NULLS FIRST, "s1"."MOVIE_TITLE"
FETCH NEXT 100 ROWS ONLY) AS "t8"