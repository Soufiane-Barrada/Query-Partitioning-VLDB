SELECT COALESCE("MOVIE_ID", "MOVIE_ID") AS "MOVIE_ID", "TITLE", "PRODUCTION_YEAR", "KEYWORD", "COMPANY_NAME", "COMPANY_TYPE", "TOTAL_CAST", "VALIDATED_CAST", "NOTE_RATIO_PERCENTAGE", "DETAILED_CAST_NAMES"
FROM (SELECT "MOVIE_ID", "TITLE", "PRODUCTION_YEAR", "KEYWORD", "COMPANY_NAME", "COMPANY_TYPE", "TOTAL_CAST", "VALIDATED_CAST", CASE WHEN ROUND(CAST("NOTE_NON_EMPTY_RATIO" AS DECIMAL(19, 0)), 2) IS NULL THEN 'No Data' ELSE CONCAT(CAST(ROUND(CAST("NOTE_NON_EMPTY_RATIO" AS DECIMAL(19, 0)), 2) AS VARCHAR CHARACTER SET "ISO-8859-1"), '%') END AS "NOTE_RATIO_PERCENTAGE", CASE WHEN "CAST_NAMES" IS NULL THEN 'No Cast Data' ELSE "CAST_NAMES" END AS "DETAILED_CAST_NAMES"
FROM "s1"
WHERE "TOTAL_CAST" > 5 AND CAST("VALIDATED_CAST" / CASE WHEN "TOTAL_CAST" = 0 THEN NULL ELSE "TOTAL_CAST" END AS DECIMAL(19, 1)) > 0.5 OR "PRODUCTION_YEAR" < 2020 AND "COMPANY_NAME" IS NOT NULL
ORDER BY "PRODUCTION_YEAR" DESC NULLS FIRST, "TITLE") AS "t8"