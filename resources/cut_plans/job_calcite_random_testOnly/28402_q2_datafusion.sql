SELECT COALESCE("t6"."ACTOR_NAME", "t6"."ACTOR_NAME") AS "ACTOR_NAME", "t6"."AVG_CO_STARS_OVER_ALL_MOVIES", "t6"."TOTAL_MOVIES", "t6"."MOVIE_TITLES"
FROM (SELECT "t3"."ACTOR_NAME", "t3"."AVG_CO_STARS_OVER_ALL_MOVIES", COUNT(DISTINCT "s10"."MOVIE_TITLE") AS "TOTAL_MOVIES", LISTAGG(DISTINCT "s10"."MOVIE_TITLE", ', ') AS "MOVIE_TITLES"
FROM (SELECT "ACTOR_NAME", AVG("AVG_CO_STARS") AS "AVG_CO_STARS_OVER_ALL_MOVIES"
FROM "s1"
GROUP BY "ACTOR_NAME"
ORDER BY 2 DESC NULLS FIRST
FETCH NEXT 10 ROWS ONLY) AS "t3"
INNER JOIN "s1" AS "s10" ON "t3"."ACTOR_NAME" = "s10"."ACTOR_NAME"
GROUP BY "t3"."ACTOR_NAME", "t3"."AVG_CO_STARS_OVER_ALL_MOVIES"
ORDER BY 3 DESC NULLS FIRST) AS "t6"