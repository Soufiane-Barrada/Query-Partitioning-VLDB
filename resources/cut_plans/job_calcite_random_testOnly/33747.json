{
  "queryId" : "33747",
  "originalSql" : "WITH RECURSIVE RankedMovies AS (\n    SELECT \n        t.id AS movie_id,\n        t.title,\n        t.production_year,\n        ROW_NUMBER() OVER (PARTITION BY t.production_year ORDER BY t.production_year DESC) AS Ran\n    FROM \n        aka_title t\n    WHERE \n        t.production_year IS NOT NULL\n),\nMovieStats AS (\n    SELECT \n        rm.movie_id,\n        COUNT(c.id) AS cast_count,\n        AVG(COALESCE(CAST(pi.info AS FLOAT), 0)) AS avg_salary,\n        STRING_AGG(DISTINCT g.keyword, ', ') AS genres\n    FROM \n        RankedMovies rm\n    JOIN \n        complete_cast cc ON rm.movie_id = cc.movie_id\n    JOIN \n        cast_info c ON cc.subject_id = c.person_id\n    LEFT JOIN \n        movie_keyword mk ON rm.movie_id = mk.movie_id\n    LEFT JOIN \n        keyword g ON mk.keyword_id = g.id\n    LEFT JOIN \n        person_info pi ON c.person_id = pi.person_id AND pi.info_type_id = (SELECT id FROM info_type WHERE info = 'salary')\n    GROUP BY \n        rm.movie_id\n),\nMoviesWithCompany AS (\n    SELECT \n        t.title, \n        t.production_year, \n        mcc.company_id, \n        c.name AS company_name\n    FROM \n        aka_title t\n    JOIN \n        movie_companies mcc ON t.id = mcc.movie_id\n    JOIN \n        company_name c ON mcc.company_id = c.id\n    WHERE \n        c.country_code = 'USA'\n),\nFilteredMovies AS (\n    SELECT \n        m.title,\n        m.production_year,\n        COALESCE(s.cast_count, 0) AS cast_count,\n        COALESCE(s.avg_salary, 0) AS avg_salary,\n        (SELECT COUNT(*) FROM MoviesWithCompany mwc WHERE mwc.title = m.title) AS company_count\n    FROM \n        RankedMovies m\n    LEFT JOIN \n        MovieStats s ON m.movie_id = s.movie_id\n)\nSELECT \n    *,\n    CASE \n        WHEN avg_salary > 100000 THEN 'High Budget'\n        WHEN avg_salary >= 50000 THEN 'Medium Budget'\n        ELSE 'Low Budget'\n    END AS budget_category\nFROM \n    FilteredMovies\nWHERE \n    cast_count > 0\nORDER BY \n    production_year DESC, cast_count DESC",
  "dpSummary" : {
    "hasCut" : true,
    "cutNodeId" : 92654,
    "q1Engine" : "duckdb",
    "q2Engine" : "datafusion",
    "costAllDuckdb" : 6893028.779713634,
    "costAllDatafusion" : 3.1657297370157763E7,
    "chosenCost" : -1.0
  },
  "analysis" : {
    "pipeline" : {
      "runId" : "job_random",
      "doOptimize" : true,
      "metadataProvider" : "custom",
      "dpMode" : "MAX",
      "transferExtraConstantMs" : 0.0,
      "transferCoeffs" : {
        "duckdb" : {
          "aMs" : 0.0,
          "bMsPerRow" : 0.0,
          "cMsPerRowSizeByte" : 0.0,
          "dMsPerOutputByte" : 0.0
        },
        "datafusion" : {
          "aMs" : 0.0,
          "bMsPerRow" : 0.0,
          "cMsPerRowSizeByte" : 0.0,
          "dMsPerOutputByte" : 0.0
        }
      },
      "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
      "cutPolicy" : "RANDOM",
      "randomSeed" : 1,
      "schemaName" : "IMDB"
    },
    "planStats" : {
      "totalNodes" : 64,
      "maxDepth" : 17,
      "operatorKindCounts" : {
        "JOIN" : 18,
        "OTHER" : 24,
        "AGGREGATE" : 6,
        "SORT" : 1,
        "FILTER" : 5
      },
      "rootOutputRows" : 1.448812158883545E9,
      "rootRowSizeOutBytes" : 238.37862960339945
    },
    "cut" : {
      "cutDepth" : 11,
      "cutNodeOperatorKind" : "JOIN",
      "cutOutputRows" : 134712.0,
      "cutRowSizeOutBytes" : 172.4488477776158,
      "cutOutputBytes" : 2.323092918181818E7,
      "transferEstimatedMs" : 0.0,
      "q1Stats" : {
        "engine" : "duckdb",
        "nodeCount" : 7,
        "maxDepth" : 6,
        "operatorKindCounts" : {
          "OTHER" : 4,
          "FILTER" : 1,
          "AGGREGATE" : 1,
          "JOIN" : 1
        }
      },
      "q2Stats" : {
        "engine" : "datafusion",
        "nodeCount" : 47,
        "maxDepth" : 18,
        "operatorKindCounts" : {
          "JOIN" : 17,
          "OTHER" : 20,
          "AGGREGATE" : 5,
          "SORT" : 1,
          "FILTER" : 4
        }
      }
    }
  },
  "dag" : {
    "finalNodeId" : "q2",
    "nodes" : [ {
      "id" : "q1",
      "engine" : "duckdb",
      "sql" : "SELECT COALESCE(\"person_info\".\"id\", \"person_info\".\"id\") AS \"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t1\".\"FD_D_f0\" AS \"FD_COL_5\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t1\"\nINNER JOIN \"person_info\" ON \"t1\".\"FD_D_f0\" = \"person_info\".\"info_type_id\"",
      "inputs" : { },
      "schema" : [ {
        "name" : "id",
        "type" : "INTEGER"
      }, {
        "name" : "person_id",
        "type" : "INTEGER"
      }, {
        "name" : "info_type_id",
        "type" : "INTEGER"
      }, {
        "name" : "info",
        "type" : "VARCHAR"
      }, {
        "name" : "note",
        "type" : "VARCHAR"
      }, {
        "name" : "FD_COL_5",
        "type" : "INTEGER"
      } ]
    }, {
      "id" : "q2",
      "engine" : "datafusion",
      "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t13\".\"TITLE\", \"t13\".\"PRODUCTION_YEAR\", CASE WHEN \"t13\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t13\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t13\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t13\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t13\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t13\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t13\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t13\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t4\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t4\".\"TITLE\" AS \"TITLE\", \"t4\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t4\".\"RAN\" AS \"RAN\", \"t12\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t12\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t12\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t12\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t4\"\nLEFT JOIN (SELECT \"t6\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t10\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t10\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"TITLE\", \"t5\".\"PRODUCTION_YEAR\", \"t5\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t5\" INNER JOIN \"complete_cast\" ON \"t5\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t5\".\"MOVIE_ID\") AS \"t6\"\nLEFT JOIN \"keyword\" ON \"t6\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t9\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t9\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t9\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t10\" ON \"t6\".\"person_id\" = \"t10\".\"person_id\"\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t12\" ON \"t4\".\"MOVIE_ID\" = \"t12\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t12\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t12\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t14\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t14\"\nLEFT JOIN (SELECT \"t16\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"s1\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"s1\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t15\".\"MOVIE_ID\", \"t15\".\"TITLE\", \"t15\".\"PRODUCTION_YEAR\", \"t15\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t15\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t15\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t15\".\"MOVIE_ID\") AS \"t16\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t16\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN \"s1\" ON \"t16\".\"person_id\" = \"s1\".\"person_id\"\nGROUP BY \"t16\".\"MOVIE_ID\") AS \"t18\" ON \"t14\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t14\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t13\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t13\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
      "inputs" : {
        "s1" : "q1"
      },
      "schema" : [ {
        "name" : "TITLE",
        "type" : "VARCHAR"
      }, {
        "name" : "PRODUCTION_YEAR",
        "type" : "INTEGER"
      }, {
        "name" : "CAST_COUNT",
        "type" : "BIGINT"
      }, {
        "name" : "AVG_SALARY",
        "type" : "FLOAT"
      }, {
        "name" : "COMPANY_COUNT",
        "type" : "BIGINT"
      }, {
        "name" : "BUDGET_CATEGORY",
        "type" : "CHAR"
      } ]
    } ]
  },
  "cutPlans" : [ {
    "planId" : "cut_92687",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92687,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 1,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.448812158883545E9,
        "cutRowSizeOutBytes" : 238.37862960339945,
        "cutOutputBytes" : 3.4536585698740204E11,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 53,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 24,
            "AGGREGATE" : 6,
            "FILTER" : 5
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 1,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t8\".\"TITLE\", \"t8\".\"TITLE\") AS \"TITLE\", \"t8\".\"PRODUCTION_YEAR\", CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t8\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t8\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t8\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t8\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t8\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t8\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t\".\"TITLE\" AS \"TITLE\", \"t\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t\".\"RAN\" AS \"RAN\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t7\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t7\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t7\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t7\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t7\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t19\".\"TITLE\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t9\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t9\"\nLEFT JOIN (SELECT \"t11\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t15\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t15\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t10\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t11\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t14\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t14\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t14\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t15\" ON \"t11\".\"person_id\" = \"t15\".\"person_id\"\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t17\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t17\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t9\".\"TITLE\") AS \"t19\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t20\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t20\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t22\" ON \"t19\".\"TITLE\" IS NOT DISTINCT FROM \"t22\".\"TITLE\") AS \"t23\" ON \"t8\".\"TITLE\" = \"t23\".\"TITLE\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"TITLE\", \"TITLE\") AS \"TITLE\", \"PRODUCTION_YEAR\", \"CAST_COUNT\", \"AVG_SALARY\", \"COMPANY_COUNT\", \"BUDGET_CATEGORY\"\nFROM \"s1\"\nORDER BY \"PRODUCTION_YEAR\" DESC NULLS FIRST, \"CAST_COUNT\" DESC NULLS FIRST",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92622",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92622,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 3,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 361470.39649838285,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 7.749152824352075E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 24,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 7,
            "OTHER" : 13,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 30,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 11,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 3
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t7\".\"CAST_COUNT\", \"t7\".\"AVG_SALARY\", \"t7\".\"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t7\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t7\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", CASE WHEN \"s1\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"s1\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"s1\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"s1\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"s1\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"s1\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"s1\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"s1\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"s1\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"s1\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92620",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92620,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 4,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722940.7929967657,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 1.549830564870415E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 23,
          "maxDepth" : 11,
          "operatorKindCounts" : {
            "JOIN" : 7,
            "OTHER" : 13,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 31,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 11,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t7\".\"CAST_COUNT\", \"t7\".\"AVG_SALARY\", \"t7\".\"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT *\nFROM \"s1\"\nWHERE CASE WHEN \"CAST_COUNT\" IS NOT NULL THEN CAST(\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92583",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92583,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 5,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 52,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"s1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"s1\".\"TITLE\" AS \"TITLE\", \"s1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"s1\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"s1\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_91022",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 91022,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"movie_id\", \"title\", \"imdb_index\", \"kind_id\", \"production_year\", \"phonetic_code\", \"episode_of_id\", \"season_nr\", \"episode_nr\", \"note\", \"md5sum\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "title",
          "type" : "VARCHAR"
        }, {
          "name" : "imdb_index",
          "type" : "VARCHAR"
        }, {
          "name" : "kind_id",
          "type" : "INTEGER"
        }, {
          "name" : "production_year",
          "type" : "INTEGER"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        }, {
          "name" : "episode_of_id",
          "type" : "INTEGER"
        }, {
          "name" : "season_nr",
          "type" : "INTEGER"
        }, {
          "name" : "episode_nr",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "md5sum",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"s1\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"s1\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"s1\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"s1\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"s13\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"s1\" AS \"s13\" INNER JOIN \"movie_companies\" ON \"s13\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"s13\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92618",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92618,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 5,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 112713.32567804334,
        "cutRowSizeOutBytes" : 32.0,
        "cutOutputBytes" : 3606826.421697387,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 21,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 6,
            "OTHER" : 12,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 33,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 12,
            "OTHER" : 12,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t4\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t4\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t3\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t3\"\nINNER JOIN \"person_info\" ON \"t3\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t4\" ON \"t0\".\"person_id\" = \"t4\".\"person_id\"\nGROUP BY \"t0\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t8\".\"TITLE\" AS \"TITLE\", \"t8\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t8\".\"RAN\" AS \"RAN\", \"s1\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"s1\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"s1\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"s1\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t8\"\nLEFT JOIN \"s1\" ON \"t8\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\"\nWHERE CASE WHEN \"s1\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"s1\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92616",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92616,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.06944355648717E7,
        "cutRowSizeOutBytes" : 529.3712013171559,
        "cutOutputBytes" : 2.683617425507128E10,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 20,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "JOIN" : 6,
            "OTHER" : 12,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 34,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 12,
            "OTHER" : 12,
            "AGGREGATE" : 5,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", CASE WHEN CAST(\"t4\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t4\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END AS \"FD_COL_1\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_3\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t3\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t3\"\nINNER JOIN \"person_info\" ON \"t3\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t4\" ON \"t0\".\"person_id\" = \"t4\".\"person_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "FLOAT"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_3",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t7\".\"TITLE\" AS \"TITLE\", \"t7\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t7\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t7\"\nLEFT JOIN (SELECT \"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(\"FD_COL_1\") AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\", \"FD_COL_3\") AS \"GENRES\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t8\" ON \"t7\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92600",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92600,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.5347311862071894E7,
        "cutRowSizeOutBytes" : 356.92235353954004,
        "cutOutputBytes" : 9.047022205711401E9,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 11,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "JOIN" : 4,
            "OTHER" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 43,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 14,
            "OTHER" : 17,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"t0\".\"id\", \"t0\".\"movie_id\" AS \"movie_id_\", \"t0\".\"subject_id\", \"t0\".\"status_id\", \"t0\".\"id0\", \"t0\".\"person_id\", \"t0\".\"movie_id0\", \"t0\".\"person_role_id\", \"t0\".\"note\", \"t0\".\"nr_order\", \"t0\".\"role_id\", \"t0\".\"id1\", \"t0\".\"movie_id1\", \"t0\".\"keyword_id\", \"keyword\".\"id\" AS \"id2\", \"keyword\".\"keyword\", \"keyword\".\"phonetic_code\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "id1",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id1",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        }, {
          "name" : "id2",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"s1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"s1\".\"keyword\", ', ') AS \"GENRES\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"s1\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"s1\".\"MOVIE_ID\") AS \"t8\" ON \"t2\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92597",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92597,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.2673703161054434E7,
        "cutRowSizeOutBytes" : 301.7619283327129,
        "cutOutputBytes" : 3.8244411049961853E9,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 9,
          "maxDepth" : 6,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 6
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 45,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 15,
            "OTHER" : 18,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\" AS \"movie_id_\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "id1",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id1",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"s1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM \"s1\"\nLEFT JOIN \"keyword\" ON \"s1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"s1\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"s1\".\"MOVIE_ID\") AS \"t8\" ON \"t2\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_91023",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 91023,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 4523930.0,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.0857432E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"movie_id\", \"keyword_id\"\nFROM \"movie_keyword\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"s1\".\"id\" AS \"id1\", \"s1\".\"movie_id\" AS \"movie_id1\", \"s1\".\"keyword_id\"\nFROM \"s1\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"s1\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"s10\".\"id\" AS \"id1\", \"s10\".\"movie_id\" AS \"movie_id1\", \"s10\".\"keyword_id\"\nFROM \"s1\" AS \"s10\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"s10\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92593",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92593,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1208374.394056977,
        "cutRowSizeOutBytes" : 277.7619283327129,
        "cutOutputBytes" : 3.3564040184113944E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 6,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "JOIN" : 2,
            "OTHER" : 4
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 48,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 16,
            "OTHER" : 20,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"cast_info\".\"id\", \"cast_info\".\"id\") AS \"id\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"t\".\"MOVIE_ID\" AS \"MOVIE_ID_\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\" AS \"id0\", \"complete_cast\".\"movie_id\" AS \"movie_id0\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\"\nFROM \"cast_info\"\nINNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "MOVIE_ID_",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID_\" AS \"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"s1\".\"id0\" AS \"id\", \"s1\".\"movie_id0\" AS \"movie_id\", \"s1\".\"subject_id\", \"s1\".\"status_id\", \"s1\".\"id\" AS \"id0\", \"s1\".\"person_id\", \"s1\".\"movie_id\" AS \"movie_id0\", \"s1\".\"person_role_id\", \"s1\".\"note\", \"s1\".\"nr_order\", \"s1\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN \"s1\" ON \"movie_keyword\".\"movie_id\" = \"s1\".\"MOVIE_ID_\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t1\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_55496",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 55496,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3.6244344E7,
        "cutRowSizeOutBytes" : 63.383298729313466,
        "cutOutputBytes" : 2.297286083E9,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"person_id\", \"movie_id\", \"person_role_id\", \"note\", \"nr_order\", \"role_id\"\nFROM \"cast_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"s1\".\"id\" AS \"id0\", \"s1\".\"person_id\", \"s1\".\"movie_id\" AS \"movie_id0\", \"s1\".\"person_role_id\", \"s1\".\"note\", \"s1\".\"nr_order\", \"s1\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"s1\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"s1\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"s10\".\"id\" AS \"id0\", \"s10\".\"person_id\", \"s10\".\"movie_id\" AS \"movie_id0\", \"s10\".\"person_role_id\", \"s10\".\"note\", \"s10\".\"nr_order\", \"s10\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"s1\" AS \"s10\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"s10\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92591",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92591,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 135086.0,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 2.8959551558604818E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 50,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 17,
            "OTHER" : 21,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\" AS \"movie_id_\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nINNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"s1\".\"id\", \"s1\".\"movie_id_\" AS \"movie_id\", \"s1\".\"subject_id\", \"s1\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN \"s1\" ON \"cast_info\".\"person_id\" = \"s1\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t1\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92588",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92588,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 52,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN (\"s1\" INNER JOIN \"complete_cast\" ON \"s1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t1\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92170",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92170,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 135086.0,
        "cutRowSizeOutBytes" : 32.0,
        "cutOutputBytes" : 4322752.0,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"movie_id\", \"subject_id\", \"status_id\"\nFROM \"complete_cast\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"s1\".\"id\", \"s1\".\"movie_id\", \"s1\".\"subject_id\", \"s1\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"s1\" ON \"t1\".\"MOVIE_ID\" = \"s1\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"s1\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"s10\".\"id\", \"s10\".\"movie_id\", \"s10\".\"subject_id\", \"s10\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"s1\" AS \"s10\" ON \"t11\".\"MOVIE_ID\" = \"s10\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"s10\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_91025",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 91025,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 134170.0,
        "cutRowSizeOutBytes" : 55.16042520682716,
        "cutOutputBytes" : 7400874.250000001,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"keyword\", \"phonetic_code\"\nFROM \"keyword\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"s1\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"s1\" ON \"t2\".\"keyword_id\" = \"s1\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"s10\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"s1\" AS \"s10\" ON \"t12\".\"keyword_id\" = \"s10\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92612",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92612,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 134712.0,
        "cutRowSizeOutBytes" : 172.4488477776158,
        "cutOutputBytes" : 2.323092918181818E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 6,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "JOIN" : 1,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 47,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 17,
            "OTHER" : 20,
            "AGGREGATE" : 5,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"person_info\".\"id\", \"person_info\".\"id\") AS \"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t1\".\"FD_D_f0\" AS \"FD_COL_5\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t1\"\nINNER JOIN \"person_info\" ON \"t1\".\"FD_D_f0\" = \"person_info\".\"info_type_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "info_type_id",
          "type" : "INTEGER"
        }, {
          "name" : "info",
          "type" : "VARCHAR"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_5",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t4\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t4\".\"TITLE\" AS \"TITLE\", \"t4\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t4\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t4\"\nLEFT JOIN (SELECT \"t6\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"s1\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"s1\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t5\".\"MOVIE_ID\", \"t5\".\"TITLE\", \"t5\".\"PRODUCTION_YEAR\", \"t5\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t5\" INNER JOIN \"complete_cast\" ON \"t5\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t5\".\"MOVIE_ID\") AS \"t6\"\nLEFT JOIN \"keyword\" ON \"t6\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN \"s1\" ON \"t6\".\"person_id\" = \"s1\".\"person_id\"\nGROUP BY \"t6\".\"MOVIE_ID\") AS \"t8\" ON \"t4\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92607",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92607,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 50,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 5,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(SINGLE_VALUE(\"id\"), SINGLE_VALUE(\"id\")) AS \"FD_COL_0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary'",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t3\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t3\".\"TITLE\" AS \"TITLE\", \"t3\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t3\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\"\nLEFT JOIN (SELECT \"t5\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" INNER JOIN \"complete_cast\" ON \"t4\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN \"keyword\" ON \"t5\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"s1\".\"FD_COL_0\" AS \"FD_D_f0\"\nFROM \"s1\"\nINNER JOIN \"person_info\" ON \"s1\".\"FD_COL_0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t5\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t8\" ON \"t3\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92605",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92605,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 38.72566371681416,
        "cutOutputBytes" : 38.72566371681416,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 51,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary'",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"t4\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" INNER JOIN \"complete_cast\" ON \"t3\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN \"keyword\" ON \"t4\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"s1\") AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t4\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t8\" ON \"t2\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92179",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92179,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 113.0,
        "cutRowSizeOutBytes" : 38.72566371681416,
        "cutOutputBytes" : 4376.0,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"info\"\nFROM \"info_type\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "info",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"s1\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"s1\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92178",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92178,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 2963664.0,
        "cutRowSizeOutBytes" : 164.4488477776158,
        "cutOutputBytes" : 4.8737113E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"person_id\", \"info_type_id\", \"info\", \"note\"\nFROM \"person_info\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "info_type_id",
          "type" : "INTEGER"
        }, {
          "name" : "info",
          "type" : "VARCHAR"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"s1\".\"id\", \"s1\".\"person_id\", \"s1\".\"info_type_id\", \"s1\".\"info\", \"s1\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"s1\" ON \"t5\".\"FD_D_f0\" = \"s1\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"s10\".\"id\", \"s10\".\"person_id\", \"s10\".\"info_type_id\", \"s10\".\"info\", \"s10\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"s1\" AS \"s10\" ON \"t15\".\"FD_D_f0\" = \"s10\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92683",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92683,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 3,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.1313710982189634E9,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 2.715290635725512E10,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 34,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 10,
            "OTHER" : 17,
            "AGGREGATE" : 4,
            "FILTER" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 20,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 8,
            "OTHER" : 7,
            "SORT" : 1,
            "FILTER" : 2,
            "AGGREGATE" : 2
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t9\".\"TITLE\", \"t9\".\"TITLE\") AS \"TITLE\", CASE WHEN \"t12\".\"EXPR$0\" IS NOT NULL THEN \"t12\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t7\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t7\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t\".\"TITLE\") AS \"t9\"\nLEFT JOIN (SELECT \"aka_title1\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t10\"\nINNER JOIN (\"aka_title\" AS \"aka_title1\" INNER JOIN \"movie_companies\" ON \"aka_title1\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t10\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title1\".\"title\") AS \"t12\" ON \"t9\".\"TITLE\" IS NOT DISTINCT FROM \"t12\".\"TITLE\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t24\".\"TITLE\", \"t24\".\"PRODUCTION_YEAR\", CASE WHEN \"t24\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t24\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t24\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t24\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t24\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t24\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t24\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t24\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t15\".\"TITLE\" AS \"TITLE\", \"t15\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t15\".\"RAN\" AS \"RAN\", \"t23\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t23\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t23\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t23\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t15\"\nLEFT JOIN (SELECT \"t17\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t21\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t21\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t16\".\"MOVIE_ID\", \"t16\".\"TITLE\", \"t16\".\"PRODUCTION_YEAR\", \"t16\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t16\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t16\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t16\".\"MOVIE_ID\") AS \"t17\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t17\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t20\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t20\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t20\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t21\" ON \"t17\".\"person_id\" = \"t21\".\"person_id\"\nGROUP BY \"t17\".\"MOVIE_ID\") AS \"t23\" ON \"t15\".\"MOVIE_ID\" = \"t23\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t23\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t23\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t24\"\nLEFT JOIN \"s1\" ON \"t24\".\"TITLE\" = \"s1\".\"TITLE\"\nORDER BY \"t24\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92666",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92666,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 5,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 282341.09890597523,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 2258728.791247802,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 25,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "OTHER" : 13,
            "JOIN" : 7,
            "FILTER" : 2,
            "AGGREGATE" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 29,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 11,
            "OTHER" : 11,
            "AGGREGATE" : 3,
            "SORT" : 1,
            "FILTER" : 3
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"TITLE\", \"t\".\"TITLE\") AS \"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t7\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t7\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t\".\"TITLE\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t20\".\"TITLE\", \"t20\".\"PRODUCTION_YEAR\", CASE WHEN \"t20\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t20\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t20\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t20\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t20\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t20\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t20\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t20\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t11\".\"TITLE\" AS \"TITLE\", \"t11\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t11\".\"RAN\" AS \"RAN\", \"t19\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t19\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t19\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t19\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\"\nLEFT JOIN (SELECT \"t13\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t17\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t17\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t12\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t13\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t16\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t16\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t16\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t17\" ON \"t13\".\"person_id\" = \"t17\".\"person_id\"\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t19\" ON \"t11\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t19\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t19\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t20\"\nLEFT JOIN (SELECT \"s1\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"s1\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t20\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t20\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92664",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92664,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 361470.39649838285,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 7.749152824352075E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 24,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 7,
            "FILTER" : 2,
            "OTHER" : 13,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 30,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 11,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 3
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t7\".\"CAST_COUNT\", \"t7\".\"AVG_SALARY\", \"t7\".\"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t7\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t7\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t19\".\"TITLE\", \"t19\".\"PRODUCTION_YEAR\", CASE WHEN \"t19\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t19\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t19\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t19\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t19\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t19\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t19\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t19\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t10\".\"TITLE\" AS \"TITLE\", \"t10\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t10\".\"RAN\" AS \"RAN\", \"t18\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t18\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t18\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t18\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t19\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"TITLE\"\nFROM \"s1\"\nGROUP BY \"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t19\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t19\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92662",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92662,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 7,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 722940.7929967657,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 1.549830564870415E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 23,
          "maxDepth" : 11,
          "operatorKindCounts" : {
            "JOIN" : 7,
            "FILTER" : 1,
            "OTHER" : 13,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 31,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 11,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t7\".\"CAST_COUNT\", \"t7\".\"AVG_SALARY\", \"t7\".\"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nLEFT JOIN (SELECT \"t1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t5\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t5\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t0\".\"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\" INNER JOIN \"complete_cast\" ON \"t0\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t0\".\"MOVIE_ID\") AS \"t1\"\nLEFT JOIN \"keyword\" ON \"t1\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t4\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t4\"\nINNER JOIN \"person_info\" ON \"t4\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t5\" ON \"t1\".\"person_id\" = \"t5\".\"person_id\"\nGROUP BY \"t1\".\"MOVIE_ID\") AS \"t7\" ON \"t\".\"MOVIE_ID\" = \"t7\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "MOVIE_ID0",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t18\".\"TITLE\", \"t18\".\"PRODUCTION_YEAR\", CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t18\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t18\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t18\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t18\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t18\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t18\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t9\".\"TITLE\" AS \"TITLE\", \"t9\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t9\".\"RAN\" AS \"RAN\", \"t17\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t17\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t17\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t17\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t9\"\nLEFT JOIN (SELECT \"t11\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t15\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t15\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t10\".\"MOVIE_ID\", \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", \"t10\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t10\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t10\".\"MOVIE_ID\") AS \"t11\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t11\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t14\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t14\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t14\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t15\" ON \"t11\".\"person_id\" = \"t15\".\"person_id\"\nGROUP BY \"t11\".\"MOVIE_ID\") AS \"t17\" ON \"t9\".\"MOVIE_ID\" = \"t17\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t17\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t17\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t18\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"TITLE\"\nFROM \"s1\"\nWHERE CASE WHEN \"CAST_COUNT\" IS NOT NULL THEN CAST(\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t18\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t18\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92625",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92625,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 52,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t9\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t9\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t3\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t7\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t7\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" INNER JOIN \"complete_cast\" ON \"t2\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN \"keyword\" ON \"t3\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t6\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t6\"\nINNER JOIN \"person_info\" ON \"t6\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t7\" ON \"t3\".\"person_id\" = \"t7\".\"person_id\"\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t9\" ON \"t1\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"TITLE\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"s1\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"s1\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t10\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t10\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92660",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92660,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 112713.32567804334,
        "cutRowSizeOutBytes" : 32.0,
        "cutOutputBytes" : 3606826.421697387,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 21,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 6,
            "FILTER" : 1,
            "OTHER" : 12,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 33,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 12,
            "OTHER" : 12,
            "AGGREGATE" : 4,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t4\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t4\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t3\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t3\"\nINNER JOIN \"person_info\" ON \"t3\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t4\" ON \"t0\".\"person_id\" = \"t4\".\"person_id\"\nGROUP BY \"t0\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "GENRES",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t17\".\"TITLE\", \"t17\".\"PRODUCTION_YEAR\", CASE WHEN \"t17\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t17\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t17\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t17\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t17\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t17\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t17\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t17\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t8\".\"TITLE\" AS \"TITLE\", \"t8\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t8\".\"RAN\" AS \"RAN\", \"t16\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t16\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t16\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t16\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t8\"\nLEFT JOIN (SELECT \"t10\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t14\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t14\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t9\".\"MOVIE_ID\", \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", \"t9\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t9\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t9\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t9\".\"MOVIE_ID\") AS \"t10\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t10\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t13\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t13\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t13\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t14\" ON \"t10\".\"person_id\" = \"t14\".\"person_id\"\nGROUP BY \"t10\".\"MOVIE_ID\") AS \"t16\" ON \"t8\".\"MOVIE_ID\" = \"t16\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t16\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t16\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t18\"\nLEFT JOIN \"s1\" ON \"t18\".\"MOVIE_ID\" = \"s1\".\"MOVIE_ID\"\nWHERE CASE WHEN \"s1\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"s1\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t18\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t17\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t17\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92658",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92658,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.06944355648717E7,
        "cutRowSizeOutBytes" : 529.3712013171559,
        "cutOutputBytes" : 2.683617425507128E10,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 20,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "JOIN" : 6,
            "FILTER" : 1,
            "OTHER" : 12,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 34,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 12,
            "OTHER" : 12,
            "AGGREGATE" : 5,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", CASE WHEN CAST(\"t4\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t4\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END AS \"FD_COL_1\", \"keyword\".\"keyword\", ', ' AS \"FD_COL_3\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t3\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t3\"\nINNER JOIN \"person_info\" ON \"t3\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t4\" ON \"t0\".\"person_id\" = \"t4\".\"person_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "FLOAT"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_3",
          "type" : "CHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t16\".\"TITLE\", \"t16\".\"PRODUCTION_YEAR\", CASE WHEN \"t16\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t16\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t16\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t16\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t16\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t16\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t16\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t16\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t7\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t7\".\"TITLE\" AS \"TITLE\", \"t7\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t7\".\"RAN\" AS \"RAN\", \"t15\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t15\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t15\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t15\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t7\"\nLEFT JOIN (SELECT \"t9\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t13\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t13\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t8\".\"MOVIE_ID\", \"t8\".\"TITLE\", \"t8\".\"PRODUCTION_YEAR\", \"t8\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t8\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t8\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t8\".\"MOVIE_ID\") AS \"t9\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t9\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t12\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t12\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t12\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t13\" ON \"t9\".\"person_id\" = \"t13\".\"person_id\"\nGROUP BY \"t9\".\"MOVIE_ID\") AS \"t15\" ON \"t7\".\"MOVIE_ID\" = \"t15\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t15\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t15\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t16\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t17\"\nLEFT JOIN (SELECT \"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(\"FD_COL_1\") AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\", \"FD_COL_3\") AS \"GENRES\"\nFROM \"s1\"\nGROUP BY \"MOVIE_ID\") AS \"t18\" ON \"t17\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t17\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t16\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t16\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92642",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92642,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.5347311862071894E7,
        "cutRowSizeOutBytes" : 356.92235353954004,
        "cutOutputBytes" : 9.047022205711401E9,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 11,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 4
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 43,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 14,
            "OTHER" : 17,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t0\".\"MOVIE_ID\", \"t0\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t0\".\"TITLE\", \"t0\".\"PRODUCTION_YEAR\", \"t0\".\"RAN\", \"t0\".\"id\", \"t0\".\"movie_id\" AS \"movie_id_\", \"t0\".\"subject_id\", \"t0\".\"status_id\", \"t0\".\"id0\", \"t0\".\"person_id\", \"t0\".\"movie_id0\", \"t0\".\"person_role_id\", \"t0\".\"note\", \"t0\".\"nr_order\", \"t0\".\"role_id\", \"t0\".\"id1\", \"t0\".\"movie_id1\", \"t0\".\"keyword_id\", \"keyword\".\"id\" AS \"id2\", \"keyword\".\"keyword\", \"keyword\".\"phonetic_code\"\nFROM (SELECT \"t\".\"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\") AS \"t0\"\nLEFT JOIN \"keyword\" ON \"t0\".\"keyword_id\" = \"keyword\".\"id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "id1",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id1",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        }, {
          "name" : "id2",
          "type" : "INTEGER"
        }, {
          "name" : "keyword",
          "type" : "VARCHAR"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t10\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t10\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"t4\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t8\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t8\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t3\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t4\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t7\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t7\"\nINNER JOIN \"person_info\" ON \"t7\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t8\" ON \"t4\".\"person_id\" = \"t8\".\"person_id\"\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t10\" ON \"t2\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t12\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\"\nLEFT JOIN (SELECT \"s1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"s1\".\"keyword\", ', ') AS \"GENRES\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"s1\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"s1\".\"MOVIE_ID\") AS \"t18\" ON \"t12\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t12\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t11\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t11\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92639",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92639,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.2673703161054434E7,
        "cutRowSizeOutBytes" : 301.7619283327129,
        "cutOutputBytes" : 3.8244411049961853E9,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 9,
          "maxDepth" : 6,
          "operatorKindCounts" : {
            "OTHER" : 6,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 45,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 15,
            "OTHER" : 18,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\" AS \"movie_id_\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t\".\"MOVIE_ID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "id1",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id1",
          "type" : "INTEGER"
        }, {
          "name" : "keyword_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t10\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t10\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"t4\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t8\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t8\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t3\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN \"keyword\" ON \"t4\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t7\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t7\"\nINNER JOIN \"person_info\" ON \"t7\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t8\" ON \"t4\".\"person_id\" = \"t8\".\"person_id\"\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t10\" ON \"t2\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t12\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\"\nLEFT JOIN (SELECT \"s1\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM \"s1\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"s1\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"s1\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"s1\".\"MOVIE_ID\") AS \"t18\" ON \"t12\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t12\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t11\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t11\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92635",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92635,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1208374.394056977,
        "cutRowSizeOutBytes" : 277.7619283327129,
        "cutOutputBytes" : 3.3564040184113944E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 6,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "JOIN" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 48,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 16,
            "OTHER" : 20,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"cast_info\".\"id\", \"cast_info\".\"id\") AS \"id\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"t\".\"MOVIE_ID\" AS \"MOVIE_ID_\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\" AS \"id0\", \"complete_cast\".\"movie_id\" AS \"movie_id0\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\"\nFROM \"cast_info\"\nINNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\" INNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "person_id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "person_role_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "nr_order",
          "type" : "INTEGER"
        }, {
          "name" : "role_id",
          "type" : "INTEGER"
        }, {
          "name" : "MOVIE_ID_",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t9\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t9\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t3\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t7\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t7\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t2\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN \"keyword\" ON \"t3\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t6\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t6\"\nINNER JOIN \"person_info\" ON \"t6\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t7\" ON \"t3\".\"person_id\" = \"t7\".\"person_id\"\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t9\" ON \"t1\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t11\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID_\" AS \"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"s1\".\"id0\" AS \"id\", \"s1\".\"movie_id0\" AS \"movie_id\", \"s1\".\"subject_id\", \"s1\".\"status_id\", \"s1\".\"id\" AS \"id0\", \"s1\".\"person_id\", \"s1\".\"movie_id\" AS \"movie_id0\", \"s1\".\"person_role_id\", \"s1\".\"note\", \"s1\".\"nr_order\", \"s1\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN \"s1\" ON \"movie_keyword0\".\"movie_id\" = \"s1\".\"MOVIE_ID_\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t11\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t10\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t10\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92633",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92633,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 135086.0,
        "cutRowSizeOutBytes" : 214.37862960339945,
        "cutOutputBytes" : 2.8959551558604818E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 3,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 50,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 17,
            "OTHER" : 21,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t\".\"MOVIE_ID\", \"t\".\"MOVIE_ID\") AS \"MOVIE_ID\", \"t\".\"TITLE\", \"t\".\"PRODUCTION_YEAR\", \"t\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\" AS \"movie_id_\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t\"\nINNER JOIN \"complete_cast\" ON \"t\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id_",
          "type" : "INTEGER"
        }, {
          "name" : "subject_id",
          "type" : "INTEGER"
        }, {
          "name" : "status_id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t9\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t9\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t3\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t7\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t7\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t2\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN \"keyword\" ON \"t3\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t6\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t6\"\nINNER JOIN \"person_info\" ON \"t6\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t7\" ON \"t3\".\"person_id\" = \"t7\".\"person_id\"\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t9\" ON \"t1\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t11\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"s1\".\"id\", \"s1\".\"movie_id_\" AS \"movie_id\", \"s1\".\"subject_id\", \"s1\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN \"s1\" ON \"cast_info0\".\"person_id\" = \"s1\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t11\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t10\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t10\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92630",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92630,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 361472.0,
        "cutRowSizeOutBytes" : 182.37862960339945,
        "cutOutputBytes" : 6.592476800000001E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 52,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "MOVIE_ID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t9\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t9\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t3\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t7\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t7\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" INNER JOIN \"complete_cast\" ON \"t2\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN \"keyword\" ON \"t3\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t6\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t6\"\nINNER JOIN \"person_info\" ON \"t6\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t7\" ON \"t3\".\"person_id\" = \"t7\".\"person_id\"\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t9\" ON \"t1\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t11\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"s1\".\"MOVIE_ID\", \"s1\".\"TITLE\", \"s1\".\"PRODUCTION_YEAR\", \"s1\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN (\"s1\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"s1\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"s1\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t11\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t11\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t10\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t10\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92649",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92649,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8.0,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 50,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 5,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(SINGLE_VALUE(\"id\"), SINGLE_VALUE(\"id\")) AS \"FD_COL_0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary'",
        "inputs" : { },
        "schema" : [ {
          "name" : "FD_COL_0",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", CASE WHEN \"t12\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t12\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t3\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t3\".\"TITLE\" AS \"TITLE\", \"t3\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t3\".\"RAN\" AS \"RAN\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t11\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t11\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\"\nLEFT JOIN (SELECT \"t5\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t9\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t9\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" INNER JOIN \"complete_cast\" ON \"t4\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN \"keyword\" ON \"t5\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t8\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t8\"\nINNER JOIN \"person_info\" ON \"t8\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t9\" ON \"t5\".\"person_id\" = \"t9\".\"person_id\"\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t11\" ON \"t3\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t13\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t13\"\nLEFT JOIN (SELECT \"t15\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t14\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t15\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"s1\".\"FD_COL_0\" AS \"FD_D_f0\"\nFROM \"s1\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"s1\".\"FD_COL_0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t15\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t18\" ON \"t13\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t13\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t12\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t12\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92647",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92647,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 38.72566371681416,
        "cutOutputBytes" : 38.72566371681416,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 51,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary'",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t10\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t10\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"t4\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t8\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t8\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" INNER JOIN \"complete_cast\" ON \"t3\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN \"keyword\" ON \"t4\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t7\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t7\"\nINNER JOIN \"person_info\" ON \"t7\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t8\" ON \"t4\".\"person_id\" = \"t8\".\"person_id\"\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t10\" ON \"t2\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t12\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\"\nLEFT JOIN (SELECT \"t14\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"PRODUCTION_YEAR\", \"t13\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t13\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t13\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t13\".\"MOVIE_ID\") AS \"t14\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t14\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"s1\") AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t14\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t18\" ON \"t12\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t12\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t11\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t11\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92679",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92679,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 5,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 4007.107369783705,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 64113.71791653928,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 8,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "JOIN" : 2,
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 46,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 16,
            "OTHER" : 20,
            "SORT" : 1,
            "FILTER" : 4,
            "AGGREGATE" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"aka_title\".\"title\", \"aka_title\".\"title\") AS \"TITLE\", COUNT(*) AS \"FD_COL_1\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t\"\nINNER JOIN (\"aka_title\" INNER JOIN \"movie_companies\" ON \"aka_title\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title\".\"title\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", CASE WHEN \"t12\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t12\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t12\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t12\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t3\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t3\".\"TITLE\" AS \"TITLE\", \"t3\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t3\".\"RAN\" AS \"RAN\", \"t11\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t11\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t11\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t11\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\"\nLEFT JOIN (SELECT \"t5\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t9\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t9\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t4\".\"MOVIE_ID\", \"t4\".\"TITLE\", \"t4\".\"PRODUCTION_YEAR\", \"t4\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t4\" INNER JOIN \"complete_cast\" ON \"t4\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t4\".\"MOVIE_ID\") AS \"t5\"\nLEFT JOIN \"keyword\" ON \"t5\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t8\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t8\"\nINNER JOIN \"person_info\" ON \"t8\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t9\" ON \"t5\".\"person_id\" = \"t9\".\"person_id\"\nGROUP BY \"t5\".\"MOVIE_ID\") AS \"t11\" ON \"t3\".\"MOVIE_ID\" = \"t11\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t23\".\"TITLE\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t13\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t13\"\nLEFT JOIN (SELECT \"t15\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t19\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t19\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t14\".\"MOVIE_ID\", \"t14\".\"TITLE\", \"t14\".\"PRODUCTION_YEAR\", \"t14\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t14\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t14\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t14\".\"MOVIE_ID\") AS \"t15\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t15\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t18\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t18\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t18\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t19\" ON \"t15\".\"person_id\" = \"t19\".\"person_id\"\nGROUP BY \"t15\".\"MOVIE_ID\") AS \"t21\" ON \"t13\".\"MOVIE_ID\" = \"t21\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t21\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t21\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t13\".\"TITLE\") AS \"t23\"\nLEFT JOIN \"s1\" ON \"t23\".\"TITLE\" IS NOT DISTINCT FROM \"s1\".\"TITLE\") AS \"t24\" ON \"t12\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t12\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92677",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92677,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 4034.669171708895,
        "cutRowSizeOutBytes" : 374.5368558396086,
        "cutOutputBytes" : 1511132.3059248475,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "JOIN" : 2,
            "OTHER" : 4,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 47,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "AGGREGATE" : 6,
            "JOIN" : 16,
            "OTHER" : 20,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"aka_title\".\"title\", \"aka_title\".\"title\") AS \"TITLE\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t\"\nINNER JOIN (\"aka_title\" INNER JOIN \"movie_companies\" ON \"aka_title\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t\".\"id\" = \"movie_companies\".\"company_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", CASE WHEN \"t11\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t11\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t11\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t11\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t2\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t2\".\"TITLE\" AS \"TITLE\", \"t2\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t2\".\"RAN\" AS \"RAN\", \"t10\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t10\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t10\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t10\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\"\nLEFT JOIN (SELECT \"t4\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t8\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t8\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t3\".\"MOVIE_ID\", \"t3\".\"TITLE\", \"t3\".\"PRODUCTION_YEAR\", \"t3\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t3\" INNER JOIN \"complete_cast\" ON \"t3\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t3\".\"MOVIE_ID\") AS \"t4\"\nLEFT JOIN \"keyword\" ON \"t4\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t7\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t7\"\nINNER JOIN \"person_info\" ON \"t7\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t8\" ON \"t4\".\"person_id\" = \"t8\".\"person_id\"\nGROUP BY \"t4\".\"MOVIE_ID\") AS \"t10\" ON \"t2\".\"MOVIE_ID\" = \"t10\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t22\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t12\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\"\nLEFT JOIN (SELECT \"t14\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t18\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t18\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t13\".\"MOVIE_ID\", \"t13\".\"TITLE\", \"t13\".\"PRODUCTION_YEAR\", \"t13\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t13\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t13\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t13\".\"MOVIE_ID\") AS \"t14\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t14\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t17\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t17\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t17\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t18\" ON \"t14\".\"person_id\" = \"t18\".\"person_id\"\nGROUP BY \"t14\".\"MOVIE_ID\") AS \"t20\" ON \"t12\".\"MOVIE_ID\" = \"t20\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t20\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t20\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t12\".\"TITLE\") AS \"t22\"\nLEFT JOIN (SELECT \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"TITLE\") AS \"t23\" ON \"t22\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t11\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t11\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92669",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92669,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1093.0093023255813,
        "cutRowSizeOutBytes" : 141.60463378255892,
        "cutOutputBytes" : 154775.18197674418,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 52,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 4
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"name\", \"country_code\", \"imdb_id\", \"name_pcode_nf\", \"name_pcode_sf\", \"md5sum\"\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA'",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "name",
          "type" : "VARCHAR"
        }, {
          "name" : "country_code",
          "type" : "VARCHAR"
        }, {
          "name" : "imdb_id",
          "type" : "INTEGER"
        }, {
          "name" : "name_pcode_nf",
          "type" : "VARCHAR"
        }, {
          "name" : "name_pcode_sf",
          "type" : "VARCHAR"
        }, {
          "name" : "md5sum",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t10\".\"TITLE\", \"t10\".\"PRODUCTION_YEAR\", CASE WHEN \"t10\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t10\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t10\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t10\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t1\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t1\".\"TITLE\" AS \"TITLE\", \"t1\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t1\".\"RAN\" AS \"RAN\", \"t9\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t9\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t9\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t9\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\"\nLEFT JOIN (SELECT \"t3\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t7\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t7\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t2\".\"MOVIE_ID\", \"t2\".\"TITLE\", \"t2\".\"PRODUCTION_YEAR\", \"t2\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t2\" INNER JOIN \"complete_cast\" ON \"t2\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t2\".\"MOVIE_ID\") AS \"t3\"\nLEFT JOIN \"keyword\" ON \"t3\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t6\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t6\"\nINNER JOIN \"person_info\" ON \"t6\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t7\" ON \"t3\".\"person_id\" = \"t7\".\"person_id\"\nGROUP BY \"t3\".\"MOVIE_ID\") AS \"t9\" ON \"t1\".\"MOVIE_ID\" = \"t9\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t21\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t11\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\"\nLEFT JOIN (SELECT \"t13\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t17\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t17\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t12\".\"MOVIE_ID\", \"t12\".\"TITLE\", \"t12\".\"PRODUCTION_YEAR\", \"t12\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t12\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t12\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t12\".\"MOVIE_ID\") AS \"t13\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t13\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t16\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t16\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t16\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t17\" ON \"t13\".\"person_id\" = \"t17\".\"person_id\"\nGROUP BY \"t13\".\"MOVIE_ID\") AS \"t19\" ON \"t11\".\"MOVIE_ID\" = \"t19\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t19\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t19\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t11\".\"TITLE\") AS \"t21\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"s1\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t21\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t10\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t10\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92189",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92189,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 234997.0,
        "cutRowSizeOutBytes" : 141.60463378255892,
        "cutOutputBytes" : 3.3276664125E7,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"name\", \"country_code\", \"imdb_id\", \"name_pcode_nf\", \"name_pcode_sf\", \"md5sum\"\nFROM \"company_name\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "name",
          "type" : "VARCHAR"
        }, {
          "name" : "country_code",
          "type" : "VARCHAR"
        }, {
          "name" : "imdb_id",
          "type" : "INTEGER"
        }, {
          "name" : "name_pcode_nf",
          "type" : "VARCHAR"
        }, {
          "name" : "name_pcode_sf",
          "type" : "VARCHAR"
        }, {
          "name" : "md5sum",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"s1\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"movie_companies\" ON \"aka_title3\".\"id\" = \"movie_companies\".\"movie_id\") ON \"t21\".\"id\" = \"movie_companies\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92673",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92673,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 867453.8719174126,
        "cutRowSizeOutBytes" : 232.93222205704967,
        "cutOutputBytes" : 2.0205795791771427E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "JOIN" : 1,
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 51,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 17,
            "OTHER" : 22,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"aka_title\".\"id\", \"aka_title\".\"id\") AS \"id\", \"aka_title\".\"movie_id\", \"aka_title\".\"title\", \"aka_title\".\"imdb_index\", \"aka_title\".\"kind_id\", \"aka_title\".\"production_year\", \"aka_title\".\"phonetic_code\", \"aka_title\".\"episode_of_id\", \"aka_title\".\"season_nr\", \"aka_title\".\"episode_nr\", \"aka_title\".\"note\", \"aka_title\".\"md5sum\", \"movie_companies\".\"id\" AS \"id0\", \"movie_companies\".\"movie_id\" AS \"movie_id0\", \"movie_companies\".\"company_id\", \"movie_companies\".\"company_type_id\", \"movie_companies\".\"note\" AS \"note0\"\nFROM \"aka_title\"\nINNER JOIN \"movie_companies\" ON \"aka_title\".\"id\" = \"movie_companies\".\"movie_id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "title",
          "type" : "VARCHAR"
        }, {
          "name" : "imdb_index",
          "type" : "VARCHAR"
        }, {
          "name" : "kind_id",
          "type" : "INTEGER"
        }, {
          "name" : "production_year",
          "type" : "INTEGER"
        }, {
          "name" : "phonetic_code",
          "type" : "VARCHAR"
        }, {
          "name" : "episode_of_id",
          "type" : "INTEGER"
        }, {
          "name" : "season_nr",
          "type" : "INTEGER"
        }, {
          "name" : "episode_nr",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        }, {
          "name" : "md5sum",
          "type" : "VARCHAR"
        }, {
          "name" : "id0",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id0",
          "type" : "INTEGER"
        }, {
          "name" : "company_id",
          "type" : "INTEGER"
        }, {
          "name" : "company_type_id",
          "type" : "INTEGER"
        }, {
          "name" : "note0",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"s1\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN \"s1\" ON \"t21\".\"id\" = \"s1\".\"company_id\"\nGROUP BY \"s1\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_92187",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 92187,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 6893028.779713634,
      "costAllDatafusion" : 3.1657297370157763E7,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "job_random",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          },
          "datafusion" : {
            "aMs" : 0.0,
            "bMsPerRow" : 0.0,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 0.0
          }
        },
        "decorrelatedPlanSha256" : "115630b04232b68b00b554deb479f1553c85532a99ee60464d1d7976fc8d2872",
        "cutPolicy" : "RANDOM",
        "randomSeed" : 1,
        "schemaName" : "IMDB"
      },
      "planStats" : {
        "totalNodes" : 64,
        "maxDepth" : 17,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 24,
          "AGGREGATE" : 6,
          "SORT" : 1,
          "FILTER" : 5
        },
        "rootOutputRows" : 1.448812158883545E9,
        "rootRowSizeOutBytes" : 238.37862960339945
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 2609129.0,
        "cutRowSizeOutBytes" : 50.55359245365024,
        "cutOutputBytes" : 1.31900844125E8,
        "transferEstimatedMs" : 0.0,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 53,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 23,
            "AGGREGATE" : 6,
            "SORT" : 1,
            "FILTER" : 5
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"id\", \"id\") AS \"id\", \"movie_id\", \"company_id\", \"company_type_id\", \"note\"\nFROM \"movie_companies\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "id",
          "type" : "INTEGER"
        }, {
          "name" : "movie_id",
          "type" : "INTEGER"
        }, {
          "name" : "company_id",
          "type" : "INTEGER"
        }, {
          "name" : "company_type_id",
          "type" : "INTEGER"
        }, {
          "name" : "note",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t26\".\"TITLE\", \"t26\".\"TITLE\") AS \"TITLE\", \"t26\".\"PRODUCTION_YEAR\", \"t26\".\"CAST_COUNT\", \"t26\".\"AVG_SALARY\", \"t26\".\"COMPANY_COUNT\", \"t26\".\"BUDGET_CATEGORY\"\nFROM (SELECT \"t9\".\"TITLE\", \"t9\".\"PRODUCTION_YEAR\", CASE WHEN \"t9\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t9\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END AS \"CAST_COUNT\", CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END AS \"AVG_SALARY\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"COMPANY_COUNT\", CASE WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END > 1.000000E5 THEN 'High Budget  ' WHEN CASE WHEN \"t9\".\"AVG_SALARY\" IS NOT NULL THEN CAST(\"t9\".\"AVG_SALARY\" AS FLOAT) ELSE 0E0 END >= 5.00000E4 THEN 'Medium Budget' ELSE 'Low Budget   ' END AS \"BUDGET_CATEGORY\"\nFROM (SELECT \"t0\".\"MOVIE_ID\" AS \"MOVIE_ID\", \"t0\".\"TITLE\" AS \"TITLE\", \"t0\".\"PRODUCTION_YEAR\" AS \"PRODUCTION_YEAR\", \"t0\".\"RAN\" AS \"RAN\", \"t8\".\"MOVIE_ID\" AS \"MOVIE_ID0\", \"t8\".\"CAST_COUNT\" AS \"CAST_COUNT\", \"t8\".\"AVG_SALARY\" AS \"AVG_SALARY\", \"t8\".\"GENRES\" AS \"GENRES\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t0\"\nLEFT JOIN (SELECT \"t2\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t6\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t6\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t1\".\"MOVIE_ID\", \"t1\".\"TITLE\", \"t1\".\"PRODUCTION_YEAR\", \"t1\".\"RAN\", \"complete_cast\".\"id\", \"complete_cast\".\"movie_id\", \"complete_cast\".\"subject_id\", \"complete_cast\".\"status_id\", \"cast_info\".\"id\" AS \"id0\", \"cast_info\".\"person_id\", \"cast_info\".\"movie_id\" AS \"movie_id0\", \"cast_info\".\"person_role_id\", \"cast_info\".\"note\", \"cast_info\".\"nr_order\", \"cast_info\".\"role_id\", \"movie_keyword\".\"id\" AS \"id1\", \"movie_keyword\".\"movie_id\" AS \"movie_id1\", \"movie_keyword\".\"keyword_id\"\nFROM \"movie_keyword\"\nRIGHT JOIN (\"cast_info\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t1\" INNER JOIN \"complete_cast\" ON \"t1\".\"MOVIE_ID\" = \"complete_cast\".\"movie_id\") ON \"cast_info\".\"person_id\" = \"complete_cast\".\"subject_id\") ON \"movie_keyword\".\"movie_id\" = \"t1\".\"MOVIE_ID\") AS \"t2\"\nLEFT JOIN \"keyword\" ON \"t2\".\"keyword_id\" = \"keyword\".\"id\"\nLEFT JOIN (SELECT \"person_info\".\"id\", \"person_info\".\"person_id\", \"person_info\".\"info_type_id\", \"person_info\".\"info\", \"person_info\".\"note\", \"t5\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t5\"\nINNER JOIN \"person_info\" ON \"t5\".\"FD_D_f0\" = \"person_info\".\"info_type_id\") AS \"t6\" ON \"t2\".\"person_id\" = \"t6\".\"person_id\"\nGROUP BY \"t2\".\"MOVIE_ID\") AS \"t8\" ON \"t0\".\"MOVIE_ID\" = \"t8\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t8\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t8\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t20\".\"TITLE\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t10\".\"TITLE\"\nFROM (SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t10\"\nLEFT JOIN (SELECT \"t12\".\"MOVIE_ID\", COUNT(*) AS \"CAST_COUNT\", AVG(CASE WHEN CAST(\"t16\".\"info\" AS FLOAT) IS NOT NULL THEN CAST(CAST(\"t16\".\"info\" AS FLOAT) AS FLOAT) ELSE 0E0 END) AS \"AVG_SALARY\", LISTAGG(DISTINCT \"keyword0\".\"keyword\", ', ') AS \"GENRES\"\nFROM (SELECT \"t11\".\"MOVIE_ID\", \"t11\".\"TITLE\", \"t11\".\"PRODUCTION_YEAR\", \"t11\".\"RAN\", \"complete_cast0\".\"id\", \"complete_cast0\".\"movie_id\", \"complete_cast0\".\"subject_id\", \"complete_cast0\".\"status_id\", \"cast_info0\".\"id\" AS \"id0\", \"cast_info0\".\"person_id\", \"cast_info0\".\"movie_id\" AS \"movie_id0\", \"cast_info0\".\"person_role_id\", \"cast_info0\".\"note\", \"cast_info0\".\"nr_order\", \"cast_info0\".\"role_id\", \"movie_keyword0\".\"id\" AS \"id1\", \"movie_keyword0\".\"movie_id\" AS \"movie_id1\", \"movie_keyword0\".\"keyword_id\"\nFROM \"movie_keyword\" AS \"movie_keyword0\"\nRIGHT JOIN (\"cast_info\" AS \"cast_info0\" INNER JOIN ((SELECT \"id\" AS \"MOVIE_ID\", \"title\" AS \"TITLE\", \"production_year\" AS \"PRODUCTION_YEAR\", ROW_NUMBER() OVER (PARTITION BY \"production_year\" ORDER BY \"production_year\" DESC NULLS FIRST) AS \"RAN\"\nFROM \"aka_title\") AS \"t11\" INNER JOIN \"complete_cast\" AS \"complete_cast0\" ON \"t11\".\"MOVIE_ID\" = \"complete_cast0\".\"movie_id\") ON \"cast_info0\".\"person_id\" = \"complete_cast0\".\"subject_id\") ON \"movie_keyword0\".\"movie_id\" = \"t11\".\"MOVIE_ID\") AS \"t12\"\nLEFT JOIN \"keyword\" AS \"keyword0\" ON \"t12\".\"keyword_id\" = \"keyword0\".\"id\"\nLEFT JOIN (SELECT \"person_info0\".\"id\", \"person_info0\".\"person_id\", \"person_info0\".\"info_type_id\", \"person_info0\".\"info\", \"person_info0\".\"note\", \"t15\".\"FD_D_f0\"\nFROM (SELECT SINGLE_VALUE(\"id\") AS \"FD_D_f0\"\nFROM \"info_type\"\nWHERE \"info\" = 'salary') AS \"t15\"\nINNER JOIN \"person_info\" AS \"person_info0\" ON \"t15\".\"FD_D_f0\" = \"person_info0\".\"info_type_id\") AS \"t16\" ON \"t12\".\"person_id\" = \"t16\".\"person_id\"\nGROUP BY \"t12\".\"MOVIE_ID\") AS \"t18\" ON \"t10\".\"MOVIE_ID\" = \"t18\".\"MOVIE_ID\"\nWHERE CASE WHEN \"t18\".\"CAST_COUNT\" IS NOT NULL THEN CAST(\"t18\".\"CAST_COUNT\" AS BIGINT) ELSE 0 END > 0\nGROUP BY \"t10\".\"TITLE\") AS \"t20\"\nLEFT JOIN (SELECT \"aka_title3\".\"title\" AS \"TITLE\", COUNT(*) AS \"EXPR$0\"\nFROM (SELECT *\nFROM \"company_name\"\nWHERE \"country_code\" = 'USA') AS \"t21\"\nINNER JOIN (\"aka_title\" AS \"aka_title3\" INNER JOIN \"s1\" ON \"aka_title3\".\"id\" = \"s1\".\"movie_id\") ON \"t21\".\"id\" = \"s1\".\"company_id\"\nGROUP BY \"aka_title3\".\"title\") AS \"t23\" ON \"t20\".\"TITLE\" IS NOT DISTINCT FROM \"t23\".\"TITLE\") AS \"t24\" ON \"t9\".\"TITLE\" = \"t24\".\"TITLE\"\nORDER BY \"t9\".\"PRODUCTION_YEAR\" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS \"t26\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "PRODUCTION_YEAR",
          "type" : "INTEGER"
        }, {
          "name" : "CAST_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "AVG_SALARY",
          "type" : "FLOAT"
        }, {
          "name" : "COMPANY_COUNT",
          "type" : "BIGINT"
        }, {
          "name" : "BUDGET_CATEGORY",
          "type" : "CHAR"
        } ]
      } ]
    }
  } ]
}