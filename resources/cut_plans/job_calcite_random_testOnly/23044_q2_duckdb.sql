SELECT COALESCE("t8"."MOVIE_ID", "t8"."MOVIE_ID") AS "MOVIE_ID", "t8"."TITLE", "t8"."PRODUCTION_YEAR", "t8"."GENRES", "t8"."TOTAL_CAST", "t8"."DIRECTOR_COUNT", "t8"."MOVIE_STATUS"
FROM (SELECT "t6"."MOVIE_ID", "t6"."TITLE", "t6"."PRODUCTION_YEAR", "t6"."GENRES", CASE WHEN "t5"."TOTAL_CAST" IS NOT NULL THEN CAST("t5"."TOTAL_CAST" AS BIGINT) ELSE 0 END AS "TOTAL_CAST", CASE WHEN "t5"."DIRECTOR_COUNT" IS NOT NULL THEN CAST("t5"."DIRECTOR_COUNT" AS INTEGER) ELSE 0 END AS "DIRECTOR_COUNT", CASE WHEN "t6"."GENRES" IS NOT NULL THEN 'Valid Movie    ' ELSE 'Incomplete Data' END AS "MOVIE_STATUS"
FROM (SELECT "cast_info"."movie_id" AS "MOVIE_ID", COUNT(DISTINCT "cast_info"."person_id") AS "TOTAL_CAST", SUM(CASE WHEN "role_type"."role" = 'Director' THEN 1 ELSE 0 END) AS "DIRECTOR_COUNT"
FROM "IMDB"."role_type"
INNER JOIN "IMDB"."cast_info" ON "role_type"."id" = "cast_info"."role_id"
GROUP BY "cast_info"."movie_id") AS "t5"
RIGHT JOIN (SELECT "MOVIE_ID", "TITLE", "PRODUCTION_YEAR", LISTAGG(DISTINCT "keyword", "FD_COL_4") AS "GENRES"
FROM "s1"
GROUP BY "MOVIE_ID", "TITLE", "PRODUCTION_YEAR") AS "t6" ON "t5"."MOVIE_ID" = "t6"."MOVIE_ID"
ORDER BY "t6"."PRODUCTION_YEAR" DESC NULLS FIRST, "t6"."TITLE") AS "t8"