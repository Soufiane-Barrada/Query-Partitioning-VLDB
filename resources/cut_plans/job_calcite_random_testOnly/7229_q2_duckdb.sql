SELECT COALESCE("t5"."MOVIE_TITLE", "t5"."MOVIE_TITLE") AS "MOVIE_TITLE", "t5"."PRODUCTION_YEAR", "t5"."KEYWORD_COUNT", "t5"."COMPANY_COUNT", "t5"."ROLE_COUNT"
FROM (SELECT "s1"."title" AS "MOVIE_TITLE", "s1"."production_year" AS "PRODUCTION_YEAR", "s1"."KEYWORD_COUNT", "t3"."COMPANY_COUNT", "s1"."ROLE_COUNT"
FROM (SELECT "movie_id", COUNT(*) AS "COMPANY_COUNT"
FROM "IMDB"."movie_companies"
GROUP BY "movie_id") AS "t3"
INNER JOIN "s1" ON "t3"."movie_id" = "s1"."id"
ORDER BY "s1"."production_year" DESC NULLS FIRST, "s1"."KEYWORD_COUNT" DESC NULLS FIRST, "t3"."COMPANY_COUNT" DESC NULLS FIRST) AS "t5"