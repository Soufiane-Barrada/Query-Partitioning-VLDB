SELECT COALESCE("MOVIE_TITLE", "MOVIE_TITLE") AS "MOVIE_TITLE", "PRODUCTION_YEAR", "ACTOR_COUNT", "KEYWORDS", "PRODUCTION_COMPANIES"
FROM (SELECT "MOVIE_TITLE", "PRODUCTION_YEAR", COUNT(DISTINCT "ACTOR_NAME") AS "ACTOR_COUNT", LISTAGG(DISTINCT "MOVIE_KEYWORD", "FD_COL_4") AS "KEYWORDS", LISTAGG(DISTINCT "COMPANY_NAME", "FD_COL_4") AS "PRODUCTION_COMPANIES"
FROM "s1"
GROUP BY "MOVIE_TITLE", "PRODUCTION_YEAR"
ORDER BY "PRODUCTION_YEAR" DESC NULLS FIRST, 3 DESC NULLS FIRST) AS "t4"