SELECT COALESCE("ACTOR_NAME", "ACTOR_NAME") AS "ACTOR_NAME", "MOVIE_TITLE", "PRODUCTION_YEAR", "ROLE_KIND", "KEYWORD_COUNT", "KEYWORDS", "name"
FROM (SELECT ANY_VALUE("name") AS "ACTOR_NAME", ANY_VALUE("title") AS "MOVIE_TITLE", "PRODUCTION_YEAR", ANY_VALUE("kind") AS "ROLE_KIND", COUNT(DISTINCT "keyword") AS "KEYWORD_COUNT", LISTAGG(DISTINCT "keyword", "FD_COL_5") AS "KEYWORDS", "name"
FROM "s1"
GROUP BY "name", "title", "PRODUCTION_YEAR", "kind"
ORDER BY 5 DESC NULLS FIRST, "name") AS "t4"