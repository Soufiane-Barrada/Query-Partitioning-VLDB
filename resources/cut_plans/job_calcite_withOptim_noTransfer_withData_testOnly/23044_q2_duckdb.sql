SELECT COALESCE("t8"."MOVIE_ID", "t8"."MOVIE_ID") AS "MOVIE_ID", "t8"."TITLE", "t8"."PRODUCTION_YEAR", "t8"."GENRES", "t8"."TOTAL_CAST", "t8"."DIRECTOR_COUNT", "t8"."MOVIE_STATUS"
FROM (SELECT "t6"."MOVIE_ID", "t6"."TITLE", "t6"."PRODUCTION_YEAR", "t6"."GENRES", CASE WHEN "t1"."TOTAL_CAST" IS NOT NULL THEN CAST("t1"."TOTAL_CAST" AS BIGINT) ELSE 0 END AS "TOTAL_CAST", CASE WHEN "t1"."DIRECTOR_COUNT" IS NOT NULL THEN CAST("t1"."DIRECTOR_COUNT" AS INTEGER) ELSE 0 END AS "DIRECTOR_COUNT", CASE WHEN "t6"."GENRES" IS NOT NULL THEN 'Valid Movie    ' ELSE 'Incomplete Data' END AS "MOVIE_STATUS"
FROM (SELECT "MOVIE_ID", COUNT(DISTINCT "person_id") AS "TOTAL_CAST", SUM("FD_COL_2") AS "DIRECTOR_COUNT"
FROM "s1"
GROUP BY "MOVIE_ID") AS "t1"
RIGHT JOIN (SELECT "t4"."MOVIE_ID", "t4"."TITLE", "t4"."PRODUCTION_YEAR", LISTAGG(DISTINCT "keyword"."keyword", ', ') AS "GENRES"
FROM (SELECT "t2"."MOVIE_ID", "t2"."TITLE", "t2"."PRODUCTION_YEAR", "t2"."YEAR_RANK", "movie_keyword"."id", "movie_keyword"."movie_id", "movie_keyword"."keyword_id"
FROM "IMDB"."movie_keyword"
RIGHT JOIN (SELECT "id" AS "MOVIE_ID", "title" AS "TITLE", "production_year" AS "PRODUCTION_YEAR", ROW_NUMBER() OVER (PARTITION BY "production_year" ORDER BY "title") AS "YEAR_RANK"
FROM "IMDB"."aka_title") AS "t2" ON "movie_keyword"."movie_id" = "t2"."MOVIE_ID"
WHERE "t2"."PRODUCTION_YEAR" >= 2000 AND "t2"."PRODUCTION_YEAR" <= 2023) AS "t4"
LEFT JOIN "IMDB"."keyword" ON "t4"."keyword_id" = "keyword"."id"
GROUP BY "t4"."MOVIE_ID", "t4"."TITLE", "t4"."PRODUCTION_YEAR") AS "t6" ON "t1"."MOVIE_ID" = "t6"."MOVIE_ID"
ORDER BY "t6"."PRODUCTION_YEAR" DESC NULLS FIRST, "t6"."TITLE") AS "t8"