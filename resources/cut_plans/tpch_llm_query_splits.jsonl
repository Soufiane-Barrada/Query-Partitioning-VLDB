{"query_id": "10001.sql", "original_sql": "SELECT\n    p.p_partkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    r.r_name = 'AMERICA'\nGROUP BY\n    p.p_partkey\nORDER BY\n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'AMERICA';", "sql2": "SELECT p.p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nGROUP BY p.p_partkey\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10029.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= '1995-01-01' \n    AND l.l_shipdate < '1996-01-01'\nGROUP BY \n    p.p_brand, \n    p.p_type\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH filtered_line AS (\n    SELECT l.l_partkey, l.l_suppkey, l.l_extendedprice, l.l_discount\n    FROM lineitem l\n    WHERE l.l_shipdate >= DATE '1995-01-01'\n      AND l.l_shipdate < DATE '1996-01-01'\n)\nSELECT \n    p.p_brand,\n    p.p_type,\n    ps.ps_suppkey AS suppkey,\n    SUM(fl.l_extendedprice * (1 - fl.l_discount)) AS revenue\nFROM filtered_line fl\nJOIN partsupp ps\n  ON fl.l_partkey = ps.ps_partkey\nJOIN part p\n  ON ps.ps_partkey = p.p_partkey\nGROUP BY p.p_brand, p.p_type, ps.ps_suppkey;", "sql2": "SELECT \n    s1.p_brand,\n    s1.p_type,\n    SUM(s1.revenue) AS total_revenue\nFROM s1\nJOIN supplier s\n  ON s1.suppkey = s.s_suppkey\nJOIN nation n\n  ON s.s_nationkey = n.n_nationkey\nJOIN region r\n  ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY s1.p_brand, s1.p_type\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10149.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nGROUP BY p.p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10161.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(o.o_totalprice) AS total_revenue\nFROM \n    nation n\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    customer c ON n.n_nationkey = c.c_nationkey\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "10216.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' AND \n    l.l_shipdate >= DATE '1997-01-01' AND \n    l.l_shipdate < DATE '1998-01-01'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT \n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nWHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\nGROUP BY p.p_partkey, p.p_name\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10363.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_brand, p.p_type\nORDER BY \n    total_cost DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT ps.ps_partkey AS p_partkey,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS part_total_cost\nFROM partsupp ps\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY ps.ps_partkey;", "sql2": "SELECT p.p_brand,\n       p.p_type,\n       SUM(s1.part_total_cost) AS total_cost\nFROM s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nGROUP BY p.p_brand, p.p_type\nORDER BY total_cost DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10389.sql", "original_sql": "SELECT \n    n_name,\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM \n    lineitem\nJOIN \n    orders ON l_orderkey = o_orderkey\nJOIN \n    customer ON o_custkey = c_custkey\nJOIN \n    supplier ON l_suppkey = s_suppkey\nJOIN \n    partsupp ON l_partkey = ps_partkey AND s_suppkey = ps_suppkey\nJOIN \n    nation ON s_nationkey = n_nationkey\nGROUP BY \n    n_name\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l_suppkey AS s_suppkey,\n       SUM(l_extendedprice * (1 - l_discount)) AS supp_rev\nFROM lineitem\nGROUP BY l_suppkey;", "sql2": "SELECT n.n_name,\n       SUM(s1.supp_rev) AS revenue\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10405.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    r.r_name AS region_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= DATE '1993-01-01' AND o.o_orderdate < DATE '1994-01-01'\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_suppkey AS s_suppkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1993-01-01'\n  AND o.o_orderdate < DATE '1994-01-01'\nGROUP BY l.l_suppkey;", "sql2": "SELECT n.n_name AS nation_name,\n       r.r_name AS region_name,\n       SUM(s1.rev) AS total_revenue\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nGROUP BY n.n_name, r.r_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10406.sql", "original_sql": "SELECT \n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-02-01'\nGROUP BY \n    n.n_name\nORDER BY \n    revenue DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "10570.sql", "original_sql": "SELECT \n    l.l_orderkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nWHERE \n    c.c_mktsegment = 'BUILDING'\n    AND l.l_shipdate >= DATE '1995-01-01'\n    AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY \n    l.l_orderkey\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    l.l_orderkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE \n    c.c_mktsegment = 'BUILDING'\n    AND l.l_shipdate >= DATE '1995-01-01'\n    AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY l.l_orderkey;", "sql2": "SELECT \n    s1.l_orderkey,\n    s1.total_revenue\nFROM s1\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10571.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(ps.ps_availqty) AS total_avail_qty, \n    SUM(ps.ps_supplycost) AS total_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'AFRICA'\nGROUP BY \n    p.p_partkey, \n    p.p_name\nORDER BY \n    total_avail_qty DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_partkey, p.p_name, SUM(ps.ps_availqty) AS total_avail_qty, SUM(ps.ps_supplycost) AS total_supply_cost\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'AFRICA'\nGROUP BY p.p_partkey, p.p_name;", "sql2": "SELECT p_partkey, p_name, total_avail_qty, total_supply_cost\nFROM s1\nORDER BY total_avail_qty DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "10604.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY l.l_partkey", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       s1.rev AS total_revenue\nFROM (\n    SELECT p_partkey, rev\n    FROM s1\n) s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10606.sql", "original_sql": "SELECT\n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    customer AS c\nJOIN\n    orders AS o ON c.c_custkey = o.o_custkey\nJOIN\n    lineitem AS l ON o.o_orderkey = l.l_orderkey\nJOIN\n    supplier AS s ON l.l_suppkey = s.s_suppkey\nJOIN\n    partsupp AS ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN\n    nation AS n ON s.s_nationkey = n.n_nationkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY\n    n.n_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    s.s_nationkey AS nation_key,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM\n    customer c\nJOIN\n    orders o ON c.c_custkey = o.o_custkey\nJOIN\n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN\n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN\n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY\n    s.s_nationkey;", "sql2": "SELECT\n    n.n_name,\n    s1.revenue AS total_revenue\nFROM\n    s1\nJOIN\n    nation n ON s1.nation_key = n.n_nationkey\nORDER BY\n    total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10610.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-12-31'\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT n.n_name AS nation,\n       r.r_name AS region,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY n.n_name, r.r_name;", "sql2": "SELECT nation, region, total_revenue\nFROM s1\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10612.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    customer AS c\nJOIN \n    orders AS o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem AS l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier AS s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp AS ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    part AS p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation AS n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "10638.sql", "original_sql": "SELECT \n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    nation n\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_suppkey AS suppkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN part p ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON ps.ps_partkey = p.p_partkey\nGROUP BY ps.ps_suppkey", "sql2": "SELECT \n    n.n_name,\n    SUM(s1.revenue) AS total_revenue\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.suppkey\nJOIN nation n ON n.n_nationkey = s.s_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10766.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part AS p\nJOIN \n    lineitem AS l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp AS ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier AS s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation AS n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region AS r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE' \n    AND l.l_shipdate >= DATE '1995-01-01' \n    AND l.l_shipdate < DATE '1995-02-01'\nGROUP BY \n    p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'EUROPE'\n  AND l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1995-02-01'\nGROUP BY l.l_partkey", "sql2": "SELECT p.p_name,\n       s1.revenue\nFROM s1\nJOIN part p ON s1.p_partkey = p.p_partkey\nORDER BY s1.revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10773.sql", "original_sql": "SELECT \n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(l.l_discount) AS average_discount,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: SchemaError(FieldNotFound { field: Column { relation: None, name: \"total_revenue\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }, Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))\n", "engine_mem_mb": 500000}
{"query_id": "10799.sql", "original_sql": "SELECT \n    n_name AS nation, \n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM \n    customer\nJOIN \n    orders ON c_custkey = o_custkey\nJOIN \n    lineitem ON o_orderkey = l_orderkey\nJOIN \n    supplier ON l_suppkey = s_suppkey\nJOIN \n    nation ON s_nationkey = n_nationkey\nGROUP BY \n    n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT n_name AS nation,\n       SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM lineitem\nJOIN supplier ON l_suppkey = s_suppkey\nJOIN nation ON s_nationkey = n_nationkey\nGROUP BY n_name", "sql2": "SELECT nation, total_revenue\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10809.sql", "original_sql": "SELECT\n    p.p_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    COUNT(DISTINCT s.s_suppkey) AS total_suppliers\nFROM\n    part p\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nGROUP BY\n    p.p_name\nORDER BY\n    total_available_quantity DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT ps.ps_partkey,\n       SUM(ps.ps_availqty) AS total_available_quantity,\n       AVG(ps.ps_supplycost) AS average_supply_cost,\n       COUNT(DISTINCT s.s_suppkey) AS total_suppliers\nFROM partsupp ps\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nGROUP BY ps.ps_partkey;", "sql2": "SELECT p.p_name,\n       s1.total_available_quantity,\n       s1.average_supply_cost,\n       s1.total_suppliers\nFROM part p\nJOIN s1 ON p.p_partkey = s1.ps_partkey\nORDER BY s1.total_available_quantity DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10823.sql", "original_sql": "SELECT \n    n_name AS nation,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM \n    lineitem\nJOIN \n    orders ON lineitem.l_orderkey = orders.o_orderkey\nJOIN \n    customer ON orders.o_custkey = customer.c_custkey\nJOIN \n    supplier ON lineitem.l_suppkey = supplier.s_suppkey\nJOIN \n    nation ON supplier.s_nationkey = nation.n_nationkey\nGROUP BY \n    n_name\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l_suppkey AS suppkey,\n       SUM(l_extendedprice * (1 - l_discount)) AS rev\nFROM lineitem\nGROUP BY l_suppkey;", "sql2": "SELECT n.n_name AS nation,\n       SUM(s1.rev) AS total_revenue\nFROM s1\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "10834.sql", "original_sql": "SELECT\n    p.p_brand,\n    p.p_type,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1996-01-01'\n    AND l.l_shipdate < DATE '1996-01-31'\nGROUP BY\n    p.p_brand,\n    p.p_type\nORDER BY\n    total_sales DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "10968.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue \nFROM \n    nation n \nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey \nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey \nJOIN \n    part p ON ps.ps_partkey = p.p_partkey \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1998-01-01' \nGROUP BY \n    n.n_name \nORDER BY \n    total_revenue DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "10997.sql", "original_sql": "SELECT \n    l.l_orderkey, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    o.o_orderdate,\n    c.c_name,\n    s.s_name,\n    p.p_name,\n    n.n_name,\n    r.r_name\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    l.l_orderkey, o.o_orderdate, c.c_name, s.s_name, p.p_name, n.n_name, r.r_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    l.l_orderkey,\n    o.o_orderdate,\n    s.s_suppkey,\n    p.p_partkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY l.l_orderkey, o.o_orderdate, s.s_suppkey, p.p_partkey;", "sql2": "SELECT \n    s1.l_orderkey,\n    s1.revenue,\n    s1.o_orderdate,\n    c.c_name,\n    sup.s_name,\n    pr.p_name,\n    n.n_name,\n    r.r_name\nFROM s1\nJOIN orders o ON s1.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN supplier sup ON s1.s_suppkey = sup.s_suppkey\nJOIN part pr ON s1.p_partkey = pr.p_partkey\nJOIN nation n ON sup.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11040.sql", "original_sql": "SELECT \n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(s.s_acctbal) AS avg_supplier_balance\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(s.s_acctbal) AS avg_supplier_balance\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nGROUP BY p.p_name", "sql2": "SELECT p_name, total_quantity, total_revenue, avg_supplier_balance\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11042.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1995-01-01'\n    AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY \n    p.p_name\nORDER BY \n    revenue DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT s.s_suppkey AS suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT p.p_name,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nJOIN part p ON p.p_partkey = l.l_partkey\nJOIN s1 ON l.l_suppkey = s1.suppkey\nWHERE l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY p.p_name\nORDER BY revenue DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11056.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue \nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1997-01-01' \n    AND l.l_shipdate < DATE '1997-01-31' \nGROUP BY \n    p.p_partkey, p.p_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN (SELECT s_suppkey FROM s1) s_filt ON ps.ps_suppkey = s_filt.s_suppkey\nWHERE l.l_shipdate >= DATE '1997-01-01'\n  AND l.l_shipdate < DATE '1997-01-31'\nGROUP BY p.p_partkey, p.p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11069.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales \nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1996-01-01' \n    AND l.l_shipdate < DATE '1996-12-31' \nGROUP BY \n    p.p_name \nORDER BY \n    total_sales DESC \nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA' AND l.l_shipdate >= DATE '1996-01-01' AND l.l_shipdate < DATE '1996-12-31' GROUP BY p.p_partkey", "sql2": "SELECT p.p_name, s1.total_sales FROM s1 JOIN part p ON p.p_partkey = s1.p_partkey ORDER BY s1.total_sales DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11081.sql", "original_sql": "SELECT \n    l_orderkey,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue,\n    o_orderdate,\n    c_name,\n    s_name\nFROM \n    lineitem\nJOIN \n    orders ON l_orderkey = o_orderkey\nJOIN \n    customer ON o_custkey = c_custkey\nJOIN \n    partsupp ON l_partkey = ps_partkey\nJOIN \n    supplier ON ps_suppkey = s_suppkey\nGROUP BY \n    l_orderkey, o_orderdate, c_name, s_name\nORDER BY \n    total_revenue DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    l_orderkey,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue,\n    o_orderdate,\n    c_name,\n    s_name\nFROM lineitem\nJOIN orders ON l_orderkey = o_orderkey\nJOIN customer ON o_custkey = c_custkey\nJOIN partsupp ON l_partkey = ps_partkey\nJOIN supplier ON ps_suppkey = s_suppkey\nGROUP BY l_orderkey, o_orderdate, c_name, s_name", "sql2": "SELECT *\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 100", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "11083.sql", "original_sql": "SELECT \n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY p.p_name;", "sql2": "SELECT p_name, total_quantity, total_revenue\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11095.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'Asia' \nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey, p.p_name, SUM(l.l_quantity) AS total_quantity, SUM(l.l_extendedprice) AS total_revenue FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'Asia' GROUP BY p.p_partkey, p.p_name", "sql2": "SELECT p_partkey, p_name, total_quantity, total_revenue FROM s1 ORDER BY total_revenue DESC LIMIT 10", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "11108.sql", "original_sql": "SELECT \n    s.s_name, \n    SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-12-31'\nGROUP BY \n    s.s_name\nORDER BY \n    total_cost DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT ps.ps_suppkey AS suppkey,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\nFROM partsupp ps\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY ps.ps_suppkey", "sql2": "SELECT s.s_name,\n       s1.total_cost\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.suppkey\nORDER BY s1.total_cost DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11121.sql", "original_sql": "SELECT \n    l.l_orderkey, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND o.o_orderdate >= DATE '1995-01-01'\n    AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY \n    l.l_orderkey\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Collection([Diagnostic(Diagnostic { kind: Error, message: \"column 'l_orderkey' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"l_orderkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))), Diagnostic(Diagnostic { kind: Error, message: \"column 'revenue' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"revenue\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\")))])\n", "engine_mem_mb": 500000}
{"query_id": "11134.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue \nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'Europe' \nGROUP BY \n    p.p_name \nORDER BY \n    total_quantity DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey,\n       p.p_name,\n       COUNT(*) AS mult\nFROM   part p\nJOIN   partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN   supplier s   ON ps.ps_suppkey = s.s_suppkey\nJOIN   nation n     ON s.s_nationkey = n.n_nationkey\nJOIN   region r     ON n.n_regionkey = r.r_regionkey\nWHERE  r.r_name = 'Europe'\nGROUP BY p.p_partkey, p.p_name;", "sql2": "SELECT s1.p_name,\n       SUM(l.l_quantity * s1.mult)   AS total_quantity,\n       SUM(l.l_extendedprice * s1.mult) AS total_revenue\nFROM   s1\nJOIN   lineitem l ON s1.p_partkey = l.l_partkey\nGROUP BY s1.p_name\nORDER BY total_quantity DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "11135.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1996-01-01' \n    AND l.l_shipdate < DATE '1996-12-31'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "11254.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_name, \n    SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost, \n    COUNT(DISTINCT l.l_orderkey) AS order_count \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    lineitem l ON ps.ps_suppkey = l.l_suppkey \nWHERE \n    p.p_size = 15 \nGROUP BY \n    p.p_brand, p.p_name \nORDER BY \n    total_cost DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_partkey, p.p_brand, p.p_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_size = 15 GROUP BY p.p_partkey, p.p_brand, p.p_name", "sql2": "SELECT s1.p_brand, s1.p_name, s1.total_cost, COUNT(DISTINCT l.l_orderkey) AS order_count FROM s1 JOIN partsupp ps ON s1.p_partkey = ps.ps_partkey JOIN lineitem l ON ps.ps_suppkey = l.l_suppkey GROUP BY s1.p_brand, s1.p_name, s1.total_cost ORDER BY s1.total_cost DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11280.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'AMERICA'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "11281.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    s.s_name AS supplier_name, \n    ps.ps_supplycost, \n    ps.ps_availqty, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-12-31' \nGROUP BY \n    p.p_partkey, p.p_name, s.s_name, ps.ps_supplycost, ps.ps_availqty \nORDER BY \n    total_revenue DESC \nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "WITH filtered_orders AS (\n    SELECT o_orderkey\n    FROM orders\n    WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < DATE '1997-12-31'\n)\nSELECT \n    l.l_partkey AS p_partkey,\n    ps.ps_suppkey AS suppkey,\n    ps.ps_supplycost,\n    ps.ps_availqty,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN filtered_orders fo ON l.l_orderkey = fo.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nGROUP BY l.l_partkey, ps.ps_suppkey, ps.ps_supplycost, ps.ps_availqty;", "sql2": "SELECT \n    s1.p_partkey,\n    p.p_name,\n    s.s_name AS supplier_name,\n    s1.ps_supplycost,\n    s1.ps_availqty,\n    s1.total_revenue\nFROM s1\nJOIN part p ON s1.p_partkey = p.p_partkey\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11294.sql", "original_sql": "SELECT\n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    r.r_name = 'ASIA'\nGROUP BY\n    p.p_partkey,\n    p.p_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT ps.ps_partkey, ps.ps_suppkey\nFROM partsupp ps\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN s1 ON l.l_partkey = s1.ps_partkey AND l.l_suppkey = s1.ps_suppkey\nJOIN part p ON p.p_partkey = l.l_partkey\nGROUP BY p.p_partkey, p.p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11444.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE' \n    AND l.l_shipdate >= '1997-01-01' \n    AND l.l_shipdate < '1997-12-31'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    l.l_partkey AS p_partkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'EUROPE'\n  AND l.l_shipdate >= DATE '1997-01-01'\n  AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY l.l_partkey;", "sql2": "SELECT\n    p.p_partkey,\n    p.p_name,\n    s1.revenue\nFROM s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11486.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(ps.ps_availqty) AS total_avail_qty, \n    SUM(ps.ps_supplycost) AS total_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_avail_qty DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey, p.p_name, SUM(ps.ps_availqty) AS total_avail_qty, SUM(ps.ps_supplycost) AS total_supply_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA' GROUP BY p.p_partkey, p.p_name", "sql2": "SELECT * FROM s1 ORDER BY total_avail_qty DESC LIMIT 100;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11487.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' AND \n    l.l_shipdate >= DATE '1995-01-01' AND \n    l.l_shipdate < DATE '1995-02-01'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\n  AND l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1995-02-01'\nGROUP BY l.l_partkey", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       s1.revenue\nFROM s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11519.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue \nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1995-01-01' \n    AND l.l_shipdate < DATE '1996-01-01' \nGROUP BY \n    p.p_brand, p.p_type \nORDER BY \n    revenue DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT p.p_brand,\n       p.p_type,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nWHERE l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY p.p_brand, p.p_type\nORDER BY revenue DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11532.sql", "original_sql": "SELECT\n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM\n    customer AS c\nJOIN\n    orders AS o ON c.c_custkey = o.o_custkey\nJOIN\n    lineitem AS l ON o.o_orderkey = l.l_orderkey\nJOIN\n    supplier AS s ON l.l_suppkey = s.s_suppkey\nJOIN\n    partsupp AS ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN\n    nation AS n ON s.s_nationkey = n.n_nationkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01'\n    AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY\n    n.n_name\nORDER BY\n    revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "11646.sql", "original_sql": "SELECT\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    SUM(l.l_tax) AS total_tax,\n    SUM(l.l_discount) AS total_discount\nFROM\n    lineitem l\nJOIN\n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    r.r_name = 'ASIA'\nGROUP BY\n    p.p_name\nORDER BY\n    revenue DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT s.s_suppkey AS suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n       SUM(l.l_tax) AS total_tax,\n       SUM(l.l_discount) AS total_discount\nFROM lineitem l\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN s1 ON ps.ps_suppkey = s1.suppkey\nGROUP BY p.p_name\nORDER BY revenue DESC\nLIMIT 100;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11647.sql", "original_sql": "SELECT \n    n.n_name AS nation, \n    r.r_name AS region, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue \nFROM \n    lineitem l \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nJOIN \n    customer c ON o.o_custkey = c.c_custkey \nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    o.o_orderdate >= DATE '1995-01-01' \n    AND o.o_orderdate < DATE '1996-01-01' \nGROUP BY \n    n.n_name, r.r_name \nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l_orderkey AS orderkey,\n       SUM(l_extendedprice * (1 - l_discount)) AS order_rev\nFROM lineitem\nGROUP BY l_orderkey;", "sql2": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    SUM(s1.order_rev) AS total_revenue\nFROM s1\nJOIN orders o ON s1.orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE o.o_orderdate >= DATE '1995-01-01'\n  AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY n.n_name, r.r_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11653.sql", "original_sql": "SELECT\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY\n    p.p_name\nORDER BY\n    total_quantity DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS sum_price,\n       COUNT(*) AS cnt_rows,\n       COUNT(DISTINCT l.l_orderkey) AS total_orders\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\ngroup by p.p_name;", "sql2": "SELECT p_name,\n       total_quantity,\n       sum_price / cnt_rows AS avg_price,\n       total_orders\nFROM s1\nORDER BY total_quantity DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11690.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1997-01-01'\n    AND l.l_shipdate < DATE '1997-04-01'\nGROUP BY \n    p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_partkey AS part_key,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\n  AND l.l_shipdate >= DATE '1997-01-01'\n  AND l.l_shipdate < DATE '1997-04-01'\nGROUP BY p.p_partkey;", "sql2": "SELECT p.p_name,\n       s1.revenue\nFROM part p\nJOIN s1 ON p.p_partkey = s1.part_key\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11691.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1996-01-01' \n    AND l.l_shipdate < DATE '1997-01-01'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey,\n       p.p_name,\n       l.l_extendedprice * (1 - l.l_discount) AS rev\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\n  AND l.l_shipdate >= DATE '1996-01-01'\n  AND l.l_shipdate < DATE '1997-01-01';", "sql2": "SELECT p_partkey,\n       p_name,\n       SUM(rev) AS total_revenue\nFROM s1\nGROUP BY p_partkey, p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11718.sql", "original_sql": "SELECT \n    p.p_partkey,\n    p.p_name,\n    s.s_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderstatus = 'F'\nGROUP BY \n    p.p_partkey, p.p_name, s.s_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS partkey,\n       l.l_suppkey AS suppkey,\n       l.l_extendedprice * (1 - l.l_discount) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderstatus = 'F'", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       s.s_name,\n       SUM(s1.revenue) AS total_revenue\nFROM s1\nJOIN part p ON s1.partkey = p.p_partkey\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nGROUP BY p.p_partkey, p.p_name, s.s_name\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11849.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_sales\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_name\nORDER BY \n    total_sales DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_sales\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY p.p_name;", "sql2": "SELECT *\nFROM s1\nORDER BY total_sales DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11860.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'EUROPE' \nGROUP BY \n    p.p_brand, p.p_type \nORDER BY \n    total_cost DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'EUROPE'", "sql2": "SELECT p.p_brand, p.p_type, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN s1 ON ps.ps_suppkey = s1.s_suppkey GROUP BY p.p_brand, p.p_type ORDER BY total_cost DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "11914.sql", "original_sql": "SELECT \n    p.p_mfgr,\n    COUNT(DISTINCT ps.ps_suppkey) AS supplier_count,\n    SUM(ps.ps_supplycost) AS total_supply_cost\nFROM \n    part AS p\nJOIN \n    partsupp AS ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier AS s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation AS n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region AS r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_mfgr\nORDER BY \n    supplier_count DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_mfgr AS p_mfgr,\n       ps.ps_suppkey AS ps_suppkey,\n       ps.ps_supplycost AS ps_supplycost\nFROM part AS p\nJOIN partsupp AS ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier AS s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation AS n ON s.s_nationkey = n.n_nationkey\nJOIN region AS r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT p_mfgr,\n       COUNT(DISTINCT ps_suppkey) AS supplier_count,\n       SUM(ps_supplycost) AS total_supply_cost\nFROM s1\nGROUP BY p_mfgr\nORDER BY supplier_count DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12005.sql", "original_sql": "SELECT \n    SUM(l_extendedprice * (1 - l_discount)) AS revenue,\n    n_name AS nation\nFROM \n    customer \nJOIN \n    orders ON c_custkey = o_custkey\nJOIN \n    lineitem ON o_orderkey = l_orderkey\nJOIN \n    supplier ON l_suppkey = s_suppkey\nJOIN \n    nation ON s_nationkey = n_nationkey\nGROUP BY \n    n_name\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT n.n_name AS nation,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM   customer c\nJOIN   orders o ON c.c_custkey = o.o_custkey\nJOIN   lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN   supplier s ON l.l_suppkey = s.s_suppkey\nJOIN   nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name;", "sql2": "SELECT nation, revenue\nFROM   s1\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12007.sql", "original_sql": "SELECT \n    p.p_brand,\n    p.p_type,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_brand, p.p_type\nORDER BY \n    total_quantity DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey, ps.ps_suppkey FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA';", "sql2": "SELECT p.p_brand, p.p_type, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN s1 ON p.p_partkey = s1.p_partkey GROUP BY p.p_brand, p.p_type ORDER BY total_quantity DESC LIMIT 100;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12158.sql", "original_sql": "SELECT \n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-02-01'\nGROUP BY \n    n.n_name\nORDER BY \n    revenue DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-02-01'\nGROUP BY s.s_suppkey", "sql2": "SELECT n.n_name,\n       SUM(s1.rev) AS revenue\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY revenue DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12159.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1998-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT n.n_name,\n       l.l_extendedprice * (1 - l.l_discount) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1998-01-01';", "sql2": "SELECT n_name,\n       SUM(revenue) AS total_revenue\nFROM s1\nGROUP BY n_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12164.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'Europe' \n    AND l.l_shipdate >= '1995-01-01' \n    AND l.l_shipdate < '1995-12-31'\nGROUP BY \n    p.p_brand, \n    p.p_type\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT DISTINCT p.p_partkey, ps.ps_suppkey, p.p_brand, p.p_type\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE r.r_name = 'Europe'", "sql2": "SELECT s1.p_brand,\n       s1.p_type,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN s1 ON l.l_partkey = s1.p_partkey AND l.l_suppkey = s1.ps_suppkey\nWHERE l.l_shipdate >= DATE '1995-01-01' AND l.l_shipdate < DATE '1995-12-31'\nGROUP BY s1.p_brand, s1.p_type\nORDER BY total_revenue DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "12207.sql", "original_sql": "SELECT\n    n.n_name AS nation,\n    r.r_name AS region,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    lineitem l\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN\n    customer c ON o.o_custkey = c.c_custkey\nJOIN\n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN\n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01'\n    AND o.o_orderdate < DATE '1997-02-01'\nGROUP BY\n    n.n_name, r.r_name\nORDER BY\n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    s.s_nationkey AS nation_key,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-02-01'\nGROUP BY s.s_nationkey;", "sql2": "SELECT\n    n.n_name AS nation,\n    r.r_name AS region,\n    s1.revenue AS total_revenue\nFROM s1\nJOIN nation n ON s1.nation_key = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12213.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    SUM(ps.ps_supplycost * l.l_quantity) AS total_cost\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY \n    n.n_name\nORDER BY \n    total_cost DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12366.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    r.r_name AS region_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-12-31'\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_orderkey,\n       o.o_custkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY o.o_orderkey, o.o_custkey;", "sql2": "SELECT n.n_name AS nation_name,\n       r.r_name AS region_name,\n       SUM(s1.rev) AS total_revenue\nFROM s1\nJOIN customer c ON s1.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nGROUP BY n.n_name, r.r_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12367.sql", "original_sql": "SELECT \n    l.l_orderkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    o.o_orderdate,\n    n.n_name,\n    r.r_name\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1996-01-01'\nGROUP BY \n    l.l_orderkey, o.o_orderdate, n.n_name, r.r_name\nORDER BY \n    revenue DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    l.l_orderkey AS order_key,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    o.o_orderdate AS order_date,\n    n.n_name AS nation_name,\n    r.r_name AS region_name\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE l.l_shipdate >= DATE '1995-01-01' AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY l.l_orderkey, o.o_orderdate, n.n_name, r.r_name;", "sql2": "SELECT order_key, revenue, order_date, nation_name, region_name\nFROM s1\nORDER BY revenue DESC\nLIMIT 100;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12372.sql", "original_sql": "SELECT\n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    nation n\nJOIN\n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN\n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nGROUP BY\n    n.n_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS part_rev\nFROM lineitem l\nGROUP BY l.l_partkey;", "sql2": "SELECT n.n_name,\n       SUM(s1.part_rev) AS total_revenue\nFROM nation n\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN s1 ON ps.ps_partkey = s1.p_partkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12400.sql", "original_sql": "SELECT \n    n_name, \n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM \n    customer \nJOIN \n    orders ON c_custkey = o_custkey \nJOIN \n    lineitem ON o_orderkey = l_orderkey \nJOIN \n    supplier ON s_suppkey = l_suppkey \nJOIN \n    partsupp ON ps_suppkey = s_suppkey \nJOIN \n    part ON ps_partkey = p_partkey \nJOIN \n    nation ON c_nationkey = n_nationkey \nWHERE \n    o_orderdate >= DATE '1994-01-01' \n    AND o_orderdate < DATE '1995-01-01' \nGROUP BY \n    n_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_custkey AS c_custkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM   orders o\nJOIN   lineitem l ON o.o_orderkey = l.l_orderkey\nWHERE  o.o_orderdate >= DATE '1994-01-01'\n  AND  o.o_orderdate <  DATE '1995-01-01'\nGROUP BY o.o_custkey", "sql2": "SELECT n.n_name,\n       SUM(s1.rev) AS total_revenue\nFROM   s1\nJOIN   customer c ON s1.c_custkey = c.c_custkey\nJOIN   nation n ON c.c_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12401.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1997-01-01'\n    AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY \n    p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey, l.l_suppkey, l.l_extendedprice, l.l_discount FROM lineitem l JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA' AND l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1997-12-31'", "sql2": "SELECT p.p_name, SUM(s1.l_extendedprice * (1 - s1.l_discount)) AS revenue FROM s1 JOIN part p ON p.p_partkey = s1.l_partkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND s1.l_suppkey = ps.ps_suppkey GROUP BY p.p_name ORDER BY revenue DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12429.sql", "original_sql": "SELECT \n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    revenue DESC;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 's_nationkey' not found in 's1'\", span: None, notes: [DiagnosticNote { message: \"possible column n.n_nationkey\", span: None }, DiagnosticNote { message: \"possible column n.n_regionkey\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"s1\" }), name: \"s_nationkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }, Column { relation: Some(Bare { table: \"n\" }), name: \"n_nationkey\" }, Column { relation: Some(Bare { table: \"n\" }), name: \"n_name\" }, Column { relation: Some(Bare { table: \"n\" }), name: \"n_regionkey\" }, Column { relation: Some(Bare { table: \"n\" }), name: \"n_comment\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "12549.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nGROUP BY \n    p.p_brand, p.p_type \nORDER BY \n    total_cost DESC \nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12561.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(ps.ps_availqty) AS total_avail_qty, \n    AVG(ps.ps_supplycost) AS avg_supply_cost \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nGROUP BY \n    p.p_brand, p.p_type \nORDER BY \n    total_avail_qty DESC, avg_supply_cost ASC \nLIMIT 100;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12563.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue, \n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND o.o_orderdate >= '1997-01-01' \n    AND o.o_orderdate <= '1997-12-31'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_revenue,\n       COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\n  AND o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate <= DATE '1997-12-31'\nGROUP BY l.l_partkey;", "sql2": "SELECT p.p_name,\n       s1.total_quantity,\n       s1.total_revenue,\n       s1.total_orders\nFROM s1\nJOIN part p ON s1.p_partkey = p.p_partkey\nORDER BY s1.total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12575.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    nation n\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM   orders o\nJOIN   lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN   part p ON l.l_partkey = p.p_partkey\nJOIN   partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN   supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE  o.o_orderdate >= DATE '1997-01-01'\nAND    o.o_orderdate < DATE '1998-01-01'\nGROUP BY s.s_suppkey;", "sql2": "SELECT n.n_name,\n       SUM(s1.revenue) AS total_revenue\nFROM   s1\nJOIN   supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN   nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12577.sql", "original_sql": "SELECT \n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'SOUTH AMERICA'\n    AND l.l_shipdate >= DATE '1997-01-01'\n    AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    l.l_partkey AS p_partkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'SOUTH AMERICA'\n  AND l.l_shipdate >= DATE '1997-01-01'\n  AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY l.l_partkey;", "sql2": "SELECT\n    p.p_partkey,\n    p.p_name,\n    s1.revenue\nFROM s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "12603.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    COUNT(DISTINCT o.o_orderkey) AS orders_count,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    nation n\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-10-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    s.s_suppkey,\n    s.s_nationkey,\n    l.l_orderkey,\n    l.l_extendedprice * (1 - l.l_discount) AS revenue\nFROM \n    orders o\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1997-10-01';", "sql2": "SELECT \n    n.n_name AS nation,\n    COUNT(DISTINCT s1.l_orderkey) AS orders_count,\n    SUM(s1.revenue) AS total_revenue\nFROM \n    s1\nJOIN \n    nation n ON s1.s_nationkey = n.n_nationkey\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12616.sql", "original_sql": "SELECT \n    p.p_partkey,\n    p.p_name,\n    SUM(ps.ps_availqty) AS total_availqty,\n    AVG(ps.ps_supplycost) AS avg_supplycost,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_availqty DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_partkey AS p_partkey,\n    SUM(ps.ps_availqty) AS total_availqty,\n    AVG(ps.ps_supplycost) AS avg_supplycost,\n    COUNT(DISTINCT ps.ps_suppkey) AS supplier_count\nFROM partsupp ps\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nGROUP BY ps.ps_partkey\nORDER BY total_availqty DESC\nLIMIT 100;", "sql2": "SELECT \n    p.p_partkey,\n    p.p_name,\n    s1.total_availqty,\n    s1.avg_supplycost,\n    s1.supplier_count\nFROM part p\nJOIN s1 ON p.p_partkey = s1.p_partkey;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12761.sql", "original_sql": "SELECT \n    l_shipmode, \n    COUNT(DISTINCT o_orderkey) AS order_count, \n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM \n    lineitem\nJOIN \n    orders ON l_orderkey = o_orderkey\nWHERE \n    l_shipdate >= DATE '1996-01-01' \n    AND l_shipdate < DATE '1996-12-31'\nGROUP BY \n    l_shipmode\nORDER BY \n    revenue DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12762.sql", "original_sql": "WITH SupplierParts AS (\n    SELECT s.s_suppkey, SUM(ps.ps_supplycost * ps.ps_availqty) AS TotalSupplyCost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey\n),\nTopSuppliers AS (\n    SELECT s.s_suppkey, s.s_name, sp.TotalSupplyCost\n    FROM supplier s\n    JOIN SupplierParts sp ON s.s_suppkey = sp.s_suppkey\n    ORDER BY sp.TotalSupplyCost DESC\n    LIMIT 10\n)\n\nSELECT ts.s_suppkey, ts.s_name, ts.TotalSupplyCost\nFROM TopSuppliers ts\nORDER BY ts.TotalSupplyCost;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12775.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(l.l_quantity) AS total_quantity, \n    AVG(l.l_extendedprice) AS avg_price\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_brand, \n    p.p_type\nORDER BY \n    total_quantity DESC, \n    avg_price ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_partkey,\n    SUM(l.l_quantity) AS sum_qty,\n    SUM(l.l_extendedprice) AS sum_price,\n    COUNT(*) AS cnt\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY p.p_partkey;", "sql2": "SELECT \n    p.p_brand,\n    p.p_type,\n    SUM(s1.sum_qty) AS total_quantity,\n    SUM(s1.sum_price) / SUM(s1.cnt) AS avg_price\nFROM s1\nJOIN part p ON s1.p_partkey = p.p_partkey\nGROUP BY p.p_brand, p.p_type\nORDER BY total_quantity DESC, avg_price ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12776.sql", "original_sql": "SELECT \n    SUM(l_extendedprice * (1 - l_discount)) AS revenue,\n    n_name,\n    extract(YEAR FROM o_orderdate) AS o_year\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' \n    AND o.o_orderdate < DATE '1996-01-01'\n    AND p.p_brand = 'Brand#22'\nGROUP BY \n    n_name, o_year\nORDER BY \n    revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_nationkey AS nation_key, EXTRACT(YEAR FROM o.o_orderdate) AS o_year, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01' AND p.p_brand = 'Brand#22' GROUP BY s.s_nationkey, o_year", "sql2": "SELECT n.n_name, t.o_year, t.revenue FROM s1 t JOIN nation n ON t.nation_key = n.n_nationkey ORDER BY t.revenue DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12824.sql", "original_sql": "SELECT \n    n_name, \n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM \n    customer \nJOIN \n    orders ON c_custkey = o_custkey \nJOIN \n    lineitem ON o_orderkey = l_orderkey \nJOIN \n    supplier ON l_suppkey = s_suppkey \nJOIN \n    nation ON s_nationkey = n_nationkey \nGROUP BY \n    n_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT n_name, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM lineitem li\nJOIN supplier s ON li.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n_name", "sql2": "SELECT n_name, total_revenue\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12985.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE' \nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12986.sql", "original_sql": "SELECT \n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "12991.sql", "original_sql": "SELECT \n    n_name, \n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM \n    lineitem \nJOIN \n    orders ON l_orderkey = o_orderkey \nJOIN \n    customer ON o_custkey = c_custkey \nJOIN \n    supplier ON l_suppkey = s_suppkey \nJOIN \n    nation ON s_nationkey = n_nationkey \nWHERE \n    o_orderdate >= DATE '1997-01-01' AND o_orderdate < DATE '1998-01-01'\nGROUP BY \n    n_name \nORDER BY \n    revenue DESC;", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 231, in run\n    self._register_downstream_aliases(nid, tbl, id_to_node, adj)\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 169, in _register_downstream_aliases\n    self._register_input_duckdb(alias, tbl)\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 81, in _register_input_duckdb\n    self.con.register(name, obj)\nduckdb.duckdb.InvalidInputException: Invalid Input Error: Provided table/dataframe must have at least one column\n", "engine_mem_mb": 500000}
{"query_id": "12992.sql", "original_sql": "SELECT n.n_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue \nFROM customer c \nJOIN orders o ON c.c_custkey = o.o_custkey \nJOIN lineitem l ON o.o_orderkey = l.l_orderkey \nJOIN supplier s ON l.l_suppkey = s.s_suppkey \nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey \nJOIN part p ON ps.ps_partkey = p.p_partkey \nJOIN nation n ON s.s_nationkey = n.n_nationkey \nWHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01' \nGROUP BY n.n_name \nORDER BY revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT n.n_name AS n_name,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM   customer c\nJOIN   orders o ON c.c_custkey = o.o_custkey\nJOIN   lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN   supplier s ON l.l_suppkey = s.s_suppkey\nJOIN   partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN   part p ON ps.ps_partkey = p.p_partkey\nJOIN   nation n ON s.s_nationkey = n.n_nationkey\nWHERE  o.o_orderdate >= DATE '1997-01-01'\nAND    o.o_orderdate <  DATE '1998-01-01'\nGROUP BY n.n_name;", "sql2": "SELECT n_name, revenue\nFROM   s1\nORDER BY revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "12993.sql", "original_sql": "SELECT \n    n.n_name AS nation, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_suppkey AS suppkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN partsupp ps\n  ON l.l_partkey = ps.ps_partkey\n AND l.l_suppkey = ps.ps_suppkey\nGROUP BY l.l_suppkey;", "sql2": "SELECT n.n_name AS nation,\n       SUM(s1.rev) AS total_revenue\nFROM s1\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13079.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue \nFROM \n    customer c \nJOIN \n    orders o ON c.c_custkey = o.o_custkey \nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey \nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey \nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31' \nGROUP BY \n    n.n_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "13290.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(ps.ps_availqty) AS total_available_qty, \n    AVG(ps.ps_supplycost) AS avg_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nGROUP BY \n    p.p_brand, \n    p.p_type\nORDER BY \n    total_available_qty DESC, \n    avg_supply_cost ASC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT ps_partkey,\n       SUM(ps_availqty) AS sum_qty,\n       AVG(ps_supplycost) AS avg_cost\nFROM partsupp\nGROUP BY ps_partkey;", "sql2": "SELECT p.p_brand,\n       p.p_type,\n       SUM(s1.sum_qty) AS total_available_qty,\n       AVG(s1.avg_cost) AS avg_supply_cost\nFROM s1\nJOIN part p ON p.p_partkey = s1.ps_partkey\nGROUP BY p.p_brand, p.p_type\nORDER BY total_available_qty DESC, avg_supply_cost ASC\nLIMIT 100;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13326.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part AS p\nJOIN \n    lineitem AS l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp AS ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier AS s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation AS n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region AS r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE' \n    AND l.l_shipdate >= DATE '1995-01-01' \n    AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_partkey, p.p_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part AS p\nJOIN lineitem AS l ON p.p_partkey = l.l_partkey\nJOIN partsupp AS ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier AS s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation AS n ON s.s_nationkey = n.n_nationkey\nJOIN region AS r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'EUROPE'\n  AND l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1996-01-01'\nGROUP BY p.p_partkey, p.p_name;", "sql2": "SELECT p_partkey, p_name, revenue\nFROM s1\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13331.sql", "original_sql": "SELECT \n    n_name, \n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM \n    nation \nJOIN \n    supplier ON n_nationkey = s_nationkey \nJOIN \n    partsupp ON s_suppkey = ps_suppkey \nJOIN \n    part ON ps_partkey = p_partkey \nJOIN \n    lineitem ON p_partkey = l_partkey \nGROUP BY \n    n_name \nORDER BY \n    revenue DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey, s.s_nationkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM   supplier s\nJOIN   partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN   part p      ON ps.ps_partkey = p.p_partkey\nJOIN   lineitem l  ON p.p_partkey = l.l_partkey\nGROUP BY s.s_suppkey, s.s_nationkey;", "sql2": "SELECT n.n_name,\n       SUM(s1.rev) AS revenue\nFROM   nation n\nJOIN   s1 ON n.n_nationkey = s1.s_nationkey\nGROUP BY n.n_name\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13469.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS p_partkey,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_revenue,\n       COUNT(DISTINCT l.l_orderkey) AS total_orders\nFROM lineitem l\nGROUP BY l.l_partkey;", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       s1.total_quantity,\n       s1.total_revenue,\n       s1.total_orders\nFROM s1\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13482.sql", "original_sql": "SELECT \n    n.n_name AS nation, \n    r.r_name AS region, \n    COUNT(DISTINCT s.s_suppkey) AS supplier_count, \n    SUM(ps.ps_availqty) AS total_availability, \n    AVG(ps.ps_supplycost) AS average_supply_cost\nFROM \n    supplier s \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey \nGROUP BY \n    n.n_name, \n    r.r_name \nORDER BY \n    region, \n    nation;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT ps_suppkey,\n       SUM(ps_availqty) AS supp_qty_sum,\n       SUM(ps_supplycost) AS supp_cost_sum,\n       COUNT(*) AS ps_cnt\nFROM partsupp\nGROUP BY ps_suppkey", "sql2": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(s1.supp_qty_sum) AS total_availability,\n    SUM(s1.supp_cost_sum) / SUM(s1.ps_cnt) AS average_supply_cost\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nJOIN s1 ON s.s_suppkey = s1.ps_suppkey\nGROUP BY n.n_name, r.r_name\nORDER BY region, nation", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13497.sql", "original_sql": "SELECT \n    p.p_brand,\n    p.p_type,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    p.p_brand, p.p_type\nORDER BY \n    avg_price DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "13657.sql", "original_sql": "SELECT \n    n.n_name AS nation, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' \n    AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    l.l_partkey AS p_partkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS rev\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1995-01-01'\n  AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY l.l_partkey;", "sql2": "SELECT \n    n.n_name AS nation,\n    SUM(s1.rev) AS total_revenue\nFROM s1\nJOIN partsupp ps ON s1.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13669.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(ps.ps_availqty) AS total_available_quantity, \n    AVG(ps.ps_supplycost) AS average_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_available_quantity DESC\nLIMIT 100;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'EUROPE'", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       SUM(ps.ps_availqty) AS total_available_quantity,\n       AVG(ps.ps_supplycost) AS average_supply_cost\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nGROUP BY p.p_partkey, p.p_name\nORDER BY total_available_quantity DESC\nLIMIT 100", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "13680.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    s.s_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON s.s_suppkey = l.l_suppkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    p.p_partkey, p.p_name, s.s_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT ps.ps_partkey, ps.ps_suppkey, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON l.l_suppkey = ps.ps_suppkey AND l.l_partkey = ps.ps_partkey WHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31' GROUP BY ps.ps_partkey, ps.ps_suppkey;", "sql2": "SELECT p.p_partkey, p.p_name, s.s_name, s1.revenue FROM s1 JOIN part p ON s1.ps_partkey = p.p_partkey JOIN supplier s ON s1.ps_suppkey = s.s_suppkey ORDER BY s1.revenue DESC LIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13682.sql", "original_sql": "SELECT \n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    l.l_shipdate >= DATE '1995-01-01' \n    AND l.l_shipdate < DATE '1995-12-31'\nGROUP BY \n    n.n_name\nORDER BY \n    revenue DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    l_partkey,\n    l_suppkey,\n    SUM(l_extendedprice * (1 - l_discount)) AS revenue\nFROM lineitem\nWHERE l_shipdate >= DATE '1995-01-01'\n  AND l_shipdate < DATE '1995-12-31'\nGROUP BY l_partkey, l_suppkey;", "sql2": "SELECT\n    n.n_name,\n    SUM(s1.revenue) AS revenue\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.l_suppkey\nJOIN nation n ON n.n_nationkey = s.s_nationkey\nGROUP BY n.n_name\nORDER BY revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13859.sql", "original_sql": "SELECT \n    p.p_partkey, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND l.l_shipdate >= DATE '1996-01-01' \n    AND l.l_shipdate < DATE '1997-01-01'\nGROUP BY \n    p.p_partkey\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT p.p_partkey,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN part p ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON ps.ps_partkey = p.p_partkey AND ps.ps_suppkey = l.l_suppkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nWHERE l.l_shipdate >= DATE '1996-01-01' AND l.l_shipdate < DATE '1997-01-01'\nGROUP BY p.p_partkey\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13866.sql", "original_sql": "SELECT\n    n.n_name AS nation_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    part p\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE\n    o.o_orderdate >= '1996-01-01' AND o.o_orderdate < '1997-01-01'\nGROUP BY\n    n.n_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "13870.sql", "original_sql": "SELECT\n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_sales\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    r.r_name = 'ASIA'\nGROUP BY\n    p.p_partkey, p.p_name\nORDER BY\n    total_sales DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT p.p_partkey, p.p_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT\n    s1.p_partkey,\n    s1.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_sales\nFROM lineitem l\nJOIN s1 ON l.l_partkey = s1.p_partkey\nGROUP BY s1.p_partkey, s1.p_name\nORDER BY total_sales DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "13904.sql", "original_sql": "SELECT\n    n.n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    nation n\nJOIN\n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN\n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY\n    n.n_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    n.n_name AS n_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM\n    nation n\nJOIN\n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN\n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE\n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY\n    n.n_name;", "sql2": "SELECT n_name, total_revenue\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14105.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' \n    AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_orderkey AS order_key,\n       o.o_custkey AS cust_key,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS order_rev\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01'\nGROUP BY o.o_orderkey, o.o_custkey;", "sql2": "SELECT n.n_name AS nation,\n       r.r_name AS region,\n       SUM(s1.order_rev) AS total_revenue\nFROM s1\nJOIN customer c ON s1.cust_key = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nGROUP BY n.n_name, r.r_name\nORDER BY total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14139.sql", "original_sql": "SELECT\n    n_name,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM\n    nation\nJOIN\n    supplier ON n_nationkey = s_nationkey\nJOIN\n    partsupp ON s_suppkey = ps_suppkey\nJOIN\n    lineitem ON ps_partkey = l_partkey\nJOIN\n    orders ON l_orderkey = o_orderkey\nGROUP BY\n    n_name\nORDER BY\n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    ps.ps_suppkey AS s_suppkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS supp_rev\nFROM partsupp ps\nJOIN lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY ps.ps_suppkey;", "sql2": "SELECT\n    n.n_name,\n    SUM(s1.supp_rev) AS total_revenue\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14299.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1998-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "14304.sql", "original_sql": "SELECT \n    p.p_partkey,\n    p.p_name,\n    Sum(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    r.r_name,\n    n.n_name\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    l.l_shipdate >= DATE '1996-01-01' AND l.l_shipdate < DATE '1996-02-01'\nGROUP BY \n    p.p_partkey, p.p_name, r.r_name, n.n_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_partkey,\n    p.p_name,\n    s.s_nationkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nWHERE l.l_shipdate >= DATE '1996-01-01' AND l.l_shipdate < DATE '1996-02-01'\nGROUP BY p.p_partkey, p.p_name, s.s_nationkey;", "sql2": "SELECT \n    s1.p_partkey,\n    s1.p_name,\n    s1.revenue,\n    r.r_name,\n    n.n_name\nFROM s1\nJOIN nation n ON s1.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "14310.sql", "original_sql": "SELECT n.n_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM customer c\nJOIN orders o ON c.c_custkey = o.o_custkey\nJOIN lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_orderkey, l.l_extendedprice, l.l_discount, l.l_suppkey, l.l_partkey FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'", "sql2": "SELECT n.n_name, SUM(s1.l_extendedprice * (1 - s1.l_discount)) AS total_revenue FROM s1 JOIN supplier s ON s1.l_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN partsupp ps ON s1.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey GROUP BY n.n_name ORDER BY total_revenue DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14338.sql", "original_sql": "SELECT \n    p.p_brand, \n    p.p_type, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    lineitem l\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1995-01-01'\n    AND l.l_shipdate < DATE '1995-02-01'\nGROUP BY \n    p.p_brand, p.p_type\nORDER BY \n    revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS p_key,\n       l.l_suppkey AS s_key,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nWHERE l.l_shipdate >= DATE '1995-01-01'\n  AND l.l_shipdate < DATE '1995-02-01'\nGROUP BY l.l_partkey, l.l_suppkey;", "sql2": "SELECT p.p_brand,\n       p.p_type,\n       SUM(s1.revenue) AS revenue\nFROM s1\nJOIN part p ON s1.p_key = p.p_partkey\nJOIN supplier s ON s1.s_key = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY p.p_brand, p.p_type\nORDER BY revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14460.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    s.s_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1995-01-31'\nGROUP BY \n    p.p_partkey, p.p_name, s.s_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey,\n       p.p_name,\n       s.s_name,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1995-01-31'\nGROUP BY p.p_partkey, p.p_name, s.s_name;", "sql2": "SELECT p_partkey,\n       p_name,\n       s_name,\n       revenue\nFROM s1\nORDER BY revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14461.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(ps.ps_availqty) AS total_avail_qty, \n    AVG(ps.ps_supplycost) AS avg_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'AMERICA'\nGROUP BY \n    p.p_partkey, p.p_name\nORDER BY \n    total_avail_qty DESC\nLIMIT 10;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 787, in urlopen\n    response = self._make_request(\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 534, in _make_request\n    response = conn.getresponse()\n               ^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connection.py\", line 565, in getresponse\n    httplib_response = super().getresponse()\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 1430, in getresponse\n    response.begin()\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 331, in begin\n    version, status, reason = self._read_status()\n                              ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 300, in _read_status\n    raise RemoteDisconnected(\"Remote end closed connection without\"\nhttp.client.RemoteDisconnected: Remote end closed connection without response\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/adapters.py\", line 644, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 841, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/util/retry.py\", line 474, in increment\n    raise reraise(type(error), error, _stacktrace)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/util/util.py\", line 38, in reraise\n    raise value.with_traceback(tb)\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 787, in urlopen\n    response = self._make_request(\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 534, in _make_request\n    response = conn.getresponse()\n               ^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/urllib3/connection.py\", line 565, in getresponse\n    httplib_response = super().getresponse()\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 1430, in getresponse\n    response.begin()\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 331, in begin\n    version, status, reason = self._read_status()\n                              ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/http/client.py\", line 300, in _read_status\n    raise RemoteDisconnected(\"Remote end closed connection without\"\nurllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 248, in _child_run_one_query\n    split = splitter.split_query(sql)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/query_splitter/splitter.py\", line 56, in split_query\n    result = self.llm.invoke([\n             ^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py\", line 402, in invoke\n    self.generate_prompt(\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py\", line 1121, in generate_prompt\n    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py\", line 931, in generate\n    self._generate_with_cache(\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/langchain_core/language_models/chat_models.py\", line 1229, in _generate_with_cache\n    result = self._generate(messages, stop=stop, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/query_splitter/rits_chat.py\", line 122, in _generate\n    response = requests.post(\n               ^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/api.py\", line 115, in post\n    return request(\"post\", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/api.py\", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/sessions.py\", line 703, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/requests/adapters.py\", line 659, in send\n    raise ConnectionError(err, request=request)\nrequests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))\n", "engine_mem_mb": 500000}
{"query_id": "14474.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    s.s_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY \n    p.p_partkey, \n    p.p_name, \n    s.s_name\nORDER BY \n    revenue DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "14476.sql", "original_sql": "SELECT\n    p.p_partkey,\n    p.p_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    n.n_name AS nation,\n    r.r_name AS region\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    l.l_shipdate >= '1996-01-01' AND l.l_shipdate < '1997-01-01'\nGROUP BY\n    p.p_partkey, p.p_name, n.n_name, r.r_name\nORDER BY\n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT l.l_partkey AS part_key,\n       l.l_suppkey AS supp_key,\n       l.l_extendedprice * (1 - l.l_discount) AS rev\nFROM lineitem l\nWHERE l.l_shipdate >= DATE '1996-01-01'\n  AND l.l_shipdate < DATE '1997-01-01'", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       SUM(s1.rev) AS revenue,\n       n.n_name AS nation,\n       r.r_name AS region\nFROM s1\nJOIN part p      ON p.p_partkey = s1.part_key\nJOIN supplier s  ON s.s_suppkey = s1.supp_key\nJOIN nation n    ON s.s_nationkey = n.n_nationkey\nJOIN region r    ON n.n_regionkey = r.r_regionkey\nGROUP BY p.p_partkey, p.p_name, n.n_name, r.r_name\nORDER BY revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14648.sql", "original_sql": "SELECT\n    nation.n_name,\n    SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue\nFROM\n    lineitem\nJOIN\n    orders ON lineitem.l_orderkey = orders.o_orderkey\nJOIN\n    customer ON orders.o_custkey = customer.c_custkey\nJOIN\n    supplier ON lineitem.l_suppkey = supplier.s_suppkey\nJOIN\n    partsupp ON lineitem.l_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey\nJOIN\n    nation ON supplier.s_nationkey = nation.n_nationkey\nGROUP BY\n    nation.n_name\nORDER BY\n    revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT supplier.s_nationkey AS n_key,\n       SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue\nFROM lineitem\nJOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey\nGROUP BY supplier.s_nationkey;", "sql2": "SELECT nation.n_name,\n       s1.revenue\nFROM s1\nJOIN nation ON s1.n_key = nation.n_nationkey\nORDER BY s1.revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14688.sql", "original_sql": "SELECT \n    p.p_partkey, \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice) AS total_revenue\nFROM \n    part p \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    r.r_name = 'ASIA' \nGROUP BY \n    p.p_partkey, \n    p.p_name \nORDER BY \n    total_revenue DESC \nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT p.p_partkey,\n       p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN s1 ON ps.ps_suppkey = s1.s_suppkey\nGROUP BY p.p_partkey, p.p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14689.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1998-01-01'\nGROUP BY \n    n.n_name\nORDER BY \n    revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    l.l_suppkey AS s_suppkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY l.l_suppkey", "sql2": "SELECT \n    n.n_name,\n    SUM(s1.revenue) AS revenue\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14851.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND l.l_shipdate >= DATE '1994-01-01'\n    AND l.l_shipdate < DATE '1995-01-01'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey,\n       p.p_name,\n       l.l_extendedprice * (1 - l.l_discount) AS rev\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\n  AND l.l_shipdate >= DATE '1994-01-01'\n  AND l.l_shipdate < DATE '1995-01-01';", "sql2": "SELECT p_name,\n       SUM(rev) AS total_revenue\nFROM s1\nGROUP BY p_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14925.sql", "original_sql": "SELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\nGROUP BY \n    p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'", "sql2": "SELECT p.p_name,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nJOIN s1 ON l.l_suppkey = s1.s_suppkey\nGROUP BY p.p_name\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "14931.sql", "original_sql": "SELECT \n    p.p_brand,\n    p.p_type,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' AND \n    l.l_shipdate >= DATE '1994-01-01' AND \n    l.l_shipdate < DATE '1995-01-01'\nGROUP BY \n    p.p_brand, p.p_type\nORDER BY \n    revenue DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "15740.sql", "original_sql": "SELECT\n    p.p_name,\n    SUM(l.l_quantity) AS total_quantity,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM\n    part p\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY\n    p.p_name\nORDER BY\n    total_quantity DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "15804.sql", "original_sql": "SELECT p.p_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA'\nGROUP BY p.p_name\nORDER BY total_sales DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "16074.sql", "original_sql": "SELECT \n    p_brand, \n    COUNT(DISTINCT ps_suppkey) AS supplier_count \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nGROUP BY \n    p_brand \nORDER BY \n    supplier_count DESC \nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "1661.sql", "original_sql": "WITH SupplierSummary AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost,\n        COUNT(DISTINCT ps.ps_partkey) AS unique_parts\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nOrderDetails AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_discounted_price\n    FROM \n        orders o \n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderdate >= '1997-01-01'\n    GROUP BY \n        o.o_orderkey, o.o_orderdate\n),\nCustomerSpend AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        SUM(od.total_discounted_price) AS total_spent\n    FROM \n        customer c\n    LEFT JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    LEFT JOIN \n        OrderDetails od ON o.o_orderkey = od.o_orderkey\n    GROUP BY \n        c.c_custkey, c.c_name\n),\nTopCustomers AS (\n    SELECT \n        cs.c_custkey,\n        cs.c_name,\n        cs.total_spent,\n        RANK() OVER (ORDER BY cs.total_spent DESC) AS spend_rank\n    FROM \n        CustomerSpend cs\n)\nSELECT \n    r.r_name,\n    SUM(ss.total_supply_cost) AS total_supplier_cost,\n    AVG(tc.total_spent) AS average_customer_spent,\n    COUNT(DISTINCT tc.c_custkey) AS customer_count\nFROM \n    region r\nLEFT JOIN \n    nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN \n    SupplierSummary ss ON s.s_suppkey = ss.s_suppkey\nLEFT JOIN \n    CustomerSpend cs ON n.n_nationkey = cs.c_custkey\nLEFT JOIN \n    TopCustomers tc ON cs.c_custkey = tc.c_custkey\nGROUP BY \n    r.r_name\nHAVING \n    COUNT(DISTINCT ss.s_suppkey) > 5 AND AVG(tc.total_spent) IS NOT NULL\nORDER BY \n    total_supplier_cost DESC;", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 'c_custkey' not found in 'o'\", span: None, notes: [DiagnosticNote { message: \"possible column c.c_custkey\", span: None }, DiagnosticNote { message: \"possible column o.o_custkey\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"o\" }), name: \"c_custkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"c\" }), name: \"c_custkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_name\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_address\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_nationkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_phone\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_acctbal\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_mktsegment\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_comment\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_custkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderstatus\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_totalprice\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderdate\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderpriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_clerk\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_shippriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_comment\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "1715.sql", "original_sql": "WITH SupplierStats AS (\n    SELECT \n        s.s_suppkey, \n        s.s_name, \n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost,\n        COUNT(DISTINCT ps.ps_partkey) AS unique_parts\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nOrderDetails AS (\n    SELECT \n        o.o_orderkey, \n        o.o_orderdate, \n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_price,\n        COUNT(l.l_orderkey) AS number_of_items\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01'\n    GROUP BY \n        o.o_orderkey, o.o_orderdate\n),\nRegionNation AS (\n    SELECT \n        n.n_nationkey,\n        r.r_name,\n        n.n_name\n    FROM \n        nation n\n    LEFT JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT \n    r.r_name AS region,\n    COUNT(DISTINCT s.s_suppkey) AS total_suppliers,\n    SUM(COALESCE(ss.total_supply_cost, 0)) AS total_supply_cost,\n    SUM(COALESCE(od.total_price, 0)) AS total_order_price,\n    AVG(od.number_of_items) AS avg_items_per_order,\n    AVG(ss.unique_parts) AS avg_unique_parts_per_supplier\nFROM \n    RegionNation r\nLEFT JOIN \n    supplier s ON s.s_nationkey = r.n_nationkey\nLEFT JOIN \n    SupplierStats ss ON s.s_suppkey = ss.s_suppkey\nLEFT JOIN \n    OrderDetails od ON s.s_suppkey = od.o_orderkey\nGROUP BY \n    r.r_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 0\nORDER BY \n    total_order_price DESC, avg_unique_parts_per_supplier DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost,\n       COUNT(DISTINCT ps.ps_partkey) AS unique_parts\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name", "sql2": "WITH OrderDetails AS (\n    SELECT o.o_orderkey,\n           o.o_orderdate,\n           SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_price,\n           COUNT(l.l_orderkey) AS number_of_items\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate >= DATE '1997-01-01'\n    GROUP BY o.o_orderkey, o.o_orderdate\n),\nRegionNation AS (\n    SELECT n.n_nationkey,\n           r.r_name,\n           n.n_name\n    FROM nation n\n    LEFT JOIN region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT rn.r_name AS region,\n       COUNT(DISTINCT s.s_suppkey) AS total_suppliers,\n       SUM(COALESCE(ss.total_supply_cost, 0)) AS total_supply_cost,\n       SUM(COALESCE(od.total_price, 0)) AS total_order_price,\n       AVG(od.number_of_items) AS avg_items_per_order,\n       AVG(ss.unique_parts) AS avg_unique_parts_per_supplier\nFROM RegionNation rn\nLEFT JOIN supplier s ON s.s_nationkey = rn.n_nationkey\nLEFT JOIN s1 ss ON s.s_suppkey = ss.s_suppkey\nLEFT JOIN OrderDetails od ON s.s_suppkey = od.o_orderkey\nGROUP BY rn.r_name\nHAVING COUNT(DISTINCT s.s_suppkey) > 0\nORDER BY total_order_price DESC, avg_unique_parts_per_supplier DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "17948.sql", "original_sql": "SELECT \n    p_brand, \n    COUNT(DISTINCT ps_suppkey) AS supplier_count, \n    SUM(ps_availqty) AS total_available_quantity, \n    AVG(ps_supplycost) AS average_supply_cost\nFROM \n    part \nJOIN \n    partsupp ON p_partkey = ps_partkey\nGROUP BY \n    p_brand\nORDER BY \n    supplier_count DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "18264.sql", "original_sql": "SELECT n_name, COUNT(DISTINCT o_orderkey) AS order_count\nFROM nation n\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY n_name\nORDER BY order_count DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT DISTINCT o.o_orderkey AS order_key, n.n_name AS n_name\nFROM nation n\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey", "sql2": "SELECT n_name, COUNT(*) AS order_count\nFROM s1\nGROUP BY n_name\nORDER BY order_count DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "2023.sql", "original_sql": "WITH RankedOrders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        o.o_orderstatus,\n        ROW_NUMBER() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_totalprice DESC) AS order_rank\n    FROM \n        orders o\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-02-01'\n),\nTopSuppliers AS (\n    SELECT \n        ps.ps_suppkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM \n        partsupp ps\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY \n        ps.ps_suppkey\n    HAVING \n        SUM(ps.ps_supplycost * ps.ps_availqty) > 10000000\n),\nNationRegionalSales AS (\n    SELECT \n        n.n_name,\n        SUM(o.o_totalprice) AS total_sales\n    FROM \n        nation n\n    LEFT JOIN \n        customer c ON n.n_nationkey = c.c_nationkey\n    LEFT JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        n.n_name\n),\nFinalReport AS (\n    SELECT \n        r.r_name AS region,\n        n.n_name AS nation,\n        COALESCE(ns.total_sales, 0) AS nation_sales,\n        ts.total_supply_cost\n    FROM \n        region r\n    LEFT JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN \n        NationRegionalSales ns ON n.n_name = ns.n_name\n    LEFT JOIN \n        TopSuppliers ts ON n.n_nationkey = ts.ps_suppkey\n)\nSELECT \n    region,\n    nation,\n    nation_sales,\n    total_supply_cost,\n    CASE \n        WHEN nation_sales > 0 AND total_supply_cost IS NOT NULL THEN nation_sales / total_supply_cost \n        ELSE NULL \n    END AS sales_to_supply_cost_ratio\nFROM \n    FinalReport\nWHERE \n    total_supply_cost IS NOT NULL\nORDER BY \n    sales_to_supply_cost_ratio DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    n.n_nationkey,\n    n.n_name,\n    ns.total_sales,\n    ts.ps_suppkey,\n    ts.total_supply_cost\nFROM nation n\nLEFT JOIN (\n    SELECT \n        n2.n_nationkey,\n        SUM(o.o_totalprice) AS total_sales\n    FROM nation n2\n    LEFT JOIN customer c ON n2.n_nationkey = c.c_nationkey\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY n2.n_nationkey\n) ns ON n.n_nationkey = ns.n_nationkey\nLEFT JOIN (\n    SELECT \n        ps.ps_suppkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM partsupp ps\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY ps.ps_suppkey\n    HAVING SUM(ps.ps_supplycost * ps.ps_availqty) > 10000000\n) ts ON n.n_nationkey = ts.ps_suppkey;", "sql2": "SELECT\n    r.r_name AS region,\n    s1.n_name AS nation,\n    COALESCE(s1.total_sales, 0) AS nation_sales,\n    s1.total_supply_cost,\n    CASE \n        WHEN s1.total_sales > 0 AND s1.total_supply_cost IS NOT NULL THEN s1.total_sales / s1.total_supply_cost\n        ELSE NULL\n    END AS sales_to_supply_cost_ratio\nFROM region r\nLEFT JOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN s1 ON n.n_nationkey = s1.n_nationkey\nWHERE s1.total_supply_cost IS NOT NULL\nORDER BY sales_to_supply_cost_ratio DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "2037.sql", "original_sql": "WITH SupplierSales AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        lineitem l ON ps.ps_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        o.o_orderstatus = 'O' \n        AND l.l_shipdate >= DATE '1997-01-01'\n    GROUP BY \n        s.s_suppkey, s.s_name\n), RankedSuppliers AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        ss.total_sales,\n        ss.order_count,\n        RANK() OVER (ORDER BY ss.total_sales DESC) AS sales_rank\n    FROM \n        SupplierSales ss\n    JOIN \n        supplier s ON ss.s_suppkey = s.s_suppkey\n)\nSELECT \n    ns.n_name AS nation_name,\n    COALESCE(SUM(rs.total_sales), 0) AS total_sales,\n    COUNT(DISTINCT rs.s_suppkey) AS supplier_count\nFROM \n    nation ns\nLEFT JOIN \n    RankedSuppliers rs ON ns.n_nationkey = (\n        SELECT \n            s_nationkey \n        FROM \n            supplier \n        WHERE \n            s_suppkey = rs.s_suppkey\n    )\nGROUP BY \n    ns.n_name\nHAVING \n    SUM(rs.total_sales) > (\n        SELECT \n            AVG(total_sales) \n        FROM \n            SupplierSales\n    )\nORDER BY \n    total_sales DESC;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "21785.sql", "original_sql": "WITH RegionalSales AS (\n    SELECT \n        r.r_name AS region_name,\n        SUM(o.o_totalprice) AS total_sales,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM \n        region r\n    LEFT JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    LEFT JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    LEFT JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    LEFT JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    LEFT JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    GROUP BY \n        r.r_name\n), \nMaxSales AS (\n    SELECT \n        region_name,\n        total_sales,\n        ROW_NUMBER() OVER (ORDER BY total_sales DESC) AS rank\n    FROM \n        RegionalSales\n),\nNationStatistics AS (\n    SELECT \n        n.n_name,\n        COUNT(DISTINCT s.s_suppkey) AS unique_suppliers,\n        AVG(s.s_acctbal) AS avg_account_balance\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY \n        n.n_name\n),\nRichCustomers AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_acctbal,\n        CASE\n            WHEN c.c_acctbal IS NULL THEN 'Unknown' \n            WHEN c.c_acctbal BETWEEN 1000 AND 2000 THEN 'Middle-Class' \n            WHEN c.c_acctbal > 2000 THEN 'High-Class' \n            ELSE 'Low-Class'\n        END AS customer_classification\n    FROM \n        customer c\n    WHERE \n        COALESCE(c.c_acctbal, 0) > 1500\n),\nFinalResults AS (\n    SELECT \n        rs.region_name,\n        rs.total_sales,\n        ns.n_name,\n        ns.unique_suppliers,\n        ns.avg_account_balance,\n        rc.c_name AS rich_customer_name,\n        rc.customer_classification\n    FROM \n        MaxSales rs\n    LEFT JOIN \n        NationStatistics ns ON rs.region_name = ns.n_name\n    LEFT JOIN \n        RichCustomers rc ON ns.n_name = rc.c_name\n)\nSELECT \n    fr.region_name,\n    fr.total_sales,\n    fr.n_name,\n    fr.unique_suppliers,\n    fr.avg_account_balance,\n    fr.rich_customer_name,\n    fr.customer_classification,\n    COALESCE(fr.total_sales / NULLIF(ns.avg_account_balance, 0), 0) AS sales_per_avg_balance\nFROM \n    FinalResults fr\nLEFT JOIN \n    NationStatistics ns ON fr.n_name = ns.n_name\nWHERE \n    fr.total_sales < (SELECT AVG(total_sales) FROM MaxSales)\nORDER BY \n    fr.total_sales DESC, \n    fr.unique_suppliers ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH RegionalSales AS (\n    SELECT \n        r.r_name AS region_name,\n        SUM(o.o_totalprice) AS total_sales,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM region r\n    LEFT JOIN nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    LEFT JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    LEFT JOIN part p ON ps.ps_partkey = p.p_partkey\n    LEFT JOIN lineitem l ON p.p_partkey = l.l_partkey\n    LEFT JOIN orders o ON l.l_orderkey = o.o_orderkey\n    GROUP BY r.r_name\n),\nMaxSales AS (\n    SELECT \n        region_name,\n        total_sales,\n        order_count,\n        ROW_NUMBER() OVER (ORDER BY total_sales DESC) AS rank,\n        AVG(total_sales) OVER () AS avg_total_sales\n    FROM RegionalSales\n)\nSELECT \n    region_name,\n    total_sales,\n    order_count,\n    rank,\n    avg_total_sales\nFROM MaxSales;", "sql2": "WITH NationStatistics AS (\n    SELECT \n        n.n_name,\n        COUNT(DISTINCT s.s_suppkey) AS unique_suppliers,\n        AVG(s.s_acctbal) AS avg_account_balance\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_name\n),\nRichCustomers AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_acctbal,\n        CASE\n            WHEN c.c_acctbal IS NULL THEN 'Unknown'\n            WHEN c.c_acctbal BETWEEN 1000 AND 2000 THEN 'Middle-Class'\n            WHEN c.c_acctbal > 2000 THEN 'High-Class'\n            ELSE 'Low-Class'\n        END AS customer_classification\n    FROM customer c\n    WHERE COALESCE(c.c_acctbal, 0) > 1500\n)\nSELECT \n    s1.region_name,\n    s1.total_sales,\n    ns.n_name,\n    ns.unique_suppliers,\n    ns.avg_account_balance,\n    rc.c_name AS rich_customer_name,\n    rc.customer_classification,\n    COALESCE(s1.total_sales / NULLIF(ns.avg_account_balance, 0), 0) AS sales_per_avg_balance\nFROM s1\nLEFT JOIN NationStatistics ns ON s1.region_name = ns.n_name\nLEFT JOIN RichCustomers rc ON ns.n_name = rc.c_name\nWHERE s1.total_sales < s1.avg_total_sales\nORDER BY s1.total_sales DESC, ns.unique_suppliers ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "2195.sql", "original_sql": "WITH ranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        o.o_orderstatus,\n        ROW_NUMBER() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_totalprice DESC) as rank\n    FROM \n        orders o\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-12-31'\n),\nsupplier_details AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nlineitem_summary AS (\n    SELECT \n        l.l_orderkey,\n        COUNT(*) AS total_lines,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM \n        lineitem l\n    GROUP BY \n        l.l_orderkey\n)\nSELECT \n    r.r_name,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    AVG(total_cost) AS avg_supplier_cost,\n    SUM(CASE WHEN lo.total_lines > 5 THEN 1 ELSE 0 END) AS large_orders,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS popular_parts\nFROM \n    region r\nLEFT JOIN \n    nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN \n    supplier_details sd ON s.s_suppkey = sd.s_suppkey\nLEFT JOIN \n    lineitem l ON s.s_suppkey = l.l_suppkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nLEFT JOIN \n    lineitem_summary lo ON o.o_orderkey = lo.l_orderkey\nLEFT JOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nLEFT JOIN \n    part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    r.r_name IS NOT NULL\n    AND o.o_orderstatus = 'O'\n    AND sd.total_cost IS NOT NULL\nGROUP BY \n    r.r_name\nORDER BY \n    unique_customers DESC,\n    avg_supplier_cost DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "2208.sql", "original_sql": "WITH ranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        o.o_orderstatus,\n        DENSE_RANK() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_orderdate DESC) AS rank_status\n    FROM \n        orders o\n    WHERE \n        o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\n), \nactive_customers AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_acctbal,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spent\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    GROUP BY \n        c.c_custkey, c.c_name, c.c_acctbal\n    HAVING \n        SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000\n), \npart_supplier_info AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_brand,\n        SUM(ps.ps_availqty) AS total_available,\n        AVG(ps.ps_supplycost) AS avg_supply_cost\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    GROUP BY \n        p.p_partkey, p.p_name, p.p_brand\n)\nSELECT \n    r.r_name,\n    ac.c_name,\n    ac.total_spent,\n    poi.p_name,\n    poi.total_available,\n    poi.avg_supply_cost\nFROM \n    region r\nLEFT JOIN \n    nation n ON n.n_regionkey = r.r_regionkey\nLEFT JOIN \n    supplier s ON s.s_nationkey = n.n_nationkey\nLEFT JOIN \n    part_supplier_info poi ON s.s_suppkey = poi.p_partkey\nLEFT JOIN \n    active_customers ac ON s.s_suppkey = ac.c_custkey\nWHERE \n    (ac.c_acctbal IS NOT NULL AND ac.total_spent > 5000)\n    OR \n    (ac.c_acctbal IS NULL AND poi.avg_supply_cost < 50.00)\nORDER BY \n    r.r_name, ac.total_spent DESC, poi.total_available DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "2234.sql", "original_sql": "WITH RankedSuppliers AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_nationkey,\n        s.s_acctbal,\n        ROW_NUMBER() OVER (PARTITION BY s.s_nationkey ORDER BY s.s_acctbal DESC) AS rank\n    FROM \n        supplier s\n),\nSupplierRegion AS (\n    SELECT \n        r.r_regionkey,\n        r.r_name,\n        n.n_name AS nation,\n        s.s_suppkey,\n        s.s_name\n    FROM \n        region r\n    JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN \n        RankedSuppliers s ON n.n_nationkey = s.s_nationkey\n)\nSELECT \n    p.p_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    sr.nation,\n    sr.r_name,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nLEFT JOIN \n    SupplierRegion sr ON sr.s_suppkey = l.l_suppkey\nWHERE \n    l.l_shipdate >= '1997-01-01' AND l.l_shipdate < '1997-12-31'\nGROUP BY \n    p.p_name, sr.nation, sr.r_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > (\n        SELECT AVG(total_revenue)\n        FROM (\n            SELECT \n                SUM(l2.l_extendedprice * (1 - l2.l_discount)) AS total_revenue\n            FROM \n                lineitem l2\n            JOIN \n                orders o2 ON l2.l_orderkey = o2.o_orderkey\n            WHERE \n                l2.l_shipdate >= '1997-01-01' AND l2.l_shipdate < '1997-12-31'\n            GROUP BY \n                o2.o_orderkey\n        ) AS order_totals\n    )\nORDER BY \n    total_revenue DESC, p.p_name;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH RankedSuppliers AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           s.s_nationkey,\n           s.s_acctbal,\n           ROW_NUMBER() OVER (PARTITION BY s.s_nationkey ORDER BY s.s_acctbal DESC) AS rank\n    FROM supplier s\n),\nSupplierRegion AS (\n    SELECT r.r_name,\n           n.n_name AS nation,\n           s.s_suppkey,\n           s.s_name,\n           s.rank\n    FROM region r\n    JOIN nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN RankedSuppliers s ON n.n_nationkey = s.s_nationkey\n)\nSELECT * FROM SupplierRegion;", "sql2": "WITH order_totals AS (\n    SELECT o2.o_orderkey,\n           SUM(l2.l_extendedprice * (1 - l2.l_discount)) AS total_revenue\n    FROM lineitem l2\n    JOIN orders o2 ON l2.l_orderkey = o2.o_orderkey\n    WHERE l2.l_shipdate >= DATE '1997-01-01' AND l2.l_shipdate < DATE '1997-12-31'\n    GROUP BY o2.o_orderkey\n),\navg_revenue AS (\n    SELECT AVG(total_revenue) AS avg_rev FROM order_totals\n)\nSELECT \n    p.p_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    s1.nation,\n    s1.r_name,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nLEFT JOIN s1 ON s1.s_suppkey = l.l_suppkey\nWHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY p.p_name, s1.nation, s1.r_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > (SELECT avg_rev FROM avg_revenue)\nORDER BY total_revenue DESC, p.p_name;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "23543.sql", "original_sql": "WITH SupplierOrders AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        COUNT(DISTINCT o.o_orderkey) AS order_count,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n        AVG(l.l_quantity) AS avg_quantity,\n        SUM(CASE \n            WHEN l.l_discount > 0.1 THEN l.l_extendedprice * l.l_discount \n            ELSE 0 \n        END) AS discount_revenue\n    FROM \n        supplier s\n    LEFT JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    LEFT JOIN \n        lineitem l ON ps.ps_partkey = l.l_partkey\n    LEFT JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        s.s_acctbal IS NOT NULL\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nRankedSuppliers AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        total_revenue,\n        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank\n    FROM \n        SupplierOrders s\n    WHERE \n        order_count > 5\n)\nSELECT \n    r.r_name AS Region_Name,\n    n.n_name AS Nation_Name,\n    rs.s_name AS Supplier_Name,\n    rs.total_revenue,\n    CASE \n        WHEN rs.total_revenue IS NULL THEN 'No Revenue'\n        WHEN rs.total_revenue < 10000 THEN 'Low Revenue'\n        WHEN rs.total_revenue BETWEEN 10000 AND 50000 THEN 'Medium Revenue'\n        ELSE 'High Revenue' \n    END AS Revenue_Category\nFROM \n    RankedSuppliers rs\nINNER JOIN \n    supplier s ON rs.s_suppkey = s.s_suppkey\nINNER JOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nLEFT JOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name IS NOT NULL\n    OR rs.total_revenue IS NOT NULL\nORDER BY \n    Revenue_Category ASC, rs.total_revenue DESC\nLIMIT 100;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 178, in _run_single_node\n    out_tbl = self._run_on_duckdb(node.sql)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 104, in _run_on_duckdb\n    return self.con.execute(sql).arrow()\n           ^^^^^^^^^^^^^^^^^^^^^\nduckdb.duckdb.InvalidInputException: Invalid Input Error: arrow_scan: get_next failed(): NotImplemented: Function 'array_filter' has no kernel matching input types (string_view, bool)\n", "engine_mem_mb": 500000}
{"query_id": "23782.sql", "original_sql": "\nWITH ranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        ROW_NUMBER() OVER (PARTITION BY EXTRACT(YEAR FROM o.o_orderdate) ORDER BY o.o_totalprice DESC) AS order_rank\n    FROM \n        orders AS o\n    WHERE \n        o.o_orderdate >= DATE '1994-01-01'\n),\nfiltered_parts AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_retailprice,\n        (CASE \n            WHEN p.p_size BETWEEN 1 AND 5 THEN 'Small'\n            WHEN p.p_size BETWEEN 6 AND 15 THEN 'Medium'\n            ELSE 'Large'\n         END) AS size_category \n    FROM \n        part AS p\n    WHERE \n        p.p_retailprice IS NOT NULL\n),\ntotal_quantity AS (\n    SELECT \n        l.l_orderkey,\n        SUM(l.l_quantity) AS total_qty\n    FROM \n        lineitem AS l\n    GROUP BY \n        l.l_orderkey\n),\nnational_supplier AS (\n    SELECT \n        n.n_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        n.n_nationkey\n    FROM \n        supplier AS s\n    JOIN \n        nation AS n ON s.s_nationkey = n.n_nationkey\n    GROUP BY \n        n.n_name, n.n_nationkey\n),\nresult_set AS (\n    SELECT \n        r.r_name,\n        COUNT(DISTINCT ns.n_nationkey) AS region_count,\n        SUM(rating.total_qty) AS total_quantity\n    FROM \n        region AS r\n    LEFT JOIN \n        national_supplier AS ns ON ns.n_nationkey = r.r_regionkey\n    LEFT JOIN \n        total_quantity AS rating ON ns.n_nationkey = rating.l_orderkey\n    GROUP BY \n        r.r_name\n)\nSELECT \n    r.r_name,\n    r.region_count,\n    COALESCE(SUM(fp.p_retailprice), 0.00) AS total_retail_price,\n    AVG(ranking.o_totalprice) AS avg_order_price\nFROM \n    result_set AS r\nLEFT JOIN \n    filtered_parts AS fp ON r.region_count > 5\nLEFT JOIN \n    ranked_orders AS ranking ON r.region_count = EXTRACT(YEAR FROM ranking.o_orderdate)\nWHERE \n    r.region_count IS NOT NULL\nGROUP BY \n    r.r_name, r.region_count\nHAVING \n    AVG(ranking.o_totalprice) > (SELECT AVG(o.o_totalprice) FROM orders AS o)\nORDER BY \n    r.r_name DESC \nLIMIT \n    10 OFFSET 5;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH total_quantity AS (\n    SELECT \n        l.l_orderkey,\n        SUM(l.l_quantity) AS total_qty\n    FROM lineitem AS l\n    GROUP BY l.l_orderkey\n),\nnational_supplier AS (\n    SELECT \n        n.n_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        n.n_nationkey\n    FROM supplier AS s\n    JOIN nation AS n ON s.s_nationkey = n.n_nationkey\n    GROUP BY n.n_name, n.n_nationkey\n)\nSELECT \n    r.r_name,\n    COUNT(DISTINCT ns.n_nationkey) AS region_count,\n    SUM(tq.total_qty) AS total_quantity\nFROM region AS r\nLEFT JOIN national_supplier AS ns ON ns.n_nationkey = r.r_regionkey\nLEFT JOIN total_quantity AS tq ON ns.n_nationkey = tq.l_orderkey\nGROUP BY r.r_name;", "sql2": "WITH filtered_parts AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_retailprice,\n        (CASE \n            WHEN p.p_size BETWEEN 1 AND 5 THEN 'Small'\n            WHEN p.p_size BETWEEN 6 AND 15 THEN 'Medium'\n            ELSE 'Large'\n         END) AS size_category \n    FROM part AS p\n    WHERE p.p_retailprice IS NOT NULL\n),\nranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        ROW_NUMBER() OVER (PARTITION BY EXTRACT(YEAR FROM o.o_orderdate) ORDER BY o.o_totalprice DESC) AS order_rank\n    FROM orders AS o\n    WHERE o.o_orderdate >= DATE '1994-01-01'\n)\nSELECT \n    s1.r_name,\n    s1.region_count,\n    COALESCE(SUM(fp.p_retailprice), 0.00) AS total_retail_price,\n    AVG(ro.o_totalprice) AS avg_order_price,\n    s1.total_quantity\nFROM s1\nLEFT JOIN filtered_parts AS fp ON s1.region_count > 5\nLEFT JOIN ranked_orders AS ro ON s1.region_count = EXTRACT(YEAR FROM ro.o_orderdate)\nWHERE s1.region_count IS NOT NULL\nGROUP BY s1.r_name, s1.region_count, s1.total_quantity\nHAVING AVG(ro.o_totalprice) > (SELECT AVG(o.o_totalprice) FROM orders AS o)\nORDER BY s1.r_name DESC\nLIMIT 10 OFFSET 5;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "25087.sql", "original_sql": "SELECT \n    p.p_name, \n    s.s_name, \n    SUM(l.l_quantity) AS total_quantity, \n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_price,\n    STRING_AGG(DISTINCT CONCAT(c.c_name, ': ', o.o_orderdate, ' - ', l.l_comment), '; ') AS order_details\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' \n    AND p.p_type LIKE '%BRASS%'\nGROUP BY \n    p.p_name, s.s_name\nORDER BY \n    total_quantity DESC, average_price DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name,\n       s.s_name,\n       l.l_quantity,\n       o.o_orderkey,\n       l.l_extendedprice,\n       l.l_discount,\n       c.c_name,\n       o.o_orderdate,\n       l.l_comment\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n  AND p.p_type LIKE '%BRASS%';", "sql2": "SELECT p_name,\n       s_name,\n       SUM(l_quantity) AS total_quantity,\n       COUNT(DISTINCT o_orderkey) AS order_count,\n       AVG(l_extendedprice * (1 - l_discount)) AS average_price,\n       STRING_AGG(DISTINCT CONCAT(c_name, ': ', o_orderdate, ' - ', l_comment), '; ') AS order_details\nFROM s1\nGROUP BY p_name, s_name\nORDER BY total_quantity DESC, average_price DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "25119.sql", "original_sql": "\nSELECT \n    p.p_name, \n    s.s_name, \n    SUM(l.l_quantity) AS total_quantity, \n    AVG(l.l_extendedprice) AS average_price, \n    COUNT(DISTINCT c.c_custkey) AS customer_count, \n    STRING_AGG(DISTINCT n.n_name, '; ') AS nations_served\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    customer c ON c.c_custkey = l.l_orderkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    p.p_size > 10 \n    AND p.p_retailprice BETWEEN 50.00 AND 100.00\n    AND l.l_shipdate >= DATE '1997-01-01' \nGROUP BY \n    p.p_name, \n    s.s_name \nHAVING \n    SUM(l.l_quantity) > 100\nORDER BY \n    total_quantity DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT p.p_partkey, p.p_name, s.s_name, n.n_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE p.p_size > 10\n  AND p.p_retailprice BETWEEN 50.00 AND 100.00", "sql2": "SELECT s1.p_name,\n       s1.s_name,\n       li.total_quantity,\n       li.average_price,\n       li.customer_count,\n       STRING_AGG(DISTINCT s1.n_name, '; ') AS nations_served\nFROM (\n    SELECT l.l_partkey AS p_partkey,\n           SUM(l.l_quantity) AS total_quantity,\n           AVG(l.l_extendedprice) AS average_price,\n           COUNT(DISTINCT l.l_orderkey) AS customer_count\n    FROM lineitem l\n    WHERE l.l_shipdate >= DATE '1997-01-01'\n    GROUP BY l.l_partkey\n    HAVING SUM(l.l_quantity) > 100\n) li\nJOIN (\n    SELECT p_partkey, p_name, s_name, n_name\n    FROM (\n        SELECT p.p_partkey, p.p_name, s.s_name, n.n_name\n        FROM part p\n        JOIN partsupp ps ON p.p_partkey = ps.ps_partkey\n        JOIN supplier s ON ps.ps_suppkey = s.s_suppkey\n        JOIN nation n ON s.s_nationkey = n.n_nationkey\n        WHERE p.p_size > 10\n          AND p.p_retailprice BETWEEN 50.00 AND 100.00\n    ) AS sub\n) s1 ON s1.p_partkey = li.p_partkey\nGROUP BY s1.p_name, s1.s_name, li.total_quantity, li.average_price, li.customer_count\nORDER BY li.total_quantity DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25124.sql", "original_sql": "SELECT \n    CONCAT(n.n_name, ' - ', r.r_name) AS nation_region,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    SUM(CASE \n        WHEN LENGTH(p.p_name) > 20 THEN p.p_retailprice \n        ELSE 0 \n    END) AS total_retail_price_large_name,\n    ROUND(AVG(l.l_extendedprice * (1 - l.l_discount)), 2) AS avg_sales_price,\n    STRING_AGG(DISTINCT p.p_comment, ', ') AS part_comments\nFROM \n    nation n\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    customer c ON c.c_nationkey = n.n_nationkey\nJOIN \n    orders o ON o.o_custkey = c.c_custkey\nJOIN \n    lineitem l ON l.l_orderkey = o.o_orderkey\nJOIN \n    partsupp ps ON ps.ps_partkey = l.l_partkey\nJOIN \n    part p ON p.p_partkey = ps.ps_partkey\nWHERE \n    l.l_shipdate >= '1997-01-01' AND l.l_shipdate < '1997-12-31'\nGROUP BY \n    n.n_name, r.r_name\nHAVING \n    COUNT(DISTINCT c.c_custkey) > 10\nORDER BY \n    nation_region;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_orderkey AS order_key,\n       l.l_extendedprice * (1 - l.l_discount) AS sales_price,\n       CASE WHEN LENGTH(p.p_name) > 20 THEN p.p_retailprice ELSE 0 END AS retail_price_large_name,\n       p.p_comment AS part_comment\nFROM lineitem l\nJOIN partsupp ps ON ps.ps_partkey = l.l_partkey AND ps.ps_suppkey = l.l_suppkey\nJOIN part p ON p.p_partkey = ps.ps_partkey\nWHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1997-12-31';", "sql2": "SELECT CONCAT(n.n_name, ' - ', r.r_name) AS nation_region,\n       COUNT(DISTINCT c.c_custkey) AS unique_customers,\n       SUM(s1.retail_price_large_name) AS total_retail_price_large_name,\n       ROUND(AVG(s1.sales_price), 2) AS avg_sales_price,\n       STRING_AGG(DISTINCT s1.part_comment, ', ') AS part_comments\nFROM s1\nJOIN orders o ON o.o_orderkey = s1.order_key\nJOIN customer c ON c.c_custkey = o.o_custkey\nJOIN nation n ON n.n_nationkey = c.c_nationkey\nJOIN region r ON r.r_regionkey = n.n_regionkey\nGROUP BY n.n_name, r.r_name\nHAVING COUNT(DISTINCT c.c_custkey) > 10\nORDER BY nation_region;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "25132.sql", "original_sql": "\nSELECT \n    p.p_name,\n    s.s_name,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUBSTRING(s.s_comment, 1, 20) AS truncated_supplier_comment,\n    CONCAT(r.r_name, ' - ', n.n_name) AS region_nation\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_brand LIKE 'Brand%1' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, r.r_name, n.n_name, s.s_comment\nHAVING \n    SUM(l.l_quantity) > 1000\nORDER BY \n    total_quantity DESC, avg_price ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH filtered AS (\n    SELECT \n        p.p_name,\n        s.s_suppkey,\n        l.l_quantity,\n        l.l_extendedprice,\n        o.o_orderkey\n    FROM part p\n    JOIN partsupp ps ON p.p_partkey = ps.ps_partkey\n    JOIN supplier s ON ps.ps_suppkey = s.s_suppkey\n    JOIN lineitem l ON p.p_partkey = l.l_partkey\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE p.p_brand LIKE 'Brand%1'\n      AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n)\nSELECT\n    p_name,\n    s_suppkey,\n    SUM(l_quantity) AS total_quantity,\n    AVG(l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o_orderkey) AS order_count\nFROM filtered\nGROUP BY p_name, s_suppkey\nHAVING SUM(l_quantity) > 1000;", "sql2": "SELECT\n    s1.p_name,\n    s.s_name,\n    s1.total_quantity,\n    s1.avg_price,\n    s1.order_count,\n    SUBSTRING(s.s_comment, 1, 20) AS truncated_supplier_comment,\n    CONCAT(r.r_name, ' - ', n.n_name) AS region_nation\nFROM s1\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY s1.total_quantity DESC, s1.avg_price ASC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25290.sql", "original_sql": "\nWITH SupplierDetails AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_address,\n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        CONCAT(s.s_name, ' from ', s.s_address, ', ', n.n_name, ', ', r.r_name, ' (', s.s_comment, ')') AS supplier_info\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n),\nPartSupplierDetails AS (\n    SELECT \n        ps.ps_partkey,\n        ps.ps_suppkey,\n        p.p_name,\n        p.p_brand,\n        p.p_comment,\n        ps.ps_availqty,\n        ps.ps_supplycost,\n        CONCAT(p.p_name, ' (', p.p_brand, ') supplied by ', \n            (SELECT STRING_AGG(s.s_name, ', ') \n             FROM SupplierDetails s \n             WHERE s.s_suppkey = ps.ps_suppkey),\n            ' available:', CAST(ps.ps_availqty AS VARCHAR), \n            ' cost:', CAST(ps.ps_supplycost AS VARCHAR), \n            ' comment:', p.p_comment) AS part_supplier_info\n    FROM \n        partsupp ps\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n)\nSELECT \n    psd.part_supplier_info\nFROM \n    PartSupplierDetails psd\nWHERE \n    psd.ps_availqty > 100\nORDER BY \n    psd.ps_supplycost DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       s.s_address,\n       n.n_name AS nation_name,\n       r.r_name AS region_name,\n       CONCAT(s.s_name, ' from ', s.s_address, ', ', n.n_name, ', ', r.r_name, ' (', s.s_comment, ')') AS supplier_info\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey", "sql2": "SELECT CONCAT(p.p_name, ' (', p.p_brand, ') supplied by ', s1.s_name,\n              ' available:', CAST(ps.ps_availqty AS VARCHAR),\n              ' cost:', CAST(ps.ps_supplycost AS VARCHAR),\n              ' comment:', p.p_comment) AS part_supplier_info\nFROM partsupp ps\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN s1 ON s1.s_suppkey = ps.ps_suppkey\nWHERE ps.ps_availqty > 100\nORDER BY ps.ps_supplycost DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25291.sql", "original_sql": "\nWITH RankedParts AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_mfgr,\n        p.p_brand,\n        p.p_type,\n        p.p_size,\n        p.p_container,\n        p.p_retailprice,\n        p.p_comment,\n        ROW_NUMBER() OVER (PARTITION BY p.p_brand ORDER BY p.p_retailprice DESC) AS price_rank\n    FROM \n        part p\n    WHERE \n        p.p_size = (SELECT MAX(p2.p_size) FROM part p2)\n),\nFilteredSuppliers AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_address,\n        s.s_phone,\n        s.s_acctbal,\n        s.s_comment,\n        SUBSTRING(s.s_comment, 1, 50) AS short_comment\n    FROM \n        supplier s\n    WHERE \n        s.s_acctbal > (\n            SELECT AVG(s2.s_acctbal) \n            FROM supplier s2\n        )\n),\nSupplierPartDetails AS (\n    SELECT \n        ps.ps_partkey,\n        ps.ps_suppkey,\n        ps.ps_availqty,\n        ps.ps_supplycost,\n        CONCAT('Part: ', p.p_name, ', Supplier: ', s.s_name, ', Available Qty: ', ps.ps_availqty) AS details\n    FROM \n        partsupp ps\n    JOIN \n        RankedParts p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        FilteredSuppliers s ON ps.ps_suppkey = s.s_suppkey\n)\nSELECT \n    spd.details,\n    COUNT(*) AS total_count,\n    SUM(spd.ps_supplycost) AS total_supply_cost\nFROM \n    SupplierPartDetails spd\nGROUP BY \n    spd.details\nHAVING \n    COUNT(*) > 1\nORDER BY \n    total_supply_cost DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "25318.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' from ', n.n_name, ' region, ', r.r_name) AS supplier_region_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS orders_count,\n    AVG(CASE \n        WHEN c.c_mktsegment = 'BUILDING' THEN l.l_extendedprice \n        ELSE NULL \n    END) AS avg_price_building,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name LIKE '%East%'\n    AND l.l_shipdate BETWEEN '1996-01-01' AND '1996-12-31'\nGROUP BY \n    supplier_region_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    s.s_suppkey,\n    s.s_name,\n    s.s_nationkey,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS orders_count,\n    AVG(CASE WHEN c.c_mktsegment = 'BUILDING' THEN l.l_extendedprice END) AS avg_price_building,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    l.l_shipdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\nGROUP BY \n    s.s_suppkey, s.s_name, s.s_nationkey;", "sql2": "SELECT \n    CONCAT(s1.s_name, ' from ', n.n_name, ' region, ', r.r_name) AS supplier_region_name,\n    s1.total_revenue,\n    s1.orders_count,\n    s1.avg_price_building,\n    s1.part_names\nFROM \n    s1\nJOIN \n    nation n ON s1.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name LIKE '%East%'\nORDER BY \n    s1.total_revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25324.sql", "original_sql": "SELECT \n    p.p_name AS part_name,\n    s.s_name AS supplier_name,\n    c.c_name AS customer_name,\n    o.o_orderkey AS order_id,\n    COUNT(l.l_orderkey) AS line_item_count,\n    SUM(l.l_extendedprice) AS total_extended_price,\n    AVG(l.l_discount) AS average_discount,\n    MAX(l.l_shipdate) AS latest_ship_date,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_supplied,\n    STRING_AGG(DISTINCT p.p_comment, '|') AS part_comments\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON o.o_orderkey = l.l_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_size > 10 AND\n    s.s_acctbal > 500 AND\n    o.o_orderdate >= DATE '1997-01-01' AND\n    o.o_orderstatus = 'O'\nGROUP BY \n    p.p_name, s.s_name, c.c_name, o.o_orderkey\nORDER BY \n    total_extended_price DESC, line_item_count ASC\nLIMIT 50;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "25326.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name, \n    p.p_name AS part_name, \n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    STRING_AGG(DISTINCT c.c_mktsegment, ', ') AS market_segments,\n    MIN(l.l_shipdate) AS first_ship_date,\n    MAX(l.l_shipdate) AS last_ship_date\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    s.s_name LIKE '%Supplier%' \n    AND c.c_address LIKE '%Street%' \n    AND o.o_orderstatus = 'O' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "WITH filtered AS (\n    SELECT l.l_suppkey, l.l_partkey, o.o_orderkey, l.l_extendedprice, l.l_discount,\n           l.l_shipdate, c.c_mktsegment\n    FROM lineitem l\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    JOIN customer c ON o.o_custkey = c.c_custkey\n    WHERE o.o_orderstatus = 'O'\n      AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n      AND c.c_address LIKE '%Street%'\n)\nSELECT\n    l_suppkey AS supp_key,\n    l_partkey AS part_key,\n    COUNT(DISTINCT o_orderkey) AS total_orders,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue,\n    STRING_AGG(DISTINCT c_mktsegment, ', ') AS market_segments,\n    MIN(l_shipdate) AS first_ship_date,\n    MAX(l_shipdate) AS last_ship_date\nFROM filtered\nGROUP BY l_suppkey, l_partkey;", "sql2": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    s1.total_orders,\n    s1.total_revenue,\n    s1.market_segments,\n    s1.first_ship_date,\n    s1.last_ship_date\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.supp_key\nJOIN part p ON p.p_partkey = s1.part_key\nWHERE s.s_name LIKE '%Supplier%'\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25441.sql", "original_sql": "WITH SupplierDetails AS (\n    SELECT \n        s.s_suppkey, \n        s.s_name, \n        s.s_nationkey,\n        CONCAT(s.s_name, ' (', SUBSTRING(s.s_address, 1, 10), '...)') AS formatted_name_address\n    FROM \n        supplier s\n),\nPartDetails AS (\n    SELECT \n        p.p_partkey, \n        p.p_name, \n        p.p_mfgr, \n        p.p_type, \n        p.p_size, \n        REPLACE(p.p_comment, 'part', 'component') AS modified_comment\n    FROM \n        part p\n),\nCustomerDetails AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_mktsegment,\n        RIGHT(c.c_address, 10) AS last_ten_address_digits\n    FROM \n        customer c\n),\nOrderLineItems AS (\n    SELECT \n        l.l_orderkey, \n        l.l_partkey, \n        l.l_quantity, \n        l.l_extendedprice, \n        l.l_discount\n    FROM \n        lineitem l\n    WHERE \n        l.l_returnflag = 'N'\n)\nSELECT \n    sd.formatted_name_address,\n    pd.p_name,\n    pd.modified_comment,\n    cd.c_name,\n    SUM(oli.l_quantity) AS total_quantity,\n    SUM(oli.l_extendedprice * (1 - oli.l_discount)) AS total_revenue\nFROM \n    SupplierDetails sd\nJOIN \n    partsupp ps ON sd.s_suppkey = ps.ps_suppkey\nJOIN \n    PartDetails pd ON ps.ps_partkey = pd.p_partkey\nJOIN \n    CustomerDetails cd ON cd.c_custkey = sd.s_nationkey\nJOIN \n    OrderLineItems oli ON oli.l_orderkey = pd.p_partkey\nGROUP BY \n    sd.formatted_name_address,\n    pd.p_name,\n    pd.modified_comment,\n    cd.c_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l_orderkey,\n       SUM(l_quantity) AS total_quantity,\n       SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\nFROM lineitem\nWHERE l_returnflag = 'N'\nGROUP BY l_orderkey", "sql2": "WITH SupplierDetails AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           s.s_nationkey,\n           CONCAT(s.s_name, ' (', SUBSTRING(s.s_address, 1, 10), '...)') AS formatted_name_address\n    FROM supplier s\n),\nPartDetails AS (\n    SELECT p.p_partkey,\n           p.p_name,\n           p.p_mfgr,\n           p.p_type,\n           p.p_size,\n           REPLACE(p.p_comment, 'part', 'component') AS modified_comment\n    FROM part p\n),\nCustomerDetails AS (\n    SELECT c.c_custkey,\n           c.c_name,\n           c.c_mktsegment,\n           RIGHT(c.c_address, 10) AS last_ten_address_digits\n    FROM customer c\n)\nSELECT \n    sd.formatted_name_address,\n    pd.p_name,\n    pd.modified_comment,\n    cd.c_name,\n    s1.total_quantity,\n    s1.total_revenue\nFROM SupplierDetails sd\nJOIN partsupp ps ON sd.s_suppkey = ps.ps_suppkey\nJOIN PartDetails pd ON ps.ps_partkey = pd.p_partkey\nJOIN CustomerDetails cd ON cd.c_custkey = sd.s_nationkey\nJOIN s1 ON s1.l_orderkey = pd.p_partkey\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "25481.sql", "original_sql": "SELECT \n    p.p_name,\n    CONCAT('Supplier: ', s.s_name, ', Part Type: ', p.p_type, ', Average Supply Cost: ', AVG(ps.ps_supplycost)) AS supplier_part_info,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice) AS total_revenue,\n    LEFT(p.p_comment, 10) AS short_comment\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_size > 20 \n    AND s.s_acctbal > 1000.00 \n    AND o.o_orderstatus = 'O'\nGROUP BY \n    p.p_name, s.s_name, p.p_type, p.p_comment\nHAVING \n    COUNT(DISTINCT o.o_orderkey) > 5\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name, s.s_name, p.p_type, p.p_comment, o.o_orderkey, l.l_extendedprice, ps.ps_supplycost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_size > 20 AND s.s_acctbal > 1000.00 AND o.o_orderstatus = 'O'", "sql2": "SELECT p_name, CONCAT('Supplier: ', s_name, ', Part Type: ', p_type, ', Average Supply Cost: ', AVG(ps_supplycost)) AS supplier_part_info, COUNT(DISTINCT o_orderkey) AS total_orders, SUM(l_extendedprice) AS total_revenue, LEFT(p_comment, 10) AS short_comment FROM s1 GROUP BY p_name, s_name, p_type, p_comment HAVING COUNT(DISTINCT o_orderkey) > 5 ORDER BY total_revenue DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "25482.sql", "original_sql": "\nSELECT \n    p.p_name,\n    p.p_brand,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    STRING_AGG(DISTINCT CONCAT(n.n_name, ': ', n.n_comment), '; ') AS nation_comments,\n    SUBSTRING(p.p_comment, 1, 20) AS short_comment\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    p.p_size BETWEEN 10 AND 100\n    AND p.p_retailprice > (SELECT AVG(p2.p_retailprice) FROM part p2)\nGROUP BY \n    p.p_name, \n    p.p_brand,\n    p.p_partkey,\n    SUBSTRING(p.p_comment, 1, 20)\nORDER BY \n    total_available_quantity DESC, \n    average_supply_cost ASC\nLIMIT 50;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "25668.sql", "original_sql": "SELECT \n    p.p_name, \n    COUNT(DISTINCT s.s_suppkey) AS unique_suppliers, \n    SUM(ps.ps_availqty) AS total_available_quantity, \n    AVG(p.p_retailprice) AS average_retail_price, \n    CONCAT('Supplier: ', s.s_name, ' | Nation: ', n.n_name) AS supplier_info\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    p.p_size BETWEEN 1 AND 50\n    AND p.p_comment LIKE '%excellent%'\nGROUP BY \n    p.p_name, s.s_name, n.n_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 1\nORDER BY \n    total_available_quantity DESC, \n    average_retail_price ASC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name,\n       s.s_name,\n       n.n_name,\n       COUNT(DISTINCT s.s_suppkey) AS unique_suppliers,\n       SUM(ps.ps_availqty) AS total_available_quantity,\n       AVG(p.p_retailprice) AS average_retail_price,\n       CONCAT('Supplier: ', s.s_name, ' | Nation: ', n.n_name) AS supplier_info\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE p.p_size BETWEEN 1 AND 50\n  AND p.p_comment LIKE '%excellent%'\nGROUP BY p.p_name, s.s_name, n.n_name\nHAVING COUNT(DISTINCT s.s_suppkey) > 1", "sql2": "SELECT p_name,\n       unique_suppliers,\n       total_available_quantity,\n       average_retail_price,\n       supplier_info\nFROM s1\nORDER BY total_available_quantity DESC, average_retail_price ASC\nLIMIT 10", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25683.sql", "original_sql": "SELECT \n    p.p_name AS part_name,\n    s.s_name AS supplier_name,\n    n.n_name AS nation_name,\n    SUM(l.l_quantity) AS total_quantity_sold,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_price_after_discount,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    STRING_AGG(DISTINCT o.o_orderpriority, ', ') AS order_priorities,\n    MAX(l.l_shipdate) AS latest_ship_date\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_name LIKE 'rubber%' \n    AND n.n_name IN (SELECT r.r_name FROM region r WHERE r.r_comment LIKE '%east%')\nGROUP BY \n    p.p_name, s.s_name, n.n_name\nHAVING \n    SUM(l.l_quantity) > 100\nORDER BY \n    total_quantity_sold DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "25694.sql", "original_sql": "\nSELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    MIN(l.l_discount) AS min_discount,\n    MAX(l.l_tax) AS max_tax,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    r.r_name AS region_name,\n    TRIM(BOTH ' ' FROM s.s_comment) AS trimmed_supplier_comment\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\n    AND p.p_type LIKE '%metal%'\nGROUP BY \n    s.s_name, p.p_name, r.r_name, s.s_comment\nHAVING \n    SUM(ps.ps_availqty) > 1000\nORDER BY \n    total_available_quantity DESC, unique_customers DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "25697.sql", "original_sql": "SELECT \n    p.p_partkey,\n    UPPER(p.p_name) AS uppercase_part_name,\n    CONCAT(p.p_brand, ' - ', p.p_type) AS brand_type,\n    REPLACE(SUBSTRING(p.p_comment, 1, 15), ' ', '-') AS modified_comment,\n    COALESCE(SUM(ps.ps_supplycost * ps.ps_availqty), 0) AS total_supply_value,\n    s.s_name AS supplier_name,\n    r.r_name AS region_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM \n    part p\nLEFT JOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nLEFT JOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nLEFT JOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nLEFT JOIN \n    region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_retailprice > 50.00\nGROUP BY \n    p.p_partkey, p.p_name, p.p_brand, p.p_type, p.p_comment, s.s_name, r.r_name\nHAVING \n    COUNT(DISTINCT o.o_orderkey) > 10\nORDER BY \n    total_supply_value DESC, uppercase_part_name ASC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "25723.sql", "original_sql": "\nSELECT \n    CONCAT('Part Name: ', p.p_name, ' - Manufacturer: ', p.p_mfgr, ' - Brand: ', p.p_brand) AS part_info,\n    SUM(CASE WHEN l.l_returnflag = 'Y' THEN l.l_quantity ELSE 0 END) AS total_returned_quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    r.r_name AS region_name,\n    n.n_name AS nation_name\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_comment LIKE '%fragile%' \n    AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31'\nGROUP BY \n    p.p_partkey, p.p_name, p.p_mfgr, p.p_brand, r.r_name, n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000\nORDER BY \n    total_sales DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    CONCAT('Part Name: ', p.p_name, ' - Manufacturer: ', p.p_mfgr, ' - Brand: ', p.p_brand) AS part_info,\n    SUM(CASE WHEN l.l_returnflag = 'Y' THEN l.l_quantity ELSE 0 END) AS total_returned_quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    r.r_name AS region_name,\n    n.n_name AS nation_name\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_comment LIKE '%fragile%'\n  AND o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\nGROUP BY p.p_partkey, p.p_name, p.p_mfgr, p.p_brand, r.r_name, n.n_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000", "sql2": "SELECT *\nFROM s1\nORDER BY total_sales DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25736.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    COUNT(l.l_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(l.l_quantity) AS avg_quantity_per_order,\n    STRING_AGG(DISTINCT c.c_name, ', ') AS customer_names\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    s.s_name LIKE 'Supplier%'\n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name\nORDER BY \n    total_revenue DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "25859.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' from ', r.r_name) AS supplier_info,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(p.p_retailprice) AS avg_part_price,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    r.r_name LIKE 'Europe%' AND \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' \nGROUP BY \n    s.s_name, r.r_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 100000\nORDER BY \n    total_revenue DESC;", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: SQL(ParserError(\"Expected: identifier, found: ) at Line: 9, Column: 1\"), None)\n", "engine_mem_mb": 500000}
{"query_id": "25864.sql", "original_sql": "WITH SupplierDetails AS (\n    SELECT s.s_suppkey, s.s_name, s.s_nationkey, \n           CONCAT(s.s_name, ' - ', s.s_address, ' (', s.s_phone, ')') AS SupplierInfo\n    FROM supplier s\n), \nNationDetails AS (\n    SELECT n.n_nationkey, n.n_name AS NationName \n    FROM nation n\n),\nPartDetails AS (\n    SELECT p.p_partkey, p.p_name, \n           CONCAT(p.p_name, ' [', p.p_brand, '] - ', p.p_comment) AS PartInfo\n    FROM part p\n),\nAggregatedData AS (\n    SELECT ps.ps_partkey, ps.ps_suppkey, \n           SUM(ps.ps_availqty) AS TotalAvailable, \n           MIN(ps.ps_supplycost) AS MinSupplyCost\n    FROM partsupp ps\n    GROUP BY ps.ps_partkey, ps.ps_suppkey\n)\nSELECT \n    sd.SupplierInfo, \n    nd.NationName, \n    pd.PartInfo, \n    ad.TotalAvailable, \n    ad.MinSupplyCost\nFROM AggregatedData ad\nJOIN SupplierDetails sd ON ad.ps_suppkey = sd.s_suppkey\nJOIN PartDetails pd ON ad.ps_partkey = pd.p_partkey\nJOIN NationDetails nd ON sd.s_nationkey = nd.n_nationkey\nWHERE ad.TotalAvailable > 100\nORDER BY sd.SupplierInfo, ad.MinSupplyCost DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT ps_partkey,\n       ps_suppkey,\n       SUM(ps_availqty) AS TotalAvailable,\n       MIN(ps_supplycost) AS MinSupplyCost\nFROM partsupp\nGROUP BY ps_partkey, ps_suppkey\nHAVING SUM(ps_availqty) > 100;", "sql2": "SELECT sd.SupplierInfo,\n       nd.NationName,\n       pd.PartInfo,\n       s1.TotalAvailable,\n       s1.MinSupplyCost\nFROM s1\nJOIN (\n    SELECT s_suppkey,\n           CONCAT(s_name, ' - ', s_address, ' (', s_phone, ')') AS SupplierInfo,\n           s_nationkey\n    FROM supplier\n) sd ON s1.ps_suppkey = sd.s_suppkey\nJOIN (\n    SELECT p_partkey,\n           CONCAT(p_name, ' [', p_brand, '] - ', p_comment) AS PartInfo\n    FROM part\n) pd ON s1.ps_partkey = pd.p_partkey\nJOIN (\n    SELECT n_nationkey,\n           n_name AS NationName\n    FROM nation\n) nd ON sd.s_nationkey = nd.n_nationkey\nORDER BY sd.SupplierInfo, s1.MinSupplyCost DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25871.sql", "original_sql": "\nSELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    p.p_brand AS part_brand,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(l.l_extendedprice) AS avg_extended_price,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    r.r_name AS region_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    s.s_comment LIKE '%reliable%'\n    AND p.p_type LIKE '%metal%'\n    AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name, p.p_brand, r.r_name\nHAVING \n    SUM(ps.ps_availqty) > 50\nORDER BY \n    total_available_quantity DESC, avg_extended_price ASC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_name AS supplier_name,\n       p.p_name AS part_name,\n       p.p_brand AS part_brand,\n       r.r_name AS region_name,\n       ps.ps_availqty,\n       l.l_extendedprice,\n       o.o_orderkey,\n       c.c_custkey\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE s.s_comment LIKE '%reliable%'\n  AND p.p_type LIKE '%metal%'\n  AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31';", "sql2": "SELECT s1.supplier_name,\n       s1.part_name,\n       s1.part_brand,\n       s1.region_name,\n       SUM(s1.ps_availqty) AS total_available_quantity,\n       AVG(s1.l_extendedprice) AS avg_extended_price,\n       COUNT(DISTINCT s1.c_custkey) AS unique_customers\nFROM s1\nGROUP BY s1.supplier_name, s1.part_name, s1.part_brand, s1.region_name\nHAVING SUM(s1.ps_availqty) > 50\nORDER BY total_available_quantity DESC, avg_extended_price ASC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "25898.sql", "original_sql": "WITH SupplierParts AS (\n    SELECT \n        s.s_name,\n        p.p_name,\n        p.p_brand,\n        p.p_type,\n        p.p_container,\n        p.p_retailprice,\n        ps.ps_availqty,\n        CONCAT(s.s_name, ': ', p.p_name, ' - ', p.p_brand, ' [', p.p_type, ']') AS part_description\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n),\nAggregatedData AS (\n    SELECT \n        p_type,\n        COUNT(DISTINCT s_name) AS unique_suppliers,\n        SUM(ps_availqty) AS total_availqty,\n        AVG(p_retailprice) AS avg_price,\n        STRING_AGG(part_description, ', ') AS descriptions\n    FROM \n        SupplierParts\n    GROUP BY \n        p_type\n)\nSELECT \n    p_type,\n    unique_suppliers,\n    total_availqty,\n    avg_price,\n    descriptions\nFROM \n    AggregatedData\nWHERE \n    unique_suppliers > 1\nORDER BY \n    avg_price DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "25904.sql", "original_sql": "SELECT \n    p.p_name AS part_name, \n    s.s_name AS supplier_name, \n    c.c_name AS customer_name, \n    o.o_orderdate AS order_date, \n    COUNT(DISTINCT li.l_orderkey) AS order_count,\n    ROUND(SUM(li.l_extendedprice * (1 - li.l_discount)), 2) AS total_revenue,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_involved,\n    MAX(CASE \n        WHEN li.l_returnflag = 'R' THEN 'Returned' \n        ELSE 'Not Returned' \n    END) AS return_status\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem li ON ps.ps_partkey = li.l_partkey AND s.s_suppkey = li.l_suppkey\nJOIN \n    orders o ON li.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_name LIKE '%steel%'\n    AND o.o_orderdate >= DATE '1996-01-01'\n    AND o.o_orderdate < DATE '1997-01-01'\nGROUP BY \n    p.p_name, s.s_name, c.c_name, o.o_orderdate\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26000.sql", "original_sql": "SELECT \n    p.p_name, \n    COUNT(DISTINCT ps.ps_suppkey) AS supplier_count, \n    SUM(ps.ps_availqty) AS total_available_quantity, \n    MAX(CASE \n            WHEN LENGTH(p.p_comment) > 20 THEN SUBSTRING(p.p_comment, 1, 20) || '...'\n            ELSE p.p_comment \n        END) AS truncated_comment,\n    r.r_name AS region_name \nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_retailprice > 100.00 \n    AND r.r_name LIKE 'Eu%'\nGROUP BY \n    p.p_name, r.r_name\nHAVING \n    COUNT(DISTINCT ps.ps_suppkey) > 5\nORDER BY \n    total_available_quantity DESC, \n    p.p_name;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    p.p_name AS p_name,\n    ps.ps_suppkey AS ps_suppkey,\n    ps.ps_availqty AS ps_availqty,\n    p.p_comment AS p_comment,\n    r.r_name AS r_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_retailprice > 100.00\n  AND r.r_name LIKE 'Eu%';", "sql2": "SELECT \n    p_name,\n    COUNT(DISTINCT ps_suppkey) AS supplier_count,\n    SUM(ps_availqty) AS total_available_quantity,\n    MAX(CASE \n            WHEN LENGTH(p_comment) > 20 THEN SUBSTRING(p_comment, 1, 20) || '...'\n            ELSE p_comment\n        END) AS truncated_comment,\n    r_name AS region_name\nFROM s1\nGROUP BY p_name, r_name\nHAVING COUNT(DISTINCT ps_suppkey) > 5\nORDER BY total_available_quantity DESC, p_name;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26029.sql", "original_sql": "SELECT \n    p.p_name AS Product_Name,\n    s.s_name AS Supplier_Name,\n    c.c_name AS Customer_Name,\n    COUNT(o.o_orderkey) AS Total_Orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS Total_Sales,\n    AVG(l.l_quantity) AS Average_Quantity,\n    MAX(l.l_shipdate) AS Last_Ship_Date,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS Regions_Supplied\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_type LIKE '%metal%' AND \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, c.c_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000\nORDER BY \n    Total_Sales DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS part_key, l.l_suppkey AS supp_key, o.o_custkey AS cust_key, COUNT(o.o_orderkey) AS total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales, AVG(l.l_quantity) AS average_quantity, MAX(l.l_shipdate) AS last_ship_date FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31' GROUP BY l.l_partkey, l.l_suppkey, o.o_custkey", "sql2": "SELECT p.p_name AS Product_Name, s.s_name AS Supplier_Name, c.c_name AS Customer_Name, s1.total_orders AS Total_Orders, s1.total_sales AS Total_Sales, s1.average_quantity AS Average_Quantity, s1.last_ship_date AS Last_Ship_Date, STRING_AGG(DISTINCT r.r_name, ', ') AS Regions_Supplied FROM s1 JOIN part p ON s1.part_key = p.p_partkey JOIN supplier s ON s1.supp_key = s.s_suppkey JOIN customer c ON s1.cust_key = c.c_custkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE p.p_type LIKE '%metal%' GROUP BY p.p_name, s.s_name, c.c_name, s1.total_orders, s1.total_sales, s1.average_quantity, s1.last_ship_date HAVING s1.total_sales > 10000 ORDER BY Total_Sales DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26160.sql", "original_sql": "SELECT \n    p.p_name, \n    COUNT(DISTINCT ps.ps_suppkey) AS supplier_count, \n    AVG(ps.ps_supplycost) AS avg_supply_cost, \n    SUM(CASE WHEN l.l_discount > 0 THEN l.l_quantity ELSE 0 END) AS total_discounted_quantity, \n    MAX(CASE WHEN o.o_orderdate > '1997-01-01' THEN o.o_totalprice ELSE NULL END) AS max_recent_order_value,\n    STRING_AGG(DISTINCT s.s_name, ', ') AS supplier_names\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON o.o_orderkey = l.l_orderkey\nWHERE \n    p.p_type LIKE '%raw%'\n    AND s.s_nationkey IN (SELECT n.n_nationkey FROM nation n WHERE n.n_name = 'Germany')\nGROUP BY \n    p.p_name\nHAVING \n    COUNT(DISTINCT ps.ps_suppkey) > 5 \nORDER BY \n    avg_supply_cost DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26175.sql", "original_sql": "\nWITH SupplierParts AS (\n    SELECT s.s_suppkey, s.s_name, p.p_name, COUNT(ps.ps_availqty) AS total_parts, \n           SUM(ps.ps_supplycost) AS total_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY s.s_suppkey, s.s_name, p.p_name\n    HAVING COUNT(ps.ps_availqty) > 10\n), RegionNations AS (\n    SELECT r.r_regionkey, r.r_name, COUNT(n.n_nationkey) AS nation_count\n    FROM region r\n    JOIN nation n ON r.r_regionkey = n.n_regionkey\n    GROUP BY r.r_regionkey, r.r_name\n), CustomerOrders AS (\n    SELECT c.c_custkey, c.c_name, COUNT(o.o_orderkey) AS total_orders, \n           AVG(o.o_totalprice) AS average_order_value\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT sp.s_name, sp.p_name, sp.total_parts, sp.total_cost, \n       rn.r_name AS region_name, co.c_name AS customer_name, \n       co.total_orders, co.average_order_value\nFROM SupplierParts sp\nJOIN RegionNations rn ON rn.nation_count > 3\nJOIN CustomerOrders co ON co.total_orders > 5\nWHERE sp.total_cost > 5000\nORDER BY sp.total_parts DESC, co.average_order_value DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       p.p_name,\n       COUNT(ps.ps_availqty) AS total_parts,\n       SUM(ps.ps_supplycost) AS total_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nGROUP BY s.s_suppkey, s.s_name, p.p_name\nHAVING COUNT(ps.ps_availqty) > 10\n   AND SUM(ps.ps_supplycost) > 5000;", "sql2": "WITH rn AS (\n    SELECT r.r_name\n    FROM region r\n    JOIN nation n ON r.r_regionkey = n.n_regionkey\n    GROUP BY r.r_regionkey, r.r_name\n    HAVING COUNT(n.n_nationkey) > 3\n),\nco AS (\n    SELECT c.c_name,\n           COUNT(o.o_orderkey) AS total_orders,\n           AVG(o.o_totalprice) AS average_order_value\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n    HAVING COUNT(o.o_orderkey) > 5\n)\nSELECT s1.s_name,\n       s1.p_name,\n       s1.total_parts,\n       s1.total_cost,\n       rn.r_name AS region_name,\n       co.c_name AS customer_name,\n       co.total_orders,\n       co.average_order_value\nFROM s1\nCROSS JOIN rn\nCROSS JOIN co\nORDER BY s1.total_parts DESC, co.average_order_value DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26188.sql", "original_sql": "SELECT \n    s_name AS supplier_name, \n    SUM(ps_availqty) AS total_available_qty,\n    COUNT(DISTINCT p_partkey) AS unique_parts_supplied,\n    STRING_AGG(DISTINCT CONCAT(p_name, ' (', p_brand, ')'), ', ') AS supplied_part_details,\n    n_name AS nation_name,\n    CONCAT('Region: ', r_name, ', Supplier Address: ', s_address) AS detailed_info\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_size > 50 AND \n    s.s_acctbal > 1000.00\nGROUP BY \n    s.s_suppkey, s_name, n_name, r_name, s_address\nORDER BY \n    total_available_qty DESC, unique_parts_supplied DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH filtered_supplier AS (\n    SELECT s_suppkey, s_name, s_address, s_nationkey\n    FROM supplier\n    WHERE s_acctbal > 1000.00\n)\nSELECT \n    fs.s_suppkey,\n    fs.s_name,\n    fs.s_address,\n    fs.s_nationkey,\n    SUM(ps.ps_availqty) AS total_available_qty,\n    COUNT(DISTINCT p.p_partkey) AS unique_parts_supplied,\n    STRING_AGG(DISTINCT CONCAT(p.p_name, ' (', p.p_brand, ')'), ', ') AS supplied_part_details\nFROM filtered_supplier fs\nJOIN partsupp ps ON fs.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE p.p_size > 50\nGROUP BY fs.s_suppkey, fs.s_name, fs.s_address, fs.s_nationkey;", "sql2": "SELECT \n    s1.s_name AS supplier_name,\n    s1.total_available_qty,\n    s1.unique_parts_supplied,\n    s1.supplied_part_details,\n    n.n_name AS nation_name,\n    CONCAT('Region: ', r.r_name, ', Supplier Address: ', s1.s_address) AS detailed_info\nFROM s1\nJOIN nation n ON s1.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY s1.total_available_qty DESC, s1.unique_parts_supplied DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26217.sql", "original_sql": "\nSELECT\n    CONCAT(part.p_name, ' - ', supplier.s_name) AS part_supplier,\n    COUNT(DISTINCT customer.c_custkey) AS unique_customers,\n    SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS total_revenue,\n    region.r_name AS region_name,\n    LEFT(part.p_comment, 10) AS comment_excerpt\nFROM\n    part\nJOIN\n    partsupp ON part.p_partkey = partsupp.ps_partkey\nJOIN\n    supplier ON partsupp.ps_suppkey = supplier.s_suppkey\nJOIN\n    lineitem ON part.p_partkey = lineitem.l_partkey\nJOIN\n    orders ON lineitem.l_orderkey = orders.o_orderkey\nJOIN\n    customer ON orders.o_custkey = customer.c_custkey\nJOIN\n    nation ON supplier.s_nationkey = nation.n_nationkey\nJOIN\n    region ON nation.n_regionkey = region.r_regionkey\nWHERE\n    lineitem.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\n    AND orders.o_orderstatus = 'F'\n    AND part.p_container IN ('BOX', 'PACK')\nGROUP BY\n    part.p_name,\n    supplier.s_name,\n    region.r_name,\n    part.p_comment\nHAVING\n    SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) > 100000\nORDER BY\n    total_revenue DESC,\n    unique_customers ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    partsupp.ps_partkey AS part_key,\n    partsupp.ps_suppkey AS supp_key,\n    region.r_name AS region_name,\n    SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS total_revenue,\n    COUNT(DISTINCT customer.c_custkey) AS unique_customers\nFROM lineitem\nJOIN orders ON lineitem.l_orderkey = orders.o_orderkey\nJOIN customer ON orders.o_custkey = customer.c_custkey\nJOIN partsupp ON lineitem.l_partkey = partsupp.ps_partkey\n               AND lineitem.l_suppkey = partsupp.ps_suppkey\nJOIN supplier ON partsupp.ps_suppkey = supplier.s_suppkey\nJOIN nation ON supplier.s_nationkey = nation.n_nationkey\nJOIN region ON nation.n_regionkey = region.r_regionkey\nWHERE lineitem.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n  AND orders.o_orderstatus = 'F'\nGROUP BY partsupp.ps_partkey, partsupp.ps_suppkey, region.r_name\nHAVING SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) > 100000", "sql2": "SELECT\n    CONCAT(part.p_name, ' - ', supplier.s_name) AS part_supplier,\n    s1.unique_customers,\n    s1.total_revenue,\n    s1.region_name,\n    LEFT(part.p_comment, 10) AS comment_excerpt\nFROM s1\nJOIN part ON s1.part_key = part.p_partkey\nJOIN supplier ON s1.supp_key = supplier.s_suppkey\nWHERE part.p_container IN ('BOX', 'PACK')\nORDER BY s1.total_revenue DESC,\n         s1.unique_customers ASC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26349.sql", "original_sql": "\nWITH SupplierProductCounts AS (\n    SELECT s.s_suppkey, s.s_name, COUNT(ps.ps_partkey) AS product_count\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n),\nCustomerSpending AS (\n    SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n),\nTopSuppliers AS (\n    SELECT s.s_name AS sc_name, sp.product_count\n    FROM SupplierProductCounts sp\n    JOIN (\n        SELECT s.s_suppkey, s.s_name\n        FROM supplier s\n        ORDER BY s.s_acctbal DESC\n        FETCH FIRST 5 ROWS ONLY\n    ) s ON sp.s_suppkey = s.s_suppkey\n),\nTopCustomers AS (\n    SELECT c.c_name, c.total_spent\n    FROM CustomerSpending c\n    JOIN (\n        SELECT c.c_custkey\n        FROM customer c\n        ORDER BY c.c_acctbal DESC\n        FETCH FIRST 5 ROWS ONLY\n    ) top_c ON c.c_custkey = top_c.c_custkey\n)\nSELECT tc.c_name AS top_customer, ts.sc_name AS top_supplier, ts.product_count\nFROM TopCustomers tc\nJOIN TopSuppliers ts ON ts.product_count > 10\nORDER BY tc.total_spent DESC, ts.product_count DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "26411.sql", "original_sql": "WITH SupplierStats AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_nationkey,\n        SUM(ps.ps_availqty) AS total_available_quantity,\n        COUNT(DISTINCT ps.ps_partkey) AS distinct_parts_supplied,\n        STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY s.s_suppkey, s.s_name, s.s_nationkey\n),\nNationRegions AS (\n    SELECT \n        n.n_nationkey,\n        n.n_name,\n        r.r_regionkey,\n        r.r_name AS region_name\n    FROM nation n\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT \n    nw.n_name AS nation_name,\n    nr.region_name,\n    ss.s_name AS supplier_name,\n    ss.total_available_quantity,\n    ss.distinct_parts_supplied,\n    ss.part_names,\n    cast('1998-10-01' as date) AS benchmark_date\nFROM SupplierStats ss\nJOIN NationRegions nr ON ss.s_nationkey = nr.n_nationkey\nJOIN nation nw ON nr.n_nationkey = nw.n_nationkey\nWHERE ss.total_available_quantity > 1000\nORDER BY ss.total_available_quantity DESC;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "26438.sql", "original_sql": "SELECT \n    p.p_name AS part_name, \n    COUNT(DISTINCT o.o_orderkey) AS order_count, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, \n    r.r_name AS region_name, \n    n.n_name AS nation_name\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_type LIKE '%BRASS%'\n    AND o.o_orderdate BETWEEN '1994-01-01' AND '1994-12-31'\nGROUP BY \n    p.p_name, r.r_name, n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000\nORDER BY \n    total_revenue DESC, part_name ASC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    l.l_partkey AS part_key,\n    s.s_nationkey AS nation_key,\n    n.n_regionkey AS region_key,\n    COUNT(DISTINCT o.o_orderkey) AS order_cnt,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE o.o_orderdate BETWEEN DATE '1994-01-01' AND DATE '1994-12-31'\nGROUP BY l.l_partkey, s.s_nationkey, n.n_regionkey\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000", "sql2": "SELECT \n    p.p_name AS part_name,\n    s1.order_cnt AS order_count,\n    s1.revenue AS total_revenue,\n    r.r_name AS region_name,\n    n.n_name AS nation_name\nFROM s1\nJOIN part p ON s1.part_key = p.p_partkey\nJOIN nation n ON s1.nation_key = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_type LIKE '%BRASS%'\nORDER BY total_revenue DESC, part_name ASC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "26559.sql", "original_sql": "SELECT \n    CONCAT('Supplier: ', s.s_name, ' (', s.s_suppkey, ')') AS supplier_info,\n    COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    STRING_AGG(DISTINCT CONCAT('Part: ', p.p_name, ' [', p.p_partkey, '] - Price: $', p.p_retailprice), ', ') AS parts_details,\n    r.r_name AS region_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name LIKE '%East%' \nGROUP BY \n    s.s_suppkey, s.s_name, r.r_name\nHAVING \n    COUNT(DISTINCT ps.ps_partkey) > 5\nORDER BY \n    total_available_quantity DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       r.r_name AS region_name\nFROM   supplier s\nJOIN   nation n ON s.s_nationkey = n.n_nationkey\nJOIN   region r ON n.n_regionkey = r.r_regionkey\nWHERE  r.r_name LIKE '%East%';", "sql2": "SELECT CONCAT('Supplier: ', s.s_name, ' (', s.s_suppkey, ')') AS supplier_info,\n       COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied,\n       SUM(ps.ps_availqty) AS total_available_quantity,\n       AVG(ps.ps_supplycost) AS average_supply_cost,\n       STRING_AGG(DISTINCT CONCAT('Part: ', p.p_name, ' [', p.p_partkey, '] - Price: $', p.p_retailprice), ', ') AS parts_details,\n       s.region_name\nFROM   s1 s\nJOIN   partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN   part p ON ps.ps_partkey = p.p_partkey\nGROUP BY s.s_suppkey, s.s_name, s.region_name\nHAVING COUNT(DISTINCT ps.ps_partkey) > 5\nORDER BY total_available_quantity DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26564.sql", "original_sql": "WITH SupplierStats AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_nationkey,\n        SUM(ps.ps_availqty) AS total_available_quantity,\n        AVG(ps.ps_supplycost) AS average_supply_cost,\n        STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY s.s_suppkey, s.s_name, s.s_nationkey\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COUNT(o.o_orderkey) AS total_orders,\n        SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n),\nSummary AS (\n    SELECT \n        r.r_name AS region_name,\n        n.n_name AS nation_name,\n        s.s_name AS supplier_name,\n        s.total_available_quantity,\n        s.average_supply_cost,\n        c.c_name AS customer_name,\n        c.total_orders,\n        c.total_spent,\n        STRING_AGG(DISTINCT s.part_names, '; ') AS all_part_names\n    FROM region r\n    JOIN nation n ON r.r_regionkey = n.n_regionkey\n    JOIN SupplierStats s ON n.n_nationkey = s.s_nationkey\n    JOIN CustomerOrders c ON c.c_custkey = s.s_nationkey \n    GROUP BY r.r_name, n.n_name, s.s_name, s.total_available_quantity, s.average_supply_cost, c.c_name, c.total_orders, c.total_spent\n)\nSELECT \n    region_name,\n    nation_name,\n    supplier_name,\n    total_available_quantity,\n    average_supply_cost,\n    customer_name,\n    total_orders,\n    total_spent,\n    all_part_names\nFROM Summary\nWHERE total_spent > 1000\nORDER BY total_spent DESC, total_orders DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26573.sql", "original_sql": "WITH SupplierParts AS (\n    SELECT \n        s.s_name AS supplier_name,\n        p.p_name AS part_name,\n        ps.ps_availqty AS available_quantity,\n        ps.ps_supplycost AS supply_cost,\n        CONCAT(s.s_name, ' supplies ', p.p_name, ' with availability of ', CAST(ps.ps_availqty AS VARCHAR), ' units at a cost of $', CAST(ps.ps_supplycost AS DECIMAL(12, 2))) AS supply_info\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n),\nCustomerOrders AS (\n    SELECT \n        c.c_name AS customer_name,\n        COUNT(o.o_orderkey) AS total_orders,\n        SUM(o.o_totalprice) AS total_spent,\n        CONCAT(c.c_name, ' has placed ', CAST(COUNT(o.o_orderkey) AS VARCHAR), ' orders totaling $', CAST(SUM(o.o_totalprice) AS DECIMAL(12, 2))) AS order_summary\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_name\n)\nSELECT \n    rp.r_name AS region_name,\n    COUNT(DISTINCT sp.supplier_name) AS supplier_count,\n    COUNT(DISTINCT co.customer_name) AS customer_count,\n    STRING_AGG(sp.supply_info, '; ') AS supplier_details,\n    STRING_AGG(co.order_summary, '; ') AS customer_orders_summary\nFROM \n    region rp\nLEFT JOIN \n    nation n ON rp.r_regionkey = n.n_regionkey\nLEFT JOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN \n    SupplierParts sp ON s.s_name = sp.supplier_name\nLEFT JOIN \n    CustomerOrders co ON co.customer_name = sp.supplier_name\nGROUP BY \n    rp.r_name\nORDER BY \n    rp.r_name;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH CustomerOrders AS (\n    SELECT \n        c.c_name AS customer_name,\n        COUNT(o.o_orderkey) AS total_orders,\n        SUM(o.o_totalprice) AS total_spent,\n        CONCAT(c.c_name, ' has placed ', CAST(COUNT(o.o_orderkey) AS VARCHAR), ' orders totaling $', CAST(SUM(o.o_totalprice) AS DECIMAL(12, 2))) AS order_summary\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_name\n)\nSELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    ps.ps_availqty AS available_quantity,\n    ps.ps_supplycost AS supply_cost,\n    CONCAT(s.s_name, ' supplies ', p.p_name, ' with availability of ', CAST(ps.ps_availqty AS VARCHAR), ' units at a cost of $', CAST(ps.ps_supplycost AS DECIMAL(12, 2))) AS supply_info,\n    co.customer_name,\n    co.total_orders,\n    co.total_spent,\n    co.order_summary\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN CustomerOrders co ON co.customer_name = s.s_name;", "sql2": "SELECT \n    rp.r_name AS region_name,\n    COUNT(DISTINCT sp.supplier_name) AS supplier_count,\n    COUNT(DISTINCT sp.customer_name) AS customer_count,\n    STRING_AGG(sp.supply_info, '; ') AS supplier_details,\n    STRING_AGG(sp.order_summary, '; ') AS customer_orders_summary\nFROM region rp\nLEFT JOIN nation n ON rp.r_regionkey = n.n_regionkey\nLEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN s1 sp ON s.s_name = sp.supplier_name\nGROUP BY rp.r_name\nORDER BY rp.r_name;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "26605.sql", "original_sql": "SELECT \n    p.p_name AS part_name,\n    s.s_name AS supplier_name,\n    n.n_name AS nation_name,\n    c.c_name AS customer_name,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    CONCAT('Supplier ', s.s_name, ' from nation ', n.n_name, ' supplied ', SUM(l.l_quantity), ' of ', p.p_name, ' to customer ', c.c_name) AS performance_comment\nFROM \n    lineitem l\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    part p ON l.l_partkey = p.p_partkey\nWHERE \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\n    AND c.c_mktsegment = 'BUILDING'\nGROUP BY \n    p.p_name, s.s_name, n.n_name, c.c_name\nORDER BY \n    total_quantity DESC, average_price ASC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS partkey, s.s_suppkey AS suppkey, s.s_nationkey AS nationkey, o.o_custkey AS custkey, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_price, COUNT(DISTINCT o.o_orderkey) AS order_count FROM lineitem l JOIN partsupp ps ON l.l_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31' AND c.c_mktsegment = 'BUILDING' GROUP BY l.l_partkey, s.s_suppkey, s.s_nationkey, o.o_custkey;", "sql2": "SELECT p.p_name AS part_name, sup.s_name AS supplier_name, n.n_name AS nation_name, cust.c_name AS customer_name, s1.total_quantity, s1.average_price, s1.order_count, CONCAT('Supplier ', sup.s_name, ' from nation ', n.n_name, ' supplied ', s1.total_quantity, ' of ', p.p_name, ' to customer ', cust.c_name) AS performance_comment FROM s1 JOIN part p ON s1.partkey = p.p_partkey JOIN supplier sup ON s1.suppkey = sup.s_suppkey JOIN nation n ON s1.nationkey = n.n_nationkey JOIN customer cust ON s1.custkey = cust.c_custkey ORDER BY s1.total_quantity DESC, s1.average_price ASC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "26773.sql", "original_sql": "SELECT \n    CONCAT(c.c_name, ' (', n.n_name, ')') AS customer_info,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    STRING_AGG(DISTINCT CONCAT(p.p_name, ' [', ps.ps_supplycost, ']'), ', ') AS supplied_parts,\n    MAX(o.o_orderdate) AS last_order_date\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    l.l_shipdate >= '1997-01-01' \nGROUP BY \n    c.c_custkey, c.c_name, n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26799.sql", "original_sql": "SELECT \n    p.p_name,\n    s.s_name,\n    n.n_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value \nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nWHERE \n    n.n_name LIKE 'A%' \n    AND l.l_shipdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31' \n    AND ps.ps_availqty > 10 \nGROUP BY \n    p.p_name, s.s_name, n.n_name \nORDER BY \n    total_orders DESC, avg_order_value DESC \nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name, s.s_name, n.n_name, o.o_orderkey, l.l_extendedprice, l.l_discount FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE n.n_name LIKE 'A%' AND l.l_shipdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31' AND ps.ps_availqty > 10", "sql2": "SELECT p_name, s_name, n_name, COUNT(DISTINCT o_orderkey) AS total_orders, AVG(l_extendedprice * (1 - l_discount)) AS avg_order_value FROM s1 GROUP BY p_name, s_name, n_name ORDER BY total_orders DESC, avg_order_value DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "26821.sql", "original_sql": "WITH NationSupplier AS (\n    SELECT \n        n.n_name AS nation_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        STRING_AGG(DISTINCT s.s_name, ', ') AS supplier_names\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY \n        n.n_name\n),\nPartInfo AS (\n    SELECT \n        p.p_name AS part_name,\n        p.p_retailprice,\n        COUNT(ps.ps_suppkey) AS available_suppliers\n    FROM \n        part p\n    LEFT JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    GROUP BY \n        p.p_name, p.p_retailprice\n),\nOrderDetails AS (\n    SELECT \n        o.o_orderkey,\n        c.c_name AS customer_name,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_value\n    FROM \n        orders o\n    JOIN \n        customer c ON o.o_custkey = c.c_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    GROUP BY \n        o.o_orderkey, c.c_name\n)\nSELECT \n    ns.nation_name,\n    ns.supplier_count,\n    ns.supplier_names,\n    pi.part_name,\n    pi.p_retailprice,\n    pi.available_suppliers,\n    od.customer_name,\n    od.total_value\nFROM \n    NationSupplier ns\nJOIN \n    PartInfo pi ON ns.nation_name LIKE '%United%'\nJOIN \n    OrderDetails od ON pi.available_suppliers > 5\nORDER BY \n    ns.supplier_count DESC, pi.p_retailprice ASC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26822.sql", "original_sql": "SELECT\n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(l.l_extendedprice) AS average_price,\n    COUNT(DISTINCT c.c_custkey) AS distinct_customers,\n    CONCAT(p.p_type, ' - ', p.p_container) AS part_details,\n    r.r_name AS region_name\nFROM\n    supplier s\nJOIN\n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN\n    customer c ON o.o_custkey = c.c_custkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    l.l_shipmode LIKE '%AIR%'\n    AND l.l_returnflag = 'N'\n    AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY\n    s.s_name, p.p_name, r.r_name, p.p_type, p.p_container\nORDER BY\n    total_available_quantity DESC, average_price ASC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    s.s_suppkey,\n    p.p_partkey,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(l.l_extendedprice) AS average_price,\n    COUNT(DISTINCT c.c_custkey) AS distinct_customers,\n    p.p_type,\n    p.p_container,\n    s.s_nationkey\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE l.l_shipmode LIKE '%AIR%'\n  AND l.l_returnflag = 'N'\n  AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY s.s_suppkey, p.p_partkey, p.p_type, p.p_container, s.s_nationkey", "sql2": "SELECT\n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    s1.total_available_quantity,\n    s1.average_price,\n    s1.distinct_customers,\n    CONCAT(s1.p_type, ' - ', s1.p_container) AS part_details,\n    r.r_name AS region_name\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.s_suppkey\nJOIN part p ON p.p_partkey = s1.p_partkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY s1.total_available_quantity DESC, s1.average_price ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "26940.sql", "original_sql": "SELECT \n    p.p_name,\n    p.p_brand,\n    CONCAT('Supplier: ', s.s_name, ', Address: ', s.s_address) AS supplier_info,\n    SUM(ps.ps_availqty) AS total_availqty,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(o.o_totalprice) AS avg_order_value,\n    STRING_AGG(DISTINCT CONCAT('Customer: ', c.c_name, ', Segment: ', c.c_mktsegment), '; ') AS customer_details\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_type LIKE '%metal%'\n    AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_partkey, p.p_name, p.p_brand, s.s_name, s.s_address\nORDER BY \n    total_availqty DESC, avg_order_value DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "26983.sql", "original_sql": "SELECT \n    CONCAT('Supplier: ', s.s_name, ' | Product: ', p.p_name, ' | Comment: ', ps.ps_comment) AS detailed_info,\n    LENGTH(ps.ps_comment) AS comment_length,\n    SUBSTR(ps.ps_comment, 1, 20) AS short_comment,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    s.s_acctbal > 1000 AND \n    p.p_type LIKE 'METAL%' AND \n    o.o_orderstatus = 'O'\nGROUP BY \n    s.s_name, p.p_name, ps.ps_comment\nHAVING \n    COUNT(DISTINCT o.o_orderkey) > 5\nORDER BY \n    comment_length DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS part_key,\n       l.l_suppkey AS supp_key,\n       COUNT(DISTINCT o.o_orderkey) AS order_cnt\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderstatus = 'O'\nGROUP BY l.l_partkey, l.l_suppkey\nHAVING COUNT(DISTINCT o.o_orderkey) > 5;", "sql2": "SELECT CONCAT('Supplier: ', s.s_name, ' | Product: ', p.p_name, ' | Comment: ', ps.ps_comment) AS detailed_info,\n       LENGTH(ps.ps_comment) AS comment_length,\n       SUBSTR(ps.ps_comment, 1, 20) AS short_comment,\n       s1.order_cnt AS order_count\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.supp_key\nJOIN partsupp ps ON ps.ps_partkey = s1.part_key AND ps.ps_suppkey = s1.supp_key\nJOIN part p ON p.p_partkey = s1.part_key\nWHERE s.s_acctbal > 1000\n  AND p.p_type LIKE 'METAL%'\nORDER BY comment_length DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27055.sql", "original_sql": "\nSELECT \n    p.p_name AS part_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    SUBSTRING(p.p_comment, 1, 15) AS short_comment,\n    CONCAT(n.n_name, ' (', r.r_name, ')') AS nation_region\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_type LIKE '%brass%'\n    AND s.s_acctbal > 1000.00\n    AND p.p_retailprice BETWEEN 10.00 AND 100.00\nGROUP BY \n    p.p_name, n.n_name, r.r_name, p.p_comment\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 5\nORDER BY \n    average_supply_cost DESC, part_name ASC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27069.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' from ', r.r_name) AS supplier_region,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(l.l_quantity) AS avg_quantity_per_order,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_comment LIKE '%fragile%'\n    AND o.o_orderdate >= DATE '1996-01-01'\n    AND o.o_orderdate < DATE '1997-01-01'\nGROUP BY \n    supplier_region\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27082.sql", "original_sql": "\nSELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS average_price_after_discount,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    SUBSTRING(p.p_comment, 1, 10) AS short_comment\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    s.s_nationkey = (SELECT n.n_nationkey FROM nation n WHERE n.n_name = 'USA')\n    AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name, ps.ps_availqty, l.l_extendedprice, l.l_discount, o.o_orderkey, c.c_custkey, p.p_comment\nORDER BY \n    total_available_quantity DESC, average_price_after_discount DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_name AS supplier_name,\n       p.p_name AS part_name,\n       ps.ps_availqty,\n       l.l_extendedprice,\n       l.l_discount,\n       o.o_orderkey,\n       c.c_custkey,\n       p.p_comment\nFROM   supplier s\nJOIN   nation n ON s.s_nationkey = n.n_nationkey AND n.n_name = 'USA'\nJOIN   partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN   part p ON ps.ps_partkey = p.p_partkey\nJOIN   lineitem l ON p.p_partkey = l.l_partkey\n               AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nJOIN   orders o ON l.l_orderkey = o.o_orderkey\nJOIN   customer c ON o.o_custkey = c.c_custkey;", "sql2": "SELECT supplier_name,\n       part_name,\n       SUM(ps_availqty) AS total_available_quantity,\n       AVG(l_extendedprice * (1 - l_discount)) AS average_price_after_discount,\n       COUNT(DISTINCT o_orderkey) AS total_orders,\n       COUNT(DISTINCT c_custkey) AS unique_customers,\n       SUBSTRING(p_comment, 1, 10) AS short_comment\nFROM   s1\nGROUP BY supplier_name,\n         part_name,\n         ps_availqty,\n         l_extendedprice,\n         l_discount,\n         o_orderkey,\n         c_custkey,\n         p_comment\nORDER BY total_available_quantity DESC,\n         average_price_after_discount DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27108.sql", "original_sql": "SELECT \n    p.p_brand,\n    COUNT(DISTINCT p.p_partkey) AS unique_parts,\n    SUM(ps.ps_availqty) AS total_avail_qty,\n    AVG(p.p_retailprice) AS avg_retail_price,\n    STRING_AGG(DISTINCT s.s_name, ', ') AS suppliers,\n    CONCAT('Region: ', r.r_name, ' (', COUNT(DISTINCT n.n_nationkey), ' Nations)') AS region_info\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_retailprice > 50.00\n    AND s.s_acctbal > 1000.00\nGROUP BY \n    p.p_brand, r.r_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 2\nORDER BY \n    total_avail_qty DESC, avg_retail_price ASC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    p.p_brand,\n    r.r_name,\n    s.s_name,\n    s.s_suppkey,\n    p.p_partkey,\n    ps.ps_availqty,\n    p.p_retailprice,\n    n.n_nationkey\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_retailprice > 50.00\n  AND s.s_acctbal > 1000.00;", "sql2": "SELECT\n    p_brand,\n    COUNT(DISTINCT p_partkey) AS unique_parts,\n    SUM(ps_availqty) AS total_avail_qty,\n    AVG(p_retailprice) AS avg_retail_price,\n    STRING_AGG(DISTINCT s_name, ', ') AS suppliers,\n    CONCAT('Region: ', r_name, ' (', COUNT(DISTINCT n_nationkey), ' Nations)') AS region_info\nFROM s1\nGROUP BY p_brand, r_name\nHAVING COUNT(DISTINCT s_suppkey) > 2\nORDER BY total_avail_qty DESC, avg_retail_price ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "27121.sql", "original_sql": "WITH SupplierInfo AS (\n    SELECT \n        s.s_suppkey, \n        s.s_name, \n        s.s_address, \n        n.n_name AS nation_name,\n        CONCAT(s.s_name, ' | ', s.s_address, ' | ', n.n_name) AS supplier_details\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n),\nPartInfo AS (\n    SELECT \n        p.p_partkey, \n        p.p_name, \n        p.p_brand, \n        p.p_mfgr, \n        p.p_comment,\n        LENGTH(p.p_comment) AS comment_length,\n        CASE \n            WHEN p.p_size > 20 THEN 'Large' \n            WHEN p.p_size BETWEEN 10 AND 20 THEN 'Medium' \n            ELSE 'Small' \n        END AS size_category\n    FROM \n        part p\n),\nOrderInfo AS (\n    SELECT \n        o.o_orderkey, \n        o.o_totalprice, \n        o.o_orderstatus, \n        EXTRACT(YEAR FROM o.o_orderdate) AS order_year\n    FROM \n        orders o\n)\nSELECT \n    si.supplier_details, \n    pi.p_name, \n    pi.size_category, \n    oi.o_totalprice, \n    oi.o_orderstatus, \n    MAX(pi.comment_length) AS max_comment_length\nFROM \n    SupplierInfo si\nJOIN \n    partsupp ps ON si.s_suppkey = ps.ps_suppkey\nJOIN \n    PartInfo pi ON ps.ps_partkey = pi.p_partkey\nJOIN \n    lineitem li ON pi.p_partkey = li.l_partkey\nJOIN \n    OrderInfo oi ON li.l_orderkey = oi.o_orderkey\nWHERE \n    oi.o_totalprice > 1000 AND \n    pi.size_category = 'Large'\nGROUP BY \n    si.supplier_details, pi.p_name, pi.size_category, oi.o_totalprice, oi.o_orderstatus\nORDER BY \n    max_comment_length DESC, oi.o_totalprice DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27243.sql", "original_sql": "SELECT\n    p.p_name,\n    p.p_brand,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(p.p_retailprice) AS average_price,\n    COUNT(DISTINCT l.l_orderkey) AS total_orders\nFROM\n    part p\nJOIN\n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN\n    lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN\n    customer c ON o.o_custkey = c.c_custkey\nJOIN\n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nWHERE\n    p.p_size BETWEEN 10 AND 20\n    AND r.r_name LIKE 'Europe%'\n    AND o.o_orderstatus = 'O'\n    AND l.l_shipmode IN ('AIR', 'TRUCK')\nGROUP BY\n    p.p_name, p.p_brand\nHAVING\n    SUM(ps.ps_availqty) > 500\nORDER BY\n    average_price DESC;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Collection([Diagnostic(Diagnostic { kind: Error, message: \"column 'p_name' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"p_name\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))), Diagnostic(Diagnostic { kind: Error, message: \"column 'p_brand' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"p_brand\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))), Diagnostic(Diagnostic { kind: Error, message: \"column 'total_available_quantity' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"total_available_quantity\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))), Diagnostic(Diagnostic { kind: Error, message: \"column 'average_price' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"average_price\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\"))), Diagnostic(Diagnostic { kind: Error, message: \"column 'total_orders' not found\", span: None, notes: [], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: None, name: \"total_orders\" }, valid_fields: [Column { relation: Some(Bare { table: \"s1\" }), name: \"count\" }] }, Some(\"\")))])\n", "engine_mem_mb": 500000}
{"query_id": "27280.sql", "original_sql": "\nSELECT\n    SUM(CASE \n            WHEN POSITION('special' IN LOWER(p_comment)) > 0 THEN 1 \n            ELSE 0 \n        END) AS special_part_count,\n    AVG(p_retailprice) AS average_retail_price,\n    COUNT(DISTINCT s.s_suppkey) AS unique_suppliers_count,\n    r.r_name AS region_name,\n    n.n_name AS nation_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_size > 10\nGROUP BY r.r_name, n.n_name, p_comment, p_retailprice\nHAVING COUNT(DISTINCT s.s_suppkey) > 5\nORDER BY region_name, nation_name;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    r.r_name AS region_name,\n    n.n_name AS nation_name,\n    p.p_comment AS p_comment,\n    p.p_retailprice AS p_retailprice,\n    s.s_suppkey AS supp_key,\n    CASE WHEN POSITION('special' IN LOWER(p.p_comment)) > 0 THEN 1 ELSE 0 END AS is_special\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_size > 10", "sql2": "SELECT\n    SUM(is_special) AS special_part_count,\n    AVG(p_retailprice) AS average_retail_price,\n    COUNT(DISTINCT supp_key) AS unique_suppliers_count,\n    region_name,\n    nation_name\nFROM s1\nGROUP BY region_name, nation_name, p_comment, p_retailprice\nHAVING COUNT(DISTINCT supp_key) > 5\nORDER BY region_name, nation_name;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27294.sql", "original_sql": "SELECT \n    CONCAT('Supplier: ', s.s_name) AS supplier_info,\n    LEFT(p.p_name, 20) AS part_name,\n    REPLACE(p.p_comment, 'obsolete', 'legacy') AS updated_comment,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    r.r_name AS region_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderstatus = 'O' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    supplier_info, part_name, updated_comment, r.r_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_suppkey AS suppkey,\n    ps.ps_partkey AS partkey,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nWHERE o.o_orderstatus = 'O'\n  AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY ps.ps_suppkey, ps.ps_partkey;", "sql2": "SELECT \n    CONCAT('Supplier: ', s.s_name) AS supplier_info,\n    LEFT(p.p_name, 20) AS part_name,\n    REPLACE(p.p_comment, 'obsolete', 'legacy') AS updated_comment,\n    s1.total_orders,\n    s1.total_revenue,\n    r.r_name AS region_name\nFROM s1\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nJOIN part p ON s1.partkey = p.p_partkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "27323.sql", "original_sql": "WITH nation_supplier AS (\n    SELECT n.n_name AS nation_name, \n           COUNT(s.s_suppkey) AS supplier_count, \n           SUM(s.s_acctbal) AS total_acctbal \n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey \n    GROUP BY n.n_name\n), \npart_supplier AS (\n    SELECT p.p_name AS part_name, \n           COUNT(ps.ps_suppkey) AS part_supplier_count \n    FROM part p \n    JOIN partsupp ps ON p.p_partkey = ps.ps_partkey \n    GROUP BY p.p_name\n),\ncombined AS (\n    SELECT ns.nation_name, \n           ps.part_name, \n           ns.supplier_count, \n           ps.part_supplier_count, \n           CONCAT(ns.nation_name, ' | ', ps.part_name) AS combined_name \n    FROM nation_supplier ns \n    JOIN part_supplier ps ON ns.nation_name LIKE '%land%' OR ps.part_name LIKE '%brass%'\n)\nSELECT combined_name, \n       supplier_count, \n       part_supplier_count, \n       CONCAT('Nation: ', nation_name, ', Suppliers: ', supplier_count, ', Part: ', part_name, ', Part Suppliers: ', part_supplier_count) AS detailed_info \nFROM combined \nWHERE supplier_count > 5 AND part_supplier_count > 3 \nORDER BY nation_name, part_name;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH nation_supplier AS (\n    SELECT n.n_name AS nation_name,\n           COUNT(s.s_suppkey) AS supplier_count,\n           SUM(s.s_acctbal) AS total_acctbal\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_name\n),\npart_supplier AS (\n    SELECT p.p_name AS part_name,\n           COUNT(ps.ps_suppkey) AS part_supplier_count\n    FROM part p\n    JOIN partsupp ps ON p.p_partkey = ps.ps_partkey\n    GROUP BY p.p_name\n),\nfiltered_ns AS (\n    SELECT * FROM nation_supplier WHERE nation_name LIKE '%land%'\n),\nfiltered_ps AS (\n    SELECT * FROM part_supplier WHERE part_name LIKE '%brass%'\n),\ncombined AS (\n    SELECT ns.nation_name,\n           ps.part_name,\n           ns.supplier_count,\n           ps.part_supplier_count,\n           CONCAT(ns.nation_name, ' | ', ps.part_name) AS combined_name\n    FROM filtered_ns ns\n    CROSS JOIN part_supplier ps\n    UNION ALL\n    SELECT ns.nation_name,\n           ps.part_name,\n           ns.supplier_count,\n           ps.part_supplier_count,\n           CONCAT(ns.nation_name, ' | ', ps.part_name) AS combined_name\n    FROM nation_supplier ns\n    CROSS JOIN filtered_ps ps\n)\nSELECT combined_name,\n       nation_name,\n       part_name,\n       supplier_count,\n       part_supplier_count\nFROM combined;", "sql2": "SELECT combined_name,\n       supplier_count,\n       part_supplier_count,\n       CONCAT('Nation: ', nation_name, ', Suppliers: ', supplier_count, ', Part: ', part_name, ', Part Suppliers: ', part_supplier_count) AS detailed_info\nFROM s1\nWHERE supplier_count > 5 AND part_supplier_count > 3\nORDER BY nation_name, part_name;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27336.sql", "original_sql": "SELECT \n    CONCAT(c.c_name, ' from ', s.s_name) AS supplier_customer, \n    SUBSTRING(p.p_name, 1, 20) AS truncated_part_name, \n    p.p_brand, \n    REGEXP_REPLACE(s.s_comment, '[^a-zA-Z0-9 ]', '') AS sanitized_supplier_comment,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    CASE \n        WHEN SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000 THEN 'High Revenue'\n        WHEN SUM(l.l_extendedprice * (1 - l.l_discount)) BETWEEN 5000 AND 10000 THEN 'Medium Revenue'\n        ELSE 'Low Revenue'\n    END AS revenue_category,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM \n    lineitem l \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nJOIN \n    customer c ON o.o_custkey = c.c_custkey \nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    part p ON ps.ps_partkey = p.p_partkey \nWHERE \n    p.p_retailprice BETWEEN 10.00 AND 100.00 \n    AND l.l_shipdate >= '1997-01-01' \nGROUP BY \n    c.c_name, s.s_name, p.p_name, p.p_brand, s.s_comment \nORDER BY \n    total_revenue DESC \nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    c.c_name AS c_name,\n    s.s_name AS s_name,\n    p.p_name AS p_name,\n    p.p_brand AS p_brand,\n    s.s_comment AS s_comment,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE p.p_retailprice BETWEEN 10.00 AND 100.00\n  AND l.l_shipdate >= DATE '1997-01-01'\nGROUP BY c.c_name, s.s_name, p.p_name, p.p_brand, s.s_comment;", "sql2": "SELECT \n    CONCAT(c_name, ' from ', s_name) AS supplier_customer,\n    SUBSTRING(p_name, 1, 20) AS truncated_part_name,\n    p_brand,\n    REGEXP_REPLACE(s_comment, '[^a-zA-Z0-9 ]', '') AS sanitized_supplier_comment,\n    total_revenue,\n    CASE \n        WHEN total_revenue > 10000 THEN 'High Revenue'\n        WHEN total_revenue BETWEEN 5000 AND 10000 THEN 'Medium Revenue'\n        ELSE 'Low Revenue'\n    END AS revenue_category,\n    order_count\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27444.sql", "original_sql": "WITH StringProcessing AS (\n    SELECT \n        p.p_partkey,\n        UPPER(p.p_name) AS upper_name,\n        LOWER(p.p_comment) AS lower_comment,\n        SUBSTRING(p.p_brand FROM 1 FOR 5) AS brand_substring,\n        CONCAT('Brand: ', p.p_brand, ' | Type: ', p.p_type) AS brand_type,\n        LENGTH(p.p_container) AS container_length,\n        REPLACE(p.p_comment, 'good', 'excellent') AS modified_comment\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey\n    WHERE \n        s.s_acctbal > 1000 \n        AND p.p_size BETWEEN 10 AND 20\n)\nSELECT \n    n.n_name,\n    COUNT(DISTINCT sp.p_partkey) AS part_count,\n    MAX(LENGTH(sp.upper_name)) AS max_upper_name_length,\n    MIN(LENGTH(sp.lower_comment)) AS min_lower_comment_length,\n    MAX(LENGTH(sp.modified_comment)) AS max_modified_comment_length,\n    STRING_AGG(sp.brand_type, '; ') AS aggregated_brand_type\nFROM \n    StringProcessing sp\nJOIN \n    supplier s ON sp.p_partkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nGROUP BY \n    n.n_name\nORDER BY \n    part_count DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_partkey,\n    UPPER(p.p_name) AS upper_name,\n    LOWER(p.p_comment) AS lower_comment,\n    SUBSTRING(p.p_brand FROM 1 FOR 5) AS brand_substring,\n    CONCAT('Brand: ', p.p_brand, ' | Type: ', p.p_type) AS brand_type,\n    LENGTH(p.p_container) AS container_length,\n    REPLACE(p.p_comment, 'good', 'excellent') AS modified_comment,\n    s.s_nationkey\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE s.s_acctbal > 1000\n  AND p.p_size BETWEEN 10 AND 20;", "sql2": "SELECT \n    n.n_name,\n    COUNT(DISTINCT sp.p_partkey) AS part_count,\n    MAX(LENGTH(sp.upper_name)) AS max_upper_name_length,\n    MIN(LENGTH(sp.lower_comment)) AS min_lower_comment_length,\n    MAX(LENGTH(sp.modified_comment)) AS max_modified_comment_length,\n    STRING_AGG(sp.brand_type, '; ') AS aggregated_brand_type\nFROM s1 sp\nJOIN nation n ON sp.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY part_count DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "27445.sql", "original_sql": "\nSELECT \n    p.p_partkey,\n    SUBSTRING(p.p_name FROM 1 FOR 15) AS short_part_name,\n    LENGTH(p.p_comment) AS comment_length,\n    r.r_name AS region_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    STRING_AGG(DISTINCT s.s_name, ', ') AS supplier_names,\n    MAX(l.l_extendedprice) AS max_extended_price\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nWHERE \n    p.p_size BETWEEN 10 AND 20\n    AND l.l_shipdate > DATE '1998-10-01' - INTERVAL '1 year'\nGROUP BY \n    p.p_partkey, short_part_name, comment_length, r.r_name\nHAVING \n    COUNT(DISTINCT l.l_orderkey) > 5\nORDER BY \n    comment_length DESC, supplier_count DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "27451.sql", "original_sql": "SELECT \n    COUNT(DISTINCT p.p_partkey) AS distinct_part_count,\n    AVG(s.s_acctbal) AS average_supplier_balance,\n    STRING_AGG(DISTINCT CONCAT(n.n_name, ': ', s.s_name), ', ') AS supplier_nations\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    p.p_retailprice > 50.00\n    AND s.s_comment LIKE '%reliable%'\n    AND n.n_name IN ('USA', 'Germany', 'Japan')\nGROUP BY \n    p.p_name\nHAVING \n    COUNT(s.s_suppkey) > 2\nORDER BY \n    average_supplier_balance DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27486.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' (', r.r_name, ')') AS supplier_info,\n    COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(p.p_retailprice) AS average_part_price,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_size > 10 AND \n    s.s_acctbal > (SELECT AVG(s_acctbal) FROM supplier)\nGROUP BY \n    supplier_info\nORDER BY \n    total_parts_supplied DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "27519.sql", "original_sql": "\nSELECT \n    c.c_name AS customer_name,\n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    COUNT(o.o_orderkey) AS number_of_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    CONCAT('Customer located at ', c.c_address, ' ordered ', p.p_name, \n           ' from supplier ', s.s_name, ' in region ', r.r_name) AS order_summary\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA' \n    AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    c.c_name, c.c_address, s.s_name, p.p_name, r.r_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000.00\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT c.c_name AS customer_name, c.c_address AS c_address, s.s_name AS supplier_name, p.p_name AS part_name, COUNT(o.o_orderkey) AS number_of_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, r.r_name AS r_name FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN nation n ON s.s_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE r.r_name = 'ASIA' AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY c.c_name, c.c_address, s.s_name, p.p_name, r.r_name HAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000.00", "sql2": "SELECT customer_name, supplier_name, part_name, number_of_orders, total_revenue, CONCAT('Customer located at ', c_address, ' ordered ', part_name, ' from supplier ', supplier_name, ' in region ', r_name) AS order_summary FROM s1 ORDER BY total_revenue DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27647.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' (', r.r_name, ')') AS supplier_region,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\n    AND o.o_orderstatus = 'O'\nGROUP BY \n    supplier_region\nHAVING \n    SUM(l.l_quantity) > 100\nORDER BY \n    total_quantity DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27653.sql", "original_sql": "\nSELECT \n    p.p_name,\n    s.s_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(o.o_totalprice) AS avg_order_price,\n    CONCAT(r.r_name, ' - ', n.n_name) AS region_nation\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    orders o ON o.o_custkey = s.s_nationkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_comment LIKE 'Special%' \n    AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31'\n    AND s.s_acctbal > 500.00\nGROUP BY \n    p.p_name, s.s_name, r.r_name, n.n_name\nHAVING \n    SUM(ps.ps_availqty) > 1000\nORDER BY \n    avg_order_price DESC, total_orders DESC\nFETCH FIRST 10 ROWS ONLY;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    p.p_name,\n    s.s_name,\n    r.r_name,\n    n.n_name,\n    s.s_nationkey,\n    SUM(ps.ps_availqty) AS total_available_quantity\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_comment LIKE 'Special%'\n  AND s.s_acctbal > 500.00\nGROUP BY p.p_name, s.s_name, r.r_name, n.n_name, s.s_nationkey\nHAVING SUM(ps.ps_availqty) > 1000", "sql2": "SELECT\n    s1.p_name,\n    s1.s_name,\n    s1.total_available_quantity,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(o.o_totalprice) AS avg_order_price,\n    CONCAT(s1.r_name, ' - ', s1.n_name) AS region_nation\nFROM s1\nJOIN orders o ON o.o_custkey = s1.s_nationkey\nWHERE o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\nGROUP BY s1.p_name, s1.s_name, s1.total_available_quantity, s1.r_name, s1.n_name\nORDER BY avg_order_price DESC, total_orders DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27685.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(CASE \n            WHEN l.l_returnflag = 'R' THEN l.l_quantity \n            ELSE NULL \n        END) AS avg_return_amt,\n    STRING_AGG(DISTINCT CONCAT(n.n_name, ': ', s.s_comment), '; ') AS supplier_comments,\n    REGEXP_REPLACE(UPPER(p.p_name), '[^A-Z0-9 ]', '') AS sanitized_part_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate <= DATE '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name\nHAVING \n    AVG(l.l_quantity) > 5\nORDER BY \n    total_revenue DESC;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "27848.sql", "original_sql": "WITH StringAgg AS (\n    SELECT \n        n.n_name AS nation_name,\n        STRING_AGG(CONCAT(p.p_name, ' (', s.s_name, ')'), ', ') AS part_supplier_list,\n        COUNT(DISTINCT p.p_partkey) AS part_count\n    FROM \n        nation n \n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey \n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey \n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey \n    WHERE \n        LENGTH(p.p_name) > 15\n    GROUP BY \n        n.n_name\n), TotalCount AS (\n    SELECT \n        COUNT(DISTINCT p.p_partkey) AS total_part_count\n    FROM \n        part p \n    WHERE \n        LENGTH(p.p_name) > 15\n)\nSELECT\n    s.nation_name,\n    s.part_supplier_list,\n    s.part_count,\n    t.total_part_count,\n    ROUND((s.part_count * 100.0 / t.total_part_count), 2) AS percentage_of_total\nFROM \n    StringAgg s,\n    TotalCount t\nWHERE \n    s.part_count > 0\nORDER BY \n    percentage_of_total DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    n.n_name AS nation_name,\n    STRING_AGG(CONCAT(p.p_name, ' (', s.s_name, ')'), ', ') AS part_supplier_list,\n    COUNT(DISTINCT p.p_partkey) AS part_count\nFROM nation n\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE LENGTH(p.p_name) > 15\nGROUP BY n.n_name;", "sql2": "SELECT\n    s.nation_name,\n    s.part_supplier_list,\n    s.part_count,\n    t.total_part_count,\n    ROUND((s.part_count * 100.0 / t.total_part_count), 2) AS percentage_of_total\nFROM s1 s\nCROSS JOIN (\n    SELECT COUNT(DISTINCT p.p_partkey) AS total_part_count\n    FROM part p\n    WHERE LENGTH(p.p_name) > 15\n) t\nWHERE s.part_count > 0\nORDER BY percentage_of_total DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "27861.sql", "original_sql": "SELECT \n    p.p_name,\n    s.s_name,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    r.r_name AS region_name\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_comment LIKE '%special%'\n    AND l.l_shipmode IN ('AIR', 'RAIL')\n    AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, r.r_name\nHAVING \n    SUM(l.l_quantity) > 100\nORDER BY \n    total_quantity DESC, avg_price ASC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    p.p_partkey,\n    s.s_suppkey,\n    n.n_regionkey,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN part p ON l.l_partkey = p.p_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nWHERE p.p_comment LIKE '%special%'\n  AND l.l_shipmode IN ('AIR', 'RAIL')\n  AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY p.p_partkey, s.s_suppkey, n.n_regionkey\nHAVING SUM(l.l_quantity) > 100;", "sql2": "SELECT\n    p.p_name,\n    s.s_name,\n    agg.total_quantity,\n    agg.avg_price,\n    agg.order_count,\n    r.r_name AS region_name\nFROM s1 agg\nJOIN part p ON agg.p_partkey = p.p_partkey\nJOIN supplier s ON agg.s_suppkey = s.s_suppkey\nJOIN region r ON agg.n_regionkey = r.r_regionkey\nORDER BY agg.total_quantity DESC, agg.avg_price ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "27875.sql", "original_sql": "SELECT \n    p.p_name,\n    s.s_name,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(l.l_discount) AS avg_discount,\n    MIN(l.l_shipdate) AS first_ship_date,\n    MAX(l.l_shipdate) AS last_ship_date,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' - ', s.s_address), '; ') AS supplier_addresses\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_name LIKE '%Steel%' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name\nORDER BY \n    total_revenue DESC, customer_count DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    p.p_partkey,\n    s.s_suppkey,\n    p.p_name,\n    s.s_name,\n    s.s_address,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(l.l_discount) AS avg_discount,\n    MIN(l.l_shipdate) AS first_ship_date,\n    MAX(l.l_shipdate) AS last_ship_date,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' - ', s.s_address), '; ') AS supplier_addresses\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE p.p_name LIKE '%Steel%'\n  AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY p.p_partkey, s.s_suppkey, p.p_name, s.s_name, s.s_address;", "sql2": "SELECT\n    p_name,\n    s_name,\n    customer_count,\n    total_revenue,\n    avg_discount,\n    first_ship_date,\n    last_ship_date,\n    supplier_addresses\nFROM s1\nORDER BY total_revenue DESC, customer_count DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27900.sql", "original_sql": "SELECT\n    CONCAT(s.s_name, ' from ', n.n_name, ' in ', r.r_name) AS supplier_info,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(CASE WHEN l.l_discount > 0 THEN l.l_extendedprice ELSE NULL END) AS avg_discounted_price,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names,\n    COUNT(DISTINCT CASE WHEN c.c_mktsegment = 'FURNITURE' THEN c.c_custkey END) AS furniture_customers\nFROM\n    supplier s\nJOIN\n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN\n    region r ON n.n_regionkey = r.r_regionkey\nJOIN\n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN\n    part p ON ps.ps_partkey = p.p_partkey\nJOIN\n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN\n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN\n    customer c ON o.o_custkey = c.c_custkey\nWHERE\n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY\n    s.s_name, n.n_name, r.r_name\nORDER BY\n    total_revenue DESC, total_orders DESC\nLIMIT 10;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "27901.sql", "original_sql": "SELECT \n    p.p_brand,\n    COUNT(DISTINCT s.s_name) AS supplier_count,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_price,\n    MAX(l.l_shipdate) AS last_ship_date,\n    MIN(l.l_shipdate) AS first_ship_date,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' (', s.s_phone, ')'), ', ') AS supplier_info\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey\nWHERE \n    p.p_type LIKE '%metal%' \n    AND s.s_acctbal > 10000\n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_brand\nHAVING \n    COUNT(DISTINCT l.l_orderkey) > 5\nORDER BY \n    avg_price DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    p.p_brand,\n    s.s_name,\n    s.s_phone,\n    l.l_extendedprice * (1 - l.l_discount) AS net_price,\n    l.l_shipdate,\n    l.l_orderkey\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON ps.ps_partkey = l.l_partkey\nWHERE p.p_type LIKE '%metal%'\n  AND s.s_acctbal > 10000\n  AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31';", "sql2": "SELECT\n    s1.p_brand,\n    COUNT(DISTINCT s1.s_name) AS supplier_count,\n    AVG(s1.net_price) AS avg_price,\n    MAX(s1.l_shipdate) AS last_ship_date,\n    MIN(s1.l_shipdate) AS first_ship_date,\n    STRING_AGG(DISTINCT CONCAT(s1.s_name, ' (', s1.s_phone, ')'), ', ') AS supplier_info\nFROM s1\nGROUP BY s1.p_brand\nHAVING COUNT(DISTINCT s1.l_orderkey) > 5\nORDER BY avg_price DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "27902.sql", "original_sql": "SELECT \n    p.p_name,\n    s.s_name,\n    customers.customer_count,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_served\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON o.o_orderkey = l.l_orderkey\nJOIN \n    customer c ON c.c_custkey = o.o_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nCROSS JOIN \n    (SELECT COUNT(DISTINCT c.c_custkey) AS customer_count \n     FROM customer c \n     WHERE c.c_acctbal > 1000) AS customers\nWHERE \n    r.r_name LIKE '%North%'\nGROUP BY \n    p.p_name, s.s_name, customers.customer_count\nORDER BY \n    total_quantity DESC, avg_price DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "27915.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' ', s.s_address) AS supplier_info,\n    LEFT(p.p_name, 10) AS short_part_name,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    rg.r_name AS region_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region rg ON n.n_regionkey = rg.r_regionkey\nWHERE \n    s.s_comment LIKE '%special%' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    supplier_info, short_part_name, rg.r_name\nHAVING \n    COUNT(DISTINCT c.c_custkey) > 5\nORDER BY \n    total_revenue DESC, region_name ASC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS part_key,\n       l.l_suppkey AS supp_key,\n       o.o_custkey AS cust_key,\n       (l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'", "sql2": "SELECT CONCAT(s.s_name, ' ', s.s_address) AS supplier_info,\n       LEFT(p.p_name, 10) AS short_part_name,\n       COUNT(DISTINCT s1.cust_key) AS customer_count,\n       SUM(s1.revenue) AS total_revenue,\n       rg.r_name AS region_name\nFROM s1\nJOIN supplier s ON s1.supp_key = s.s_suppkey\nJOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey AND ps.ps_partkey = s1.part_key\nJOIN part p ON p.p_partkey = ps.ps_partkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region rg ON n.n_regionkey = rg.r_regionkey\nWHERE s.s_comment LIKE '%special%'\nGROUP BY supplier_info, short_part_name, rg.r_name\nHAVING COUNT(DISTINCT s1.cust_key) > 5\nORDER BY total_revenue DESC, region_name ASC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "28159.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    count(DISTINCT p.p_partkey) AS total_parts_supplied,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS supplied_part_names,\n    r.r_name AS region_name\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_retailprice > 100 \n    AND s.s_acctbal > 500\nGROUP BY \n    s.s_name, r.r_name\nHAVING \n    COUNT(DISTINCT p.p_partkey) > 5\nORDER BY \n    total_parts_supplied DESC, supplier_name;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "28165.sql", "original_sql": "SELECT \n    p.p_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(p.p_retailprice) AS average_price,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' (', s.s_address, ')'), '; ') AS supplier_details\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE \n    p.p_name LIKE '%steel%'\n    AND s.s_acctbal > 1000\nGROUP BY \n    p.p_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 2\nORDER BY \n    average_price DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(p.p_retailprice) AS average_price,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' (', s.s_address, ')'), '; ') AS supplier_details\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE p.p_name LIKE '%steel%'\n  AND s.s_acctbal > 1000\nGROUP BY p.p_name", "sql2": "SELECT *\nFROM s1\nWHERE supplier_count > 2\nORDER BY average_price DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "28166.sql", "original_sql": "SELECT \n    p.p_name,\n    COUNT(DISTINCT ps.ps_suppkey) AS supplier_count,\n    STRING_AGG(CONCAT(s.s_name, ' (', s.s_phone, ')'), '; ') AS supplier_details,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    MAX(ps.ps_supplycost) AS max_supply_cost,\n    MIN(ps.ps_supplycost) AS min_supply_cost\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE \n    p.p_mfgr LIKE '%Manufacturer%'\nGROUP BY \n    p.p_name\nHAVING \n    COUNT(DISTINCT ps.ps_suppkey) > 5\nORDER BY \n    total_available_quantity DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "28172.sql", "original_sql": "\nSELECT \n    p.p_name,\n    s.s_name,\n    n.n_name,\n    LEFT(s.s_address, POSITION(',' IN s.s_address) - 1) AS city,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_name LIKE '%steel%'\n    AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31'\n    AND s.s_acctbal > 5000\nGROUP BY \n    p.p_name, s.s_name, n.n_name, LEFT(s.s_address, POSITION(',' IN s.s_address) - 1)\nHAVING \n    COUNT(DISTINCT o.o_orderkey) > 10\nORDER BY \n    total_quantity DESC, avg_price ASC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_partkey, s.s_suppkey, p.p_name, s.s_name, n.n_name, LEFT(s.s_address, POSITION(',' IN s.s_address) - 1) AS city FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE p.p_name LIKE '%steel%' AND s.s_acctbal > 5000", "sql2": "SELECT s1.p_name, s1.s_name, s1.n_name, s1.city, COUNT(DISTINCT o.o_orderkey) AS total_orders, SUM(l.l_quantity) AS total_quantity, AVG(l.l_extendedprice) AS avg_price FROM s1 JOIN lineitem l ON s1.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31' GROUP BY s1.p_name, s1.s_name, s1.n_name, s1.city HAVING COUNT(DISTINCT o.o_orderkey) > 10 ORDER BY total_quantity DESC, avg_price ASC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "28207.sql", "original_sql": "WITH StringBenchmark AS (\n    SELECT \n        p.p_name,\n        CONCAT('Supplier: ', s.s_name, ' | Comment: ', ps.ps_comment) AS supplier_info,\n        REPLACE(REPLACE(LOWER(p.p_comment), ' ', '_'), '!', '') AS sanitized_comment,\n        LENGTH(p.p_name) AS name_length,\n        SUBSTRING(s.s_address, 1, 20) AS short_address,\n        TRIM(BOTH ' ' FROM s.s_phone) AS formatted_phone,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM \n        part p \n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey \n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey \n    LEFT JOIN \n        lineitem l ON l.l_partkey = p.p_partkey \n    LEFT JOIN \n        orders o ON o.o_orderkey = l.l_orderkey \n    GROUP BY \n        p.p_name, s.s_name, ps.ps_comment, p.p_comment, s.s_address, s.s_phone\n)\n\nSELECT \n    p_name, \n    supplier_info, \n    sanitized_comment, \n    name_length, \n    short_address, \n    formatted_phone, \n    order_count \nFROM \n    StringBenchmark \nWHERE \n    order_count > 0 \nORDER BY \n    name_length DESC, \n    order_count DESC \nLIMIT 10;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "28367.sql", "original_sql": "\nSELECT \n    p.p_brand,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    AVG(ps.ps_supplycost) AS avg_supply_cost,\n    MIN(l.l_shipdate) AS first_ship_date,\n    MAX(l.l_shipdate) AS last_ship_date,\n    STRING_AGG(DISTINCT TRIM(p.p_name), ', ') AS part_names,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_size > 20 \n    AND l.l_shipmode IN ('AIR', 'RAIL')\n    AND c.c_mktsegment = 'BUILDING'\nGROUP BY \n    p.p_brand\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_brand AS brand,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    AVG(ps.ps_supplycost) AS avg_supply_cost,\n    MIN(l.l_shipdate) AS first_ship_date,\n    MAX(l.l_shipdate) AS last_ship_date,\n    STRING_AGG(DISTINCT TRIM(p.p_name), ', ') AS part_names,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON l.l_partkey = p.p_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE p.p_size > 20\n  AND l.l_shipmode IN ('AIR', 'RAIL')\n  AND c.c_mktsegment = 'BUILDING'\nGROUP BY p.p_brand;", "sql2": "SELECT *\nFROM s1\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "28416.sql", "original_sql": "\nSELECT \n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(p.p_retailprice) AS average_part_price,\n    SUBSTRING(p.p_name, 1, 20) AS short_part_name,\n    LEFT(s.s_name, 10) AS supplier_prefix,\n    r.r_name AS region_name,\n    n.n_name AS nation_name,\n    LENGTH(p.p_comment) AS comment_length\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name LIKE '%EUROPE%'\n    AND l.l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31'\nGROUP BY \n    r.r_name, n.n_name, SUBSTRING(p.p_name, 1, 20), LEFT(s.s_name, 10), LENGTH(p.p_comment)\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    r.r_name AS region_name,\n    n.n_name AS nation_name,\n    SUBSTRING(p.p_name, 1, 20) AS short_part_name,\n    LEFT(s.s_name, 10) AS supplier_prefix,\n    LENGTH(p.p_comment) AS comment_length,\n    l.l_extendedprice,\n    l.l_discount,\n    p.p_retailprice,\n    c.c_custkey\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name LIKE '%EUROPE%'\n    AND l.l_shipdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31';", "sql2": "SELECT \n    COUNT(DISTINCT c_custkey) AS unique_customers,\n    SUM(l_extendedprice * (1 - l_discount)) AS total_revenue,\n    AVG(p_retailprice) AS average_part_price,\n    region_name,\n    nation_name,\n    short_part_name,\n    supplier_prefix,\n    comment_length\nFROM \n    s1\nGROUP BY \n    region_name, nation_name, short_part_name, supplier_prefix, comment_length\nORDER BY \n    total_revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "28428.sql", "original_sql": "SELECT \n    p.p_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(CASE WHEN l_discount > 0.1 THEN l_extendedprice * (1 - l_discount) ELSE l_extendedprice END) AS total_discounted_sales,\n    AVG(l_quantity) AS avg_quantity_per_line,\n    MAX(l_shipdate) AS latest_shipdate,\n    MIN(l_shipdate) AS earliest_shipdate,\n    STRING_AGG(DISTINCT CONCAT('Supplier ', s.s_name, ' in ', n.n_name), ', ') AS supplier_details\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nWHERE \n    p.p_retailprice > 100.00\nGROUP BY \n    p.p_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 5\nORDER BY \n    total_discounted_sales DESC\nLIMIT 10;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "28561.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    CONCAT('Supplier ', s.s_name, ' supplies ', p.p_name, ' with a price of ', CAST(ps.ps_supplycost AS VARCHAR), ' per unit.') AS description,\n    r.r_name AS region_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(CASE WHEN l.l_discount > 0 THEN (l.l_extendedprice * (1 - l.l_discount)) ELSE l.l_extendedprice END) AS avg_price_after_discount\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey\nJOIN \n    orders o ON o.o_orderkey = l.l_orderkey\nJOIN \n    customer c ON c.c_custkey = o.o_custkey\nJOIN \n    nation n ON n.n_nationkey = c.c_nationkey\nJOIN \n    region r ON r.r_regionkey = n.n_regionkey\nWHERE \n    r.r_name LIKE 'Europ%'\nGROUP BY \n    s.s_name, p.p_name, r.r_name, ps.ps_supplycost\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s.s_suppkey,\n       p.p_partkey,\n       r.r_name,\n       ps.ps_supplycost,\n       COUNT(DISTINCT o.o_orderkey) AS total_orders,\n       SUM(l.l_quantity) AS total_quantity,\n       SUM(l.l_extendedprice) AS total_revenue,\n       AVG(CASE WHEN l.l_discount > 0 THEN (l.l_extendedprice * (1 - l.l_discount)) ELSE l.l_extendedprice END) AS avg_price_after_discount\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON l.l_partkey = p.p_partkey\nJOIN orders o ON o.o_orderkey = l.l_orderkey\nJOIN customer c ON c.c_custkey = o.o_custkey\nJOIN nation n ON n.n_nationkey = c.c_nationkey\nJOIN region r ON r.r_regionkey = n.n_regionkey\nWHERE r.r_name LIKE 'Europ%'\nGROUP BY s.s_suppkey, p.p_partkey, r.r_name, ps.ps_supplycost;", "sql2": "SELECT s.s_name AS supplier_name,\n       p.p_name AS part_name,\n       CONCAT('Supplier ', s.s_name, ' supplies ', p.p_name, ' with a price of ', CAST(s1.ps_supplycost AS VARCHAR), ' per unit.') AS description,\n       s1.r_name AS region_name,\n       s1.total_orders,\n       s1.total_quantity,\n       s1.total_revenue,\n       s1.avg_price_after_discount\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.s_suppkey\nJOIN part p ON p.p_partkey = s1.p_partkey\nORDER BY s1.total_revenue DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28603.sql", "original_sql": "SELECT \n    p.p_name,\n    s.s_name,\n    c.c_name,\n    n.n_name,\n    r.r_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(p.p_retailprice) AS avg_retail_price,\n    STRING_AGG(DISTINCT l.l_comment, '; ') AS comments_aggregated\nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nJOIN \n    customer c ON o.o_custkey = c.c_custkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nWHERE \n    l.l_shipdate BETWEEN DATE '1996-01-01' AND DATE '1997-12-31' \n    AND p.p_comment LIKE '%special%'\nGROUP BY \n    p.p_name, s.s_name, c.c_name, n.n_name, r.r_name \nORDER BY \n    total_revenue DESC, total_orders DESC;", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "28614.sql", "original_sql": "\nSELECT \n    s.s_name AS supplier_name, \n    p.p_name AS part_name, \n    SUM(ps.ps_availqty) AS total_available_quantity, \n    COUNT(DISTINCT o.o_orderkey) AS total_orders, \n    STRING_AGG(DISTINCT c.c_name, ', ') AS customer_names, \n    p.p_retailprice * SUM(ps.ps_availqty) AS total_retail_value\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_name LIKE 'widget%'\n    AND o.o_orderstatus = 'O'\n    AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY \n    s.s_name, p.p_name, p.p_retailprice\nORDER BY \n    total_retail_value DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    l.l_suppkey AS suppkey,\n    l.l_partkey AS partkey,\n    o.o_orderkey,\n    c.c_name AS customer_name\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN part p ON l.l_partkey = p.p_partkey\nWHERE \n    p.p_name LIKE 'widget%'\n    AND o.o_orderstatus = 'O'\n    AND l.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31';", "sql2": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    COUNT(DISTINCT s1.o_orderkey) AS total_orders,\n    STRING_AGG(DISTINCT s1.customer_name, ', ') AS customer_names,\n    p.p_retailprice * SUM(ps.ps_availqty) AS total_retail_value\nFROM s1\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nJOIN partsupp ps ON ps.ps_suppkey = s1.suppkey AND ps.ps_partkey = s1.partkey\nJOIN part p ON p.p_partkey = s1.partkey\nGROUP BY s.s_name, p.p_name, p.p_retailprice\nORDER BY total_retail_value DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28628.sql", "original_sql": "\nSELECT \n    p.p_name, \n    s.s_name, \n    CONCAT('Supplier: ', s.s_name, ' provides ', p.p_name, ' in ', p.p_container) AS supply_info,\n    COUNT(l.l_orderkey) AS total_orders,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    STRING_AGG(DISTINCT c.c_mktsegment, '; ') AS market_segments\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    s.s_nationkey IN (SELECT n.n_nationkey FROM nation n WHERE n.n_name LIKE '%Germany%')\nGROUP BY \n    p.p_name, s.s_name, p.p_container, p.p_partkey, s.s_suppkey\nORDER BY \n    total_quantity DESC, avg_price;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    p.p_partkey,\n    p.p_name,\n    p.p_container,\n    s.s_suppkey,\n    s.s_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE s.s_nationkey IN (SELECT n.n_nationkey FROM nation n WHERE n.n_name LIKE '%Germany%');", "sql2": "SELECT \n    s1.p_name,\n    s1.s_name,\n    CONCAT('Supplier: ', s1.s_name, ' provides ', s1.p_name, ' in ', s1.p_container) AS supply_info,\n    COUNT(l.l_orderkey) AS total_orders,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    STRING_AGG(DISTINCT c.c_mktsegment, '; ') AS market_segments\nFROM s1\nJOIN lineitem l ON s1.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nGROUP BY s1.p_name, s1.s_name, s1.p_container, s1.p_partkey, s1.s_suppkey\nORDER BY total_quantity DESC, avg_price;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28776.sql", "original_sql": "SELECT \n    p.p_name AS Part_Name, \n    s.s_name AS Supplier_Name, \n    c.c_name AS Customer_Name, \n    COUNT(DISTINCT o.o_orderkey) AS Total_Orders,\n    SUM(l.l_quantity) AS Total_Quantity,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS Total_Revenue,\n    AVG(l.l_tax) AS Average_Tax,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS Regions_Supplied\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_size > 10 AND \n    o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, c.c_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 10000\nORDER BY \n    Total_Revenue DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name,\n       s.s_name,\n       c.c_name,\n       r.r_name,\n       o.o_orderkey,\n       l.l_quantity,\n       l.l_extendedprice,\n       l.l_discount,\n       l.l_tax\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_size > 10\n  AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31';", "sql2": "SELECT p_name AS Part_Name,\n       s_name AS Supplier_Name,\n       c_name AS Customer_Name,\n       COUNT(DISTINCT o_orderkey) AS Total_Orders,\n       SUM(l_quantity) AS Total_Quantity,\n       SUM(l_extendedprice * (1 - l_discount)) AS Total_Revenue,\n       AVG(l_tax) AS Average_Tax,\n       STRING_AGG(DISTINCT r_name, ', ') AS Regions_Supplied\nFROM s1\nGROUP BY p_name, s_name, c_name\nHAVING SUM(l_extendedprice * (1 - l_discount)) > 10000\nORDER BY Total_Revenue DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28788.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied,\n    SUM(ps.ps_availqty) AS total_quantity_available,\n    AVG(p.p_retailprice) AS average_part_price,\n    SUM(CASE \n        WHEN l.l_returnflag = 'R' THEN l.l_quantity \n        ELSE 0 \n    END) AS total_returned_quantity,\n    STRING_AGG(DISTINCT n.n_name, ', ') AS nations_supplied,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_served\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey\nWHERE \n    r.r_name LIKE 'Asia%' \n    AND s.s_comment NOT LIKE '%promotional%'\nGROUP BY \n    s.s_name\nORDER BY \n    total_parts_supplied DESC, total_quantity_available DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_suppkey AS s_suppkey,\n    ps.ps_partkey AS ps_partkey,\n    SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_qty\nFROM \n    lineitem l\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nGROUP BY \n    ps.ps_suppkey,\n    ps.ps_partkey;", "sql2": "SELECT \n    s.s_name AS supplier_name,\n    COUNT(DISTINCT ps.ps_partkey) AS total_parts_supplied,\n    SUM(ps.ps_availqty) AS total_quantity_available,\n    AVG(p.p_retailprice) AS average_part_price,\n    COALESCE(SUM(s1.returned_qty), 0) AS total_returned_quantity,\n    STRING_AGG(DISTINCT n.n_name, ', ') AS nations_supplied,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_served\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN \n    s1 ON ps.ps_suppkey = s1.s_suppkey AND ps.ps_partkey = s1.ps_partkey\nWHERE \n    r.r_name LIKE 'Asia%' \n    AND s.s_comment NOT LIKE '%promotional%'\nGROUP BY \n    s.s_name\nORDER BY \n    total_parts_supplied DESC, total_quantity_available DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28824.sql", "original_sql": "\nWITH StringProcessing AS (\n    SELECT \n        p.p_partkey,\n        CONCAT('Part Name: ', p.p_name, ', Brand: ', p.p_brand, ', Type: ', p.p_type, ', Size: ', p.p_size) AS part_info,\n        REPLACE(UPPER(p.p_comment), ' ', '-') AS processed_comment,\n        s.s_name AS supplier_name,\n        SUBSTR(s.s_address, 1, 20) AS short_address,\n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        ps.ps_supplycost\n    FROM part p\n    JOIN partsupp ps ON p.p_partkey = ps.ps_partkey\n    JOIN supplier s ON ps.ps_suppkey = s.s_suppkey\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n    WHERE p.p_size > 10\n),\nAggregatedResults AS (\n    SELECT \n        part_info,\n        COUNT(*) AS supplier_count,\n        STRING_AGG(DISTINCT nation_name, ', ') AS nations_supplied,\n        STRING_AGG(DISTINCT supplier_name, ', ') AS unique_suppliers,\n        AVG(ps_supplycost) AS avg_supply_cost\n    FROM StringProcessing\n    GROUP BY part_info\n)\nSELECT \n    part_info,\n    supplier_count,\n    nations_supplied,\n    unique_suppliers,\n    avg_supply_cost\nFROM AggregatedResults\nORDER BY supplier_count DESC, avg_supply_cost ASC\nLIMIT 10;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "28825.sql", "original_sql": "SELECT \n    s.s_name,\n    s.s_address,\n    SUBSTRING(s.s_comment, 1, 25) AS comment_excerpt,\n    CONCAT('Supplier: ', s.s_name, ', Address: ', s.s_address) AS supplier_info,\n    COUNT(DISTINCT ps.ps_partkey) AS part_count,\n    SUM(ps.ps_availqty) AS total_availability,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    REGEXP_REPLACE(s.s_comment, '[^a-zA-Z0-9 ]', '') AS sanitized_comment,\n    CASE \n        WHEN AVG(ps.ps_supplycost) > 100 THEN 'Expensive'\n        ELSE 'Affordable'\n    END AS cost_category\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nWHERE \n    s.s_comment LIKE '%high quality%'\nGROUP BY \n    s.s_name, s.s_address, s.s_comment\nORDER BY \n    total_availability DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    s.s_suppkey,\n    s.s_name,\n    s.s_address,\n    s.s_comment,\n    COUNT(DISTINCT ps.ps_partkey) AS part_count,\n    SUM(ps.ps_availqty) AS total_availability,\n    AVG(ps.ps_supplycost) AS average_supply_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE s.s_comment LIKE '%high quality%'\nGROUP BY s.s_suppkey, s.s_name, s.s_address, s.s_comment;", "sql2": "SELECT \n    s1.s_name,\n    s1.s_address,\n    SUBSTRING(s1.s_comment, 1, 25) AS comment_excerpt,\n    CONCAT('Supplier: ', s1.s_name, ', Address: ', s1.s_address) AS supplier_info,\n    s1.part_count,\n    s1.total_availability,\n    s1.average_supply_cost,\n    REGEXP_REPLACE(s1.s_comment, '[^a-zA-Z0-9 ]', '') AS sanitized_comment,\n    CASE \n        WHEN s1.average_supply_cost > 100 THEN 'Expensive'\n        ELSE 'Affordable'\n    END AS cost_category\nFROM s1\nORDER BY s1.total_availability DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "28830.sql", "original_sql": "SELECT \n    p.p_name, \n    CONCAT(s.s_name, ' ', s.s_address, ', ', r.r_name) AS supplier_info,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_order_value,\n    STRING_AGG(DISTINCT l.l_shipmode, ', ') AS ship_modes\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_brand LIKE 'Brand%'\n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, supplier_info\nORDER BY \n    order_count DESC, avg_order_value DESC, p.p_name;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "28831.sql", "original_sql": "\nSELECT \n    p.p_name, \n    s.s_name, \n    CONCAT('Region: ', r.r_name, ', Nation: ', n.n_name, ', Supplier: ', s.s_name) AS supplier_info,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p \nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey \nJOIN \n    region r ON n.n_regionkey = r.r_regionkey \nJOIN \n    lineitem l ON l.l_partkey = p.p_partkey \nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nWHERE \n    p.p_name LIKE 'prod_%' \n    AND s.s_comment NOT LIKE '%fraud%' \n    AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, r.r_name, n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name AS p_name,\n       s.s_name AS s_name,\n       r.r_name AS r_name,\n       n.n_name AS n_name,\n       (l.l_extendedprice * (1 - l.l_discount)) AS revenue\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nJOIN lineitem l ON l.l_partkey = p.p_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE p.p_name LIKE 'prod_%'\n  AND s.s_comment NOT LIKE '%fraud%'\n  AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'", "sql2": "SELECT p_name,\n       s_name,\n       CONCAT('Region: ', r_name, ', Nation: ', n_name, ', Supplier: ', s_name) AS supplier_info,\n       SUM(revenue) AS total_revenue\nFROM s1\nGROUP BY p_name, s_name, r_name, n_name\nHAVING SUM(revenue) > 1000\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29078.sql", "original_sql": "\nWITH PartStats AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_retailprice,\n        LENGTH(p.p_comment) AS comment_length,\n        SUM(ps.ps_availqty) AS total_available_qty,\n        COUNT(DISTINCT ps.ps_suppkey) AS supplier_count\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    GROUP BY \n        p.p_partkey, p.p_name, p.p_retailprice, LENGTH(p.p_comment)\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        SUM(o.o_totalprice) AS total_order_value,\n        COUNT(o.o_orderkey) AS order_count\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n),\nFinalBenchmark AS (\n    SELECT \n        ps.p_partkey,\n        ps.p_name,\n        ps.p_retailprice,\n        ps.comment_length,\n        ps.total_available_qty,\n        ps.supplier_count,\n        co.c_custkey,\n        co.c_name,\n        co.total_order_value,\n        co.order_count,\n        CONCAT('Part: ', ps.p_name, ' | Customer: ', co.c_name) AS combined_info\n    FROM \n        PartStats ps\n    JOIN \n        CustomerOrders co ON ps.supplier_count > 0\n    ORDER BY \n        ps.total_available_qty DESC, co.total_order_value DESC\n)\nSELECT \n    *\nFROM \n    FinalBenchmark\nWHERE \n    LENGTH(combined_info) > 50\nFETCH FIRST 100 ROWS ONLY;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "29079.sql", "original_sql": "WITH StringBench AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        s.s_name AS supplier_name,\n        CONCAT(p.p_name, ' - ', s.s_name) AS combined_string,\n        LENGTH(CONCAT(p.p_name, ' - ', s.s_name)) AS string_length,\n        SUBSTRING(p.p_comment, 1, 10) AS comment_snippet,\n        REGEXP_REPLACE(p.p_comment, '[^a-zA-Z0-9]', '') AS cleaned_comment\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey\n    WHERE \n        p.p_size BETWEEN 10 AND 20\n),\nStringAggregates AS (\n    SELECT \n        AVG(string_length) AS avg_string_length,\n        MAX(string_length) AS max_string_length,\n        COUNT(*) AS total_entries,\n        COUNT(DISTINCT cleaned_comment) AS unique_comments\n    FROM \n        StringBench\n)\nSELECT \n    sb.p_partkey,\n    sb.p_name,\n    sb.supplier_name,\n    sb.combined_string,\n    sb.string_length,\n    sb.comment_snippet,\n    sa.avg_string_length,\n    sa.max_string_length,\n    sa.total_entries,\n    sa.unique_comments\nFROM \n    StringBench sb\nCROSS JOIN \n    StringAggregates sa\nORDER BY \n    sb.string_length DESC \nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "29087.sql", "original_sql": "WITH SupplierPartDetails AS (\n    SELECT \n        s.s_name AS supplier_name,\n        p.p_name AS part_name,\n        SUBSTRING(p.p_comment FROM 1 FOR 20) AS short_comment,\n        CONCAT('Region: ', r.r_name, ', Nation: ', n.n_name) AS location_info,\n        SUM(ps.ps_availqty) AS total_available_qty\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    GROUP BY \n        s.s_name, p.p_name, p.p_comment, r.r_name, n.n_name\n)\nSELECT \n    supplier_name, \n    part_name, \n    short_comment, \n    location_info,\n    total_available_qty\nFROM \n    SupplierPartDetails\nWHERE \n    total_available_qty > 50\nORDER BY \n    location_info, part_name;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    SUBSTRING(p.p_comment FROM 1 FOR 20) AS short_comment,\n    CONCAT('Region: ', r.r_name, ', Nation: ', n.n_name) AS location_info,\n    SUM(ps.ps_availqty) AS total_available_qty\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nGROUP BY s.s_name, p.p_name, p.p_comment, r.r_name, n.n_name;", "sql2": "SELECT \n    supplier_name,\n    part_name,\n    short_comment,\n    location_info,\n    total_available_qty\nFROM s1\nWHERE total_available_qty > 50\nORDER BY location_info, part_name;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29118.sql", "original_sql": "\nSELECT \n    p.p_name, \n    SUM(l.l_quantity) AS total_quantity, \n    AVG(l.l_extendedprice) AS avg_price, \n    CONCAT('Total Quantity: ', CAST(SUM(l.l_quantity) AS CHAR), \n           ', Avg Price: ', CAST(AVG(l.l_extendedprice) AS DECIMAL(10, 2))) AS summary,\n    r.r_name AS region_name,\n    n.n_name AS nation_name,\n    s.s_name AS supplier_name,\n    c.c_name AS customer_name\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    customer c ON c.c_custkey = l.l_orderkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_name LIKE '%widget%'\n    AND l.l_shipdate BETWEEN '1996-01-01' AND '1996-12-31'\nGROUP BY \n    p.p_name, r.r_name, n.n_name, s.s_name, c.c_name\nORDER BY \n    total_quantity DESC, avg_price ASC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "29125.sql", "original_sql": "WITH SupplierInfo AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        n.n_name AS nation,\n        COUNT(DISTINCT p.p_partkey) AS total_parts,\n        SUM(ps.ps_supplycost) AS total_supplycost\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY \n        s.s_suppkey, s.s_name, n.n_name\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COUNT(DISTINCT o.o_orderkey) AS total_orders,\n        SUM(o.o_totalprice) AS total_spent\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n)\nSELECT \n    si.s_name AS supplier_name,\n    si.nation AS supplier_nation,\n    si.total_parts AS parts_supplied,\n    si.total_supplycost AS total_supply_cost,\n    co.c_name AS customer_name,\n    co.total_orders AS total_orders_placed,\n    co.total_spent AS total_spent_by_customer\nFROM \n    SupplierInfo si\nJOIN \n    CustomerOrders co ON si.total_parts = (SELECT MAX(total_parts) FROM SupplierInfo)\nWHERE \n    si.total_supplycost > 10000\nORDER BY \n    co.total_spent DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH SupplierInfo AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        n.n_name AS nation,\n        COUNT(DISTINCT p.p_partkey) AS total_parts,\n        SUM(ps.ps_supplycost) AS total_supplycost\n    FROM supplier s\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY s.s_suppkey, s.s_name, n.n_name\n)\nSELECT \n    s_name,\n    nation,\n    total_parts,\n    total_supplycost\nFROM SupplierInfo\nWHERE total_parts = (SELECT MAX(total_parts) FROM SupplierInfo)\n  AND total_supplycost > 10000;", "sql2": "WITH CustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COUNT(DISTINCT o.o_orderkey) AS total_orders,\n        SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT \n    si.s_name AS supplier_name,\n    si.nation AS supplier_nation,\n    si.total_parts AS parts_supplied,\n    si.total_supplycost AS total_supply_cost,\n    co.c_name AS customer_name,\n    co.total_orders AS total_orders_placed,\n    co.total_spent AS total_spent_by_customer\nFROM s1 si\nCROSS JOIN CustomerOrders co\nORDER BY co.total_spent DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "29247.sql", "original_sql": "WITH SupplierDetails AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_address,\n        s.s_phone,\n        COALESCE(NULLIF(LOWER(s.s_comment), ''), 'No Comment') AS adjusted_comment\n    FROM \n        supplier s\n),\nPartDetails AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_brand,\n        p.p_retailprice,\n        LENGTH(REPLACE(LOWER(p.p_comment), ' ', '')) AS non_space_comment_length\n    FROM \n        part p\n),\nOrderSummaries AS (\n    SELECT \n        o.o_orderkey,\n        o.o_totalprice,\n        COUNT(li.l_orderkey) AS total_lineitems,\n        SUM(li.l_quantity) AS total_quantity,\n        SUM(li.l_extendedprice) AS total_extended_price\n    FROM \n        orders o\n    JOIN \n        lineitem li ON o.o_orderkey = li.l_orderkey\n    GROUP BY \n        o.o_orderkey, o.o_totalprice\n)\nSELECT \n    sd.s_name AS supplier_name,\n    pd.p_name AS part_name,\n    os.total_lineitems,\n    os.total_quantity,\n    os.total_extended_price,\n    pd.non_space_comment_length,\n    sd.adjusted_comment\nFROM \n    SupplierDetails sd\nJOIN \n    partsupp ps ON sd.s_suppkey = ps.ps_suppkey\nJOIN \n    PartDetails pd ON ps.ps_partkey = pd.p_partkey\nJOIN \n    OrderSummaries os ON os.o_orderkey = ps.ps_partkey  \nWHERE \n    pd.p_retailprice > 100.00\nORDER BY \n    os.total_extended_price DESC\nLIMIT 100;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_orderkey,\n       o.o_totalprice,\n       COUNT(li.l_orderkey) AS total_lineitems,\n       SUM(li.l_quantity) AS total_quantity,\n       SUM(li.l_extendedprice) AS total_extended_price\nFROM   orders o\nJOIN   lineitem li ON o.o_orderkey = li.l_orderkey\nGROUP BY o.o_orderkey, o.o_totalprice", "sql2": "WITH SupplierDetails AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           s.s_address,\n           s.s_phone,\n           COALESCE(NULLIF(LOWER(s.s_comment), ''), 'No Comment') AS adjusted_comment\n    FROM   supplier s\n),\nPartDetails AS (\n    SELECT p.p_partkey,\n           p.p_name,\n           p.p_brand,\n           p.p_retailprice,\n           LENGTH(REPLACE(LOWER(p.p_comment), ' ', '')) AS non_space_comment_length\n    FROM   part p\n)\nSELECT sd.s_name AS supplier_name,\n       pd.p_name AS part_name,\n       os.total_lineitems,\n       os.total_quantity,\n       os.total_extended_price,\n       pd.non_space_comment_length,\n       sd.adjusted_comment\nFROM   SupplierDetails sd\nJOIN   partsupp ps ON sd.s_suppkey = ps.ps_suppkey\nJOIN   PartDetails pd ON ps.ps_partkey = pd.p_partkey\nJOIN   s1 os ON os.o_orderkey = ps.ps_partkey\nWHERE  pd.p_retailprice > 100.00\nORDER BY os.total_extended_price DESC\nLIMIT 100;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29250.sql", "original_sql": "\nSELECT \n    p.p_name, \n    s.s_name AS supplier_name, \n    c.c_name AS customer_name, \n    o.o_orderdate, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    LEFT(p.p_comment, 10) AS short_comment,\n    CONCAT('Supplier ', s.s_name, ' provides ', p.p_name) AS supplier_info\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_type LIKE '%BRASS%'\n    AND o.o_orderdate >= DATE '1997-01-01'\n    AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, c.c_name, o.o_orderdate, p.p_comment\nORDER BY \n    total_revenue DESC, o.o_orderdate DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    s.s_name AS supplier_name,\n    c.c_name AS customer_name,\n    o.o_orderdate AS o_orderdate,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    LEFT(p.p_comment, 10) AS short_comment,\n    CONCAT('Supplier ', s.s_name, ' provides ', p.p_name) AS supplier_info\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE p.p_type LIKE '%BRASS%'\n  AND o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY p.p_name, s.s_name, c.c_name, o.o_orderdate, p.p_comment;", "sql2": "SELECT \n    p_name,\n    supplier_name,\n    customer_name,\n    o_orderdate,\n    total_revenue,\n    total_orders,\n    short_comment,\n    supplier_info\nFROM s1\nORDER BY total_revenue DESC, o_orderdate DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29253.sql", "original_sql": "\nSELECT \n    CONCAT(s.s_name, ' (', SUBSTRING(s.s_address, 1, 20), '...)') AS supplier_info,\n    p.p_name AS part_name,\n    ps.ps_availqty AS available_quantity,\n    REPLACE(p.p_comment, 'old', 'new') AS modified_comment,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    CASE \n        WHEN SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000 THEN 'High'\n        WHEN SUM(l.l_extendedprice * (1 - l.l_discount)) BETWEEN 500 AND 1000 THEN 'Medium'\n        ELSE 'Low' \n    END AS revenue_category\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    s.s_comment LIKE '%urgent%'\n    AND p.p_size BETWEEN 10 AND 20\nGROUP BY \n    s.s_name, s.s_address, p.p_name, ps.ps_availqty, p.p_comment\nORDER BY \n    total_revenue DESC, supplier_info\nLIMIT 100;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "29287.sql", "original_sql": "WITH PartDetails AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        p.p_mfgr,\n        p.p_retailprice,\n        p.p_comment,\n        ps.ps_supplycost,\n        CONCAT(p.p_name, ' ', p.p_mfgr, ' - Price: ', CAST(p.p_retailprice AS VARCHAR), ' | Comment: ', p.p_comment) AS detailed_info\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    WHERE \n        p.p_size BETWEEN 10 AND 20\n),\nSupplierDetails AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_address,\n        s.s_phone,\n        CONCAT(s.s_name, ' - Address: ', s.s_address, ' | Phone: ', s.s_phone) AS supplier_info\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    WHERE \n        n.n_name LIKE 'United%'\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_acctbal,\n        SUM(o.o_totalprice) AS total_spent,\n        COUNT(o.o_orderkey) AS order_count,\n        CONCAT(c.c_name, ' - Total Spent: ', CAST(SUM(o.o_totalprice) AS VARCHAR), ' | Orders: ', COUNT(o.o_orderkey)) AS customer_summary\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    WHERE \n        c.c_acctbal > 1000\n    GROUP BY \n        c.c_custkey, c.c_name, c.c_acctbal\n)\nSELECT \n    pd.p_partkey,\n    pd.detailed_info,\n    sd.supplier_info,\n    co.customer_summary\nFROM \n    PartDetails pd\nJOIN \n    SupplierDetails sd ON pd.p_partkey % 10 = sd.s_suppkey % 10\nJOIN \n    CustomerOrders co ON pd.p_partkey % 10 = co.c_custkey % 10\nWHERE \n    pd.ps_supplycost < 500\nORDER BY \n    pd.p_partkey, sd.s_suppkey, co.c_custkey;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 's_supplier_info' not found in 'sd'\", span: None, notes: [DiagnosticNote { message: \"possible column sd.supplier_info\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"sd\" }), name: \"s_supplier_info\" }, valid_fields: [Column { relation: Some(Bare { table: \"pd\" }), name: \"p_partkey\" }, Column { relation: Some(Bare { table: \"pd\" }), name: \"detailed_info\" }, Column { relation: Some(Bare { table: \"pd\" }), name: \"ps_supplycost\" }, Column { relation: Some(Bare { table: \"pd\" }), name: \"mod_key\" }, Column { relation: Some(Bare { table: \"sd\" }), name: \"s_suppkey\" }, Column { relation: Some(Bare { table: \"sd\" }), name: \"supplier_info\" }, Column { relation: Some(Bare { table: \"sd\" }), name: \"mod_key\" }, Column { relation: Some(Bare { table: \"s1\" }), name: \"c_custkey\" }, Column { relation: Some(Bare { table: \"s1\" }), name: \"customer_summary\" }, Column { relation: Some(Bare { table: \"s1\" }), name: \"mod_key\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "29290.sql", "original_sql": "WITH RECURSIVE string_benchmark AS (\n    SELECT \n        p.p_partkey,\n        p.p_name, \n        p.p_comment,\n        LENGTH(p.p_name) AS name_length,\n        LENGTH(p.p_comment) AS comment_length,\n        'Part Name: ' || p.p_name || ' | Comment: ' || p.p_comment AS concatenated_string\n    FROM \n        part p\n    WHERE \n        p.p_size > 0\n\n    UNION ALL\n\n    SELECT \n        ps.ps_partkey,\n        s.s_name AS p_name,\n        s.s_comment AS p_comment,\n        LENGTH(s.s_name) AS name_length,\n        LENGTH(s.s_comment) AS comment_length,\n        'Supplier Name: ' || s.s_name || ' | Comment: ' || s.s_comment AS concatenated_string\n    FROM \n        partsupp ps\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey \n    WHERE \n        ps.ps_availqty > 0\n)\n\nSELECT \n    p.p_partkey,\n    AVG(name_length) AS avg_name_length,\n    AVG(comment_length) AS avg_comment_length,\n    COUNT(*) AS total_records,\n    STRING_AGG(concatenated_string, '; ') AS aggregated_strings\nFROM \n    string_benchmark p\nGROUP BY \n    p.p_partkey\nORDER BY \n    total_records DESC\nLIMIT 10;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "29440.sql", "original_sql": "SELECT \n    SUBSTRING(p_name, 1, 10) AS short_name,\n    COUNT(DISTINCT s_nationkey) AS nation_count,\n    AVG(ps_supplycost) AS avg_supply_cost,\n    STRING_AGG(DISTINCT c_mktsegment, ', ') AS market_segments,\n    MAX(o_totalprice) AS max_order_price\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    customer c ON c.c_nationkey = s.s_nationkey\nJOIN \n    orders o ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_name LIKE 'Z%' \n    AND o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31'\nGROUP BY \n    short_name\nHAVING \n    COUNT(DISTINCT s_nationkey) > 1\nORDER BY \n    avg_supply_cost DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT SUBSTRING(p.p_name, 1, 10) AS short_name,\n       s.s_nationkey,\n       ps.ps_supplycost,\n       c.c_mktsegment,\n       o.o_totalprice\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN customer c ON c.c_nationkey = s.s_nationkey\nJOIN orders o ON o.o_custkey = c.c_custkey\nWHERE p.p_name LIKE 'Z%'\n  AND o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31';", "sql2": "SELECT short_name,\n       COUNT(DISTINCT s_nationkey) AS nation_count,\n       AVG(ps_supplycost) AS avg_supply_cost,\n       STRING_AGG(DISTINCT c_mktsegment, ', ') AS market_segments,\n       MAX(o_totalprice) AS max_order_price\nFROM s1\nGROUP BY short_name\nHAVING COUNT(DISTINCT s_nationkey) > 1\nORDER BY avg_supply_cost DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29497.sql", "original_sql": "WITH Supplier_Products AS (\n    SELECT \n        s.s_name AS supplier_name,\n        p.p_name AS product_name,\n        p.p_brand AS product_brand,\n        p.p_container AS product_container,\n        ps.ps_availqty AS available_quantity,\n        ps.ps_supplycost AS supply_cost,\n        p.p_comment AS product_comment\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n),\nAggregated_Supplier_Products AS (\n    SELECT \n        supplier_name,\n        COUNT(*) AS total_products,\n        SUM(available_quantity) AS total_available_quantity,\n        AVG(supply_cost) AS average_supply_cost,\n        STRING_AGG(DISTINCT product_brand, ', ') AS brands_offered,\n        STRING_AGG(DISTINCT product_container, ', ') AS container_types\n    FROM \n        Supplier_Products\n    GROUP BY \n        supplier_name\n)\nSELECT \n    supplier_name,\n    total_products,\n    total_available_quantity,\n    average_supply_cost,\n    brands_offered,\n    container_types,\n    CONCAT('Supplier: ', supplier_name, ' offers ', total_products, ' products, with an average supply cost of $', ROUND(average_supply_cost, 2), '.') AS supplier_summary\nFROM \n    Aggregated_Supplier_Products\nWHERE \n    total_available_quantity > 0\nORDER BY \n    total_products DESC;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 231, in run\n    self._register_downstream_aliases(nid, tbl, id_to_node, adj)\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 169, in _register_downstream_aliases\n    self._register_input_duckdb(alias, tbl)\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 81, in _register_input_duckdb\n    self.con.register(name, obj)\nduckdb.duckdb.InvalidInputException: Invalid Input Error: Provided table/dataframe must have at least one column\n", "engine_mem_mb": 500000}
{"query_id": "29536.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    SUM(CASE WHEN p.p_size > 10 THEN ps.ps_availqty ELSE 0 END) AS large_part_avail_qty,\n    AVG(p.p_retailprice) AS avg_retail_price,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS part_names,\n    MAX(o.o_totalprice) AS max_order_total_price\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN \n    lineitem l ON ps.ps_partkey = l.l_partkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    n.n_name LIKE 'N%'\nGROUP BY \n    n.n_name\nHAVING \n    COUNT(DISTINCT s.s_suppkey) > 5\nORDER BY \n    nation_name;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH base AS (\n    SELECT\n        n.n_name AS nation_name,\n        s.s_suppkey,\n        p.p_size,\n        ps.ps_availqty,\n        p.p_retailprice,\n        p.p_name\n    FROM supplier s\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    WHERE n.n_name LIKE 'N%'\n)\nSELECT\n    nation_name,\n    COUNT(DISTINCT s_suppkey) AS supplier_count,\n    SUM(CASE WHEN p_size > 10 THEN ps_availqty ELSE 0 END) AS large_part_avail_qty,\n    AVG(p_retailprice) AS avg_retail_price,\n    STRING_AGG(DISTINCT p_name, ', ') AS part_names\nFROM base\nGROUP BY nation_name\nHAVING COUNT(DISTINCT s_suppkey) > 5;", "sql2": "SELECT\n    s1.nation_name,\n    s1.supplier_count,\n    s1.large_part_avail_qty,\n    s1.avg_retail_price,\n    s1.part_names,\n    COALESCE(m.max_order_total_price, 0) AS max_order_total_price\nFROM s1\nLEFT JOIN (\n    SELECT\n        n.n_name AS nation_name,\n        MAX(o.o_totalprice) AS max_order_total_price\n    FROM supplier s\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN part p ON ps.ps_partkey = p.p_partkey\n    LEFT JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    LEFT JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE n.n_name LIKE 'N%'\n    GROUP BY n.n_name\n) m ON s1.nation_name = m.nation_name\nWHERE s1.supplier_count > 5\nORDER BY s1.nation_name;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29642.sql", "original_sql": "SELECT \n    p.p_name, \n    s.s_name,\n    n.n_name,\n    r.r_name,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice) AS total_revenue,\n    AVG(s.s_acctbal) AS avg_supplier_balance,\n    STRING_AGG(DISTINCT o.o_orderpriority, ', ') AS order_priorities\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_name LIKE '%widget%' \n    AND o.o_orderstatus = 'O'\n    AND l.l_shipdate >= '1997-01-01'\nGROUP BY \n    p.p_name, s.s_name, n.n_name, r.r_name\nHAVING \n    SUM(l.l_extendedprice) > 10000\nORDER BY \n    total_revenue DESC, total_orders DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT\n    ps.ps_partkey AS partkey,\n    ps.ps_suppkey AS suppkey,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    SUM(l.l_extendedprice) AS total_revenue,\n    STRING_AGG(DISTINCT o.o_orderpriority, ', ') AS order_priorities\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nWHERE o.o_orderstatus = 'O'\n  AND l.l_shipdate >= DATE '1997-01-01'\nGROUP BY ps.ps_partkey, ps.ps_suppkey\nHAVING SUM(l.l_extendedprice) > 10000;", "sql2": "SELECT\n    p.p_name,\n    s.s_name,\n    n.n_name,\n    r.r_name,\n    s1.total_orders,\n    s1.total_revenue,\n    s.s_acctbal AS avg_supplier_balance,\n    s1.order_priorities\nFROM s1\nJOIN part p ON s1.partkey = p.p_partkey\nJOIN supplier s ON s1.suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_name LIKE '%widget%'\nORDER BY s1.total_revenue DESC, s1.total_orders DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29656.sql", "original_sql": "\nSELECT \n    p.p_name,\n    s.s_name AS supplier_name,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    MAX(l.l_shipdate) AS last_ship_date,\n    MIN(l.l_shipdate) AS first_ship_date,\n    AVG(l.l_discount) AS average_discount,\n    STRING_AGG(DISTINCT r.r_name, ', ') AS regions_supply,\n    SUBSTRING(p.p_comment, 1, 10) AS short_comment\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, s.s_name, p.p_comment\nHAVING \n    SUM(l.l_quantity) > 100\nORDER BY \n    total_revenue DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "29708.sql", "original_sql": "\nSELECT \n    CONCAT('Part Name: ', p.p_name, ', Brand: ', p.p_brand, ', Type: ', p.p_type, \n           ', Container: ', p.p_container, ', Comment: ', p.p_comment) AS part_details,\n    s.s_name AS supplier_name,\n    CONCAT(c.c_name, ' (', c.c_address, ')') AS customer_info,\n    o.o_orderkey,\n    o.o_orderdate,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    p.p_retailprice > 100.00 \n    AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name, p.p_brand, p.p_type, p.p_container, p.p_comment, s.s_name, \n    c.c_name, c.c_address, o.o_orderkey, o.o_orderdate\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 5000.00\nORDER BY \n    total_revenue DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT p.p_name, p.p_brand, p.p_type, p.p_container, p.p_comment, s.s_name, c.c_name, c.c_address, o.o_orderkey, o.o_orderdate, l.l_extendedprice * (1 - l.l_discount) AS revenue FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN lineitem l ON p.p_partkey = l.l_partkey JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey WHERE p.p_retailprice > 100.00 AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'", "sql2": "SELECT CONCAT('Part Name: ', p_name, ', Brand: ', p_brand, ', Type: ', p_type, ', Container: ', p_container, ', Comment: ', p_comment) AS part_details, s_name AS supplier_name, CONCAT(c_name, ' (', c_address, ')') AS customer_info, o_orderkey, o_orderdate, SUM(revenue) AS total_revenue FROM s1 GROUP BY p_name, p_brand, p_type, p_container, p_comment, s_name, c_name, c_address, o_orderkey, o_orderdate HAVING SUM(revenue) > 5000.00 ORDER BY total_revenue DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29734.sql", "original_sql": "SELECT \n    s.s_name AS supplier_name,\n    p.p_name AS part_name,\n    COUNT(DISTINCT o.o_orderkey) AS number_of_orders,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS average_extended_price,\n    STRING_AGG(DISTINCT CONCAT(c.c_name, ' from ', r.r_name), ', ') AS customer_names,\n    STRING_AGG(DISTINCT p.p_comment, '; ') AS part_comments\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    p.p_name LIKE '%widget%' AND \n    o.o_orderdate >= '1997-01-01' AND \n    o.o_orderdate < '1998-01-01'\nGROUP BY \n    s.s_name, p.p_name\nORDER BY \n    number_of_orders DESC, total_quantity DESC;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT\n    s.s_suppkey,\n    s.s_name,\n    p.p_partkey,\n    p.p_name,\n    o.o_orderkey,\n    SUM(l.l_quantity) AS qty_sum,\n    SUM(l.l_extendedprice) AS extprice_sum,\n    COUNT(*) AS line_cnt,\n    c.c_custkey,\n    r.r_name AS region_name,\n    p.p_comment AS part_comment\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_name LIKE '%widget%'\n  AND o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY\n    s.s_suppkey,\n    s.s_name,\n    p.p_partkey,\n    p.p_name,\n    o.o_orderkey,\n    c.c_custkey,\n    r.r_name,\n    p.p_comment;", "sql2": "SELECT\n    s1.s_name AS supplier_name,\n    s1.p_name AS part_name,\n    COUNT(s1.o_orderkey) AS number_of_orders,\n    SUM(s1.qty_sum) AS total_quantity,\n    SUM(s1.extprice_sum) / SUM(s1.line_cnt) AS average_extended_price,\n    STRING_AGG(DISTINCT CONCAT(c.c_name, ' from ', s1.region_name), ', ') AS customer_names,\n    STRING_AGG(DISTINCT s1.part_comment, '; ') AS part_comments\nFROM s1\nJOIN customer c ON s1.c_custkey = c.c_custkey\nGROUP BY s1.s_name, s1.p_name\nORDER BY number_of_orders DESC, total_quantity DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29865.sql", "original_sql": "SELECT \n    CONCAT(s.s_name, ' from ', n.n_name, ', located in ', r.r_name) AS supplier_info,\n    COUNT(DISTINCT p.p_partkey) AS unique_parts,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    SUM(ps.ps_supplycost) AS total_supply_cost\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nWHERE \n    p.p_brand LIKE '%BRAND%'\n    AND p.p_comment NOT LIKE '%defective%'\n    AND r.r_name IN ('EUROPE', 'ASIA')\nGROUP BY \n    s.s_name, n.n_name, r.r_name\nHAVING \n    COUNT(DISTINCT p.p_partkey) > 5\nORDER BY \n    total_supply_cost DESC, unique_parts ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_suppkey AS suppkey,\n    COUNT(DISTINCT p.p_partkey) AS unique_parts,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    SUM(ps.ps_supplycost) AS total_supply_cost\nFROM partsupp ps\nJOIN part p ON ps.ps_partkey = p.p_partkey\nWHERE p.p_brand LIKE '%BRAND%'\n  AND p.p_comment NOT LIKE '%defective%'\nGROUP BY ps.ps_suppkey\nHAVING COUNT(DISTINCT p.p_partkey) > 5", "sql2": "SELECT \n    CONCAT(s.s_name, ' from ', n.n_name, ', located in ', r.r_name) AS supplier_info,\n    s1.unique_parts,\n    s1.total_available_quantity,\n    s1.total_supply_cost\nFROM s1\nJOIN supplier s ON s.s_suppkey = s1.suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name IN ('EUROPE', 'ASIA')\nORDER BY s1.total_supply_cost DESC, s1.unique_parts ASC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29905.sql", "original_sql": "SELECT \n    p.p_name,\n    SUBSTRING(p.p_comment, 1, 10) AS short_comment,\n    CONCAT('Supplier: ', s.s_name, ', Region: ', r.r_name) AS supplier_region_info,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUM(l.l_quantity) AS total_quantity,\n    AVG(l.l_extendedprice) AS avg_price,\n    CASE\n        WHEN SUM(l.l_discount) > 0 THEN 'Discounted'\n        ELSE 'Regular Price'\n    END AS price_type\nFROM \n    part p\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    p.p_size > 10 AND \n    o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_partkey, p.p_name, p.p_comment, s.s_name, r.r_name\nHAVING \n    COUNT(DISTINCT o.o_orderkey) > 5\nORDER BY \n    total_quantity DESC, avg_price ASC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    ps.ps_partkey AS p_partkey,\n    ps.ps_suppkey AS s_suppkey,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    SUM(l.l_quantity) AS total_quantity,\n    SUM(l.l_extendedprice) AS sum_extendedprice,\n    COUNT(*) AS cnt_rows,\n    SUM(l.l_discount) AS sum_discount\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\nWHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY ps.ps_partkey, ps.ps_suppkey", "sql2": "SELECT \n    p.p_name,\n    SUBSTRING(p.p_comment, 1, 10) AS short_comment,\n    CONCAT('Supplier: ', s.s_name, ', Region: ', r.r_name) AS supplier_region_info,\n    s1.order_count,\n    s1.total_quantity,\n    s1.sum_extendedprice / s1.cnt_rows AS avg_price,\n    CASE WHEN s1.sum_discount > 0 THEN 'Discounted' ELSE 'Regular Price' END AS price_type\nFROM s1\nJOIN part p ON s1.p_partkey = p.p_partkey\nJOIN supplier s ON s1.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_size > 10\n  AND s1.order_count > 5\nORDER BY s1.total_quantity DESC, avg_price ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "29910.sql", "original_sql": "\nWITH SupplierParts AS (\n    SELECT \n        s.s_name AS supplier_name,\n        p.p_name AS part_name,\n        p.p_brand AS part_brand,\n        ps.ps_supplycost AS supply_cost,\n        ps.ps_availqty AS available_quantity,\n        CONCAT(CAST(EXTRACT(YEAR FROM CURRENT_DATE) AS VARCHAR), '-', \n               LPAD(CAST(EXTRACT(MONTH FROM CURRENT_DATE) AS VARCHAR), 2, '0'), '-', \n               LPAD(CAST(EXTRACT(DAY FROM CURRENT_DATE) AS VARCHAR), 2, '0')) AS as_of_date\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n)\nSELECT \n    supplier_name,\n    COUNT(DISTINCT part_name) AS total_parts,\n    SUM(supply_cost * available_quantity) AS total_inventory_value,\n    STRING_AGG(part_name, ', ') AS part_names_list,\n    STRING_AGG(DISTINCT part_brand, ', ') AS unique_brands\nFROM \n    SupplierParts\nGROUP BY \n    supplier_name\nHAVING \n    COUNT(DISTINCT part_name) > 3\nORDER BY \n    total_inventory_value DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "29938.sql", "original_sql": "SELECT \n    CONCAT('Supplier Name: ', s.s_name, ' | Nation: ', n.n_name, \n           ' | Product: ', p.p_name, ' | Comment: ', ps.ps_comment) AS detailed_info,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    COUNT(distinct o.o_orderkey) AS total_orders\nFROM \n    supplier s\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey \nWHERE \n    s.s_comment LIKE '%reliable%' \n    AND p.p_size BETWEEN 10 AND 50\nGROUP BY \n    s.s_name, n.n_name, p.p_name, ps.ps_comment\nORDER BY \n    total_orders DESC, average_supply_cost ASC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT l.l_partkey AS part_key,\n       COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM lineitem l\nLEFT JOIN orders o ON l.l_orderkey = o.o_orderkey\nGROUP BY l.l_partkey;", "sql2": "SELECT \n    CONCAT('Supplier Name: ', s.s_name, ' | Nation: ', n.n_name, \n           ' | Product: ', p.p_name, ' | Comment: ', ps.ps_comment) AS detailed_info,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    AVG(ps.ps_supplycost) AS average_supply_cost,\n    COALESCE(s1.total_orders, 0) AS total_orders\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nLEFT JOIN (\n    SELECT part_key, total_orders FROM s1\n) s1 ON p.p_partkey = s1.part_key\nWHERE s.s_comment LIKE '%reliable%'\n  AND p.p_size BETWEEN 10 AND 50\nGROUP BY s.s_name, n.n_name, p.p_name, ps.ps_comment, s1.total_orders\nORDER BY total_orders DESC, average_supply_cost ASC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "29939.sql", "original_sql": "\nSELECT \n    p.p_name, \n    SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    MAX(l.l_extendedprice) AS max_price,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' (', s.s_phone, ')'), '; ') AS supplier_details\nFROM \n    part p\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE \n    p.p_name LIKE '%Steel%'\n    AND o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    p.p_name\nHAVING \n    SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) > 0\nORDER BY \n    total_orders DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS returned_quantity,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    MAX(l.l_extendedprice) AS max_price\nFROM part p\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE p.p_name LIKE '%Steel%'\n  AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY p.p_name\nHAVING SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) > 0", "sql2": "SELECT \n    s1.p_name,\n    s1.returned_quantity,\n    s1.total_orders,\n    s1.max_price,\n    STRING_AGG(DISTINCT CONCAT(s.s_name, ' (', s.s_phone, ')'), '; ') AS supplier_details\nFROM s1\nJOIN part p ON p.p_name = s1.p_name\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY s1.p_name, s1.returned_quantity, s1.total_orders, s1.max_price\nORDER BY s1.total_orders DESC\nLIMIT 10", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "31420.sql", "original_sql": "WITH RECURSIVE CTE_Supplier AS (\n    SELECT s_suppkey, s_name, s_acctbal, s_nationkey, 1 AS level\n    FROM supplier\n    WHERE s_acctbal > (\n        SELECT AVG(s_acctbal) * 0.5 FROM supplier\n    )\n    UNION ALL\n    SELECT s.s_suppkey, s.s_name, s.s_acctbal, s.s_nationkey, cs.level + 1\n    FROM supplier s\n    JOIN CTE_Supplier cs ON s.s_nationkey = cs.s_nationkey\n    WHERE s.s_acctbal > (\n        SELECT AVG(s_acctbal) FROM supplier\n    ) AND cs.level < 5\n),\nOrderStats AS (\n    SELECT \n        o.o_orderkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n        COUNT(DISTINCT l.l_partkey) AS part_count\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31'\n    GROUP BY o.o_orderkey\n),\nHighValueOrders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_totalprice,\n        o.o_orderstatus,\n        os.total_revenue,\n        os.part_count,\n        ROW_NUMBER() OVER (PARTITION BY o.o_orderstatus ORDER BY os.total_revenue DESC) AS rn\n    FROM orders o\n    JOIN OrderStats os ON o.o_orderkey = os.o_orderkey\n    WHERE o.o_totalprice > 10000\n)\nSELECT \n    r.r_name AS region,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(s.s_acctbal) AS total_supplier_balance,\n    AVG(hvo.o_totalprice) AS average_order_value\nFROM region r\nLEFT JOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN customer c ON n.n_nationkey = c.c_nationkey\nLEFT JOIN HighValueOrders hvo ON c.c_custkey = hvo.o_orderkey\nWHERE c.c_acctbal IS NOT NULL\nAND s.s_acctbal > 1000\nGROUP BY r.r_name\nORDER BY total_supplier_balance DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "WITH OrderStats AS (\n    SELECT \n        o.o_orderkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n        COUNT(DISTINCT l.l_partkey) AS part_count\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate BETWEEN DATE '1995-01-01' AND DATE '1995-12-31'\n    GROUP BY o.o_orderkey\n)\nSELECT \n    o.o_orderkey,\n    o.o_totalprice,\n    o.o_orderstatus,\n    os.total_revenue,\n    os.part_count,\n    ROW_NUMBER() OVER (PARTITION BY o.o_orderstatus ORDER BY os.total_revenue DESC) AS rn\nFROM orders o\nJOIN OrderStats os ON o.o_orderkey = os.o_orderkey\nWHERE o.o_totalprice > 10000;", "sql2": "SELECT \n    r.r_name AS region,\n    COUNT(DISTINCT c.c_custkey) AS customer_count,\n    SUM(s.s_acctbal) AS total_supplier_balance,\n    AVG(s1.o_totalprice) AS average_order_value\nFROM region r\nLEFT JOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN customer c ON n.n_nationkey = c.c_nationkey\nLEFT JOIN s1 ON c.c_custkey = s1.o_orderkey\nWHERE c.c_acctbal IS NOT NULL\n  AND s.s_acctbal > 1000\nGROUP BY r.r_name\nORDER BY total_supplier_balance DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "31568.sql", "original_sql": "WITH RECURSIVE NationHierarchy AS (\n    SELECT n_nationkey, n_name, n_regionkey, 1 AS level\n    FROM nation\n    WHERE n_regionkey IS NOT NULL\n    UNION ALL\n    SELECT n.n_nationkey, n.n_name, n.n_regionkey, nh.level + 1\n    FROM nation n\n    INNER JOIN NationHierarchy nh ON n.n_regionkey = nh.n_nationkey\n),\nSupplierWithMaxCost AS (\n    SELECT ps_suppkey, MAX(ps_supplycost) AS max_supplycost\n    FROM partsupp\n    GROUP BY ps_suppkey\n),\nCustomerOrders AS (\n    SELECT c.c_custkey, c.c_name, COUNT(o.o_orderkey) AS order_count, SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT\n    r.r_name,\n    COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n    AVG(c.total_spent) AS avg_customer_spent,\n    MAX(ps.ps_supplycost) AS max_supply_cost,\n    SUM(CASE WHEN l.l_discount > 0.05 THEN l.l_extendedprice * (1 - l.l_discount) END) AS total_discounted_sales,\n    SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS total_returned_quantity\nFROM\n    region r\nLEFT JOIN nation n ON n.n_regionkey = r.r_regionkey\nLEFT JOIN supplier s ON s.s_nationkey = n.n_nationkey\nLEFT JOIN SupplierWithMaxCost smc ON s.s_suppkey = smc.ps_suppkey\nLEFT JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nLEFT JOIN lineitem l ON ps.ps_partkey = l.l_partkey\nLEFT JOIN CustomerOrders c ON s.s_suppkey = c.c_custkey\nWHERE\n    ps.ps_availqty > 10\n    AND (s.s_acctbal IS NOT NULL OR s.s_name LIKE 'Supplier%')\nGROUP BY r.r_name\nORDER BY r.r_name DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH SupplierWithMaxCost AS (\n    SELECT ps_suppkey, MAX(ps_supplycost) AS max_supplycost\n    FROM partsupp\n    GROUP BY ps_suppkey\n),\nCustomerOrders AS (\n    SELECT c.c_custkey, c.c_name, COUNT(o.o_orderkey) AS order_count, SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n),\nFilteredPartsupp AS (\n    SELECT ps.*\n    FROM partsupp ps\n    WHERE ps.ps_availqty > 10\n),\nLineItemAgg AS (\n    SELECT\n        ps.ps_suppkey,\n        SUM(CASE WHEN l.l_discount > 0.05 THEN l.l_extendedprice * (1 - l.l_discount) END) AS total_discounted_sales,\n        SUM(CASE WHEN l.l_returnflag = 'R' THEN l.l_quantity ELSE 0 END) AS total_returned_quantity,\n        MAX(ps.ps_supplycost) AS max_ps_supplycost\n    FROM FilteredPartsupp ps\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    GROUP BY ps.ps_suppkey\n)\nSELECT\n    s.s_suppkey,\n    s.s_nationkey,\n    s.s_acctbal,\n    s.s_name,\n    smc.max_supplycost,\n    co.total_spent,\n    la.total_discounted_sales,\n    la.total_returned_quantity,\n    la.max_ps_supplycost\nFROM supplier s\nLEFT JOIN SupplierWithMaxCost smc ON s.s_suppkey = smc.ps_suppkey\nLEFT JOIN CustomerOrders co ON s.s_suppkey = co.c_custkey\nLEFT JOIN LineItemAgg la ON s.s_suppkey = la.ps_suppkey\nWHERE (s.s_acctbal IS NOT NULL OR s.s_name LIKE 'Supplier%');", "sql2": "SELECT\n    r.r_name,\n    COUNT(DISTINCT s1.s_suppkey) AS supplier_count,\n    AVG(s1.total_spent) AS avg_customer_spent,\n    MAX(s1.max_ps_supplycost) AS max_supply_cost,\n    SUM(s1.total_discounted_sales) AS total_discounted_sales,\n    SUM(s1.total_returned_quantity) AS total_returned_quantity\nFROM s1\nJOIN nation n ON s1.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nGROUP BY r.r_name\nORDER BY r.r_name DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "31582.sql", "original_sql": "\nWITH RECURSIVE sales_hierarchy AS (\n    SELECT \n        c.c_custkey, \n        c.c_name, \n        c.c_nationkey, \n        c.c_acctbal, \n        0 AS level\n    FROM \n        customer c\n    WHERE \n        c.c_acctbal > 1000\n\n    UNION ALL\n\n    SELECT \n        o.o_custkey, \n        sh.c_name, \n        sh.c_nationkey, \n        sh.c_acctbal, \n        sh.level + 1\n    FROM \n        orders o\n    JOIN \n        sales_hierarchy sh ON o.o_custkey = sh.c_custkey\n)\n\nSELECT \n    n.n_name AS nation_name,\n    SUM(COALESCE(l.l_extendedprice * (1 - l.l_discount), 0)) AS total_sales,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    MAX(l.l_shipdate) AS last_ship_date,\n    STRING_AGG(DISTINCT p.p_name, ', ') AS product_names\nFROM \n    lineitem l \nLEFT JOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nLEFT JOIN \n    customer c ON o.o_custkey = c.c_custkey\nLEFT JOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nLEFT JOIN \n    part p ON l.l_partkey = p.p_partkey\nWHERE \n    l.l_shipdate >= DATE '1997-01-01'\n    AND l.l_shipdate < DATE '1997-12-31'\n    AND p.p_size IS NOT NULL\nGROUP BY \n    n.n_name\nHAVING \n    SUM(COALESCE(l.l_extendedprice * (1 - l.l_discount), 0)) > (\n        SELECT AVG(total_sales) FROM (\n            SELECT \n                SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\n            FROM \n                lineitem l\n            JOIN \n                orders o ON l.l_orderkey = o.o_orderkey\n            GROUP BY \n                o.o_orderkey\n        ) AS avg_sales\n    )\nORDER BY \n    total_sales DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "32504.sql", "original_sql": "WITH RecursiveOrderCTE AS (\n    SELECT \n        o.o_orderkey, \n        o.o_orderdate, \n        o.o_totalprice,\n        RANK() OVER (PARTITION BY o.o_orderkey ORDER BY l_orderkey) as rank_val\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderstatus = 'O'\n),\nSupplierCostCTE AS (\n    SELECT \n        ps.ps_partkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM \n        partsupp ps\n    GROUP BY \n        ps.ps_partkey\n),\nFilteredCustomer AS (\n    SELECT \n        c.c_custkey, \n        c.c_name, \n        c.c_acctbal,\n        COALESCE(NULLIF(c.c_phone, ''), 'N/A') AS contact_number\n    FROM \n        customer c\n    WHERE \n        c.c_acctbal > 1000\n)\nSELECT \n    r.r_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    COUNT(DISTINCT o.o_orderkey) AS order_count,\n    (SELECT AVG(total_supply_cost) FROM SupplierCostCTE) AS avg_supplier_cost\nFROM \n    region r\nJOIN \n    nation n ON r.r_regionkey = n.n_regionkey\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    RecursiveOrderCTE o ON l.l_orderkey = o.o_orderkey\nJOIN \n    FilteredCustomer c ON o.o_orderkey = c.c_custkey\nWHERE \n    l.l_shipdate >= DATE '1997-01-01' AND \n    l.l_shipdate < DATE '1997-12-31'\nGROUP BY \n    r.r_name\nORDER BY \n    revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH RecursiveOrderCTE AS (\n    SELECT \n        o.o_orderkey, \n        o.o_orderdate, \n        o.o_totalprice,\n        RANK() OVER (PARTITION BY o.o_orderkey ORDER BY l.l_orderkey) AS rank_val\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderstatus = 'O'\n),\nSupplierCostCTE AS (\n    SELECT \n        ps.ps_partkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM partsupp ps\n    GROUP BY ps.ps_partkey\n),\nAvgSup AS (\n    SELECT AVG(total_supply_cost) AS avg_supplier_cost\n    FROM SupplierCostCTE\n)\nSELECT \n    ro.o_orderkey,\n    ro.o_orderdate,\n    ro.o_totalprice,\n    ro.rank_val,\n    a.avg_supplier_cost\nFROM RecursiveOrderCTE ro\nCROSS JOIN AvgSup a;", "sql2": "WITH FilteredCustomer AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        c.c_acctbal,\n        COALESCE(NULLIF(c.c_phone, ''), 'N/A') AS contact_number\n    FROM customer c\n    WHERE c.c_acctbal > 1000\n)\nSELECT \n    r.r_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    COUNT(DISTINCT s1.o_orderkey) AS order_count,\n    MAX(s1.avg_supplier_cost) AS avg_supplier_cost\nFROM s1\nJOIN lineitem l ON s1.o_orderkey = l.l_orderkey\nJOIN part p ON p.p_partkey = l.l_partkey\nJOIN partsupp ps ON ps.ps_partkey = p.p_partkey\nJOIN supplier s ON s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON n.n_nationkey = s.s_nationkey\nJOIN region r ON r.r_regionkey = n.n_regionkey\nJOIN FilteredCustomer c ON s1.o_orderkey = c.c_custkey\nWHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY r.r_name\nORDER BY revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "32909.sql", "original_sql": "WITH RECURSIVE RankedOrders AS (\n    SELECT \n        o_orderkey,\n        o_custkey,\n        o_orderstatus,\n        o_totalprice,\n        o_orderdate,\n        o_orderpriority,\n        ROW_NUMBER() OVER (PARTITION BY o_orderstatus ORDER BY o_totalprice DESC) as rank\n    FROM orders\n    WHERE o_orderdate >= '1997-01-01'\n),\nSupplierStats AS (\n    SELECT \n        s_nationkey, \n        AVG(s_acctbal) AS avg_acctbal, \n        SUM(CASE WHEN s_comment LIKE '%urgent%' THEN 1 ELSE 0 END) as urgent_count\n    FROM supplier\n    GROUP BY s_nationkey\n),\nPartAvailability AS (\n    SELECT \n        ps_partkey,\n        SUM(ps_availqty) AS total_avail_qty,\n        AVG(ps_supplycost) AS avg_supply_cost\n    FROM partsupp\n    GROUP BY ps_partkey\n)\nSELECT \n    r.r_name,\n    COALESCE(SUM(CASE WHEN lo.l_returnflag = 'R' THEN lo.l_extendedprice * (1 - lo.l_discount) END), 0) AS total_returned,\n    COUNT(DISTINCT co.c_custkey) AS total_customers,\n    AVG(ss.avg_acctbal) AS avg_supplier_acct_bal,\n    COUNT(DISTINCT ro.o_orderkey) AS total_orders,\n    SUM(pa.total_avail_qty) AS total_qty_available,\n    MAX(pa.avg_supply_cost) AS max_supply_cost\nFROM region r\nLEFT JOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\nLEFT JOIN SupplierStats ss ON s.s_nationkey = ss.s_nationkey\nLEFT JOIN lineitem lo ON s.s_suppkey = lo.l_suppkey\nLEFT JOIN orders ro ON lo.l_orderkey = ro.o_orderkey\nLEFT JOIN PartAvailability pa ON lo.l_partkey = pa.ps_partkey\nLEFT JOIN customer co ON ro.o_custkey = co.c_custkey\nWHERE (ro.o_orderstatus = 'F' OR ro.o_orderstatus = 'P')\n  AND (co.c_acctbal IS NOT NULL AND co.c_acctbal > 100)\nGROUP BY r.r_name\nHAVING COUNT(DISTINCT co.c_custkey) > 10\nORDER BY total_orders DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "3300.sql", "original_sql": "WITH RankedOrders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        ROW_NUMBER() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_orderdate DESC) AS order_rank\n    FROM \n        orders o\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' AND\n        o.o_orderstatus IN ('O', 'F')\n),\nAggregatedSuppliers AS (\n    SELECT \n        ps.ps_suppkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_value,\n        COUNT(DISTINCT ps.ps_partkey) AS part_count\n    FROM\n        partsupp ps\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey\n    WHERE \n        s.s_acctbal > 10000.00\n    GROUP BY \n        ps.ps_suppkey\n),\nCustomerOrderSummary AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COUNT(o.o_orderkey) AS total_orders,\n        AVG(o.o_totalprice) AS avg_order_value\n    FROM \n        customer c\n    LEFT JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n    HAVING \n        COUNT(o.o_orderkey) > 5\n)\n\nSELECT \n    n.n_name,\n    r.r_name,\n    COALESCE(SUM(a.total_supply_value), 0) AS total_supply_value,\n    COALESCE(SUM(cos.total_orders), 0) AS total_orders,\n    COALESCE(AVG(cos.avg_order_value), 0) AS avg_order_value\nFROM \n    nation n\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN \n    AggregatedSuppliers a ON n.n_nationkey = a.ps_suppkey\nLEFT JOIN \n    CustomerOrderSummary cos ON n.n_nationkey = cos.c_custkey\nWHERE \n    r.r_name LIKE 'Europe%' AND \n    n.n_comment IS NOT NULL\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_supply_value DESC, total_orders DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "33182.sql", "original_sql": "WITH RECURSIVE customer_order_summary AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        o.o_orderkey,\n        o.o_orderdate,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spent,\n        SUM(l.l_quantity) AS total_items\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\n    GROUP BY \n        c.c_custkey, c.c_name, o.o_orderkey, o.o_orderdate\n),\n\nsupplier_performance AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        AVG(ps.ps_supplycost) AS avg_supply_cost,\n        COUNT(DISTINCT ps.ps_partkey) AS supplied_parts\n    FROM \n        supplier s\n    LEFT JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\n\ntop_customers AS (\n    SELECT \n        c.c_custkey, \n        c.c_name, \n        SUM(co.total_spent) AS total_customer_spent\n    FROM \n        customer_order_summary co\n    JOIN \n        customer c ON co.c_custkey = c.c_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n    ORDER BY \n        total_customer_spent DESC\n    LIMIT 10\n)\n\nSELECT \n    tc.c_name AS customer_name,\n    tc.total_customer_spent,\n    sp.s_name AS supplier_name,\n    sp.avg_supply_cost,\n    sp.supplied_parts\nFROM \n    top_customers tc\nCROSS JOIN \n    supplier_performance sp\nWHERE \n    tc.total_customer_spent > (SELECT AVG(total_spent) FROM customer_order_summary)\nORDER BY \n    tc.total_customer_spent DESC, sp.avg_supply_cost ASC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH\n    customer_order_summary AS (\n        SELECT \n            c.c_custkey,\n            c.c_name,\n            o.o_orderkey,\n            o.o_orderdate,\n            SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_spent,\n            SUM(l.l_quantity) AS total_items\n        FROM customer c\n        JOIN orders o ON c.c_custkey = o.o_custkey\n        JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n        WHERE o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\n        GROUP BY c.c_custkey, c.c_name, o.o_orderkey, o.o_orderdate\n    ),\n    top_customers AS (\n        SELECT \n            c.c_custkey,\n            c.c_name,\n            SUM(co.total_spent) AS total_customer_spent\n        FROM customer_order_summary co\n        JOIN customer c ON co.c_custkey = c.c_custkey\n        GROUP BY c.c_custkey, c.c_name\n        ORDER BY total_customer_spent DESC\n        LIMIT 10\n    ),\n    avg_spent AS (\n        SELECT AVG(total_spent) AS avg_total_spent FROM customer_order_summary\n    )\nSELECT \n    tc.c_custkey,\n    tc.c_name,\n    tc.total_customer_spent,\n    a.avg_total_spent\nFROM top_customers tc\nCROSS JOIN avg_spent a;", "sql2": "WITH supplier_performance AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        AVG(ps.ps_supplycost) AS avg_supply_cost,\n        COUNT(DISTINCT ps.ps_partkey) AS supplied_parts\n    FROM supplier s\n    LEFT JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n)\nSELECT \n    s1.c_name AS customer_name,\n    s1.total_customer_spent,\n    sp.s_name AS supplier_name,\n    sp.avg_supply_cost,\n    sp.supplied_parts\nFROM s1\nCROSS JOIN supplier_performance sp\nWHERE s1.total_customer_spent > s1.avg_total_spent\nORDER BY s1.total_customer_spent DESC, sp.avg_supply_cost ASC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "34606.sql", "original_sql": "WITH RECURSIVE SupplierHierarchy AS (\n    SELECT s.s_suppkey, s.s_name, s.s_nationkey, s.s_acctbal, 0 AS HierarchyLevel\n    FROM supplier s\n    WHERE s.s_acctbal > (SELECT AVG(s_acctbal) FROM supplier)\n\n    UNION ALL\n\n    SELECT s.s_suppkey, s.s_name, s.s_nationkey, s.s_acctbal, sh.HierarchyLevel + 1\n    FROM supplier s\n    JOIN SupplierHierarchy sh ON s.s_nationkey = sh.s_nationkey\n    WHERE s.s_acctbal < sh.s_acctbal\n)\n\nSELECT \n    n.n_name AS NationName,\n    r.r_name AS RegionName,\n    COUNT(DISTINCT s.s_suppkey) AS TotalSuppliers,\n    SUM(COALESCE(ps.ps_availqty, 0)) AS TotalAvailableQuantity,\n    AVG(s.s_acctbal) AS AvgAccountBalance,\n    STRING_AGG(DISTINCT s.s_name, ', ') AS SupplierNames,\n    MAX(CASE WHEN o.o_orderstatus = 'F' THEN o.o_orderkey END) AS LastFinishedOrder,\n    SUM(CASE WHEN l.l_discount > 0.1 THEN l.l_extendedprice * (1 - l.l_discount) ELSE 0 END) AS DiscountedRevenue\nFROM nation n\nJOIN region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN supplier s ON s.s_nationkey = n.n_nationkey\nLEFT JOIN partsupp ps ON ps.ps_suppkey = s.s_suppkey\nLEFT JOIN lineitem l ON l.l_partkey = ps.ps_partkey\nLEFT JOIN orders o ON o.o_orderkey = l.l_orderkey\nWHERE n.n_nationkey IN (SELECT n_nationkey FROM nation WHERE n_comment IS NOT NULL)\nGROUP BY n.n_name, r.r_name\nHAVING COUNT(s.s_suppkey) > 0\nORDER BY AvgAccountBalance DESC\nLIMIT 10;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "4256.sql", "original_sql": "\nWITH AvgOrderAmount AS (\n    SELECT \n        o_custkey,\n        AVG(o_totalprice) AS avg_totalprice\n    FROM \n        orders\n    GROUP BY \n        o_custkey\n),\nTopSuppliers AS (\n    SELECT \n        ps_suppkey,\n        SUM(ps_supplycost * ps_availqty) AS total_supplycost\n    FROM \n        partsupp\n    GROUP BY \n        ps_suppkey\n    HAVING \n        SUM(ps_supplycost * ps_availqty) > (SELECT AVG(ps_supplycost * ps_availqty) FROM partsupp)\n),\nSupplierRegion AS (\n    SELECT \n        s.s_suppkey, \n        r.r_name\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        COUNT(o.o_orderkey) AS order_count,\n        MAX(o.o_totalprice) AS max_order_price\n    FROM \n        customer c\n    LEFT JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey\n)\nSELECT \n    c.c_custkey AS custkey,\n    c.c_name,\n    COALESCE(oa.avg_totalprice, 0) AS avg_order_amount,\n    COALESCE(o.max_order_price, 0) AS max_order_value,\n    sr.r_name AS supplier_region,\n    CASE \n        WHEN o.order_count > 10 THEN 'High Value Customer'\n        WHEN o.order_count BETWEEN 5 AND 10 THEN 'Medium Value Customer'\n        ELSE 'Low Value Customer'\n    END AS customer_segment\nFROM \n    customer c\nLEFT JOIN \n    AvgOrderAmount oa ON c.c_custkey = oa.o_custkey\nLEFT JOIN \n    CustomerOrders o ON c.c_custkey = o.c_custkey\nLEFT JOIN \n    TopSuppliers ts ON o.c_custkey = ts.ps_suppkey\nLEFT JOIN \n    SupplierRegion sr ON ts.ps_suppkey = sr.s_suppkey\nWHERE \n    c.c_acctbal IS NOT NULL\nORDER BY \n    avg_order_amount DESC, \n    max_order_value DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT c.c_custkey AS custkey,\n       AVG(o.o_totalprice) AS avg_totalprice,\n       COUNT(o.o_orderkey) AS order_count,\n       MAX(o.o_totalprice) AS max_order_price\nFROM customer c\nLEFT JOIN orders o ON c.c_custkey = o.o_custkey\ngroup by c.c_custkey;", "sql2": "WITH TopSuppliers AS (\n    SELECT ps_suppkey,\n           SUM(ps_supplycost * ps_availqty) AS total_supplycost\n    FROM partsupp\n    GROUP BY ps_suppkey\n    HAVING SUM(ps_supplycost * ps_availqty) > (\n        SELECT AVG(ps_supplycost * ps_availqty) FROM partsupp\n    )\n),\nSupplierRegion AS (\n    SELECT s.s_suppkey,\n           r.r_name\n    FROM supplier s\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT s1.custkey,\n       c.c_name,\n       COALESCE(s1.avg_totalprice, 0) AS avg_order_amount,\n       COALESCE(s1.max_order_price, 0) AS max_order_value,\n       sr.r_name AS supplier_region,\n       CASE \n           WHEN s1.order_count > 10 THEN 'High Value Customer'\n           WHEN s1.order_count BETWEEN 5 AND 10 THEN 'Medium Value Customer'\n           ELSE 'Low Value Customer'\n       END AS customer_segment\nFROM s1\nJOIN customer c ON s1.custkey = c.c_custkey\nLEFT JOIN TopSuppliers ts ON s1.custkey = ts.ps_suppkey\nLEFT JOIN SupplierRegion sr ON ts.ps_suppkey = sr.s_suppkey\nWHERE c.c_acctbal IS NOT NULL\nORDER BY avg_order_amount DESC, max_order_value DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "4863.sql", "original_sql": "WITH SupplierSummary AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(ps.ps_availqty) AS total_available_quantity,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost,\n        AVG(CASE WHEN ps.ps_availqty > 0 THEN ps.ps_supplycost ELSE NULL END) AS avg_supply_cost\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COUNT(o.o_orderkey) AS order_count,\n        SUM(o.o_totalprice) AS total_spent\n    FROM \n        customer c\n    LEFT JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n),\nTopSuppliers AS (\n    SELECT \n        s.s_suppkey, \n        s.s_name,\n        DENSE_RANK() OVER (ORDER BY total_available_quantity DESC) AS supplier_rank\n    FROM \n        SupplierSummary s\n),\nTopCustomers AS (\n    SELECT \n        c.c_custkey, \n        c.c_name,\n        DENSE_RANK() OVER (ORDER BY total_spent DESC) AS customer_rank\n    FROM \n        CustomerOrders c\n)\nSELECT \n    s.s_name AS supplier_name,\n    c.c_name AS customer_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n    COUNT(DISTINCT o.o_orderkey) AS number_of_orders\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    TopSuppliers s ON l.l_suppkey = s.s_suppkey\nJOIN \n    TopCustomers c ON o.o_custkey = c.c_custkey\nWHERE \n    o.o_orderstatus = 'O' \n    AND l.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY \n    s.s_name, c.c_name\nORDER BY \n    revenue DESC \nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "487.sql", "original_sql": "\nWITH RegionNation AS (\n    SELECT \n        r.r_regionkey,\n        r.r_name AS region_name,\n        n.n_name AS nation_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count\n    FROM region r\n    JOIN nation n ON r.r_regionkey = n.n_regionkey\n    LEFT JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY r.r_regionkey, r.r_name, n.n_name\n),\nPartSupplierStats AS (\n    SELECT \n        ps.ps_partkey,\n        SUM(ps.ps_availqty) AS total_available_quantity,\n        AVG(ps.ps_supplycost) AS avg_supply_cost\n    FROM partsupp ps\n    GROUP BY ps.ps_partkey\n),\nOrderTotals AS (\n    SELECT \n        o.o_custkey,\n        SUM(o.o_totalprice) AS total_spent,\n        COUNT(o.o_orderkey) AS order_count\n    FROM orders o\n    WHERE o.o_orderdate >= DATE '1997-01-01'\n    GROUP BY o.o_custkey\n),\nCustomerPerformance AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        COALESCE(ot.total_spent, 0) AS total_spent,\n        COALESCE(ot.order_count, 0) AS order_count,\n        CASE \n            WHEN COALESCE(ot.total_spent, 0) > 10000 THEN 'High Value'\n            WHEN COALESCE(ot.total_spent, 0) BETWEEN 5000 AND 10000 THEN 'Medium Value'\n            ELSE 'Low Value'\n        END AS customer_segment\n    FROM customer c\n    LEFT JOIN OrderTotals ot ON c.c_custkey = ot.o_custkey\n),\nSupplierPartRegion AS (\n    SELECT \n        sp.ps_partkey,\n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        sp.ps_supplycost\n    FROM partsupp sp\n    JOIN supplier s ON sp.ps_suppkey = s.s_suppkey\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT \n    cp.c_name,\n    rp.region_name,\n    rp.nation_name,\n    SUM(sp.ps_supplycost) AS total_supply_cost,\n    SUM(COALESCE(ps.total_available_quantity, 0)) AS total_available_quantity,\n    cp.customer_segment\nFROM CustomerPerformance cp\nJOIN RegionNation rp ON cp.c_custkey = rp.supplier_count\nLEFT JOIN PartSupplierStats ps ON cp.c_custkey = ps.ps_partkey\nLEFT JOIN SupplierPartRegion sp ON cp.c_custkey = sp.ps_partkey\nWHERE cp.order_count > 1 \nAND rp.supplier_count > 0\nGROUP BY cp.c_name, rp.region_name, rp.nation_name, cp.customer_segment\nHAVING SUM(sp.ps_supplycost) > 5000\nORDER BY total_supply_cost DESC, cp.c_name;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 178, in _run_single_node\n    out_tbl = self._run_on_duckdb(node.sql)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 104, in _run_on_duckdb\n    return self.con.execute(sql).arrow()\n           ^^^^^^^^^^^^^^^^^^^^^\nduckdb.duckdb.InvalidInputException: Invalid Input Error: arrow_scan: get_next failed(): NotImplemented: Function 'array_filter' has no kernel matching input types (string_view, bool)\n", "engine_mem_mb": 500000}
{"query_id": "4903.sql", "original_sql": "\nWITH RankedOrders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        o.o_orderstatus,\n        DENSE_RANK() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_totalprice DESC) AS order_rank,\n        o.o_custkey\n    FROM \n        orders o\n    WHERE \n        o.o_orderdate >= DATE '1996-01-01' \n        AND o.o_orderdate < DATE '1997-01-01'\n),\nSupplierPartCounts AS (\n    SELECT \n        ps.ps_partkey,\n        COUNT(DISTINCT ps.ps_suppkey) AS supplier_count\n    FROM \n        partsupp ps\n    GROUP BY \n        ps.ps_partkey\n),\nCustomerRegion AS (\n    SELECT \n        c.c_custkey,\n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        c.c_acctbal\n    FROM \n        customer c\n    JOIN \n        nation n ON c.c_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    WHERE \n        c.c_acctbal > 1000.00\n)\nSELECT \n    cr.region_name,\n    cr.nation_name,\n    COUNT(DISTINCT cr.c_custkey) AS customer_count,\n    SUM(o.o_totalprice) AS total_order_value,\n    COALESCE(SUM(l.l_extendedprice * (1 - l.l_discount)), 0) AS total_lineitem_value,\n    AVG(spc.supplier_count) AS average_supplier_count\nFROM \n    CustomerRegion cr\nLEFT JOIN \n    RankedOrders o ON cr.c_custkey = o.o_custkey\nLEFT JOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nLEFT JOIN \n    SupplierPartCounts spc ON l.l_partkey = spc.ps_partkey\nGROUP BY \n    cr.region_name, cr.nation_name\nHAVING \n    COUNT(DISTINCT cr.c_custkey) > 5\nORDER BY \n    total_order_value DESC, cr.region_name, cr.nation_name;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 115, in _run_on_datafusion\n    return df.to_arrow_table()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/dataframe.py\", line 1164, in to_arrow_table\n    return self.df.to_arrow_table()\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pyarrow/table.pxi\", line 4767, in pyarrow.lib.Table.from_batches\n  File \"pyarrow/error.pxi\", line 154, in pyarrow.lib.pyarrow_internal_check_status\n  File \"pyarrow/error.pxi\", line 91, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: Schema at index 0 was different: \nregion_name: string_view\nnation_name: string_view\ncustomer_count: int64 not null\ntotal_order_value: double\ntotal_lineitem_value: double\naverage_supplier_count: int64\nvs\nregion_name: string_view\nnation_name: string_view\ncustomer_count: int64 not null\ntotal_order_value: double\ntotal_lineitem_value: double\naverage_supplier_count: double\n", "engine_mem_mb": 500000}
{"query_id": "5177.sql", "original_sql": "\nWITH TotalSales AS (\n    SELECT \n        p.p_partkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM \n        part p\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    WHERE \n        l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY \n        p.p_partkey\n),\nSupplierSales AS (\n    SELECT \n        s.s_suppkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS supplier_revenue\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        lineitem l ON ps.ps_partkey = l.l_partkey\n    WHERE \n        l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY \n        s.s_suppkey\n),\nCustomerSales AS (\n    SELECT \n        c.c_custkey,\n        SUM(o.o_totalprice) AS customer_expenditure\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY \n        c.c_custkey\n),\nTopSellingParts AS (\n    SELECT \n        p.p_partkey,\n        p.p_name,\n        ts.total_revenue\n    FROM \n        TotalSales ts\n    JOIN \n        part p ON ts.p_partkey = p.p_partkey\n    ORDER BY \n        ts.total_revenue DESC\n    LIMIT 10\n)\nSELECT \n    ts.p_name,\n    ts.total_revenue,\n    ss.supplier_revenue,\n    cs.customer_expenditure\nFROM \n    TopSellingParts ts\nJOIN \n    SupplierSales ss ON ts.p_partkey = ss.s_suppkey\nJOIN \n    CustomerSales cs ON cs.customer_expenditure > 1000\nORDER BY \n    ts.total_revenue DESC, ss.supplier_revenue DESC, cs.customer_expenditure DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH TotalSales AS (\n    SELECT \n        p.p_partkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM part p\n    JOIN lineitem l ON p.p_partkey = l.l_partkey\n    WHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY p.p_partkey\n)\nSELECT \n    p.p_partkey,\n    p.p_name,\n    ts.total_revenue\nFROM TotalSales ts\nJOIN part p ON ts.p_partkey = p.p_partkey\nORDER BY ts.total_revenue DESC\nLIMIT 10;", "sql2": "WITH SupplierSales AS (\n    SELECT \n        s.s_suppkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS supplier_revenue\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    WHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY s.s_suppkey\n),\nCustomerSales AS (\n    SELECT \n        c.c_custkey,\n        SUM(o.o_totalprice) AS customer_expenditure\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate < DATE '1998-01-01'\n    GROUP BY c.c_custkey\n)\nSELECT \n    s1.p_name,\n    s1.total_revenue,\n    ss.supplier_revenue,\n    cs.customer_expenditure\nFROM s1\nJOIN SupplierSales ss ON s1.p_partkey = ss.s_suppkey\nJOIN CustomerSales cs ON cs.customer_expenditure > 1000\nORDER BY s1.total_revenue DESC, ss.supplier_revenue DESC, cs.customer_expenditure DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "5349.sql", "original_sql": "SELECT \n    n.n_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue, \n    COUNT(DISTINCT o.o_orderkey) AS orders_count\nFROM \n    nation n\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nWHERE \n    o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\n    AND l.l_shipmode IN ('AIR', 'TRUCK')\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    s.s_nationkey,\n    o.o_orderkey,\n    l.l_extendedprice * (1 - l.l_discount) AS revenue\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN part p ON l.l_partkey = p.p_partkey\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nWHERE o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\n  AND l.l_shipmode IN ('AIR', 'TRUCK');", "sql2": "SELECT \n    n.n_name,\n    SUM(s1.revenue) AS total_revenue,\n    COUNT(DISTINCT s1.o_orderkey) AS orders_count\nFROM s1\nJOIN nation n ON s1.s_nationkey = n.n_nationkey\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "5362.sql", "original_sql": "WITH ranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01'\n    GROUP BY \n        o.o_orderkey, o.o_orderdate\n),\ntop_customers AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        SUM(ro.total_revenue) AS revenue\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    JOIN \n        ranked_orders ro ON o.o_orderkey = ro.o_orderkey\n    GROUP BY \n        c.c_custkey, c.c_name\n    ORDER BY \n        revenue DESC\n    LIMIT 10\n)\nSELECT \n    tc.c_custkey,\n    tc.c_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS customer_total_spent,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(l.l_extendedprice) AS avg_lineitem_price,\n    MAX(l.l_shipdate) AS last_order_date\nFROM \n    top_customers tc\nJOIN \n    orders o ON tc.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nGROUP BY \n    tc.c_custkey, tc.c_name\nORDER BY \n    customer_total_spent DESC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH ranked_orders AS (\n    SELECT \n        o.o_orderkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate >= DATE '1995-01-01' AND o.o_orderdate < DATE '1996-01-01'\n    GROUP BY o.o_orderkey\n)\nSELECT \n    c.c_custkey,\n    c.c_name,\n    SUM(ro.total_revenue) AS revenue\nFROM customer c\nJOIN orders o ON c.c_custkey = o.o_custkey\nJOIN ranked_orders ro ON o.o_orderkey = ro.o_orderkey\nGROUP BY c.c_custkey, c.c_name\nORDER BY revenue DESC\nLIMIT 10;", "sql2": "SELECT \n    s1.c_custkey,\n    s1.c_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS customer_total_spent,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(l.l_extendedprice) AS avg_lineitem_price,\n    MAX(l.l_shipdate) AS last_order_date\nFROM s1\nJOIN orders o ON s1.c_custkey = o.o_custkey\nJOIN lineitem l ON o.o_orderkey = l.l_orderkey\nGROUP BY s1.c_custkey, s1.c_name\nORDER BY customer_total_spent DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "5412.sql", "original_sql": "WITH ranked_suppliers AS (\n    SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n),\nhigh_value_parts AS (\n    SELECT p.p_partkey, p.p_name, AVG(l.l_extendedprice) AS avg_extended_price\n    FROM part p\n    JOIN lineitem l ON p.p_partkey = l.l_partkey\n    WHERE l.l_shipdate >= '1997-01-01' AND l.l_shipdate <= '1997-12-31'\n    GROUP BY p.p_partkey, p.p_name\n    HAVING AVG(l.l_extendedprice) > 100.00\n),\ntop_nations AS (\n    SELECT n.n_nationkey, n.n_name, COUNT(DISTINCT c.c_custkey) AS customer_count\n    FROM nation n\n    JOIN customer c ON n.n_nationkey = c.c_nationkey\n    GROUP BY n.n_nationkey, n.n_name\n    ORDER BY customer_count DESC\n    LIMIT 5\n)\nSELECT r.r_name AS region_name, \n       tn.n_name AS nation_name, \n       ts.s_name AS supplier_name, \n       hp.p_name AS part_name, \n       hp.avg_extended_price, \n       ts.total_supply_cost\nFROM region r\nJOIN nation tn ON r.r_regionkey = tn.n_regionkey\nJOIN ranked_suppliers ts ON tn.n_nationkey = ts.s_suppkey\nJOIN high_value_parts hp ON ts.s_suppkey = hp.p_partkey\nWHERE ts.total_supply_cost > 50000\nORDER BY r.r_name, tn.n_name, ts.total_supply_cost DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH ranked_suppliers AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n),\nhigh_value_parts AS (\n    SELECT p.p_partkey,\n           p.p_name,\n           AVG(l.l_extendedprice) AS avg_extended_price\n    FROM part p\n    JOIN lineitem l ON p.p_partkey = l.l_partkey\n    WHERE l.l_shipdate >= DATE '1997-01-01' AND l.l_shipdate <= DATE '1997-12-31'\n    GROUP BY p.p_partkey, p.p_name\n    HAVING AVG(l.l_extendedprice) > 100.00\n)\nSELECT rs.s_suppkey,\n       rs.s_name,\n       rs.total_supply_cost,\n       hvp.p_name,\n       hvp.avg_extended_price\nFROM ranked_suppliers rs\nJOIN high_value_parts hvp ON rs.s_suppkey = hvp.p_partkey\nWHERE rs.total_supply_cost > 50000;", "sql2": "SELECT r.r_name AS region_name,\n       n.n_name AS nation_name,\n       s1.s_name AS supplier_name,\n       s1.p_name AS part_name,\n       s1.avg_extended_price,\n       s1.total_supply_cost\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nJOIN s1 ON n.n_nationkey = s1.s_suppkey\nORDER BY r.r_name, n.n_name, s1.total_supply_cost DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "5604.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    AVG(s.s_acctbal) AS avg_supplier_balance,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    COUNT(DISTINCT c.c_custkey) AS total_customers\nFROM \n    customer c \nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey \nJOIN \n    orders o ON c.c_custkey = o.o_custkey \nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey \nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey \nJOIN \n    supplier s ON ps.ps_suppkey = s.s_suppkey \nWHERE \n    l.l_shipdate >= DATE '1997-01-01' \n    AND l.l_shipdate < DATE '1997-12-31'\nGROUP BY \n    n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 500000\nORDER BY \n    total_revenue DESC;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "5770.sql", "original_sql": "WITH NationSupplier AS (\n    SELECT n.n_name, SUM(s.s_acctbal) AS total_acctbal\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_name\n),\nPartSupplier AS (\n    SELECT p.p_partkey, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supplycost\n    FROM part p\n    JOIN partsupp ps ON p.p_partkey = ps.ps_partkey\n    GROUP BY p.p_partkey\n),\nCustomerOrder AS (\n    SELECT c.c_custkey, SUM(o.o_totalprice) AS total_ordervalue\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey\n),\nOrderLine AS (\n    SELECT o.o_orderkey, COUNT(l.l_linenumber) AS total_lines\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    GROUP BY o.o_orderkey\n)\nSELECT ns.n_name, ns.total_acctbal, ps.total_supplycost, co.total_ordervalue, ol.total_lines\nFROM NationSupplier ns\nJOIN PartSupplier ps ON ns.n_name = 'USA'  \nJOIN CustomerOrder co ON co.total_ordervalue > 100000  \nJOIN OrderLine ol ON ol.total_lines > 5  \nORDER BY ns.total_acctbal DESC, ps.total_supplycost DESC\nLIMIT 10;", "status": "timeout", "exitcode": -15, "signal": 15, "engine_mem_mb": 500000}
{"query_id": "5821.sql", "original_sql": "WITH SupplierStats AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        sum(ps.ps_availqty) AS total_available,\n        avg(ps.ps_supplycost) AS avg_supply_cost\n    FROM \n        supplier s \n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nCustomerStats AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        count(o.o_orderkey) AS total_orders,\n        sum(o.o_totalprice) AS total_spending\n    FROM \n        customer c \n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        c.c_custkey, c.c_name\n),\nLineItemStats AS (\n    SELECT \n        l.l_orderkey,\n        sum(l.l_extendedprice * (1 - l.l_discount)) AS revenue\n    FROM \n        lineitem l\n    WHERE \n        l.l_shipdate >= DATE '1995-01-01' AND l.l_shipdate < DATE '1996-01-01'\n    GROUP BY \n        l.l_orderkey\n)\nSELECT \n    r.r_name,\n    COUNT(DISTINCT cs.c_custkey) AS total_customers,\n    SUM(COALESCE(ss.total_available, 0)) AS total_parts_available,\n    SUM(COALESCE(lis.revenue, 0)) AS total_revenue\nFROM \n    region r\nLEFT JOIN \n    nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN \n    customer cs ON n.n_nationkey = cs.c_nationkey\nLEFT JOIN \n    SupplierStats ss ON cs.c_custkey = ss.s_suppkey\nLEFT JOIN \n    LineItemStats lis ON cs.c_custkey = lis.l_orderkey\nGROUP BY \n    r.r_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 115, in _run_on_datafusion\n    return df.to_arrow_table()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/dataframe.py\", line 1164, in to_arrow_table\n    return self.df.to_arrow_table()\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pyarrow/table.pxi\", line 4767, in pyarrow.lib.Table.from_batches\n  File \"pyarrow/error.pxi\", line 154, in pyarrow.lib.pyarrow_internal_check_status\n  File \"pyarrow/error.pxi\", line 91, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: Schema at index 0 was different: \ns_suppkey: int64\ntotal_available: int64\nl_orderkey: int64\nrevenue: double\nvs\ns_suppkey: int64\ntotal_available: double\nl_orderkey: int64\nrevenue: double\n", "engine_mem_mb": 500000}
{"query_id": "5995.sql", "original_sql": "WITH RECURSIVE top_suppliers AS (\n    SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost) AS total_supplycost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n    ORDER BY total_supplycost DESC\n    LIMIT 5\n),\ncustomer_orders AS (\n    SELECT c.c_custkey, c.c_name, COUNT(o.o_orderkey) AS order_count, SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n),\ntop_customers AS (\n    SELECT c.c_custkey, c.c_name, co.order_count, co.total_spent\n    FROM customer_orders co\n    JOIN customer c ON c.c_custkey = co.c_custkey\n    ORDER BY co.total_spent DESC\n    LIMIT 10\n)\nSELECT ts.s_name AS supplier_name, tc.c_name AS customer_name, tc.total_spent\nFROM top_suppliers ts\nJOIN lineitem l ON l.l_suppkey = ts.s_suppkey\nJOIN orders o ON o.o_orderkey = l.l_orderkey\nJOIN top_customers tc ON tc.c_custkey = o.o_custkey\nWHERE l.l_shipdate >= '1997-01-01' AND l.l_shipdate < '1997-12-31'\nORDER BY ts.s_name, tc.total_spent DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey AS suppkey,\n       s.s_name AS s_name,\n       SUM(ps.ps_supplycost) AS total_supplycost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name\nORDER BY total_supplycost DESC\nLIMIT 5;", "sql2": "SELECT s1.s_name AS supplier_name,\n       tc.c_name AS customer_name,\n       tc.total_spent\nFROM s1\nJOIN lineitem l ON l.l_suppkey = s1.suppkey\nJOIN orders o ON o.o_orderkey = l.l_orderkey\nJOIN (\n    SELECT c.c_custkey,\n           c.c_name,\n           co.total_spent\n    FROM (\n        SELECT o.o_custkey,\n               SUM(o.o_totalprice) AS total_spent\n        FROM orders o\n        GROUP BY o.o_custkey\n    ) co\n    JOIN customer c ON c.c_custkey = co.o_custkey\n    ORDER BY co.total_spent DESC\n    LIMIT 10\n) tc ON tc.c_custkey = o.o_custkey\nWHERE l.l_shipdate >= TIMESTAMP '1997-01-01'\n  AND l.l_shipdate < TIMESTAMP '1997-12-31'\nORDER BY s1.s_name, tc.total_spent DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "6131.sql", "original_sql": "WITH RegionalSales AS (\n    SELECT \n        r.r_regionkey,\n        r.r_name AS region_name,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n        COUNT(DISTINCT c.c_custkey) AS unique_customers,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM \n        region r\n    JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    JOIN \n        customer c ON o.o_custkey = c.c_custkey\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-10-01'\n    GROUP BY \n        r.r_regionkey, r.r_name\n)\n\nSELECT \n    region_name,\n    total_sales,\n    unique_customers,\n    order_count,\n    total_sales / NULLIF(unique_customers, 0) AS avg_sales_per_customer,\n    total_sales / NULLIF(order_count, 0) AS avg_sales_per_order\nFROM \n    RegionalSales\nORDER BY \n    total_sales DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    r.r_regionkey,\n    r.r_name AS region_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1997-10-01'\nGROUP BY r.r_regionkey, r.r_name;", "sql2": "SELECT \n    region_name,\n    total_sales,\n    unique_customers,\n    order_count,\n    total_sales / NULLIF(unique_customers, 0) AS avg_sales_per_customer,\n    total_sales / NULLIF(order_count, 0) AS avg_sales_per_order\nFROM s1\nORDER BY total_sales DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "6327.sql", "original_sql": "WITH RECURSIVE top_suppliers AS (\n    SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n    ORDER BY total_cost DESC\n    LIMIT 10\n),\nmonthly_sales AS (\n    SELECT \n        EXTRACT(YEAR FROM o.o_orderdate) AS order_year,\n        EXTRACT(MONTH FROM o.o_orderdate) AS order_month,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate >= '1996-01-01' AND o.o_orderdate < '1997-01-01'\n    GROUP BY order_year, order_month\n),\nsupplier_performance AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        COUNT(DISTINCT o.o_orderkey) AS order_count,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n        AVG(l.l_quantity) AS avg_quantity\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31'\n    GROUP BY s.s_suppkey, s.s_name\n)\nSELECT \n    ts.s_name,\n    ts.total_cost,\n    ms.order_year,\n    ms.order_month,\n    ms.total_sales,\n    sp.order_count,\n    sp.revenue,\n    sp.avg_quantity\nFROM top_suppliers ts\nJOIN monthly_sales ms ON TRUE\nJOIN supplier_performance sp ON ts.s_suppkey = sp.s_suppkey\nORDER BY ts.total_cost DESC, ms.order_year, ms.order_month;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name\nORDER BY total_cost DESC\nLIMIT 10;", "sql2": "WITH monthly_sales AS (\n    SELECT EXTRACT(YEAR FROM o.o_orderdate) AS order_year,\n           EXTRACT(MONTH FROM o.o_orderdate) AS order_month,\n           SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\n    FROM orders o\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\n    GROUP BY order_year, order_month\n),\nsupplier_performance AS (\n    SELECT s.s_suppkey,\n           COUNT(DISTINCT o.o_orderkey) AS order_count,\n           SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n           AVG(l.l_quantity) AS avg_quantity\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE o.o_orderdate BETWEEN DATE '1996-01-01' AND DATE '1996-12-31'\n    GROUP BY s.s_suppkey\n)\nSELECT s1.s_name,\n       s1.total_cost,\n       ms.order_year,\n       ms.order_month,\n       ms.total_sales,\n       sp.order_count,\n       sp.revenue,\n       sp.avg_quantity\nFROM s1\nJOIN monthly_sales ms ON TRUE\nJOIN supplier_performance sp ON s1.s_suppkey = sp.s_suppkey\nORDER BY s1.total_cost DESC, ms.order_year, ms.order_month;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "6331.sql", "original_sql": "WITH SupplierSummary AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        n.n_name AS supplier_nation,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name, n.n_name\n),\n\nCustomerOrders AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        SUM(o.o_totalprice) AS total_order_value\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01'\n    GROUP BY \n        c.c_custkey, c.c_name\n),\n\nJoinSummary AS (\n    SELECT \n        ss.supplier_nation,\n        co.c_name,\n        co.total_order_value,\n        ss.total_supply_cost\n    FROM \n        CustomerOrders co\n    JOIN \n        SupplierSummary ss ON co.c_custkey % 10 = ss.s_suppkey % 10\n)\n\nSELECT \n    supplier_nation,\n    AVG(total_order_value) AS avg_order_value,\n    SUM(total_supply_cost) AS total_supply_cost\nFROM \n    JoinSummary\nGROUP BY \n    supplier_nation\nORDER BY \n    supplier_nation;", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 'c_custkey' not found in 'o'\", span: None, notes: [DiagnosticNote { message: \"possible column c.c_custkey\", span: None }, DiagnosticNote { message: \"possible column o.o_custkey\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"o\" }), name: \"c_custkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"c\" }), name: \"c_custkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_name\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_address\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_nationkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_phone\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_acctbal\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_mktsegment\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_comment\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_custkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderstatus\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_totalprice\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderdate\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderpriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_clerk\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_shippriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_comment\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "6480.sql", "original_sql": "\nWITH RegionalSuppliers AS (\n    SELECT \n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        SUM(s.s_acctbal) AS total_acctbal\n    FROM \n        supplier s\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    GROUP BY \n        n.n_name, r.r_name\n),\nPartSupplies AS (\n    SELECT \n        p.p_name,\n        ps.ps_availqty,\n        ps.ps_supplycost,\n        ps.ps_comment,\n        r.r_name AS region_name\n    FROM \n        part p\n    JOIN \n        partsupp ps ON p.p_partkey = ps.ps_partkey\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    WHERE \n        ps.ps_availqty > 0\n)\nSELECT \n    rs.nation_name,\n    rs.region_name,\n    AVG(ps.ps_supplycost) AS avg_supply_cost,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    COUNT(DISTINCT ps.p_name) AS part_count\nFROM \n    RegionalSuppliers rs\nLEFT JOIN \n    PartSupplies ps ON rs.region_name = ps.region_name\nGROUP BY \n    rs.nation_name, rs.region_name\nORDER BY \n    rs.region_name, avg_supply_cost DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    p.p_name,\n    ps.ps_availqty,\n    ps.ps_supplycost,\n    ps.ps_comment,\n    r.r_name AS region_name\nFROM part p\nJOIN partsupp ps ON p.p_partkey = ps.ps_partkey\nJOIN supplier s ON ps.ps_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE ps.ps_availqty > 0;", "sql2": "WITH RegionalSuppliers AS (\n    SELECT \n        n.n_name AS nation_name,\n        r.r_name AS region_name,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        SUM(s.s_acctbal) AS total_acctbal\n    FROM supplier s\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n    GROUP BY n.n_name, r.r_name\n)\nSELECT \n    rs.nation_name,\n    rs.region_name,\n    AVG(ps.ps_supplycost) AS avg_supply_cost,\n    SUM(ps.ps_availqty) AS total_available_quantity,\n    COUNT(DISTINCT ps.p_name) AS part_count\nFROM RegionalSuppliers rs\nLEFT JOIN s1 ps ON rs.region_name = ps.region_name\nGROUP BY rs.nation_name, rs.region_name\nORDER BY rs.region_name, avg_supply_cost DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "6536.sql", "original_sql": "WITH RevenueData AS (\n    SELECT \n        n.n_name AS nation_name,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n        COUNT(DISTINCT o.o_orderkey) AS total_orders\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\n    GROUP BY \n        n.n_name\n),\nTieredRevenue AS (\n    SELECT \n        nation_name,\n        total_revenue,\n        total_orders,\n        CASE \n            WHEN total_revenue >= 1000000 THEN 'High'\n            WHEN total_revenue >= 500000 THEN 'Medium'\n            ELSE 'Low'\n        END AS revenue_tier\n    FROM \n        RevenueData\n)\nSELECT \n    revenue_tier,\n    COUNT(nation_name) AS nation_count,\n    AVG(total_revenue) AS avg_revenue,\n    SUM(total_orders) AS total_orders_aggregated\nFROM \n    TieredRevenue\nGROUP BY \n    revenue_tier\nORDER BY \n    revenue_tier DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    n.n_name AS nation_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders\nFROM nation n\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nWHERE o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\nGROUP BY n.n_name;", "sql2": "WITH TieredRevenue AS (\n    SELECT \n        nation_name,\n        total_revenue,\n        total_orders,\n        CASE \n            WHEN total_revenue >= 1000000 THEN 'High'\n            WHEN total_revenue >= 500000 THEN 'Medium'\n            ELSE 'Low'\n        END AS revenue_tier\n    FROM s1\n)\nSELECT \n    revenue_tier,\n    COUNT(nation_name) AS nation_count,\n    AVG(total_revenue) AS avg_revenue,\n    SUM(total_orders) AS total_orders_aggregated\nFROM TieredRevenue\nGROUP BY revenue_tier\nORDER BY revenue_tier DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "6720.sql", "original_sql": "\nSELECT \n    n.n_name AS nation_name, \n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(c.c_acctbal) AS avg_customer_balance\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nWHERE \n    l.l_shipdate >= '1997-01-01' AND l.l_shipdate < '1997-12-31'\nGROUP BY \n    n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000000\nORDER BY \n    total_revenue DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "7199.sql", "original_sql": "\nWITH SupplierStats AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(ps.ps_availqty) AS total_available,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_value\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n),\nTopRegions AS (\n    SELECT \n        n.n_regionkey,\n        r.r_name,\n        SUM(o.o_totalprice) AS total_order_value\n    FROM \n        region r\n    JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    JOIN \n        customer c ON n.n_nationkey = c.c_nationkey\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    GROUP BY \n        n.n_regionkey, r.r_name\n    ORDER BY \n        total_order_value DESC\n    LIMIT 5\n)\nSELECT \n    tr.r_name,\n    ss.s_name,\n    ss.total_available,\n    ss.total_supply_value\nFROM \n    SupplierStats ss\nJOIN \n    partsupp ps ON ss.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    TopRegions tr ON ss.s_suppkey = p.p_partkey\nJOIN \n    nation n ON tr.n_regionkey = n.n_regionkey\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nWHERE \n    ss.total_supply_value > 1000000\nORDER BY \n    tr.r_name, ss.total_supply_value DESC;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 's_suppkey' not found in 'ss'\", span: None, notes: [DiagnosticNote { message: \"possible column ps.ps_partkey\", span: None }, DiagnosticNote { message: \"possible column ps.ps_suppkey\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"ss\" }), name: \"s_suppkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"ss\" }), name: \"count\" }, Column { relation: Some(Bare { table: \"ps\" }), name: \"ps_partkey\" }, Column { relation: Some(Bare { table: \"ps\" }), name: \"ps_suppkey\" }, Column { relation: Some(Bare { table: \"ps\" }), name: \"ps_availqty\" }, Column { relation: Some(Bare { table: \"ps\" }), name: \"ps_supplycost\" }, Column { relation: Some(Bare { table: \"ps\" }), name: \"ps_comment\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "7238.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    AVG(o.o_totalprice) AS avg_order_value\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\n    AND n.n_name IN ('USA', 'Germany', 'Japan')\nGROUP BY \n    n.n_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 1000000\nORDER BY \n    total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    n.n_name AS nation_name,\n    l.l_extendedprice * (1 - l.l_discount) AS revenue,\n    c.c_custkey,\n    o.o_orderkey,\n    o.o_totalprice\nFROM customer c\nJOIN orders o ON c.c_custkey = o.o_custkey\nJOIN lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nWHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n  AND n.n_name IN ('USA', 'Germany', 'Japan')", "sql2": "SELECT \n    s1.nation_name,\n    SUM(s1.revenue) AS total_revenue,\n    COUNT(DISTINCT s1.c_custkey) AS unique_customers,\n    COUNT(DISTINCT s1.o_orderkey) AS total_orders,\n    AVG(s1.o_totalprice) AS avg_order_value\nFROM s1\nGROUP BY s1.nation_name\nHAVING SUM(s1.revenue) > 1000000\nORDER BY total_revenue DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "7239.sql", "original_sql": "WITH RankedOrders AS (\n    SELECT o.o_orderkey, o.o_orderdate, o.o_totalprice, \n           RANK() OVER (PARTITION BY o.o_orderstatus ORDER BY o.o_totalprice DESC) as OrderRank\n    FROM orders o\n    WHERE o.o_orderdate >= DATE '1997-01-01' \n      AND o.o_orderdate < DATE '1998-01-01'\n),\nTopCustomers AS (\n    SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS TotalSpent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n    HAVING SUM(o.o_totalprice) > 10000\n),\nSupplierStats AS (\n    SELECT s.s_suppkey, s.s_name, COUNT(ps.ps_partkey) AS TotalSupplied, \n           SUM(ps.ps_supplycost * ps.ps_availqty) AS TotalSupplyCost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n    HAVING COUNT(ps.ps_partkey) > 5\n)\nSELECT r.r_name AS Region, \n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS Revenue, \n       COUNT(DISTINCT o.o_orderkey) AS OrderCount,\n       COUNT(DISTINCT c.c_custkey) AS CustomerCount,\n       COUNT(DISTINCT ss.s_suppkey) AS SupplierCount\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nJOIN SupplierStats ss ON l.l_suppkey = ss.s_suppkey\nWHERE l.l_shipdate >= DATE '1997-04-01' \n  AND l.l_shipdate < DATE '1997-10-01'\nGROUP BY r.r_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 50000\nORDER BY Revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       COUNT(ps.ps_partkey) AS total_supplied,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name\nHAVING COUNT(ps.ps_partkey) > 5;", "sql2": "SELECT r.r_name AS Region,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS Revenue,\n       COUNT(DISTINCT o.o_orderkey) AS OrderCount,\n       COUNT(DISTINCT c.c_custkey) AS CustomerCount,\n       COUNT(DISTINCT ss.s_suppkey) AS SupplierCount\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nJOIN s1 ss ON l.l_suppkey = ss.s_suppkey\nWHERE l.l_shipdate >= DATE '1997-04-01'\n  AND l.l_shipdate < DATE '1997-10-01'\nGROUP BY r.r_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 50000\nORDER BY Revenue DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "7370.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    r.r_name AS region_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS number_of_orders,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers\nFROM \n    region r\nJOIN \n    nation n ON r.r_regionkey = n.n_regionkey\nJOIN \n    supplier s ON n.n_nationkey = s.s_nationkey\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1997-10-01'\n    AND l.l_shipmode IN ('AIR', 'TRUCK')\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT n.n_name AS nation_name,\n       r.r_name AS region_name,\n       o.o_orderkey,\n       c.c_custkey,\n       l.l_extendedprice,\n       l.l_discount\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nJOIN supplier s ON n.n_nationkey = s.s_nationkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-10-01'\n  AND l.l_shipmode IN ('AIR', 'TRUCK')", "sql2": "SELECT s1.nation_name,\n       s1.region_name,\n       SUM(s1.l_extendedprice * (1 - s1.l_discount)) AS total_revenue,\n       COUNT(DISTINCT s1.o_orderkey) AS number_of_orders,\n       COUNT(DISTINCT s1.c_custkey) AS unique_customers\nFROM s1\nGROUP BY s1.nation_name, s1.region_name\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "7950.sql", "original_sql": "\nWITH RankedSuppliers AS (\n    SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_value\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n), HighValueOrders AS (\n    SELECT o.o_orderkey, o.o_totalprice, c.c_name\n    FROM orders o\n    JOIN customer c ON o.o_custkey = c.c_custkey\n    WHERE o.o_totalprice > (SELECT AVG(o_totalprice) FROM orders)\n), OrderLineInfo AS (\n    SELECT l.l_orderkey, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_line_value\n    FROM lineitem l\n    GROUP BY l.l_orderkey\n), FinalReport AS (\n    SELECT hv.o_orderkey, hv.o_totalprice, hv.c_name, rs.s_name, rs.total_supply_value, oli.total_line_value\n    FROM HighValueOrders hv\n    JOIN RankedSuppliers rs ON hv.o_orderkey = rs.s_suppkey\n    JOIN OrderLineInfo oli ON hv.o_orderkey = oli.l_orderkey\n)\nSELECT o.o_orderkey, o.o_totalprice, o.c_name, s.s_name, s.total_supply_value, li.total_line_value\nFROM FinalReport o\nJOIN RankedSuppliers s ON o.s_name = s.s_name\nJOIN OrderLineInfo li ON o.o_orderkey = li.l_orderkey\nWHERE s.total_supply_value > 100000\nORDER BY o.o_totalprice DESC, s.total_supply_value ASC\nLIMIT 50;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "WITH HighValueOrders AS (\n    SELECT o.o_orderkey, o.o_totalprice, c.c_name\n    FROM orders o\n    JOIN customer c ON o.o_custkey = c.c_custkey\n    WHERE o.o_totalprice > (SELECT AVG(o_totalprice) FROM orders)\n), OrderLineInfo AS (\n    SELECT l.l_orderkey, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_line_value\n    FROM lineitem l\n    GROUP BY l.l_orderkey\n), HV_OLI AS (\n    SELECT hv.o_orderkey,\n           hv.o_totalprice,\n           hv.c_name,\n           oli.total_line_value\n    FROM HighValueOrders hv\n    JOIN OrderLineInfo oli ON hv.o_orderkey = oli.l_orderkey\n)\nSELECT * FROM HV_OLI;", "sql2": "WITH RankedSuppliers AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_value\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n)\nSELECT s1.o_orderkey,\n       s1.o_totalprice,\n       s1.c_name,\n       rs.s_name,\n       rs.total_supply_value,\n       s1.total_line_value\nFROM s1\nJOIN RankedSuppliers rs ON s1.o_orderkey = rs.s_suppkey\nWHERE rs.total_supply_value > 100000\nORDER BY s1.o_totalprice DESC, rs.total_supply_value ASC\nLIMIT 50;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8042.sql", "original_sql": "WITH SupplierOrders AS (\n    SELECT s.s_suppkey, s.s_name, COUNT(o.o_orderkey) AS order_count, SUM(l.l_extendedprice) AS total_revenue\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE o.o_orderstatus = 'O'  \n    GROUP BY s.s_suppkey, s.s_name\n),\nTopSuppliers AS (\n    SELECT s_suppkey, s_name, order_count, total_revenue\n    FROM SupplierOrders\n    ORDER BY total_revenue DESC\n    LIMIT 10\n)\nSELECT ts.s_name, ts.order_count, ts.total_revenue, p.p_name, p.p_mfgr, p.p_type, r.r_name\nFROM TopSuppliers ts\nJOIN partsupp ps ON ts.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN supplier s ON ts.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_retailprice > 100.00\nORDER BY ts.total_revenue DESC, p.p_name;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH SupplierOrders AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           COUNT(o.o_orderkey) AS order_count,\n           SUM(l.l_extendedprice) AS total_revenue\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    JOIN orders o ON l.l_orderkey = o.o_orderkey\n    WHERE o.o_orderstatus = 'O'\n    GROUP BY s.s_suppkey, s.s_name\n)\nSELECT s_suppkey,\n       s_name,\n       order_count,\n       total_revenue\nFROM SupplierOrders\nORDER BY total_revenue DESC\nLIMIT 10;", "sql2": "SELECT ts.s_name,\n       ts.order_count,\n       ts.total_revenue,\n       p.p_name,\n       p.p_mfgr,\n       p.p_type,\n       r.r_name\nFROM s1 ts\nJOIN partsupp ps ON ts.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN supplier s ON ts.s_suppkey = s.s_suppkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE p.p_retailprice > 100.00\nORDER BY ts.total_revenue DESC, p.p_name;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8057.sql", "original_sql": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders,\n    COUNT(DISTINCT c.c_custkey) AS unique_customers,\n    AVG(o.o_totalprice) AS average_order_value\nFROM \n    supplier s\nJOIN \n    partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN \n    part p ON ps.ps_partkey = p.p_partkey\nJOIN \n    lineitem l ON p.p_partkey = l.l_partkey\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= DATE '1996-01-01'\n    AND o.o_orderdate < DATE '1997-01-01'\n    AND l.l_shipmode IN ('TRUCK', 'AIR')\nGROUP BY \n    n.n_name, r.r_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT \n    n.n_name AS nation,\n    r.r_name AS region,\n    l.l_extendedprice * (1 - l.l_discount) AS revenue,\n    o.o_orderkey,\n    c.c_custkey,\n    o.o_totalprice\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN part p ON ps.ps_partkey = p.p_partkey\nJOIN lineitem l ON p.p_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE o.o_orderdate >= DATE '1996-01-01'\n  AND o.o_orderdate < DATE '1997-01-01'\n  AND l.l_shipmode IN ('TRUCK', 'AIR');", "sql2": "SELECT \n    nation,\n    region,\n    SUM(revenue) AS total_revenue,\n    COUNT(DISTINCT o_orderkey) AS total_orders,\n    COUNT(DISTINCT c_custkey) AS unique_customers,\n    AVG(o_totalprice) AS average_order_value\nFROM s1\nGROUP BY nation, region\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8268.sql", "original_sql": "SELECT \n    n.n_name AS nation, \n    SUM(o.o_totalprice) AS total_revenue,\n    COUNT(DISTINCT c.c_custkey) AS num_customers,\n    AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'AMERICA'\n    AND o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_orderkey,\n       o.o_custkey,\n       o.o_totalprice,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS sum_discounted_price,\n       COUNT(*) AS lineitem_cnt\nFROM orders o\nJOIN lineitem l ON o.o_orderkey = l.l_orderkey\nWHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY o.o_orderkey, o.o_custkey, o.o_totalprice", "sql2": "SELECT n.n_name AS nation,\n       SUM(s1.o_totalprice) AS total_revenue,\n       COUNT(DISTINCT s1.o_custkey) AS num_customers,\n       SUM(s1.sum_discounted_price) / SUM(s1.lineitem_cnt) AS avg_discounted_price\nFROM s1\nJOIN customer c ON s1.o_custkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'AMERICA'\nGROUP BY n.n_name\nORDER BY total_revenue DESC\nLIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8446.sql", "original_sql": "WITH supplier_details AS (\n    SELECT s.s_suppkey, s.s_name, s.s_nationkey, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name, s.s_nationkey\n),\ncustomer_order_summary AS (\n    SELECT c.c_custkey, c.c_name, c.c_nationkey, COUNT(o.o_orderkey) AS order_count, SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    WHERE o.o_orderstatus = 'F' \n    GROUP BY c.c_custkey, c.c_name, c.c_nationkey\n),\nnation_summary AS (\n    SELECT n.n_nationkey, n.n_name, COUNT(s.s_suppkey) AS supplier_count\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_nationkey, n.n_name\n)\nSELECT \n    ns.n_name,\n    cs.c_name,\n    sd.s_name,\n    sd.total_cost,\n    cs.order_count,\n    cs.total_spent,\n    ns.supplier_count\nFROM customer_order_summary cs\nJOIN supplier_details sd ON cs.c_nationkey = sd.s_nationkey\nJOIN nation_summary ns ON cs.c_nationkey = ns.n_nationkey\nWHERE sd.total_cost > 100000 \nORDER BY cs.total_spent DESC, sd.total_cost DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey,\n       s.s_name,\n       s.s_nationkey,\n       SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name, s.s_nationkey;", "sql2": "WITH customer_order_summary AS (\n    SELECT c.c_custkey,\n           c.c_name,\n           c.c_nationkey,\n           COUNT(o.o_orderkey) AS order_count,\n           SUM(o.o_totalprice) AS total_spent\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    WHERE o.o_orderstatus = 'F'\n    GROUP BY c.c_custkey, c.c_name, c.c_nationkey\n),\nnation_summary AS (\n    SELECT n.n_nationkey,\n           n.n_name,\n           COUNT(s.s_suppkey) AS supplier_count\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_nationkey, n.n_name\n)\nSELECT \n    ns.n_name,\n    cs.c_name,\n    s1.s_name,\n    s1.total_cost,\n    cs.order_count,\n    cs.total_spent,\n    ns.supplier_count\nFROM customer_order_summary cs\nJOIN s1 ON cs.c_nationkey = s1.s_nationkey\nJOIN nation_summary ns ON cs.c_nationkey = ns.n_nationkey\nWHERE s1.total_cost > 100000\nORDER BY cs.total_spent DESC, s1.total_cost DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8490.sql", "original_sql": "WITH OrderSummary AS (\n    SELECT \n        o.o_orderkey,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n        COUNT(DISTINCT o.o_custkey) AS unique_customers,\n        AVG(c.c_acctbal) AS avg_customer_balance,\n        MAX(l.l_shipdate) AS last_ship_date\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    JOIN \n        customer c ON o.o_custkey = c.c_custkey\n    WHERE \n        o.o_orderdate >= DATE '1997-01-01' \n        AND o.o_orderdate < DATE '1998-01-01'\n    GROUP BY \n        o.o_orderkey\n),\nSupplierSummary AS (\n    SELECT \n        ps.ps_suppkey,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_value,\n        COUNT(DISTINCT p.p_partkey) AS total_parts_supplied\n    FROM \n        partsupp ps\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    GROUP BY \n        ps.ps_suppkey\n),\nFinalMetrics AS (\n    SELECT \n        os.o_orderkey,\n        os.total_revenue,\n        os.unique_customers,\n        os.avg_customer_balance,\n        ss.total_supply_value,\n        ss.total_parts_supplied,\n        os.last_ship_date\n    FROM \n        OrderSummary os\n    JOIN \n        SupplierSummary ss ON os.o_orderkey % 10 = ss.ps_suppkey % 10  \n)\nSELECT \n    f.o_orderkey,\n    f.total_revenue,\n    f.unique_customers,\n    f.avg_customer_balance,\n    f.total_supply_value,\n    f.total_parts_supplied,\n    f.last_ship_date\nFROM \n    FinalMetrics f\nORDER BY \n    f.total_revenue DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "8678.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    nation n ON s.s_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'ASIA'\n    AND o.o_orderdate >= DATE '1997-01-01'\n    AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    n.n_name\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey AS suppkey, n.n_name AS nation_name\nFROM supplier s\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'ASIA';", "sql2": "SELECT s1.nation_name,\n       SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n       COUNT(DISTINCT o.o_orderkey) AS order_count\nFROM lineitem l\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN s1 ON l.l_suppkey = s1.suppkey\nWHERE o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY s1.nation_name\nORDER BY total_revenue DESC\nLIMIT 10;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8685.sql", "original_sql": "WITH OrderDetails AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        o.o_totalprice,\n        c.c_name,\n        l.l_quantity,\n        l.l_extendedprice,\n        l.l_discount,\n        l.l_tax,\n        s.s_name AS supplier_name,\n        p.p_name AS part_name,\n        ps.ps_supplycost,\n        (l.l_extendedprice * (1 - l.l_discount)) AS discounted_price\n    FROM \n        orders o\n    JOIN \n        customer c ON o.o_custkey = c.c_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    JOIN \n        partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\n    JOIN \n        supplier s ON ps.ps_suppkey = s.s_suppkey\n    JOIN \n        part p ON l.l_partkey = p.p_partkey\n    WHERE \n        o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\n),\nSummary AS (\n    SELECT \n        od.o_orderkey,\n        COUNT(*) AS total_items,\n        SUM(od.discounted_price) AS total_discounted_price,\n        SUM(od.l_quantity) AS total_quantity,\n        AVG(od.ps_supplycost) AS avg_supply_cost\n    FROM \n        OrderDetails od\n    GROUP BY \n        od.o_orderkey\n)\nSELECT \n    s.o_orderkey,\n    s.total_items,\n    s.total_discounted_price,\n    s.total_quantity,\n    s.avg_supply_cost,\n    r.r_name AS region_name\nFROM \n    Summary s\nJOIN \n    customer c ON s.o_orderkey = c.c_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    s.total_discounted_price > 10000\nORDER BY \n    s.total_discounted_price DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT od.o_orderkey,\n       COUNT(*) AS total_items,\n       SUM(od.discounted_price) AS total_discounted_price,\n       SUM(od.l_quantity) AS total_quantity,\n       AVG(od.ps_supplycost) AS avg_supply_cost\nFROM (\n    SELECT o.o_orderkey,\n           o.o_orderdate,\n           o.o_totalprice,\n           c.c_name,\n           l.l_quantity,\n           l.l_extendedprice,\n           l.l_discount,\n           l.l_tax,\n           s.s_name AS supplier_name,\n           p.p_name AS part_name,\n           ps.ps_supplycost,\n           (l.l_extendedprice * (1 - l.l_discount)) AS discounted_price\n    FROM orders o\n    JOIN customer c ON o.o_custkey = c.c_custkey\n    JOIN lineitem l ON o.o_orderkey = l.l_orderkey\n    JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey\n    JOIN supplier s ON ps.ps_suppkey = s.s_suppkey\n    JOIN part p ON l.l_partkey = p.p_partkey\n    WHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n) od\nGROUP BY od.o_orderkey", "sql2": "SELECT s.o_orderkey,\n       s.total_items,\n       s.total_discounted_price,\n       s.total_quantity,\n       s.avg_supply_cost,\n       r.r_name AS region_name\nFROM s1 s\nJOIN customer c ON s.o_orderkey = c.c_custkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE s.total_discounted_price > 10000\nORDER BY s.total_discounted_price DESC", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "8863.sql", "original_sql": "WITH SupplierPartCost AS (\n    SELECT s.s_suppkey, s.s_name, ps.ps_partkey, ps.ps_supplycost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n),\nTotalCosts AS (\n    SELECT spc.s_suppkey, spc.s_name, SUM(spc.ps_supplycost * ps.ps_availqty) AS total_cost\n    FROM SupplierPartCost spc\n    JOIN partsupp ps ON spc.ps_partkey = ps.ps_partkey\n    GROUP BY spc.s_suppkey, spc.s_name\n),\nCustomerOrderTotals AS (\n    SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS total_order_value\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT cot.c_name AS customer_name, cot.total_order_value AS total_orders,\n       tc.s_name AS supplier_name, tc.total_cost AS supplier_cost\nFROM CustomerOrderTotals cot\nJOIN TotalCosts tc ON cot.total_order_value > tc.total_cost\nWHERE cot.total_order_value > 10000\nORDER BY cot.total_order_value DESC, tc.total_cost ASC;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH SupplierPartCost AS (\n    SELECT s.s_suppkey,\n           s.s_name,\n           ps.ps_partkey,\n           ps.ps_supplycost,\n           ps.ps_availqty\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n),\nTotalCosts AS (\n    SELECT spc.s_suppkey,\n           spc.s_name,\n           SUM(spc.ps_supplycost * spc.ps_availqty) AS total_cost\n    FROM SupplierPartCost spc\n    GROUP BY spc.s_suppkey, spc.s_name\n)\nSELECT s_suppkey, s_name, total_cost FROM TotalCosts;", "sql2": "WITH CustomerOrderTotals AS (\n    SELECT c.c_custkey,\n           c.c_name,\n           SUM(o.o_totalprice) AS total_order_value\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT cot.c_name AS customer_name,\n       cot.total_order_value AS total_orders,\n       tc.s_name AS supplier_name,\n       tc.total_cost AS supplier_cost\nFROM CustomerOrderTotals cot\nCROSS JOIN s1 tc\nWHERE cot.total_order_value > tc.total_cost\n  AND cot.total_order_value > 10000\nORDER BY cot.total_order_value DESC, tc.total_cost ASC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "8916.sql", "original_sql": "WITH TopSuppliers AS (\n    SELECT \n        s.s_suppkey, \n        s.s_name, \n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n    ORDER BY \n        total_supply_cost DESC\n    LIMIT 10\n),\nOrdersSummary AS (\n    SELECT \n        o.o_orderkey, \n        o.o_orderdate, \n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    GROUP BY \n        o.o_orderkey, o.o_orderdate\n),\nRegionNation AS (\n    SELECT \n        n.n_nationkey, \n        n.n_name, \n        r.r_regionkey, \n        r.r_name\n    FROM \n        nation n\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT \n    rn.r_name AS region_name,\n    rn.n_name AS nation_name,\n    ts.s_name AS supplier_name,\n    os.total_revenue,\n    os.o_orderdate\nFROM \n    OrdersSummary os\nJOIN \n    TopSuppliers ts ON ts.s_suppkey = (SELECT ps.ps_suppkey FROM partsupp ps JOIN lineitem l ON ps.ps_partkey = l.l_partkey WHERE l.l_orderkey = os.o_orderkey LIMIT 1)\nJOIN \n    lineitem l ON os.o_orderkey = l.l_orderkey\nJOIN \n    RegionNation rn ON rn.n_nationkey = (SELECT c.c_nationkey FROM customer c WHERE c.c_custkey = os.o_orderkey LIMIT 1)\nWHERE \n    os.total_revenue > 10000\nORDER BY \n    region_name, total_revenue DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "9162.sql", "original_sql": "WITH TotalSupplierCost AS (\n    SELECT \n        ps.ps_partkey, \n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_cost\n    FROM \n        partsupp ps\n    GROUP BY \n        ps.ps_partkey\n),\n\nMaxSupplierCost AS (\n    SELECT \n        p.p_partkey, \n        p.p_name, \n        r.r_name AS region_name,\n        MAX(t.total_cost) AS max_cost\n    FROM \n        part p\n    JOIN \n        TotalSupplierCost t ON p.p_partkey = t.ps_partkey\n    JOIN \n        supplier s ON s.s_suppkey = (SELECT ps.ps_suppkey FROM partsupp ps WHERE ps.ps_partkey = p.p_partkey LIMIT 1)\n    JOIN \n        nation n ON s.s_nationkey = n.n_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    GROUP BY \n        p.p_partkey, p.p_name, r.r_name\n),\n\nQualifiedSuppliers AS (\n    SELECT \n        o.o_orderkey, \n        c.c_name, \n        l.l_linenumber, \n        l.l_quantity, \n        l.l_extendedprice, \n        MAX(m.max_cost) AS max_part_cost\n    FROM \n        orders o\n    JOIN \n        customer c ON o.o_custkey = c.c_custkey\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    JOIN \n        MaxSupplierCost m ON l.l_partkey = m.p_partkey\n    WHERE \n        l.l_quantity > 50 AND \n        o.o_orderstatus = 'F'\n    GROUP BY \n        o.o_orderkey, c.c_name, l.l_linenumber, l.l_quantity, l.l_extendedprice\n)\n\nSELECT \n    qs.o_orderkey,\n    qs.c_name,\n    SUM(qs.l_extendedprice) AS total_extended_price,\n    COUNT(DISTINCT qs.l_linenumber) AS unique_line_items,\n    AVG(qs.max_part_cost) AS average_max_part_cost\nFROM \n    QualifiedSuppliers qs\nGROUP BY \n    qs.o_orderkey, qs.c_name\nORDER BY \n    total_extended_price DESC\nLIMIT 10;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "9176.sql", "original_sql": "\nWITH supplier_summary AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        s.s_nationkey,\n        SUM(ps.ps_availqty) AS total_available_quantity,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name, s.s_nationkey\n),\norder_summary AS (\n    SELECT \n        o.o_orderkey,\n        COUNT(l.l_linenumber) AS line_item_count,\n        SUM(l.l_extendedprice) AS total_order_value,\n        o.o_orderdate,\n        o.o_orderstatus,\n        o.o_custkey\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    GROUP BY \n        o.o_orderkey, o.o_orderdate, o.o_orderstatus, o.o_custkey\n),\nnation_summary AS (\n    SELECT \n        n.n_nationkey,\n        n.n_name,\n        r.r_regionkey,\n        COUNT(DISTINCT s.s_suppkey) AS supplier_count,\n        SUM(ss.total_supply_cost) AS total_supply_cost_per_nation\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        region r ON n.n_regionkey = r.r_regionkey\n    JOIN \n        supplier_summary ss ON s.s_suppkey = ss.s_suppkey\n    GROUP BY \n        n.n_nationkey, n.n_name, r.r_regionkey\n)\nSELECT \n    ns.n_name AS nation_name,\n    ns.supplier_count,\n    ns.total_supply_cost_per_nation,\n    os.line_item_count,\n    os.total_order_value,\n    os.o_orderstatus\nFROM \n    nation_summary ns\nJOIN \n    order_summary os ON ns.n_nationkey = (SELECT c.c_nationkey FROM customer c WHERE c.c_custkey = os.o_custkey)\nWHERE \n    ns.total_supply_cost_per_nation > 10000\nORDER BY \n    os.total_order_value DESC, ns.supplier_count ASC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "9177.sql", "original_sql": "WITH SupplierAgg AS (\n    SELECT s_nationkey, SUM(ps_supplycost * ps_availqty) AS total_cost\n    FROM supplier\n    JOIN partsupp ON s_suppkey = ps_suppkey\n    GROUP BY s_nationkey\n),\nCustomerOrders AS (\n    SELECT c_nationkey, COUNT(o_orderkey) AS order_count, SUM(o_totalprice) AS total_revenue\n    FROM customer\n    JOIN orders ON c_custkey = o_custkey\n    GROUP BY c_nationkey\n)\nSELECT r.r_name AS region_name,\n       n.n_name AS nation_name,\n       COALESCE(c.order_count, 0) AS total_orders,\n       COALESCE(c.total_revenue, 0) AS total_revenue,\n       COALESCE(s.total_cost, 0) AS total_supplier_cost\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN CustomerOrders c ON n.n_nationkey = c.c_nationkey\nLEFT JOIN SupplierAgg s ON n.n_nationkey = s.s_nationkey\nWHERE r.r_name = 'ASIA'\nORDER BY total_orders DESC, total_supplier_cost DESC;\n", "has_cut": true, "q1_engine": "datafusion", "q2_engine": "duckdb", "sql1": "SELECT s_nationkey, SUM(ps_supplycost * ps_availqty) AS total_cost\nFROM supplier\nJOIN partsupp ON s_suppkey = ps_suppkey\nGROUP BY s_nationkey", "sql2": "WITH CustomerOrders AS (\n    SELECT c_nationkey, COUNT(o_orderkey) AS order_count, SUM(o_totalprice) AS total_revenue\n    FROM customer\n    JOIN orders ON c_custkey = o_custkey\n    GROUP BY c_nationkey\n)\nSELECT r.r_name AS region_name,\n       n.n_name AS nation_name,\n       COALESCE(c.order_count, 0) AS total_orders,\n       COALESCE(c.total_revenue, 0) AS total_revenue,\n       COALESCE(s.total_cost, 0) AS total_supplier_cost\nFROM region r\nJOIN nation n ON r.r_regionkey = n.n_regionkey\nLEFT JOIN CustomerOrders c ON n.n_nationkey = c.c_nationkey\nLEFT JOIN s1 s ON n.n_nationkey = s.s_nationkey\nWHERE r.r_name = 'ASIA'\nORDER BY total_orders DESC, total_supplier_cost DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "9188.sql", "original_sql": "\nWITH RegionalSales AS (\n    SELECT \n        r.r_name AS region_name,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales,\n        COUNT(DISTINCT o.o_orderkey) AS order_count\n    FROM \n        region r\n    JOIN \n        nation n ON r.r_regionkey = n.n_regionkey\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        o.o_orderdate >= DATE '1996-01-01' AND o.o_orderdate < DATE '1997-01-01'\n    GROUP BY \n        r.r_name\n),\nAverageSales AS (\n    SELECT \n        AVG(total_sales) AS avg_sales,\n        AVG(order_count) AS avg_order_count\n    FROM \n        RegionalSales\n)\nSELECT \n    rs.region_name,\n    rs.total_sales,\n    rs.order_count,\n    (rs.total_sales - avg.avg_sales) / NULLIF(avg.avg_sales, 0) * 100 AS sales_variance_percentage,\n    (rs.order_count - avg.avg_order_count) / NULLIF(avg.avg_order_count, 0) * 100 AS order_count_variance_percentage\nFROM \n    RegionalSales rs\nCROSS JOIN \n    AverageSales avg\nORDER BY \n    rs.total_sales DESC;\n", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "9564.sql", "original_sql": "SELECT \n    c.c_name AS customer_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    n.n_name AS nation_name,\n    o.o_orderdate\nFROM \n    customer c\nJOIN \n    orders o ON c.c_custkey = o.o_custkey\nJOIN \n    lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN \n    supplier s ON l.l_suppkey = s.s_suppkey\nJOIN \n    partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    r.r_name = 'EUROPE' AND \n    o.o_orderdate >= DATE '1997-01-01' AND \n    o.o_orderdate < DATE '1997-12-31'\nGROUP BY \n    c.c_name, n.n_name, o.o_orderdate\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 100000\nORDER BY \n    total_revenue DESC, o.o_orderdate DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT \n    c.c_name AS customer_name,\n    n.n_name AS nation_name,\n    o.o_orderdate AS o_orderdate,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\nFROM customer c\nJOIN orders o ON c.c_custkey = o.o_custkey\nJOIN lineitem l ON o.o_orderkey = l.l_orderkey\nJOIN supplier s ON l.l_suppkey = s.s_suppkey\nJOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND s.s_suppkey = ps.ps_suppkey\nJOIN nation n ON c.c_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nWHERE r.r_name = 'EUROPE'\n  AND o.o_orderdate >= DATE '1997-01-01'\n  AND o.o_orderdate < DATE '1997-12-31'\nGROUP BY c.c_name, n.n_name, o.o_orderdate;", "sql2": "SELECT \n    customer_name,\n    total_revenue,\n    nation_name,\n    o_orderdate\nFROM s1\nWHERE total_revenue > 100000\nORDER BY total_revenue DESC, o_orderdate DESC;", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "9598.sql", "original_sql": "WITH RECURSIVE SalesData AS (\n    SELECT \n        n.n_name AS nation, \n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        o.o_orderdate >= '1997-01-01' AND o.o_orderdate < '1997-10-01'\n    GROUP BY \n        n.n_name\n    UNION ALL\n    SELECT \n        n.n_name AS nation, \n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_sales\n    FROM \n        nation n\n    JOIN \n        supplier s ON n.n_nationkey = s.s_nationkey\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN \n        part p ON ps.ps_partkey = p.p_partkey\n    JOIN \n        lineitem l ON p.p_partkey = l.l_partkey\n    JOIN \n        orders o ON l.l_orderkey = o.o_orderkey\n    WHERE \n        o.o_orderdate >= '1996-01-01' AND o.o_orderdate < '1996-10-01'\n    GROUP BY \n        n.n_name\n)\nSELECT \n    nation, \n    SUM(total_sales) AS overall_sales\nFROM \n    SalesData\nGROUP BY \n    nation\nORDER BY \n    overall_sales DESC\nLIMIT 10;", "has_cut": false, "engine_mem_mb": 500000, "llm_raw": {"has_cut": false}}
{"query_id": "9772.sql", "original_sql": "WITH OrderSummary AS (\n    SELECT \n        o.o_orderkey,\n        o.o_orderdate,\n        SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue,\n        COUNT(DISTINCT l.l_suppkey) AS supplier_count\n    FROM \n        orders o\n    JOIN \n        lineitem l ON o.o_orderkey = l.l_orderkey\n    WHERE \n        o.o_orderdate BETWEEN DATE '1994-01-01' AND DATE '1996-12-31'\n    GROUP BY \n        o.o_orderkey, o.o_orderdate\n),\nTopCustomers AS (\n    SELECT \n        c.c_custkey,\n        c.c_name,\n        SUM(os.revenue) AS total_revenue\n    FROM \n        customer c\n    JOIN \n        orders o ON c.c_custkey = o.o_custkey\n    JOIN \n        OrderSummary os ON o.o_orderkey = os.o_orderkey\n    GROUP BY \n        c.c_custkey, c.c_name\n    ORDER BY \n        total_revenue DESC\n    LIMIT 5\n),\nSupplierDetails AS (\n    SELECT \n        s.s_suppkey,\n        s.s_name,\n        SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supplycost\n    FROM \n        supplier s\n    JOIN \n        partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY \n        s.s_suppkey, s.s_name\n)\nSELECT \n    tc.c_name AS Top_Customer,\n    sd.s_name AS Top_Supplier,\n    ROUND(SUM(os.revenue), 2) AS Total_Revenue,\n    ROUND(SUM(sd.total_supplycost), 2) AS Total_Supply_Cost,\n    tc.total_revenue AS Customer_Revenue\nFROM \n    TopCustomers tc\nJOIN \n    OrderSummary os ON tc.c_custkey = os.o_orderkey\nJOIN \n    SupplierDetails sd ON sd.total_supplycost = (\n        SELECT MAX(total_supplycost) FROM SupplierDetails\n    )\nGROUP BY \n    tc.c_name, sd.s_name, tc.total_revenue;\n", "status": "error", "traceback": "Traceback (most recent call last):\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 393, in _child_run_one_query\n    primary_result = _run_distributed_for_engines(q1_engine, q2_engine)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/run_proofOfConcept_paper.py\", line 344, in _run_distributed_for_engines\n    df_row = benchmark_distributed_only(\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/runner/benchmark.py\", line 124, in benchmark_distributed_only\n    distributed_results = runner.run(subqueries)\n                          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 226, in run\n    tbl, elapsed = self._run_single_node(node)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 191, in _run_single_node\n    out_tbl = self._run_on_datafusion(node)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/flexdata-distributed-execution-bis/python/distributed_executor/distributed_runner.py\", line 108, in _run_on_datafusion\n    df = self.ctx.sql(node.sql)\n         ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/u/sba/miniconda3/envs/flexdata/lib/python3.12/site-packages/datafusion/context.py\", line 611, in sql\n    return DataFrame(self.ctx.sql(query))\n                     ^^^^^^^^^^^^^^^^^^^\nException: DataFusion error: Diagnostic(Diagnostic { kind: Error, message: \"column 'o_orderkey' not found in 'os'\", span: None, notes: [DiagnosticNote { message: \"possible column o.o_orderkey\", span: None }, DiagnosticNote { message: \"possible column o.o_custkey\", span: None }, DiagnosticNote { message: \"possible column o.o_orderstatus\", span: None }, DiagnosticNote { message: \"possible column o.o_orderdate\", span: None }, DiagnosticNote { message: \"possible column o.o_orderpriority\", span: None }, DiagnosticNote { message: \"possible column o.o_clerk\", span: None }], helps: [] }, SchemaError(FieldNotFound { field: Column { relation: Some(Bare { table: \"os\" }), name: \"o_orderkey\" }, valid_fields: [Column { relation: Some(Bare { table: \"c\" }), name: \"c_custkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_name\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_address\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_nationkey\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_phone\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_acctbal\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_mktsegment\" }, Column { relation: Some(Bare { table: \"c\" }), name: \"c_comment\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_custkey\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderstatus\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_totalprice\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderdate\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_orderpriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_clerk\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_shippriority\" }, Column { relation: Some(Bare { table: \"o\" }), name: \"o_comment\" }, Column { relation: Some(Bare { table: \"os\" }), name: \"count\" }] }, Some(\"\")))\n", "engine_mem_mb": 500000}
{"query_id": "9942.sql", "original_sql": "WITH TopSuppliers AS (\n    SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name\n    ORDER BY total_supply_cost DESC\n    LIMIT 10\n),\nCustomerOrders AS (\n    SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS total_orders\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n),\nNationRegion AS (\n    SELECT n.n_nationkey, n.n_name, r.r_name\n    FROM nation n\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n)\nSELECT \n    tr.s_name AS supplier_name,\n    co.c_name AS customer_name,\n    nr.n_name AS nation_name,\n    COALESCE(SUM(lo.l_extendedprice * (1 - lo.l_discount)), 0) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders_count\nFROM TopSuppliers tr\nJOIN partsupp ps ON tr.s_suppkey = ps.ps_suppkey\nJOIN lineitem lo ON ps.ps_partkey = lo.l_partkey\nJOIN orders o ON lo.l_orderkey = o.o_orderkey\nJOIN customer co ON o.o_custkey = co.c_custkey\nJOIN NationRegion nr ON co.c_nationkey = nr.n_nationkey\nWHERE lo.l_shipdate BETWEEN '1997-01-01' AND '1997-12-31' AND o.o_orderstatus = 'F'\nGROUP BY tr.s_name, co.c_name, nr.n_name\nORDER BY total_revenue DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s.s_suppkey, s.s_name, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\nFROM supplier s\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nGROUP BY s.s_suppkey, s.s_name\nORDER BY total_supply_cost DESC\nLIMIT 10", "sql2": "SELECT \n    tr.s_name AS supplier_name,\n    co.c_name AS customer_name,\n    nr.n_name AS nation_name,\n    COALESCE(SUM(lo.l_extendedprice * (1 - lo.l_discount)), 0) AS total_revenue,\n    COUNT(DISTINCT o.o_orderkey) AS total_orders_count\nFROM s1 tr\nJOIN partsupp ps ON tr.s_suppkey = ps.ps_suppkey\nJOIN lineitem lo ON ps.ps_partkey = lo.l_partkey\nJOIN orders o ON lo.l_orderkey = o.o_orderkey\nJOIN customer co ON o.o_custkey = co.c_custkey\nJOIN (\n    SELECT n.n_nationkey, n.n_name, r.r_name\n    FROM nation n\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n) nr ON co.c_nationkey = nr.n_nationkey\nWHERE lo.l_shipdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\n  AND o.o_orderstatus = 'F'\nGROUP BY tr.s_name, co.c_name, nr.n_name\nORDER BY total_revenue DESC", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "9969.sql", "original_sql": "SELECT \n    n.n_name AS nation_name,\n    SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue,\n    r.r_name AS region_name\nFROM \n    lineitem l\nJOIN \n    orders o ON l.l_orderkey = o.o_orderkey\nJOIN \n    customer c ON o.o_custkey = c.c_custkey\nJOIN \n    nation n ON c.c_nationkey = n.n_nationkey\nJOIN \n    region r ON n.n_regionkey = r.r_regionkey\nWHERE \n    o.o_orderdate >= DATE '1997-01-01' \n    AND o.o_orderdate < DATE '1998-01-01'\nGROUP BY \n    n.n_name, r.r_name\nHAVING \n    SUM(l.l_extendedprice * (1 - l.l_discount)) > 100000\nORDER BY \n    total_revenue DESC\nLIMIT 10;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT o.o_orderkey, o.o_custkey, SUM(l.l_extendedprice * (1 - l.l_discount)) AS order_rev FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE o.o_orderdate >= DATE '1997-01-01' AND o.o_orderdate < DATE '1998-01-01' GROUP BY o.o_orderkey, o.o_custkey", "sql2": "SELECT n.n_name AS nation_name, SUM(s1.order_rev) AS total_revenue, r.r_name AS region_name FROM s1 JOIN customer c ON s1.o_custkey = c.c_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY n.n_name, r.r_name HAVING SUM(s1.order_rev) > 100000 ORDER BY total_revenue DESC LIMIT 10", "results_match": false, "engine_mem_mb": 500000}
{"query_id": "9980.sql", "original_sql": "WITH RankedSuppliers AS (\n    SELECT s.s_suppkey, s.s_name, s.s_nationkey, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_supply_cost\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    GROUP BY s.s_suppkey, s.s_name, s.s_nationkey\n),\nNationStats AS (\n    SELECT n.n_nationkey, n.n_name, COUNT(DISTINCT c.c_custkey) AS customer_count, \n           SUM(o.o_totalprice) AS total_order_value\n    FROM nation n\n    LEFT JOIN customer c ON n.n_nationkey = c.c_nationkey\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY n.n_nationkey, n.n_name\n),\nAggregatedData AS (\n    SELECT p.p_partkey, p.p_name, p.p_brand, MAX(r.r_name) AS region_name, \n           AVG(rn.total_supply_cost) AS avg_supply_cost, ns.customer_count, ns.total_order_value\n    FROM part p\n    JOIN RankedSuppliers rn ON rn.total_supply_cost > 10000\n    JOIN supplier s ON p.p_partkey = s.s_suppkey\n    JOIN nation n ON s.s_nationkey = n.n_nationkey\n    JOIN region r ON n.n_regionkey = r.r_regionkey\n    JOIN NationStats ns ON n.n_nationkey = ns.n_nationkey\n    GROUP BY p.p_partkey, p.p_name, p.p_brand, ns.customer_count, ns.total_order_value\n)\nSELECT AVG(avg_supply_cost) AS average_supplier_cost, SUM(total_order_value) AS total_sales_value\nFROM AggregatedData\nWHERE region_name IS NOT NULL\nGROUP BY region_name\nORDER BY total_sales_value DESC;\n", "status": "missing_whole_cache", "engine_mem_mb": 500000}
{"query_id": "9982.sql", "original_sql": "WITH SupplierRevenue AS (\n    SELECT s_suppkey, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue\n    FROM supplier\n    JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey\n    JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey\n    GROUP BY s_suppkey\n),\nTopSuppliers AS (\n    SELECT s_suppkey, total_revenue\n    FROM SupplierRevenue\n    ORDER BY total_revenue DESC\n    LIMIT 10\n),\nCustomerOrderCounts AS (\n    SELECT c.c_custkey, COUNT(o.o_orderkey) AS order_count\n    FROM customer c\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey\n)\nSELECT \n    s.s_name AS supplier_name,\n    r.r_name AS region,\n    n.n_name AS nation,\n    SUM(COALESCE(ol.order_count, 0)) AS total_orders\nFROM TopSuppliers ts\nJOIN supplier s ON ts.s_suppkey = s.s_suppkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN CustomerOrderCounts ol ON c.c_custkey = ol.c_custkey\nWHERE o.o_orderdate BETWEEN '1997-01-01' AND '1997-12-31'\nGROUP BY s.s_suppkey, s.s_name, r.r_name, n.n_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 100000\nORDER BY total_orders DESC;", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "SELECT s_suppkey, total_revenue\nFROM (\n    SELECT s.s_suppkey,\n           SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue\n    FROM supplier s\n    JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\n    JOIN lineitem l ON ps.ps_partkey = l.l_partkey\n    GROUP BY s.s_suppkey\n) t\nORDER BY total_revenue DESC\nLIMIT 10;", "sql2": "SELECT \n    s.s_name AS supplier_name,\n    r.r_name AS region,\n    n.n_name AS nation,\n    SUM(COALESCE(oc.order_count, 0)) AS total_orders\nFROM s1 ts\nJOIN supplier s ON ts.s_suppkey = s.s_suppkey\nJOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey\nJOIN lineitem l ON ps.ps_partkey = l.l_partkey\nJOIN orders o ON l.l_orderkey = o.o_orderkey\nJOIN customer c ON o.o_custkey = c.c_custkey\nJOIN nation n ON s.s_nationkey = n.n_nationkey\nJOIN region r ON n.n_regionkey = r.r_regionkey\nLEFT JOIN (\n    SELECT c.c_custkey, COUNT(o.o_orderkey) AS order_count\n    FROM customer c\n    LEFT JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey\n) oc ON c.c_custkey = oc.c_custkey\nWHERE o.o_orderdate BETWEEN DATE '1997-01-01' AND DATE '1997-12-31'\nGROUP BY s.s_suppkey, s.s_name, r.r_name, n.n_name\nHAVING SUM(l.l_extendedprice * (1 - l.l_discount)) > 100000\nORDER BY total_orders DESC;", "results_match": true, "engine_mem_mb": 500000}
{"query_id": "9995.sql", "original_sql": "WITH ranked_nations AS (\n    SELECT n.n_name, n.n_regionkey, COUNT(s.s_suppkey) AS supplier_count\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_name, n.n_regionkey\n),\ntotal_parts AS (\n    SELECT ps.ps_suppkey, SUM(ps.ps_availqty) AS total_available\n    FROM partsupp ps\n    GROUP BY ps.ps_suppkey\n),\norder_summary AS (\n    SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS customer_total\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey, c.c_name\n)\nSELECT rn.n_name AS nation_name,\n       COUNT(DISTINCT os.c_custkey) AS total_customers,\n       SUM(tp.total_available) AS total_parts_available,\n       AVG(os.customer_total) AS avg_customer_spending\nFROM ranked_nations rn\nJOIN total_parts tp ON rn.supplier_count > 10\nJOIN order_summary os ON rn.n_regionkey = (SELECT r.r_regionkey FROM region r WHERE r.r_name = 'Asia')\nWHERE rn.supplier_count IS NOT NULL\nGROUP BY rn.n_name\nORDER BY total_customers DESC, avg_customer_spending DESC\nLIMIT 10;\n", "has_cut": true, "q1_engine": "duckdb", "q2_engine": "datafusion", "sql1": "WITH ranked_nations AS (\n    SELECT n.n_name,\n           n.n_regionkey,\n           COUNT(s.s_suppkey) AS supplier_count\n    FROM nation n\n    JOIN supplier s ON n.n_nationkey = s.s_nationkey\n    GROUP BY n.n_name, n.n_regionkey\n),\ntotal_parts AS (\n    SELECT ps.ps_suppkey,\n           SUM(ps.ps_availqty) AS total_available\n    FROM partsupp ps\n    GROUP BY ps.ps_suppkey\n)\nSELECT rn.n_name AS nation_name,\n       SUM(tp.total_available) AS total_parts_available\nFROM ranked_nations rn\nJOIN total_parts tp ON rn.supplier_count > 10\nWHERE rn.n_regionkey = (SELECT r.r_regionkey FROM region r WHERE r.r_name = 'Asia')\nGROUP BY rn.n_name;", "sql2": "WITH order_summary AS (\n    SELECT c.c_custkey,\n           SUM(o.o_totalprice) AS customer_total\n    FROM customer c\n    JOIN orders o ON c.c_custkey = o.o_custkey\n    GROUP BY c.c_custkey\n)\nSELECT s1.nation_name,\n       (SELECT COUNT(DISTINCT os.c_custkey) FROM order_summary os) AS total_customers,\n       (SELECT SUM(os.customer_total) / COUNT(*) FROM order_summary os) AS avg_customer_spending,\n       s1.total_parts_available\nFROM s1\nORDER BY total_customers DESC, avg_customer_spending DESC\nLIMIT 10;", "results_match": true, "engine_mem_mb": 500000}
