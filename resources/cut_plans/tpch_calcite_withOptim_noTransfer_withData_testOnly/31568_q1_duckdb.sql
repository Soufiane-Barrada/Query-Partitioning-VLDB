SELECT COALESCE("t4"."r_name", "t4"."r_name") AS "R_NAME", "t4"."s_suppkey", "t5"."TOTAL_SPENT", "t4"."ps_supplycost", CASE WHEN "t4"."l_discount" > 0.05 THEN "t4"."l_extendedprice" * (1 - "t4"."l_discount") ELSE NULL END AS "FD_COL_4", CASE WHEN "t4"."l_returnflag" = 'R' THEN "t4"."l_quantity" ELSE 0.00 END AS "FD_COL_5"
FROM (SELECT "t3"."r_regionkey", "t3"."r_name", "t3"."r_comment", "t3"."n_nationkey", "t3"."n_name", "t3"."n_regionkey", "t3"."n_comment", "t3"."s_suppkey", "t3"."s_name", "t3"."s_address", "t3"."s_nationkey", "t3"."s_phone", "t3"."s_acctbal", "t3"."s_comment", "t3"."PS_SUPPKEY", "t3"."MAX_SUPPLYCOST", "t3"."ps_partkey", "t3"."ps_suppkey", "t3"."ps_availqty", "t3"."ps_supplycost", "t3"."ps_comment", "lineitem"."l_orderkey", "lineitem"."l_partkey", "lineitem"."l_suppkey", "lineitem"."l_linenumber", "lineitem"."l_quantity", "lineitem"."l_extendedprice", "lineitem"."l_discount", "lineitem"."l_tax", "lineitem"."l_returnflag", "lineitem"."l_linestatus", "lineitem"."l_shipdate", "lineitem"."l_commitdate", "lineitem"."l_receiptdate", "lineitem"."l_shipinstruct", "lineitem"."l_shipmode", "lineitem"."l_comment"
FROM "TPCH"."lineitem"
RIGHT JOIN (SELECT "t1"."r_regionkey", "t1"."r_name", "t1"."r_comment", "t1"."n_nationkey", "t1"."n_name", "t1"."n_regionkey", "t1"."n_comment", "t1"."s_suppkey", "t1"."s_name", "t1"."s_address", "t1"."s_nationkey", "t1"."s_phone", "t1"."s_acctbal", "t1"."s_comment", "t2"."ps_suppkey" AS "PS_SUPPKEY", "t2"."MAX_SUPPLYCOST", CAST("t"."ps_partkey" AS BIGINT) AS "ps_partkey", CAST("t"."ps_suppkey" AS BIGINT) AS "ps_suppkey", CAST("t"."ps_availqty" AS BIGINT) AS "ps_availqty", CAST("t"."ps_supplycost" AS DECIMAL(15, 2)) AS "ps_supplycost", CAST("t"."ps_comment" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "ps_comment"
FROM (SELECT *
FROM "TPCH"."partsupp"
WHERE "ps_availqty" > 10) AS "t"
INNER JOIN ((SELECT "t0"."r_regionkey", "t0"."r_name", "t0"."r_comment", "t0"."n_nationkey", "t0"."n_name", "t0"."n_regionkey", "t0"."n_comment", CAST("supplier"."s_suppkey" AS BIGINT) AS "s_suppkey", CAST("supplier"."s_name" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "s_name", CAST("supplier"."s_address" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "s_address", CAST("supplier"."s_nationkey" AS INTEGER) AS "s_nationkey", CAST("supplier"."s_phone" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "s_phone", CAST("supplier"."s_acctbal" AS DECIMAL(15, 2)) AS "s_acctbal", CAST("supplier"."s_comment" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "s_comment"
FROM (SELECT "region"."r_regionkey", "region"."r_name", "region"."r_comment", "nation"."n_nationkey", "nation"."n_name", "nation"."n_regionkey", "nation"."n_comment"
FROM "TPCH"."nation"
RIGHT JOIN "TPCH"."region" ON "nation"."n_regionkey" = "region"."r_regionkey") AS "t0"
INNER JOIN "TPCH"."supplier" ON "t0"."n_nationkey" = "supplier"."s_nationkey") AS "t1" LEFT JOIN (SELECT "ps_suppkey", MAX("ps_supplycost") AS "MAX_SUPPLYCOST"
FROM "TPCH"."partsupp"
GROUP BY "ps_suppkey") AS "t2" ON "t1"."s_suppkey" = "t2"."ps_suppkey") ON "t"."ps_suppkey" = "t1"."s_suppkey") AS "t3" ON "lineitem"."l_partkey" = "t3"."ps_partkey") AS "t4"
LEFT JOIN (SELECT "customer"."c_custkey", "customer"."c_name", COUNT("orders"."o_orderkey") AS "ORDER_COUNT", SUM("orders"."o_totalprice") AS "TOTAL_SPENT"
FROM "TPCH"."orders"
RIGHT JOIN "TPCH"."customer" ON "orders"."o_custkey" = "customer"."c_custkey"
GROUP BY "customer"."c_custkey", "customer"."c_name") AS "t5" ON "t4"."s_suppkey" = "t5"."c_custkey"