SELECT COALESCE("REGION_NAME", "REGION_NAME") AS "REGION_NAME", "SUPPLIER_COUNT", "CUSTOMER_COUNT", "SUPPLIER_DETAILS", "CUSTOMER_ORDERS_SUMMARY", "r_name"
FROM (SELECT ANY_VALUE("r_name") AS "REGION_NAME", COUNT(DISTINCT "SUPPLIER_NAME") AS "SUPPLIER_COUNT", COUNT(DISTINCT "CUSTOMER_NAME") AS "CUSTOMER_COUNT", LISTAGG("SUPPLY_INFO", "FD_COL_4") AS "SUPPLIER_DETAILS", LISTAGG("ORDER_SUMMARY", "FD_COL_4") AS "CUSTOMER_ORDERS_SUMMARY", "r_name"
FROM "s1"
GROUP BY "r_name"
ORDER BY "r_name") AS "t9"