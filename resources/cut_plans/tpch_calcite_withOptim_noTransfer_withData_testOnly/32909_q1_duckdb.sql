SELECT COALESCE("t6"."r_name", "t6"."r_name") AS "R_NAME", CASE WHEN "t6"."l_returnflag" = 'R' THEN "t6"."l_extendedprice" * (1 - "t6"."l_discount") ELSE NULL END AS "FD_COL_1", CAST("t"."c_custkey" AS BIGINT) AS "c_custkey", "t6"."AVG_ACCTBAL", "t6"."o_orderkey", "t7"."TOTAL_AVAIL_QTY", "t7"."AVG_SUPPLY_COST"
FROM (SELECT *
FROM "TPCH"."customer"
WHERE "c_acctbal" > 100.00) AS "t"
INNER JOIN ((SELECT "t5"."r_regionkey", "t5"."r_name", "t5"."r_comment", "t5"."n_nationkey", "t5"."n_name", "t5"."n_regionkey", "t5"."n_comment", "t5"."s_suppkey", "t5"."s_name", "t5"."s_address", "t5"."s_nationkey", "t5"."s_phone", "t5"."s_acctbal", "t5"."s_comment", "t5"."S_NATIONKEY", "t5"."AVG_ACCTBAL", "t5"."URGENT_COUNT", "t5"."l_orderkey", "t5"."l_partkey", "t5"."l_suppkey", "t5"."l_linenumber", "t5"."l_quantity", "t5"."l_extendedprice", "t5"."l_discount", "t5"."l_tax", "t5"."l_returnflag", "t5"."l_linestatus", "t5"."l_shipdate", "t5"."l_commitdate", "t5"."l_receiptdate", "t5"."l_shipinstruct", "t5"."l_shipmode", "t5"."l_comment", CAST("t0"."o_orderkey" AS BIGINT) AS "o_orderkey", CAST("t0"."o_custkey" AS BIGINT) AS "o_custkey", CAST("t0"."o_orderstatus" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "o_orderstatus", CAST("t0"."o_totalprice" AS DECIMAL(15, 2)) AS "o_totalprice", CAST("t0"."o_orderdate" AS DATE) AS "o_orderdate", CAST("t0"."o_orderpriority" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "o_orderpriority", CAST("t0"."o_clerk" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "o_clerk", CAST("t0"."o_shippriority" AS INTEGER) AS "o_shippriority", CAST("t0"."o_comment" AS VARCHAR CHARACTER SET "ISO-8859-1") AS "o_comment"
FROM (SELECT *
FROM "TPCH"."orders"
WHERE "o_orderstatus" IN ('F', 'P')) AS "t0"
INNER JOIN (SELECT "t2"."r_regionkey", "t2"."r_name", "t2"."r_comment", "t2"."n_nationkey", "t2"."n_name", "t2"."n_regionkey", "t2"."n_comment", "t2"."s_suppkey", "t2"."s_name", "t2"."s_address", "t2"."s_nationkey", "t2"."s_phone", "t2"."s_acctbal", "t2"."s_comment", "t4"."S_NATIONKEY", "t4"."AVG_ACCTBAL", "t4"."URGENT_COUNT", "lineitem"."l_orderkey", "lineitem"."l_partkey", "lineitem"."l_suppkey", "lineitem"."l_linenumber", "lineitem"."l_quantity", "lineitem"."l_extendedprice", "lineitem"."l_discount", "lineitem"."l_tax", "lineitem"."l_returnflag", "lineitem"."l_linestatus", "lineitem"."l_shipdate", "lineitem"."l_commitdate", "lineitem"."l_receiptdate", "lineitem"."l_shipinstruct", "lineitem"."l_shipmode", "lineitem"."l_comment"
FROM "TPCH"."lineitem"
RIGHT JOIN ((SELECT "t1"."r_regionkey", "t1"."r_name", "t1"."r_comment", "t1"."n_nationkey", "t1"."n_name", "t1"."n_regionkey", "t1"."n_comment", "supplier"."s_suppkey", "supplier"."s_name", "supplier"."s_address", "supplier"."s_nationkey", "supplier"."s_phone", "supplier"."s_acctbal", "supplier"."s_comment"
FROM "TPCH"."supplier"
RIGHT JOIN (SELECT "region"."r_regionkey", "region"."r_name", "region"."r_comment", "nation"."n_nationkey", "nation"."n_name", "nation"."n_regionkey", "nation"."n_comment"
FROM "TPCH"."nation"
RIGHT JOIN "TPCH"."region" ON "nation"."n_regionkey" = "region"."r_regionkey") AS "t1" ON "supplier"."s_nationkey" = "t1"."n_nationkey") AS "t2" LEFT JOIN (SELECT "s_nationkey" AS "S_NATIONKEY", AVG("s_acctbal") AS "AVG_ACCTBAL", SUM(CASE WHEN "s_comment" LIKE '%urgent%' THEN 1 ELSE 0 END) AS "URGENT_COUNT"
FROM "TPCH"."supplier"
GROUP BY "s_nationkey") AS "t4" ON "t2"."s_nationkey" = "t4"."S_NATIONKEY") ON "lineitem"."l_suppkey" = "t2"."s_suppkey") AS "t5" ON "t0"."o_orderkey" = "t5"."l_orderkey") AS "t6" LEFT JOIN (SELECT "ps_partkey", SUM("ps_availqty") AS "TOTAL_AVAIL_QTY", AVG("ps_supplycost") AS "AVG_SUPPLY_COST"
FROM "TPCH"."partsupp"
GROUP BY "ps_partkey") AS "t7" ON "t6"."l_partkey" = "t7"."ps_partkey") ON "t"."c_custkey" = "t6"."o_custkey"