SELECT COALESCE("t"."S_SUPPKEY", "t"."S_SUPPKEY") AS "S_SUPPKEY", "t"."S_NAME", "t"."S_ADDRESS", "t"."S_PHONE", "t"."ADJUSTED_COMMENT", "t1"."P_PARTKEY", "t1"."P_NAME", "t1"."P_BRAND", "t1"."P_RETAILPRICE", "t1"."NON_SPACE_COMMENT_LENGTH", "partsupp"."ps_partkey", "partsupp"."ps_suppkey", "partsupp"."ps_availqty", "partsupp"."ps_supplycost", "partsupp"."ps_comment", "t2"."o_orderkey" AS "O_ORDERKEY", "t2"."o_totalprice" AS "O_TOTALPRICE", "t2"."TOTAL_LINEITEMS", "t2"."TOTAL_QUANTITY", "t2"."TOTAL_EXTENDED_PRICE"
FROM (SELECT "s_suppkey" AS "S_SUPPKEY", "s_name" AS "S_NAME", "s_address" AS "S_ADDRESS", "s_phone" AS "S_PHONE", CASE WHEN CASE WHEN LOWER("s_comment") = '' THEN FALSE ELSE LOWER("s_comment") IS NOT NULL END THEN CAST(CASE WHEN LOWER("s_comment") = '' THEN NULL ELSE LOWER("s_comment") END AS VARCHAR CHARACTER SET "ISO-8859-1") ELSE 'No Comment' END AS "ADJUSTED_COMMENT"
FROM "TPCH"."supplier") AS "t"
INNER JOIN ((SELECT "p_partkey" AS "P_PARTKEY", "p_name" AS "P_NAME", "p_brand" AS "P_BRAND", "p_retailprice" AS "P_RETAILPRICE", LENGTH(REPLACE(LOWER("p_comment"), ' ', '')) AS "NON_SPACE_COMMENT_LENGTH"
FROM "TPCH"."part"
WHERE "p_retailprice" > 100.00) AS "t1" INNER JOIN ("TPCH"."partsupp" INNER JOIN (SELECT "orders"."o_orderkey", "orders"."o_totalprice", COUNT(*) AS "TOTAL_LINEITEMS", SUM("lineitem"."l_quantity") AS "TOTAL_QUANTITY", SUM("lineitem"."l_extendedprice") AS "TOTAL_EXTENDED_PRICE"
FROM "TPCH"."orders"
INNER JOIN "TPCH"."lineitem" ON "orders"."o_orderkey" = "lineitem"."l_orderkey"
GROUP BY "orders"."o_orderkey", "orders"."o_totalprice") AS "t2" ON "partsupp"."ps_partkey" = "t2"."o_orderkey") ON "t1"."P_PARTKEY" = "partsupp"."ps_partkey") ON "t"."S_SUPPKEY" = "partsupp"."ps_suppkey"