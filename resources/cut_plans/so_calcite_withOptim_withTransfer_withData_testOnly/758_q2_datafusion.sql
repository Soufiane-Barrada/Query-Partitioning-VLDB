SELECT COALESCE("t115"."USERID", "t115"."USERID") AS "USERID", "t115"."DISPLAYNAME", "t115"."TOTALPOSTS", "t115"."TOTALSCORE", "t115"."UPVOTECOUNT", "t115"."DOWNVOTECOUNT", "t115"."AVGCOMMENTSPERPOST", "t115"."SCORECATEGORY", "t115"."GOLDBADGES", "t115"."SILVERBADGES", "t115"."BRONZEBADGES"
FROM (SELECT "t108"."USERID", "t108"."DISPLAYNAME", "t108"."TOTALPOSTS", "t108"."TOTALSCORE", "t108"."UPVOTECOUNT", "t108"."DOWNVOTECOUNT", "t108"."AVGCOMMENTSPERPOST", CASE WHEN "t108"."TOTALSCORE" > 100 THEN 'High Scorer  ' WHEN "t108"."TOTALSCORE" >= 50 AND "t108"."TOTALSCORE" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS "SCORECATEGORY", "t108"."EXPR$0" AS "GOLDBADGES", "t108"."EXPR$08" AS "SILVERBADGES", CASE WHEN "t112"."EXPR$0" IS NULL THEN 0 ELSE "t112"."EXPR$0" END AS "BRONZEBADGES"
FROM (SELECT "t78"."USERID", "t78"."DISPLAYNAME", "t78"."TOTALPOSTS", "t78"."TOTALSCORE", "t78"."UPVOTECOUNT", "t78"."DOWNVOTECOUNT", "t78"."AVGCOMMENTSPERPOST", "t78"."EXPR$0", CASE WHEN "t107"."EXPR$0" IS NULL THEN 0 ELSE "t107"."EXPR$0" END AS "EXPR$08"
FROM (SELECT "t63"."USERID", "t63"."DISPLAYNAME", "t63"."TOTALPOSTS", "t63"."TOTALSCORE", "t63"."UPVOTECOUNT", "t63"."DOWNVOTECOUNT", "t63"."AVGCOMMENTSPERPOST", CASE WHEN "t77"."EXPR$0" IS NULL THEN 0 ELSE "t77"."EXPR$0" END AS "EXPR$0"
FROM (SELECT ANY_VALUE("t59"."Id") AS "USERID", "t59"."DisplayName" AS "DISPLAYNAME", COUNT(DISTINCT "Posts8"."Id") AS "TOTALPOSTS", SUM("Posts8"."Score") AS "TOTALSCORE", SUM("t59"."UpVotes") AS "UPVOTECOUNT", SUM("t59"."DownVotes") AS "DOWNVOTECOUNT", AVG(CASE WHEN "t59"."COMMENTCOUNT" IS NOT NULL THEN CAST("t59"."COMMENTCOUNT" AS BIGINT) ELSE 0 END) AS "AVGCOMMENTSPERPOST"
FROM (SELECT "Users3"."Id", "Users3"."Reputation", "Users3"."CreationDate", "Users3"."DisplayName", "Users3"."LastAccessDate", "Users3"."WebsiteUrl", "Users3"."Location", "Users3"."AboutMe", "Users3"."Views", "Users3"."UpVotes", "Users3"."DownVotes", "Users3"."ProfileImageUrl", "Users3"."AccountId", "t58"."POSTID", "t58"."TITLE", "t58"."SCORE", "t58"."CREATIONDATE", "t58"."OWNERUSERID", "t58"."RAN", "t58"."COMMENTCOUNT"
FROM (SELECT "t57"."Id" AS "POSTID", "t57"."Title" AS "TITLE", "t57"."Score" AS "SCORE", "t57"."CreationDate" AS "CREATIONDATE", "t57"."OwnerUserId" AS "OWNERUSERID", RANK() OVER (PARTITION BY "t57"."OwnerUserId" ORDER BY "t57"."Score" DESC NULLS FIRST) AS "RAN", CASE WHEN "t56"."COMMENTCOUNT" IS NOT NULL THEN CAST("t56"."COMMENTCOUNT" AS BIGINT) ELSE 0 END AS "COMMENTCOUNT"
FROM (SELECT "PostId", COUNT(*) AS "COMMENTCOUNT"
FROM "STACK"."Comments"
GROUP BY "PostId") AS "t56"
RIGHT JOIN (SELECT *
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS "t57" ON "t56"."PostId" = "t57"."Id") AS "t58"
RIGHT JOIN "STACK"."Users" AS "Users3" ON "t58"."OWNERUSERID" = "Users3"."Id") AS "t59"
LEFT JOIN "STACK"."Posts" AS "Posts8" ON "t59"."Id" = "Posts8"."OwnerUserId"
GROUP BY "t59"."Id", "t59"."DisplayName"
HAVING COUNT(DISTINCT "Posts8"."Id") > 0) AS "t63"
LEFT JOIN (SELECT "t73"."USERID" AS "UserId", CASE WHEN "t76"."EXPR$0" IS NOT NULL THEN "t76"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM (SELECT "t72"."USERID"
FROM (SELECT ANY_VALUE("t68"."Id") AS "USERID"
FROM (SELECT "Users4"."Id", "Users4"."Reputation", "Users4"."CreationDate", "Users4"."DisplayName", "Users4"."LastAccessDate", "Users4"."WebsiteUrl", "Users4"."Location", "Users4"."AboutMe", "Users4"."Views", "Users4"."UpVotes", "Users4"."DownVotes", "Users4"."ProfileImageUrl", "Users4"."AccountId", "t67"."POSTID", "t67"."TITLE", "t67"."SCORE", "t67"."CREATIONDATE", "t67"."OWNERUSERID", "t67"."RAN", "t67"."COMMENTCOUNT"
FROM (SELECT "t66"."Id" AS "POSTID", "t66"."Title" AS "TITLE", "t66"."Score" AS "SCORE", "t66"."CreationDate" AS "CREATIONDATE", "t66"."OwnerUserId" AS "OWNERUSERID", RANK() OVER (PARTITION BY "t66"."OwnerUserId" ORDER BY "t66"."Score" DESC NULLS FIRST) AS "RAN", CASE WHEN "t65"."COMMENTCOUNT" IS NOT NULL THEN CAST("t65"."COMMENTCOUNT" AS BIGINT) ELSE 0 END AS "COMMENTCOUNT"
FROM (SELECT "PostId", COUNT(*) AS "COMMENTCOUNT"
FROM "STACK"."Comments"
GROUP BY "PostId") AS "t65"
RIGHT JOIN (SELECT *
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS "t66" ON "t65"."PostId" = "t66"."Id") AS "t67"
RIGHT JOIN "STACK"."Users" AS "Users4" ON "t67"."OWNERUSERID" = "Users4"."Id") AS "t68"
LEFT JOIN "STACK"."Posts" AS "Posts10" ON "t68"."Id" = "Posts10"."OwnerUserId"
GROUP BY "t68"."Id", "t68"."DisplayName"
HAVING COUNT(DISTINCT "Posts10"."Id") > 0) AS "t72"
GROUP BY "t72"."USERID") AS "t73"
LEFT JOIN (SELECT "UserId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Badges"
WHERE CAST("Class" AS INTEGER) = 1
GROUP BY "UserId") AS "t76" ON "t73"."USERID" IS NOT DISTINCT FROM "t76"."UserId") AS "t77" ON "t63"."USERID" = "t77"."UserId") AS "t78"
LEFT JOIN (SELECT "t103"."USERID" AS "UserId", CASE WHEN "t106"."EXPR$0" IS NOT NULL THEN "t106"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM (SELECT "t87"."USERID"
FROM (SELECT ANY_VALUE("t83"."Id") AS "USERID", "t83"."DisplayName" AS "DISPLAYNAME", COUNT(DISTINCT "Posts12"."Id") AS "TOTALPOSTS", SUM("Posts12"."Score") AS "TOTALSCORE", SUM("t83"."UpVotes") AS "UPVOTECOUNT", SUM("t83"."DownVotes") AS "DOWNVOTECOUNT", AVG(CASE WHEN "t83"."COMMENTCOUNT" IS NOT NULL THEN CAST("t83"."COMMENTCOUNT" AS BIGINT) ELSE 0 END) AS "AVGCOMMENTSPERPOST"
FROM (SELECT "Users5"."Id", "Users5"."Reputation", "Users5"."CreationDate", "Users5"."DisplayName", "Users5"."LastAccessDate", "Users5"."WebsiteUrl", "Users5"."Location", "Users5"."AboutMe", "Users5"."Views", "Users5"."UpVotes", "Users5"."DownVotes", "Users5"."ProfileImageUrl", "Users5"."AccountId", "t82"."POSTID", "t82"."TITLE", "t82"."SCORE", "t82"."CREATIONDATE", "t82"."OWNERUSERID", "t82"."RAN", "t82"."COMMENTCOUNT"
FROM (SELECT "t81"."Id" AS "POSTID", "t81"."Title" AS "TITLE", "t81"."Score" AS "SCORE", "t81"."CreationDate" AS "CREATIONDATE", "t81"."OwnerUserId" AS "OWNERUSERID", RANK() OVER (PARTITION BY "t81"."OwnerUserId" ORDER BY "t81"."Score" DESC NULLS FIRST) AS "RAN", CASE WHEN "t80"."COMMENTCOUNT" IS NOT NULL THEN CAST("t80"."COMMENTCOUNT" AS BIGINT) ELSE 0 END AS "COMMENTCOUNT"
FROM (SELECT "PostId", COUNT(*) AS "COMMENTCOUNT"
FROM "STACK"."Comments"
GROUP BY "PostId") AS "t80"
RIGHT JOIN (SELECT *
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS "t81" ON "t80"."PostId" = "t81"."Id") AS "t82"
RIGHT JOIN "STACK"."Users" AS "Users5" ON "t82"."OWNERUSERID" = "Users5"."Id") AS "t83"
LEFT JOIN "STACK"."Posts" AS "Posts12" ON "t83"."Id" = "Posts12"."OwnerUserId"
GROUP BY "t83"."Id", "t83"."DisplayName"
HAVING COUNT(DISTINCT "Posts12"."Id") > 0) AS "t87"
LEFT JOIN (SELECT "t97"."USERID" AS "UserId", CASE WHEN "t100"."EXPR$0" IS NOT NULL THEN "t100"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM (SELECT "t96"."USERID"
FROM (SELECT ANY_VALUE("t92"."Id") AS "USERID"
FROM (SELECT "Users6"."Id", "Users6"."Reputation", "Users6"."CreationDate", "Users6"."DisplayName", "Users6"."LastAccessDate", "Users6"."WebsiteUrl", "Users6"."Location", "Users6"."AboutMe", "Users6"."Views", "Users6"."UpVotes", "Users6"."DownVotes", "Users6"."ProfileImageUrl", "Users6"."AccountId", "t91"."POSTID", "t91"."TITLE", "t91"."SCORE", "t91"."CREATIONDATE", "t91"."OWNERUSERID", "t91"."RAN", "t91"."COMMENTCOUNT"
FROM (SELECT "t90"."Id" AS "POSTID", "t90"."Title" AS "TITLE", "t90"."Score" AS "SCORE", "t90"."CreationDate" AS "CREATIONDATE", "t90"."OwnerUserId" AS "OWNERUSERID", RANK() OVER (PARTITION BY "t90"."OwnerUserId" ORDER BY "t90"."Score" DESC NULLS FIRST) AS "RAN", CASE WHEN "t89"."COMMENTCOUNT" IS NOT NULL THEN CAST("t89"."COMMENTCOUNT" AS BIGINT) ELSE 0 END AS "COMMENTCOUNT"
FROM (SELECT "PostId", COUNT(*) AS "COMMENTCOUNT"
FROM "STACK"."Comments"
GROUP BY "PostId") AS "t89"
RIGHT JOIN (SELECT *
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS "t90" ON "t89"."PostId" = "t90"."Id") AS "t91"
RIGHT JOIN "STACK"."Users" AS "Users6" ON "t91"."OWNERUSERID" = "Users6"."Id") AS "t92"
LEFT JOIN "STACK"."Posts" AS "Posts14" ON "t92"."Id" = "Posts14"."OwnerUserId"
GROUP BY "t92"."Id", "t92"."DisplayName"
HAVING COUNT(DISTINCT "Posts14"."Id") > 0) AS "t96"
GROUP BY "t96"."USERID") AS "t97"
LEFT JOIN (SELECT "UserId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Badges"
WHERE CAST("Class" AS INTEGER) = 1
GROUP BY "UserId") AS "t100" ON "t97"."USERID" IS NOT DISTINCT FROM "t100"."UserId") AS "t101" ON "t87"."USERID" = "t101"."UserId"
GROUP BY "t87"."USERID") AS "t103"
LEFT JOIN (SELECT "UserId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Badges"
WHERE CAST("Class" AS INTEGER) = 2
GROUP BY "UserId") AS "t106" ON "t103"."USERID" IS NOT DISTINCT FROM "t106"."UserId") AS "t107" ON "t78"."USERID" = "t107"."UserId") AS "t108"
LEFT JOIN (SELECT "s1"."USERID" AS "UserId", CASE WHEN "t111"."EXPR$0" IS NOT NULL THEN "t111"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM "s1"
LEFT JOIN (SELECT "UserId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Badges"
WHERE CAST("Class" AS INTEGER) = 3
GROUP BY "UserId") AS "t111" ON "s1"."USERID" IS NOT DISTINCT FROM "t111"."UserId") AS "t112" ON "t108"."USERID" = "t112"."UserId"
ORDER BY "t108"."TOTALSCORE" DESC NULLS FIRST, "t108"."DISPLAYNAME"
OFFSET 0 ROWS
FETCH NEXT 100 ROWS ONLY) AS "t115"