SELECT COALESCE("t"."Id", "t"."Id") AS "Id", "t"."Reputation", "t"."CreationDate", "t"."DisplayName", "t"."LastAccessDate", "t"."WebsiteUrl", "t"."Location", "t"."AboutMe", "t"."Views", "t"."UpVotes", "t"."DownVotes", "t"."ProfileImageUrl", "t"."AccountId", "t1"."USERID", "t1"."TOTALVOTES", "t1"."UPVOTES" AS "UPVOTES_", "t1"."DOWNVOTES" AS "DOWNVOTES_", "t3"."USERID" AS "USERID0", "t3"."TOTALBADGES", "t3"."GOLDBADGES", "t3"."SILVERBADGES", "t3"."BRONZEBADGES", "t5"."OWNERUSERID", "t5"."TOTALPOSTS", "t5"."QUESTIONS", "t5"."ANSWERS", "t5"."TOTALVIEWS", "t5"."TOTALSCORE"
FROM (SELECT *
FROM "STACK"."Users"
WHERE "Reputation" > 1000) AS "t"
LEFT JOIN (SELECT "UserId" AS "USERID", COUNT(*) AS "TOTALVOTES", SUM(CASE WHEN CAST("VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."Votes"
GROUP BY "UserId") AS "t1" ON "t"."Id" = "t1"."USERID"
LEFT JOIN (SELECT "UserId" AS "USERID", COUNT(*) AS "TOTALBADGES", SUM(CASE WHEN CAST("Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES"
FROM "STACK"."Badges"
GROUP BY "UserId") AS "t3" ON "t"."Id" = "t3"."USERID"
LEFT JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(*) AS "TOTALPOSTS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERS", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t5" ON "t"."Id" = "t5"."OWNERUSERID"