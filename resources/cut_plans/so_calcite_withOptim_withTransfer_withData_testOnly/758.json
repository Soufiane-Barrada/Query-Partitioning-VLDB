{
  "queryId" : "758",
  "originalSql" : "WITH RankedPosts AS (\n    SELECT \n        p.Id AS PostId, \n        p.Title, \n        p.Score, \n        p.CreationDate, \n        p.OwnerUserId, \n        RANK() OVER (PARTITION BY p.OwnerUserId ORDER BY p.Score DESC) AS Ran,\n        COALESCE(cc.CommentCount, 0) AS CommentCount\n    FROM \n        Posts p\n    LEFT JOIN \n        (SELECT PostId, COUNT(*) AS CommentCount \n         FROM Comments \n         GROUP BY PostId) cc ON p.Id = cc.PostId\n    WHERE \n        p.CreationDate >= (CAST('2024-10-01 12:34:56' AS TIMESTAMP) - INTERVAL '1' YEAR)\n), UserStats AS (\n    SELECT \n        u.Id AS UserId,\n        u.DisplayName,\n        COUNT(DISTINCT p.Id) AS TotalPosts,\n        SUM(p.Score) AS TotalScore,\n        SUM(u.UpVotes) AS UpVoteCount,\n        SUM(u.DownVotes) AS DownVoteCount,\n        AVG(COALESCE(rp.CommentCount, 0)) AS AvgCommentsPerPost\n    FROM \n        Users u\n    LEFT JOIN \n        RankedPosts rp ON u.Id = rp.OwnerUserId\n    LEFT JOIN \n        Posts p ON u.Id = p.OwnerUserId\n    GROUP BY \n        u.Id, u.DisplayName\n)\nSELECT \n    us.UserId,\n    us.DisplayName,\n    us.TotalPosts,\n    us.TotalScore,\n    us.UpVoteCount,\n    us.DownVoteCount,\n    us.AvgCommentsPerPost,\n    (CASE \n        WHEN us.TotalScore > 100 THEN 'High Scorer'\n        WHEN us.TotalScore BETWEEN 50 AND 100 THEN 'Medium Scorer'\n        ELSE 'Low Scorer'\n    END) AS ScoreCategory,\n    (SELECT COUNT(*) \n     FROM Badges b \n     WHERE b.UserId = us.UserId \n       AND b.Class = 1) AS GoldBadges,\n    (SELECT COUNT(*) \n     FROM Badges b \n     WHERE b.UserId = us.UserId \n       AND b.Class = 2) AS SilverBadges,\n    (SELECT COUNT(*) \n     FROM Badges b \n     WHERE b.UserId = us.UserId \n       AND b.Class = 3) AS BronzeBadges\nFROM \n    UserStats us\nWHERE \n    us.TotalPosts > 0\nORDER BY \n    us.TotalScore DESC, us.DisplayName ASC\nLIMIT 100 OFFSET 0",
  "dpSummary" : {
    "hasCut" : true,
    "cutNodeId" : 43925,
    "q1Engine" : "duckdb",
    "q2Engine" : "datafusion",
    "costAllDuckdb" : 2.96033284298688E7,
    "costAllDatafusion" : 5404447.622810792,
    "chosenCost" : 1845411.8725956613
  },
  "analysis" : {
    "pipeline" : {
      "runId" : "so_optim_withTransfer",
      "doOptimize" : true,
      "metadataProvider" : "custom",
      "dpMode" : "MAX",
      "transferExtraConstantMs" : 0.0,
      "transferCoeffs" : {
        "duckdb" : {
          "aMs" : 62.297202312292534,
          "bMsPerRow" : 1.9855075008663652E-4,
          "cMsPerRowSizeByte" : 0.0,
          "dMsPerOutputByte" : 9.37543642726493E-7
        },
        "datafusion" : {
          "aMs" : 72.934497671158,
          "bMsPerRow" : 8.296144368777564E-5,
          "cMsPerRowSizeByte" : 0.0010951149669102135,
          "dMsPerOutputByte" : 3.7986948397307897E-7
        }
      },
      "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
      "cutPolicy" : "DP",
      "randomSeed" : 1770162173403,
      "schemaName" : "STACK"
    },
    "planStats" : {
      "totalNodes" : 193,
      "maxDepth" : 28,
      "operatorKindCounts" : {
        "OTHER" : 66,
        "JOIN" : 38,
        "AGGREGATE" : 30,
        "FILTER" : 23,
        "SORT" : 1
      },
      "rootOutputRows" : 100.0,
      "rootRowSizeOutBytes" : 136.0
    },
    "cut" : {
      "cutDepth" : 6,
      "cutNodeOperatorKind" : "AGGREGATE",
      "cutOutputRows" : 426354.8482972674,
      "cutRowSizeOutBytes" : 8.0,
      "cutOutputBytes" : 3410838.786378139,
      "transferEstimatedMs" : 109.60994589861399,
      "q1Stats" : {
        "engine" : "duckdb",
        "nodeCount" : 77,
        "maxDepth" : 23,
        "operatorKindCounts" : {
          "JOIN" : 18,
          "OTHER" : 33,
          "AGGREGATE" : 15,
          "FILTER" : 11
        }
      },
      "q2Stats" : {
        "engine" : "datafusion",
        "nodeCount" : 81,
        "maxDepth" : 26,
        "operatorKindCounts" : {
          "OTHER" : 33,
          "AGGREGATE" : 15,
          "FILTER" : 12,
          "JOIN" : 20,
          "SORT" : 1
        }
      }
    }
  },
  "dag" : {
    "finalNodeId" : "q2",
    "nodes" : [ {
      "id" : "q1",
      "engine" : "duckdb",
      "sql" : "SELECT COALESCE(\"t22\".\"USERID\", \"t22\".\"USERID\") AS \"USERID\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t22\".\"USERID\"",
      "inputs" : { },
      "schema" : [ {
        "name" : "USERID",
        "type" : "INTEGER"
      } ]
    }, {
      "id" : "q2",
      "engine" : "datafusion",
      "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t108\".\"USERID\", \"t108\".\"DISPLAYNAME\", \"t108\".\"TOTALPOSTS\", \"t108\".\"TOTALSCORE\", \"t108\".\"UPVOTECOUNT\", \"t108\".\"DOWNVOTECOUNT\", \"t108\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t108\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t108\".\"TOTALSCORE\" >= 50 AND \"t108\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t108\".\"EXPR$0\" AS \"GOLDBADGES\", \"t108\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t78\".\"USERID\", \"t78\".\"DISPLAYNAME\", \"t78\".\"TOTALPOSTS\", \"t78\".\"TOTALSCORE\", \"t78\".\"UPVOTECOUNT\", \"t78\".\"DOWNVOTECOUNT\", \"t78\".\"AVGCOMMENTSPERPOST\", \"t78\".\"EXPR$0\", CASE WHEN \"t107\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t107\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t59\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t72\".\"USERID\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t68\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t72\"\nGROUP BY \"t72\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t63\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t103\".\"USERID\" AS \"UserId\", CASE WHEN \"t106\".\"EXPR$0\" IS NOT NULL THEN \"t106\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t87\".\"USERID\"\nFROM (SELECT MIN(\"t83\".\"Id\") AS \"USERID\", \"t83\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t83\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t83\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t83\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t83\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t82\".\"POSTID\", \"t82\".\"TITLE\", \"t82\".\"SCORE\", \"t82\".\"CREATIONDATE\", \"t82\".\"OWNERUSERID\", \"t82\".\"RAN\", \"t82\".\"COMMENTCOUNT\"\nFROM (SELECT \"t81\".\"Id\" AS \"POSTID\", \"t81\".\"Title\" AS \"TITLE\", \"t81\".\"Score\" AS \"SCORE\", \"t81\".\"CreationDate\" AS \"CREATIONDATE\", \"t81\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t81\".\"OwnerUserId\" ORDER BY \"t81\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t80\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t80\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t80\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t81\" ON \"t80\".\"PostId\" = \"t81\".\"Id\") AS \"t82\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t82\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t83\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t83\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t83\".\"Id\", \"t83\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t87\"\nLEFT JOIN (SELECT \"t97\".\"USERID\" AS \"UserId\", CASE WHEN \"t100\".\"EXPR$0\" IS NOT NULL THEN \"t100\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t96\".\"USERID\"\nFROM (SELECT MIN(\"t92\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t91\".\"POSTID\", \"t91\".\"TITLE\", \"t91\".\"SCORE\", \"t91\".\"CREATIONDATE\", \"t91\".\"OWNERUSERID\", \"t91\".\"RAN\", \"t91\".\"COMMENTCOUNT\"\nFROM (SELECT \"t90\".\"Id\" AS \"POSTID\", \"t90\".\"Title\" AS \"TITLE\", \"t90\".\"Score\" AS \"SCORE\", \"t90\".\"CreationDate\" AS \"CREATIONDATE\", \"t90\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t90\".\"OwnerUserId\" ORDER BY \"t90\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t89\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t89\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t89\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t90\" ON \"t89\".\"PostId\" = \"t90\".\"Id\") AS \"t91\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t91\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t92\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t92\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t92\".\"Id\", \"t92\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t96\"\nGROUP BY \"t96\".\"USERID\") AS \"t97\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t100\" ON \"t97\".\"USERID\" IS NOT DISTINCT FROM \"t100\".\"UserId\") AS \"t101\" ON \"t87\".\"USERID\" = \"t101\".\"UserId\"\nGROUP BY \"t87\".\"USERID\") AS \"t103\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t106\" ON \"t103\".\"USERID\" IS NOT DISTINCT FROM \"t106\".\"UserId\") AS \"t107\" ON \"t78\".\"USERID\" = \"t107\".\"UserId\") AS \"t108\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t108\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t108\".\"TOTALSCORE\" DESC NULLS FIRST, \"t108\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
      "inputs" : {
        "s1" : "q1"
      },
      "schema" : [ {
        "name" : "USERID",
        "type" : "INTEGER"
      }, {
        "name" : "DISPLAYNAME",
        "type" : "VARCHAR"
      }, {
        "name" : "TOTALPOSTS",
        "type" : "BIGINT"
      }, {
        "name" : "TOTALSCORE",
        "type" : "INTEGER"
      }, {
        "name" : "UPVOTECOUNT",
        "type" : "INTEGER"
      }, {
        "name" : "DOWNVOTECOUNT",
        "type" : "INTEGER"
      }, {
        "name" : "AVGCOMMENTSPERPOST",
        "type" : "BIGINT"
      }, {
        "name" : "SCORECATEGORY",
        "type" : "CHAR"
      }, {
        "name" : "GOLDBADGES",
        "type" : "BIGINT"
      }, {
        "name" : "SILVERBADGES",
        "type" : "BIGINT"
      }, {
        "name" : "BRONZEBADGES",
        "type" : "BIGINT"
      } ]
    } ]
  },
  "cutPlans" : [ {
    "planId" : "cut_43944",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43944,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 0,
        "cutNodeOperatorKind" : "SORT",
        "cutOutputRows" : 100.0,
        "cutRowSizeOutBytes" : 136.0,
        "cutOutputBytes" : 13600.0,
        "transferEstimatedMs" : 73.09689567600859,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 158,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 66,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 0,
          "maxDepth" : 1,
          "operatorKindCounts" : { }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t114\".\"USERID\", \"t114\".\"USERID\") AS \"USERID\", \"t114\".\"DISPLAYNAME\", \"t114\".\"TOTALPOSTS\", \"t114\".\"TOTALSCORE\", \"t114\".\"UPVOTECOUNT\", \"t114\".\"DOWNVOTECOUNT\", \"t114\".\"AVGCOMMENTSPERPOST\", \"t114\".\"SCORECATEGORY\", \"t114\".\"GOLDBADGES\", \"t114\".\"SILVERBADGES\", \"t114\".\"BRONZEBADGES\"\nFROM (SELECT \"t52\".\"USERID\", \"t52\".\"DISPLAYNAME\", \"t52\".\"TOTALPOSTS\", \"t52\".\"TOTALSCORE\", \"t52\".\"UPVOTECOUNT\", \"t52\".\"DOWNVOTECOUNT\", \"t52\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t52\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t52\".\"TOTALSCORE\" >= 50 AND \"t52\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t52\".\"EXPR$0\" AS \"GOLDBADGES\", \"t52\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t111\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t111\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", \"t22\".\"EXPR$0\", CASE WHEN \"t51\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t51\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\") AS \"t52\"\nLEFT JOIN (SELECT \"t107\".\"USERID\" AS \"UserId\", CASE WHEN \"t110\".\"EXPR$0\" IS NOT NULL THEN \"t110\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t76\".\"USERID\"\nFROM (SELECT \"t61\".\"USERID\", \"t61\".\"DISPLAYNAME\", \"t61\".\"TOTALPOSTS\", \"t61\".\"TOTALSCORE\", \"t61\".\"UPVOTECOUNT\", \"t61\".\"DOWNVOTECOUNT\", \"t61\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t75\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t75\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t57\".\"Id\") AS \"USERID\", \"t57\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t57\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t57\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t56\".\"POSTID\", \"t56\".\"TITLE\", \"t56\".\"SCORE\", \"t56\".\"CREATIONDATE\", \"t56\".\"OWNERUSERID\", \"t56\".\"RAN\", \"t56\".\"COMMENTCOUNT\"\nFROM (SELECT \"t55\".\"Id\" AS \"POSTID\", \"t55\".\"Title\" AS \"TITLE\", \"t55\".\"Score\" AS \"SCORE\", \"t55\".\"CreationDate\" AS \"CREATIONDATE\", \"t55\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t55\".\"OwnerUserId\" ORDER BY \"t55\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t54\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t54\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t54\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t55\" ON \"t54\".\"PostId\" = \"t55\".\"Id\") AS \"t56\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t56\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t57\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t57\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t57\".\"Id\", \"t57\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t61\"\nLEFT JOIN (SELECT \"t71\".\"USERID\" AS \"UserId\", CASE WHEN \"t74\".\"EXPR$0\" IS NOT NULL THEN \"t74\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t70\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t66\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t65\".\"POSTID\", \"t65\".\"TITLE\", \"t65\".\"SCORE\", \"t65\".\"CREATIONDATE\", \"t65\".\"OWNERUSERID\", \"t65\".\"RAN\", \"t65\".\"COMMENTCOUNT\"\nFROM (SELECT \"t64\".\"Id\" AS \"POSTID\", \"t64\".\"Title\" AS \"TITLE\", \"t64\".\"Score\" AS \"SCORE\", \"t64\".\"CreationDate\" AS \"CREATIONDATE\", \"t64\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t64\".\"OwnerUserId\" ORDER BY \"t64\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t63\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t64\" ON \"t63\".\"PostId\" = \"t64\".\"Id\") AS \"t65\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t65\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t66\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t66\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t66\".\"Id\", \"t66\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t70\"\nGROUP BY \"t70\".\"USERID\") AS \"t71\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t74\" ON \"t71\".\"USERID\" IS NOT DISTINCT FROM \"t74\".\"UserId\") AS \"t75\" ON \"t61\".\"USERID\" = \"t75\".\"UserId\") AS \"t76\"\nLEFT JOIN (SELECT \"t101\".\"USERID\" AS \"UserId\", CASE WHEN \"t104\".\"EXPR$0\" IS NOT NULL THEN \"t104\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t85\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t81\".\"Id\") AS \"USERID\", \"t81\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t81\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t81\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t80\".\"POSTID\", \"t80\".\"TITLE\", \"t80\".\"SCORE\", \"t80\".\"CREATIONDATE\", \"t80\".\"OWNERUSERID\", \"t80\".\"RAN\", \"t80\".\"COMMENTCOUNT\"\nFROM (SELECT \"t79\".\"Id\" AS \"POSTID\", \"t79\".\"Title\" AS \"TITLE\", \"t79\".\"Score\" AS \"SCORE\", \"t79\".\"CreationDate\" AS \"CREATIONDATE\", \"t79\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t79\".\"OwnerUserId\" ORDER BY \"t79\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t78\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t78\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t78\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t79\" ON \"t78\".\"PostId\" = \"t79\".\"Id\") AS \"t80\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t80\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t81\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t81\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t81\".\"Id\", \"t81\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t85\"\nLEFT JOIN (SELECT \"t95\".\"USERID\" AS \"UserId\", CASE WHEN \"t98\".\"EXPR$0\" IS NOT NULL THEN \"t98\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t94\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t90\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t89\".\"POSTID\", \"t89\".\"TITLE\", \"t89\".\"SCORE\", \"t89\".\"CREATIONDATE\", \"t89\".\"OWNERUSERID\", \"t89\".\"RAN\", \"t89\".\"COMMENTCOUNT\"\nFROM (SELECT \"t88\".\"Id\" AS \"POSTID\", \"t88\".\"Title\" AS \"TITLE\", \"t88\".\"Score\" AS \"SCORE\", \"t88\".\"CreationDate\" AS \"CREATIONDATE\", \"t88\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t88\".\"OwnerUserId\" ORDER BY \"t88\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t87\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t87\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t87\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t88\" ON \"t87\".\"PostId\" = \"t88\".\"Id\") AS \"t89\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t89\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t90\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t90\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t90\".\"Id\", \"t90\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t94\"\nGROUP BY \"t94\".\"USERID\") AS \"t95\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t98\" ON \"t95\".\"USERID\" IS NOT DISTINCT FROM \"t98\".\"UserId\") AS \"t99\" ON \"t85\".\"USERID\" = \"t99\".\"UserId\"\nGROUP BY \"t85\".\"USERID\") AS \"t101\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t104\" ON \"t101\".\"USERID\" IS NOT DISTINCT FROM \"t104\".\"UserId\") AS \"t105\" ON \"t76\".\"USERID\" = \"t105\".\"UserId\"\nGROUP BY \"t76\".\"USERID\") AS \"t107\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t110\" ON \"t107\".\"USERID\" IS NOT DISTINCT FROM \"t110\".\"UserId\") AS \"t111\" ON \"t52\".\"USERID\" = \"t111\".\"UserId\"\nORDER BY \"t52\".\"TOTALSCORE\" DESC NULLS FIRST, \"t52\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t114\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"USERID\", \"USERID\") AS \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\", \"SCORECATEGORY\", \"GOLDBADGES\", \"SILVERBADGES\", \"BRONZEBADGES\"\nFROM \"s1\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43940",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43940,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 2,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 1.6548904226145427E17,
        "cutRowSizeOutBytes" : 136.0,
        "cutOutputBytes" : 2.250650974755778E19,
        "transferEstimatedMs" : 2.2278746104430492E13,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 156,
          "maxDepth" : 27,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 2,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "SORT" : 1,
            "OTHER" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t52\".\"USERID\", \"t52\".\"USERID\") AS \"USERID\", \"t52\".\"DISPLAYNAME\", \"t52\".\"TOTALPOSTS\", \"t52\".\"TOTALSCORE\", \"t52\".\"UPVOTECOUNT\", \"t52\".\"DOWNVOTECOUNT\", \"t52\".\"AVGCOMMENTSPERPOST\", \"t52\".\"EXPR$0\" AS \"FD_COL_7\", \"t52\".\"EXPR$08\" AS \"FD_COL_8\", CASE WHEN \"t111\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t111\".\"EXPR$0\" END AS \"FD_COL_9\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", \"t22\".\"EXPR$0\", CASE WHEN \"t51\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t51\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\") AS \"t52\"\nLEFT JOIN (SELECT \"t107\".\"USERID\" AS \"UserId\", CASE WHEN \"t110\".\"EXPR$0\" IS NOT NULL THEN \"t110\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t76\".\"USERID\"\nFROM (SELECT \"t61\".\"USERID\", \"t61\".\"DISPLAYNAME\", \"t61\".\"TOTALPOSTS\", \"t61\".\"TOTALSCORE\", \"t61\".\"UPVOTECOUNT\", \"t61\".\"DOWNVOTECOUNT\", \"t61\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t75\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t75\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t57\".\"Id\") AS \"USERID\", \"t57\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t57\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t57\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t56\".\"POSTID\", \"t56\".\"TITLE\", \"t56\".\"SCORE\", \"t56\".\"CREATIONDATE\", \"t56\".\"OWNERUSERID\", \"t56\".\"RAN\", \"t56\".\"COMMENTCOUNT\"\nFROM (SELECT \"t55\".\"Id\" AS \"POSTID\", \"t55\".\"Title\" AS \"TITLE\", \"t55\".\"Score\" AS \"SCORE\", \"t55\".\"CreationDate\" AS \"CREATIONDATE\", \"t55\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t55\".\"OwnerUserId\" ORDER BY \"t55\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t54\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t54\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t54\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t55\" ON \"t54\".\"PostId\" = \"t55\".\"Id\") AS \"t56\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t56\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t57\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t57\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t57\".\"Id\", \"t57\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t61\"\nLEFT JOIN (SELECT \"t71\".\"USERID\" AS \"UserId\", CASE WHEN \"t74\".\"EXPR$0\" IS NOT NULL THEN \"t74\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t70\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t66\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t65\".\"POSTID\", \"t65\".\"TITLE\", \"t65\".\"SCORE\", \"t65\".\"CREATIONDATE\", \"t65\".\"OWNERUSERID\", \"t65\".\"RAN\", \"t65\".\"COMMENTCOUNT\"\nFROM (SELECT \"t64\".\"Id\" AS \"POSTID\", \"t64\".\"Title\" AS \"TITLE\", \"t64\".\"Score\" AS \"SCORE\", \"t64\".\"CreationDate\" AS \"CREATIONDATE\", \"t64\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t64\".\"OwnerUserId\" ORDER BY \"t64\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t63\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t64\" ON \"t63\".\"PostId\" = \"t64\".\"Id\") AS \"t65\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t65\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t66\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t66\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t66\".\"Id\", \"t66\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t70\"\nGROUP BY \"t70\".\"USERID\") AS \"t71\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t74\" ON \"t71\".\"USERID\" IS NOT DISTINCT FROM \"t74\".\"UserId\") AS \"t75\" ON \"t61\".\"USERID\" = \"t75\".\"UserId\") AS \"t76\"\nLEFT JOIN (SELECT \"t101\".\"USERID\" AS \"UserId\", CASE WHEN \"t104\".\"EXPR$0\" IS NOT NULL THEN \"t104\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t85\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t81\".\"Id\") AS \"USERID\", \"t81\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t81\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t81\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t80\".\"POSTID\", \"t80\".\"TITLE\", \"t80\".\"SCORE\", \"t80\".\"CREATIONDATE\", \"t80\".\"OWNERUSERID\", \"t80\".\"RAN\", \"t80\".\"COMMENTCOUNT\"\nFROM (SELECT \"t79\".\"Id\" AS \"POSTID\", \"t79\".\"Title\" AS \"TITLE\", \"t79\".\"Score\" AS \"SCORE\", \"t79\".\"CreationDate\" AS \"CREATIONDATE\", \"t79\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t79\".\"OwnerUserId\" ORDER BY \"t79\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t78\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t78\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t78\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t79\" ON \"t78\".\"PostId\" = \"t79\".\"Id\") AS \"t80\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t80\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t81\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t81\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t81\".\"Id\", \"t81\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t85\"\nLEFT JOIN (SELECT \"t95\".\"USERID\" AS \"UserId\", CASE WHEN \"t98\".\"EXPR$0\" IS NOT NULL THEN \"t98\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t94\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t90\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t89\".\"POSTID\", \"t89\".\"TITLE\", \"t89\".\"SCORE\", \"t89\".\"CREATIONDATE\", \"t89\".\"OWNERUSERID\", \"t89\".\"RAN\", \"t89\".\"COMMENTCOUNT\"\nFROM (SELECT \"t88\".\"Id\" AS \"POSTID\", \"t88\".\"Title\" AS \"TITLE\", \"t88\".\"Score\" AS \"SCORE\", \"t88\".\"CreationDate\" AS \"CREATIONDATE\", \"t88\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t88\".\"OwnerUserId\" ORDER BY \"t88\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t87\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t87\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t87\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t88\" ON \"t87\".\"PostId\" = \"t88\".\"Id\") AS \"t89\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t89\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t90\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t90\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t90\".\"Id\", \"t90\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t94\"\nGROUP BY \"t94\".\"USERID\") AS \"t95\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t98\" ON \"t95\".\"USERID\" IS NOT DISTINCT FROM \"t98\".\"UserId\") AS \"t99\" ON \"t85\".\"USERID\" = \"t99\".\"UserId\"\nGROUP BY \"t85\".\"USERID\") AS \"t101\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t104\" ON \"t101\".\"USERID\" IS NOT DISTINCT FROM \"t104\".\"UserId\") AS \"t105\" ON \"t76\".\"USERID\" = \"t105\".\"UserId\"\nGROUP BY \"t76\".\"USERID\") AS \"t107\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t110\" ON \"t107\".\"USERID\" IS NOT DISTINCT FROM \"t110\".\"UserId\") AS \"t111\" ON \"t52\".\"USERID\" = \"t111\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_7",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_8",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_9",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"USERID\", \"USERID\") AS \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\", \"SCORECATEGORY\", \"GOLDBADGES\", \"SILVERBADGES\", \"BRONZEBADGES\"\nFROM (SELECT \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\", CASE WHEN \"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"TOTALSCORE\" >= 50 AND \"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"FD_COL_7\" AS \"GOLDBADGES\", \"FD_COL_8\" AS \"SILVERBADGES\", \"FD_COL_9\" AS \"BRONZEBADGES\"\nFROM \"s1\"\nORDER BY \"TOTALSCORE\" DESC NULLS FIRST, \"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43760",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43760,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 4,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3.014251564821833E11,
        "cutRowSizeOutBytes" : 112.0,
        "cutOutputBytes" : 3.3759617526004527E13,
        "transferEstimatedMs" : 3.783098769145801E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 76,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "AGGREGATE" : 14,
            "FILTER" : 11,
            "OTHER" : 33,
            "JOIN" : 18
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 82,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 33,
            "JOIN" : 20,
            "AGGREGATE" : 16,
            "FILTER" : 12,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t22\".\"USERID\", \"t22\".\"USERID\") AS \"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", \"t22\".\"EXPR$0\" AS \"FD_COL_7\", CASE WHEN \"t51\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t51\".\"EXPR$0\" END AS \"FD_COL_8\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_7",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_8",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"s1\".\"USERID\", \"s1\".\"DISPLAYNAME\", \"s1\".\"TOTALPOSTS\", \"s1\".\"TOTALSCORE\", \"s1\".\"UPVOTECOUNT\", \"s1\".\"DOWNVOTECOUNT\", \"s1\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"s1\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"s1\".\"TOTALSCORE\" >= 50 AND \"s1\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"s1\".\"FD_COL_7\" AS \"GOLDBADGES\", \"s1\".\"FD_COL_8\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"s1\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"s1\".\"TOTALSCORE\" DESC NULLS FIRST, \"s1\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43670",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43670,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 549021.9999990364,
        "cutRowSizeOutBytes" : 88.0,
        "cutOutputBytes" : 4.8313935999915205E7,
        "transferEstimatedMs" : 136.93151546151228,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 36,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "AGGREGATE" : 6,
            "FILTER" : 5,
            "OTHER" : 17,
            "JOIN" : 8
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 122,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "JOIN" : 30,
            "AGGREGATE" : 24,
            "FILTER" : 18,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"FD_COL_7\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_7",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"s1\".\"USERID\", \"s1\".\"DISPLAYNAME\", \"s1\".\"TOTALPOSTS\", \"s1\".\"TOTALSCORE\", \"s1\".\"UPVOTECOUNT\", \"s1\".\"DOWNVOTECOUNT\", \"s1\".\"AVGCOMMENTSPERPOST\", \"s1\".\"FD_COL_7\" AS \"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"s1\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43625",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43625,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"s1\".\"USERID\", \"s1\".\"DISPLAYNAME\", \"s1\".\"TOTALPOSTS\", \"s1\".\"TOTALSCORE\", \"s1\".\"UPVOTECOUNT\", \"s1\".\"DOWNVOTECOUNT\", \"s1\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"s1\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43621",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43621,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43619",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43619,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 3,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\", \"DISPLAYNAME\", COUNT(DISTINCT \"Id0\") AS \"TOTALPOSTS\", SUM(\"Score\") AS \"TOTALSCORE\", SUM(\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(\"FD_COL_6\") AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43614",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43614,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 6,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\", \"s1\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"s1\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"s1\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"s1\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43609",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43609,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 15,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" ON \"s1\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43602",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43602,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"t2\".\"Id\" AS \"POSTID\", \"t2\".\"Title\" AS \"TITLE\", \"t2\".\"Score\" AS \"SCORE\", \"t2\".\"CreationDate\" AS \"CREATIONDATE\", \"t2\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t2\".\"OwnerUserId\" ORDER BY \"t2\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t2\" ON \"s1\".\"PostId\" = \"t2\".\"Id\") AS \"t3\"\nRIGHT JOIN \"Users\" ON \"t3\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43600",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43600,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"t2\".\"Id\" AS \"POSTID\", \"t2\".\"Title\" AS \"TITLE\", \"t2\".\"Score\" AS \"SCORE\", \"t2\".\"CreationDate\" AS \"CREATIONDATE\", \"t2\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t2\".\"OwnerUserId\" ORDER BY \"t2\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t2\" ON \"t1\".\"PostId\" = \"t2\".\"Id\") AS \"t3\"\nRIGHT JOIN \"Users\" ON \"t3\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43864",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43864,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 27,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 28,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t59\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t72\".\"USERID\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t68\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t72\"\nGROUP BY \"t72\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t63\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t87\".\"USERID\"\nFROM (SELECT MIN(\"t83\".\"Id\") AS \"USERID\", \"t83\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t83\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t83\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t83\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t83\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t82\".\"POSTID\", \"t82\".\"TITLE\", \"t82\".\"SCORE\", \"t82\".\"CREATIONDATE\", \"t82\".\"OWNERUSERID\", \"t82\".\"RAN\", \"t82\".\"COMMENTCOUNT\"\nFROM (SELECT \"t81\".\"Id\" AS \"POSTID\", \"t81\".\"Title\" AS \"TITLE\", \"t81\".\"Score\" AS \"SCORE\", \"t81\".\"CreationDate\" AS \"CREATIONDATE\", \"t81\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t81\".\"OwnerUserId\" ORDER BY \"t81\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t80\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t80\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t80\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t81\" ON \"t80\".\"PostId\" = \"t81\".\"Id\") AS \"t82\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t82\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t83\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t83\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t83\".\"Id\", \"t83\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t87\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t87\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t87\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t78\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t78\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43605",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43605,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN \"s1\" ON \"t2\".\"PostId\" = \"s1\".\"Id\") AS \"t3\"\nRIGHT JOIN \"Users\" ON \"t3\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_25",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 25,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 22,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 3850116.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 4.661265338000001E9,
        "transferEstimatedMs" : 2164.3439737547246,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 157,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"s10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"s10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"t2\".\"Id\" AS \"POSTID\", \"t2\".\"Title\" AS \"TITLE\", \"t2\".\"Score\" AS \"SCORE\", \"t2\".\"CreationDate\" AS \"CREATIONDATE\", \"t2\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t2\".\"OwnerUserId\" ORDER BY \"t2\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t1\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t2\" ON \"t1\".\"PostId\" = \"t2\".\"Id\") AS \"t3\"\nRIGHT JOIN \"Users\" ON \"t3\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"s1\" AS \"s10\" ON \"t4\".\"Id\" = \"s10\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s10\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"s1\" AS \"s12\" ON \"t13\".\"Id\" = \"s12\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s12\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"s14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"s14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"s1\" AS \"s14\" ON \"t28\".\"Id\" = \"s14\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s14\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"s1\" AS \"s16\" ON \"t37\".\"Id\" = \"s16\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s16\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"s18\".\"Id\") AS \"TOTALPOSTS\", SUM(\"s18\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"s1\" AS \"s18\" ON \"t58\".\"Id\" = \"s18\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s18\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"s1\" AS \"s110\" ON \"t67\".\"Id\" = \"s110\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s110\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"s112\".\"Id\") AS \"TOTALPOSTS\", SUM(\"s112\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"s1\" AS \"s112\" ON \"t82\".\"Id\" = \"s112\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s112\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"s1\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"s1\" AS \"s114\" ON \"t91\".\"Id\" = \"s114\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"s114\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_42612",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 42612,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 24,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 1260710.0,
        "cutRowSizeOutBytes" : 148.1378556527671,
        "cutOutputBytes" : 1.86758876E8,
        "transferEstimatedMs" : 248.6310451791772,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 157,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"Reputation\", \"CreationDate\", \"DisplayName\", \"LastAccessDate\", \"WebsiteUrl\", \"Location\", \"AboutMe\", \"Views\", \"UpVotes\", \"DownVotes\", \"ProfileImageUrl\", \"AccountId\"\nFROM \"Users\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"s1\".\"Id\", \"s1\".\"Reputation\", \"s1\".\"CreationDate\", \"s1\".\"DisplayName\", \"s1\".\"LastAccessDate\", \"s1\".\"WebsiteUrl\", \"s1\".\"Location\", \"s1\".\"AboutMe\", \"s1\".\"Views\", \"s1\".\"UpVotes\", \"s1\".\"DownVotes\", \"s1\".\"ProfileImageUrl\", \"s1\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"t2\".\"Id\" AS \"POSTID\", \"t2\".\"Title\" AS \"TITLE\", \"t2\".\"Score\" AS \"SCORE\", \"t2\".\"CreationDate\" AS \"CREATIONDATE\", \"t2\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t2\".\"OwnerUserId\" ORDER BY \"t2\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t2\" ON \"t1\".\"PostId\" = \"t2\".\"Id\") AS \"t3\"\nRIGHT JOIN \"s1\" ON \"t3\".\"OWNERUSERID\" = \"s1\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"s10\".\"Id\", \"s10\".\"Reputation\", \"s10\".\"CreationDate\", \"s10\".\"DisplayName\", \"s10\".\"LastAccessDate\", \"s10\".\"WebsiteUrl\", \"s10\".\"Location\", \"s10\".\"AboutMe\", \"s10\".\"Views\", \"s10\".\"UpVotes\", \"s10\".\"DownVotes\", \"s10\".\"ProfileImageUrl\", \"s10\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"s1\" AS \"s10\" ON \"t12\".\"OWNERUSERID\" = \"s10\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"s11\".\"Id\", \"s11\".\"Reputation\", \"s11\".\"CreationDate\", \"s11\".\"DisplayName\", \"s11\".\"LastAccessDate\", \"s11\".\"WebsiteUrl\", \"s11\".\"Location\", \"s11\".\"AboutMe\", \"s11\".\"Views\", \"s11\".\"UpVotes\", \"s11\".\"DownVotes\", \"s11\".\"ProfileImageUrl\", \"s11\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"s1\" AS \"s11\" ON \"t27\".\"OWNERUSERID\" = \"s11\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"s12\".\"Id\", \"s12\".\"Reputation\", \"s12\".\"CreationDate\", \"s12\".\"DisplayName\", \"s12\".\"LastAccessDate\", \"s12\".\"WebsiteUrl\", \"s12\".\"Location\", \"s12\".\"AboutMe\", \"s12\".\"Views\", \"s12\".\"UpVotes\", \"s12\".\"DownVotes\", \"s12\".\"ProfileImageUrl\", \"s12\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"s1\" AS \"s12\" ON \"t36\".\"OWNERUSERID\" = \"s12\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"s13\".\"Id\", \"s13\".\"Reputation\", \"s13\".\"CreationDate\", \"s13\".\"DisplayName\", \"s13\".\"LastAccessDate\", \"s13\".\"WebsiteUrl\", \"s13\".\"Location\", \"s13\".\"AboutMe\", \"s13\".\"Views\", \"s13\".\"UpVotes\", \"s13\".\"DownVotes\", \"s13\".\"ProfileImageUrl\", \"s13\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"s1\" AS \"s13\" ON \"t57\".\"OWNERUSERID\" = \"s13\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"s14\".\"Id\", \"s14\".\"Reputation\", \"s14\".\"CreationDate\", \"s14\".\"DisplayName\", \"s14\".\"LastAccessDate\", \"s14\".\"WebsiteUrl\", \"s14\".\"Location\", \"s14\".\"AboutMe\", \"s14\".\"Views\", \"s14\".\"UpVotes\", \"s14\".\"DownVotes\", \"s14\".\"ProfileImageUrl\", \"s14\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"s1\" AS \"s14\" ON \"t66\".\"OWNERUSERID\" = \"s14\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"s15\".\"Id\", \"s15\".\"Reputation\", \"s15\".\"CreationDate\", \"s15\".\"DisplayName\", \"s15\".\"LastAccessDate\", \"s15\".\"WebsiteUrl\", \"s15\".\"Location\", \"s15\".\"AboutMe\", \"s15\".\"Views\", \"s15\".\"UpVotes\", \"s15\".\"DownVotes\", \"s15\".\"ProfileImageUrl\", \"s15\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"s1\" AS \"s15\" ON \"t81\".\"OWNERUSERID\" = \"s15\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"s16\".\"Id\", \"s16\".\"Reputation\", \"s16\".\"CreationDate\", \"s16\".\"DisplayName\", \"s16\".\"LastAccessDate\", \"s16\".\"WebsiteUrl\", \"s16\".\"Location\", \"s16\".\"AboutMe\", \"s16\".\"Views\", \"s16\".\"UpVotes\", \"s16\".\"DownVotes\", \"s16\".\"ProfileImageUrl\", \"s16\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"s1\" AS \"s16\" ON \"t90\".\"OWNERUSERID\" = \"s16\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43666",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43666,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.698010705604928E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.3675225693451828E13,
        "transferEstimatedMs" : 5.2466393316705965E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 22,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "AGGREGATE" : 4,
            "FILTER" : 3,
            "OTHER" : 11,
            "JOIN" : 4
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 55,
            "JOIN" : 34,
            "AGGREGATE" : 26,
            "FILTER" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t8\".\"USERID\", \"t8\".\"USERID\") AS \"UserId\", CASE WHEN \"t11\".\"EXPR$0\" IS NOT NULL THEN \"t11\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\") AS \"t8\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t11\" ON \"t8\".\"USERID\" IS NOT DISTINCT FROM \"t11\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\", \"t18\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t18\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t18\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t18\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t18\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t17\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t18\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t22\"\nLEFT JOIN \"s1\" ON \"t22\".\"USERID\" = \"s1\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43655",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43655,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8302794.546081011,
        "transferEstimatedMs" : 162.19871464388137,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 16,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "AGGREGATE" : 3,
            "FILTER" : 2,
            "OTHER" : 8,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 142,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 27,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t18\".\"USERID\", \"t18\".\"DISPLAYNAME\", \"t18\".\"TOTALPOSTS\", \"t18\".\"TOTALSCORE\", \"t18\".\"UPVOTECOUNT\", \"t18\".\"DOWNVOTECOUNT\", \"t18\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\", \"t14\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t14\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t14\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t18\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43653",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43653,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "AGGREGATE" : 2,
            "FILTER" : 2,
            "OTHER" : 8,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t17\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43649",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43649,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "AGGREGATE" : 2,
            "OTHER" : 7,
            "FILTER" : 1,
            "JOIN" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0\nGROUP BY \"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t15\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43647",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43647,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t17\"\nGROUP BY \"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t14\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43642",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43642,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 2,
            "OTHER" : 6,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"s1\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t13\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43637",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43637,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 1,
            "OTHER" : 4,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"s1\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t12\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43630",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43630,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"s1\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t10\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43628",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43628,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t9\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43633",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43633,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN \"s1\" ON \"t11\".\"PostId\" = \"s1\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t9\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43662",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43662,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 10,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN \"s1\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t22\" ON \"t11\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43660",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43660,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t21\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t10\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43299",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43299,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 2321724.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 7.1992373E7,
        "transferEstimatedMs" : 292.9297356296617,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 1,
          "maxDepth" : 1,
          "operatorKindCounts" : {
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 157,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"UserId\", \"Name\", \"Date\", \"Class\", \"TagBased\"\nFROM \"Badges\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "Name",
          "type" : "VARCHAR"
        }, {
          "name" : "Date",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Class",
          "type" : "SMALLINT"
        }, {
          "name" : "TagBased",
          "type" : "BOOLEAN"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t23\".\"USERID\", \"t23\".\"DISPLAYNAME\", \"t23\".\"TOTALPOSTS\", \"t23\".\"TOTALSCORE\", \"t23\".\"UPVOTECOUNT\", \"t23\".\"DOWNVOTECOUNT\", \"t23\".\"AVGCOMMENTSPERPOST\", \"t23\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t8\".\"USERID\", \"t8\".\"DISPLAYNAME\", \"t8\".\"TOTALPOSTS\", \"t8\".\"TOTALSCORE\", \"t8\".\"UPVOTECOUNT\", \"t8\".\"DOWNVOTECOUNT\", \"t8\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t22\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t22\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t4\".\"Id\") AS \"USERID\", \"t4\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t4\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t4\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t3\".\"POSTID\", \"t3\".\"TITLE\", \"t3\".\"SCORE\", \"t3\".\"CREATIONDATE\", \"t3\".\"OWNERUSERID\", \"t3\".\"RAN\", \"t3\".\"COMMENTCOUNT\"\nFROM (SELECT \"t2\".\"Id\" AS \"POSTID\", \"t2\".\"Title\" AS \"TITLE\", \"t2\".\"Score\" AS \"SCORE\", \"t2\".\"CreationDate\" AS \"CREATIONDATE\", \"t2\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t2\".\"OwnerUserId\" ORDER BY \"t2\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t2\" ON \"t1\".\"PostId\" = \"t2\".\"Id\") AS \"t3\"\nRIGHT JOIN \"Users\" ON \"t3\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t4\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t4\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t4\".\"Id\", \"t4\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t8\"\nLEFT JOIN (SELECT \"t18\".\"USERID\" AS \"UserId\", CASE WHEN \"t21\".\"EXPR$0\" IS NOT NULL THEN \"t21\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t17\".\"USERID\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nGROUP BY \"t17\".\"USERID\") AS \"t18\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t21\" ON \"t18\".\"USERID\" IS NOT DISTINCT FROM \"t21\".\"UserId\") AS \"t22\" ON \"t8\".\"USERID\" = \"t22\".\"UserId\") AS \"t23\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t23\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43756",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43756,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.3407776516701404E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 5.617866364008337E12,
        "transferEstimatedMs" : 2.1553558290969595E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 42,
          "maxDepth" : 20,
          "operatorKindCounts" : {
            "JOIN" : 9,
            "OTHER" : 19,
            "AGGREGATE" : 8,
            "FILTER" : 6
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 116,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 47,
            "JOIN" : 29,
            "AGGREGATE" : 22,
            "FILTER" : 17,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t23\".\"USERID\", \"t23\".\"USERID\") AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"\nGROUP BY \"t7\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t52\".\"USERID\", \"t52\".\"DISPLAYNAME\", \"t52\".\"TOTALPOSTS\", \"t52\".\"TOTALSCORE\", \"t52\".\"UPVOTECOUNT\", \"t52\".\"DOWNVOTECOUNT\", \"t52\".\"AVGCOMMENTSPERPOST\", \"t52\".\"EXPR$0\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"EXPR$08\"\nFROM (SELECT \"t37\".\"USERID\", \"t37\".\"DISPLAYNAME\", \"t37\".\"TOTALPOSTS\", \"t37\".\"TOTALSCORE\", \"t37\".\"UPVOTECOUNT\", \"t37\".\"DOWNVOTECOUNT\", \"t37\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t51\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t51\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t32\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t33\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t41\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t42\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\") AS \"t52\"\nLEFT JOIN \"s1\" ON \"t52\".\"USERID\" = \"s1\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43745",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43745,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 426354.8482972674,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 3410838.786378139,
        "transferEstimatedMs" : 109.60994589861399,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 37,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 8,
            "OTHER" : 17,
            "AGGREGATE" : 7,
            "FILTER" : 5
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 121,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "JOIN" : 30,
            "AGGREGATE" : 23,
            "FILTER" : 18,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t48\".\"USERID\", \"t48\".\"DISPLAYNAME\", \"t48\".\"TOTALPOSTS\", \"t48\".\"TOTALSCORE\", \"t48\".\"UPVOTECOUNT\", \"t48\".\"DOWNVOTECOUNT\", \"t48\".\"AVGCOMMENTSPERPOST\", \"t48\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t33\".\"USERID\", \"t33\".\"DISPLAYNAME\", \"t33\".\"TOTALPOSTS\", \"t33\".\"TOTALSCORE\", \"t33\".\"UPVOTECOUNT\", \"t33\".\"DOWNVOTECOUNT\", \"t33\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t47\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t47\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\") AS \"t48\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t48\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43743",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43743,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 549021.9999990364,
        "cutRowSizeOutBytes" : 88.0,
        "cutOutputBytes" : 4.8313935999915205E7,
        "transferEstimatedMs" : 136.93151546151228,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 36,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 8,
            "OTHER" : 17,
            "AGGREGATE" : 6,
            "FILTER" : 5
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 122,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "JOIN" : 30,
            "AGGREGATE" : 24,
            "FILTER" : 18,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t47\".\"USERID\", \"t47\".\"DISPLAYNAME\", \"t47\".\"TOTALPOSTS\", \"t47\".\"TOTALSCORE\", \"t47\".\"UPVOTECOUNT\", \"t47\".\"DOWNVOTECOUNT\", \"t47\".\"AVGCOMMENTSPERPOST\", \"t47\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t46\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t46\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\") AS \"t47\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t47\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43698",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43698,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"USERID\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"s1\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"s1\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t32\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43694",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43694,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t30\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43692",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43692,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\", \"DISPLAYNAME\", COUNT(DISTINCT \"Id0\") AS \"TOTALPOSTS\", SUM(\"Score\") AS \"TOTALSCORE\", SUM(\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(\"FD_COL_6\") AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t29\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43687",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43687,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "JOIN" : 2,
            "OTHER" : 6,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\", \"s1\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"s1\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"s1\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"s1\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t28\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43682",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43682,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "JOIN" : 1,
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"s1\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t27\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43675",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43675,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"s1\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t25\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43673",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43673,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t24\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43678",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43678,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t32\".\"USERID\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN \"s1\" ON \"t26\".\"PostId\" = \"s1\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t32\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t24\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43739",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43739,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.698010705604928E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.3675225693451828E13,
        "transferEstimatedMs" : 5.2466393316705965E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 22,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 4,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "FILTER" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 55,
            "JOIN" : 34,
            "AGGREGATE" : 26,
            "FILTER" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t8\".\"USERID\", \"t8\".\"USERID\") AS \"UserId\", CASE WHEN \"t11\".\"EXPR$0\" IS NOT NULL THEN \"t11\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\") AS \"t8\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t11\" ON \"t8\".\"USERID\" IS NOT DISTINCT FROM \"t11\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t37\".\"USERID\", \"t37\".\"DISPLAYNAME\", \"t37\".\"TOTALPOSTS\", \"t37\".\"TOTALSCORE\", \"t37\".\"UPVOTECOUNT\", \"t37\".\"DOWNVOTECOUNT\", \"t37\".\"AVGCOMMENTSPERPOST\", \"t37\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t36\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t36\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\", \"t18\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t18\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t18\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t18\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t18\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t17\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t18\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t22\"\nLEFT JOIN (SELECT \"t32\".\"USERID\" AS \"UserId\", CASE WHEN \"t35\".\"EXPR$0\" IS NOT NULL THEN \"t35\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT MIN(\"t27\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nGROUP BY \"t31\".\"USERID\") AS \"t32\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t35\" ON \"t32\".\"USERID\" IS NOT DISTINCT FROM \"t35\".\"UserId\") AS \"t36\" ON \"t22\".\"USERID\" = \"t36\".\"UserId\") AS \"t37\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\", \"t42\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t42\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t42\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t42\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t42\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t41\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t42\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t46\"\nLEFT JOIN \"s1\" ON \"t46\".\"USERID\" = \"s1\".\"UserId\"\nGROUP BY \"t46\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t37\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43728",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43728,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8302794.546081011,
        "transferEstimatedMs" : 162.19871464388137,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 16,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 3,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 142,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 27,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t33\".\"USERID\", \"t33\".\"DISPLAYNAME\", \"t33\".\"TOTALPOSTS\", \"t33\".\"TOTALSCORE\", \"t33\".\"UPVOTECOUNT\", \"t33\".\"DOWNVOTECOUNT\", \"t33\".\"AVGCOMMENTSPERPOST\", \"t33\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t18\".\"USERID\", \"t18\".\"DISPLAYNAME\", \"t18\".\"TOTALPOSTS\", \"t18\".\"TOTALSCORE\", \"t18\".\"UPVOTECOUNT\", \"t18\".\"DOWNVOTECOUNT\", \"t18\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t32\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t32\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\", \"t14\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t14\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t14\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nLEFT JOIN (SELECT \"t28\".\"USERID\" AS \"UserId\", CASE WHEN \"t31\".\"EXPR$0\" IS NOT NULL THEN \"t31\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t27\".\"USERID\"\nFROM (SELECT MIN(\"t23\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t22\".\"POSTID\", \"t22\".\"TITLE\", \"t22\".\"SCORE\", \"t22\".\"CREATIONDATE\", \"t22\".\"OWNERUSERID\", \"t22\".\"RAN\", \"t22\".\"COMMENTCOUNT\"\nFROM (SELECT \"t21\".\"Id\" AS \"POSTID\", \"t21\".\"Title\" AS \"TITLE\", \"t21\".\"Score\" AS \"SCORE\", \"t21\".\"CreationDate\" AS \"CREATIONDATE\", \"t21\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t21\".\"OwnerUserId\" ORDER BY \"t21\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t20\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t20\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t20\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t21\" ON \"t20\".\"PostId\" = \"t21\".\"Id\") AS \"t22\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t22\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t23\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t23\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t23\".\"Id\", \"t23\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t27\"\nGROUP BY \"t27\".\"USERID\") AS \"t28\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t31\" ON \"t28\".\"USERID\" IS NOT DISTINCT FROM \"t31\".\"UserId\") AS \"t32\" ON \"t18\".\"USERID\" = \"t32\".\"UserId\") AS \"t33\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\", \"t38\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t38\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t38\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t42\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t42\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t33\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43726",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43726,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\", \"t37\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t37\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t37\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t41\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t41\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t32\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43722",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43722,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"USERID\"\nFROM (SELECT MIN(\"t35\".\"Id\") AS \"USERID\", \"t35\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t35\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t35\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t34\".\"POSTID\", \"t34\".\"TITLE\", \"t34\".\"SCORE\", \"t34\".\"CREATIONDATE\", \"t34\".\"OWNERUSERID\", \"t34\".\"RAN\", \"t34\".\"COMMENTCOUNT\"\nFROM (SELECT \"t33\".\"Id\" AS \"POSTID\", \"t33\".\"Title\" AS \"TITLE\", \"t33\".\"Score\" AS \"SCORE\", \"t33\".\"CreationDate\" AS \"CREATIONDATE\", \"t33\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t33\".\"OwnerUserId\" ORDER BY \"t33\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t32\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t33\" ON \"t32\".\"PostId\" = \"t33\".\"Id\") AS \"t34\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t34\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t35\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t35\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t35\".\"Id\", \"t35\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t39\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0\nGROUP BY \"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t39\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t39\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t30\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43720",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43720,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"USERID\"\nFROM (SELECT MIN(\"t34\".\"Id\") AS \"USERID\", \"t34\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t34\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t34\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t33\".\"POSTID\", \"t33\".\"TITLE\", \"t33\".\"SCORE\", \"t33\".\"CREATIONDATE\", \"t33\".\"OWNERUSERID\", \"t33\".\"RAN\", \"t33\".\"COMMENTCOUNT\"\nFROM (SELECT \"t32\".\"Id\" AS \"POSTID\", \"t32\".\"Title\" AS \"TITLE\", \"t32\".\"Score\" AS \"SCORE\", \"t32\".\"CreationDate\" AS \"CREATIONDATE\", \"t32\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t32\".\"OwnerUserId\" ORDER BY \"t32\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t31\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t32\" ON \"t31\".\"PostId\" = \"t32\".\"Id\") AS \"t33\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t33\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t34\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t34\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t34\".\"Id\", \"t34\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t38\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t41\"\nGROUP BY \"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t38\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t38\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t29\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43715",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43715,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "JOIN" : 2,
            "OTHER" : 6,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"USERID\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t32\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t33\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"s1\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t37\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t37\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t28\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43710",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43710,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"USERID\"\nFROM (SELECT MIN(\"t32\".\"Id\") AS \"USERID\", \"t32\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t32\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t32\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t31\".\"POSTID\", \"t31\".\"TITLE\", \"t31\".\"SCORE\", \"t31\".\"CREATIONDATE\", \"t31\".\"OWNERUSERID\", \"t31\".\"RAN\", \"t31\".\"COMMENTCOUNT\"\nFROM (SELECT \"t30\".\"Id\" AS \"POSTID\", \"t30\".\"Title\" AS \"TITLE\", \"t30\".\"Score\" AS \"SCORE\", \"t30\".\"CreationDate\" AS \"CREATIONDATE\", \"t30\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t30\".\"OwnerUserId\" ORDER BY \"t30\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t29\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t30\" ON \"t29\".\"PostId\" = \"t30\".\"Id\") AS \"t31\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t31\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t32\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t32\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t32\".\"Id\", \"t32\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t36\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"s1\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t36\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t36\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t27\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43703",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43703,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"s1\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t34\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t25\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43701",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43701,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 24,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t33\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t24\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43706",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43706,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t29\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN \"s1\" ON \"t35\".\"PostId\" = \"s1\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t33\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t24\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43735",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43735,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN \"s1\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t46\" ON \"t35\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t26\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43733",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43733,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t45\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t34\".\"USERID\" = \"t46\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t25\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43752",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43752,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 8,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"t48\".\"EXPR$0\" IS NOT NULL THEN \"t48\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t48\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"t48\".\"UserId\") AS \"t49\" ON \"t35\".\"USERID\" = \"t49\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t51\"\nLEFT JOIN \"s1\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t52\" ON \"t26\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43750",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43750,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t53\".\"USERID\", \"t53\".\"DISPLAYNAME\", \"t53\".\"TOTALPOSTS\", \"t53\".\"TOTALSCORE\", \"t53\".\"UPVOTECOUNT\", \"t53\".\"DOWNVOTECOUNT\", \"t53\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t53\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t53\".\"TOTALSCORE\" >= 50 AND \"t53\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t53\".\"EXPR$0\" AS \"GOLDBADGES\", \"t53\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t52\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t52\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t51\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t25\".\"USERID\" = \"t52\".\"UserId\") AS \"t53\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t53\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t53\".\"TOTALSCORE\" DESC NULLS FIRST, \"t53\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43936",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43936,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 4,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.3407776516701404E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 5.617866364008337E12,
        "transferEstimatedMs" : 2.1553558290969595E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 82,
          "maxDepth" : 25,
          "operatorKindCounts" : {
            "JOIN" : 19,
            "OTHER" : 35,
            "AGGREGATE" : 16,
            "FILTER" : 12
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 76,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 31,
            "AGGREGATE" : 14,
            "FILTER" : 11,
            "JOIN" : 19,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t53\".\"USERID\", \"t53\".\"USERID\") AS \"UserId\", CASE WHEN \"t56\".\"EXPR$0\" IS NOT NULL THEN \"t56\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t22\".\"USERID\") AS \"t53\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t56\" ON \"t53\".\"USERID\" IS NOT DISTINCT FROM \"t56\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t112\".\"USERID\", \"t112\".\"DISPLAYNAME\", \"t112\".\"TOTALPOSTS\", \"t112\".\"TOTALSCORE\", \"t112\".\"UPVOTECOUNT\", \"t112\".\"DOWNVOTECOUNT\", \"t112\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t112\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t112\".\"TOTALSCORE\" >= 50 AND \"t112\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t112\".\"EXPR$0\" AS \"GOLDBADGES\", \"t112\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t82\".\"USERID\", \"t82\".\"DISPLAYNAME\", \"t82\".\"TOTALPOSTS\", \"t82\".\"TOTALSCORE\", \"t82\".\"UPVOTECOUNT\", \"t82\".\"DOWNVOTECOUNT\", \"t82\".\"AVGCOMMENTSPERPOST\", \"t82\".\"EXPR$0\", CASE WHEN \"t111\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t111\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t81\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t81\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t63\".\"Id\") AS \"USERID\", \"t63\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t63\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t63\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t62\".\"POSTID\", \"t62\".\"TITLE\", \"t62\".\"SCORE\", \"t62\".\"CREATIONDATE\", \"t62\".\"OWNERUSERID\", \"t62\".\"RAN\", \"t62\".\"COMMENTCOUNT\"\nFROM (SELECT \"t61\".\"Id\" AS \"POSTID\", \"t61\".\"Title\" AS \"TITLE\", \"t61\".\"Score\" AS \"SCORE\", \"t61\".\"CreationDate\" AS \"CREATIONDATE\", \"t61\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t61\".\"OwnerUserId\" ORDER BY \"t61\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t60\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t61\" ON \"t60\".\"PostId\" = \"t61\".\"Id\") AS \"t62\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t62\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t63\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t63\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t63\".\"Id\", \"t63\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t67\"\nLEFT JOIN (SELECT \"t77\".\"USERID\" AS \"UserId\", CASE WHEN \"t80\".\"EXPR$0\" IS NOT NULL THEN \"t80\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t76\".\"USERID\"\nFROM (SELECT MIN(\"t72\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t71\".\"POSTID\", \"t71\".\"TITLE\", \"t71\".\"SCORE\", \"t71\".\"CREATIONDATE\", \"t71\".\"OWNERUSERID\", \"t71\".\"RAN\", \"t71\".\"COMMENTCOUNT\"\nFROM (SELECT \"t70\".\"Id\" AS \"POSTID\", \"t70\".\"Title\" AS \"TITLE\", \"t70\".\"Score\" AS \"SCORE\", \"t70\".\"CreationDate\" AS \"CREATIONDATE\", \"t70\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t70\".\"OwnerUserId\" ORDER BY \"t70\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t69\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t69\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t69\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t70\" ON \"t69\".\"PostId\" = \"t70\".\"Id\") AS \"t71\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t71\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t72\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t72\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t72\".\"Id\", \"t72\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t76\"\nGROUP BY \"t76\".\"USERID\") AS \"t77\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t80\" ON \"t77\".\"USERID\" IS NOT DISTINCT FROM \"t80\".\"UserId\") AS \"t81\" ON \"t67\".\"USERID\" = \"t81\".\"UserId\") AS \"t82\"\nLEFT JOIN (SELECT \"t107\".\"USERID\" AS \"UserId\", CASE WHEN \"t110\".\"EXPR$0\" IS NOT NULL THEN \"t110\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t91\".\"USERID\"\nFROM (SELECT MIN(\"t87\".\"Id\") AS \"USERID\", \"t87\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t87\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t87\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t87\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t87\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t86\".\"POSTID\", \"t86\".\"TITLE\", \"t86\".\"SCORE\", \"t86\".\"CREATIONDATE\", \"t86\".\"OWNERUSERID\", \"t86\".\"RAN\", \"t86\".\"COMMENTCOUNT\"\nFROM (SELECT \"t85\".\"Id\" AS \"POSTID\", \"t85\".\"Title\" AS \"TITLE\", \"t85\".\"Score\" AS \"SCORE\", \"t85\".\"CreationDate\" AS \"CREATIONDATE\", \"t85\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t85\".\"OwnerUserId\" ORDER BY \"t85\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t84\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t85\" ON \"t84\".\"PostId\" = \"t85\".\"Id\") AS \"t86\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t86\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t87\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t87\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t87\".\"Id\", \"t87\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t91\"\nLEFT JOIN (SELECT \"t101\".\"USERID\" AS \"UserId\", CASE WHEN \"t104\".\"EXPR$0\" IS NOT NULL THEN \"t104\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t100\".\"USERID\"\nFROM (SELECT MIN(\"t96\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t95\".\"POSTID\", \"t95\".\"TITLE\", \"t95\".\"SCORE\", \"t95\".\"CREATIONDATE\", \"t95\".\"OWNERUSERID\", \"t95\".\"RAN\", \"t95\".\"COMMENTCOUNT\"\nFROM (SELECT \"t94\".\"Id\" AS \"POSTID\", \"t94\".\"Title\" AS \"TITLE\", \"t94\".\"Score\" AS \"SCORE\", \"t94\".\"CreationDate\" AS \"CREATIONDATE\", \"t94\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t94\".\"OwnerUserId\" ORDER BY \"t94\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t93\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t93\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t93\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t94\" ON \"t93\".\"PostId\" = \"t94\".\"Id\") AS \"t95\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t95\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t96\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t96\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t96\".\"Id\", \"t96\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t100\"\nGROUP BY \"t100\".\"USERID\") AS \"t101\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t104\" ON \"t101\".\"USERID\" IS NOT DISTINCT FROM \"t104\".\"UserId\") AS \"t105\" ON \"t91\".\"USERID\" = \"t105\".\"UserId\"\nGROUP BY \"t91\".\"USERID\") AS \"t107\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t110\" ON \"t107\".\"USERID\" IS NOT DISTINCT FROM \"t110\".\"UserId\") AS \"t111\" ON \"t82\".\"USERID\" = \"t111\".\"UserId\") AS \"t112\"\nLEFT JOIN \"s1\" ON \"t112\".\"USERID\" = \"s1\".\"UserId\"\nORDER BY \"t112\".\"TOTALSCORE\" DESC NULLS FIRST, \"t112\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43923",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43923,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 7,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3.014251564821833E11,
        "cutRowSizeOutBytes" : 112.0,
        "cutOutputBytes" : 3.3759617526004527E13,
        "transferEstimatedMs" : 3.783098769145801E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 76,
          "maxDepth" : 22,
          "operatorKindCounts" : {
            "JOIN" : 18,
            "OTHER" : 33,
            "AGGREGATE" : 14,
            "FILTER" : 11
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 82,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 33,
            "AGGREGATE" : 16,
            "FILTER" : 12,
            "JOIN" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t22\".\"USERID\", \"t22\".\"USERID\") AS \"USERID\"\nFROM (SELECT \"t7\".\"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\") AS \"t22\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t27\".\"Id\") AS \"USERID\", \"t27\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t27\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t27\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nLEFT JOIN (SELECT \"t41\".\"USERID\" AS \"UserId\", CASE WHEN \"t44\".\"EXPR$0\" IS NOT NULL THEN \"t44\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t40\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t36\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t35\".\"POSTID\", \"t35\".\"TITLE\", \"t35\".\"SCORE\", \"t35\".\"CREATIONDATE\", \"t35\".\"OWNERUSERID\", \"t35\".\"RAN\", \"t35\".\"COMMENTCOUNT\"\nFROM (SELECT \"t34\".\"Id\" AS \"POSTID\", \"t34\".\"Title\" AS \"TITLE\", \"t34\".\"Score\" AS \"SCORE\", \"t34\".\"CreationDate\" AS \"CREATIONDATE\", \"t34\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t34\".\"OwnerUserId\" ORDER BY \"t34\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t33\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t34\" ON \"t33\".\"PostId\" = \"t34\".\"Id\") AS \"t35\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t35\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t36\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t36\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t36\".\"Id\", \"t36\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t40\"\nGROUP BY \"t40\".\"USERID\") AS \"t41\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t44\" ON \"t41\".\"USERID\" IS NOT DISTINCT FROM \"t44\".\"UserId\") AS \"t45\" ON \"t31\".\"USERID\" = \"t45\".\"UserId\"\nGROUP BY \"t31\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t22\".\"USERID\" = \"t51\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t107\".\"USERID\", \"t107\".\"DISPLAYNAME\", \"t107\".\"TOTALPOSTS\", \"t107\".\"TOTALSCORE\", \"t107\".\"UPVOTECOUNT\", \"t107\".\"DOWNVOTECOUNT\", \"t107\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t107\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t107\".\"TOTALSCORE\" >= 50 AND \"t107\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t107\".\"EXPR$0\" AS \"GOLDBADGES\", \"t107\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t77\".\"USERID\", \"t77\".\"DISPLAYNAME\", \"t77\".\"TOTALPOSTS\", \"t77\".\"TOTALSCORE\", \"t77\".\"UPVOTECOUNT\", \"t77\".\"DOWNVOTECOUNT\", \"t77\".\"AVGCOMMENTSPERPOST\", \"t77\".\"EXPR$0\", CASE WHEN \"t106\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t106\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\") AS \"t107\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t107\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t107\".\"TOTALSCORE\" DESC NULLS FIRST, \"t107\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43833",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43833,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 549021.9999990364,
        "cutRowSizeOutBytes" : 88.0,
        "cutOutputBytes" : 4.8313935999915205E7,
        "transferEstimatedMs" : 136.93151546151228,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 36,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "OTHER" : 17,
            "JOIN" : 8,
            "AGGREGATE" : 6,
            "FILTER" : 5
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 122,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "AGGREGATE" : 24,
            "FILTER" : 18,
            "JOIN" : 30,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\", \"t7\".\"DISPLAYNAME\", \"t7\".\"TOTALPOSTS\", \"t7\".\"TOTALSCORE\", \"t7\".\"UPVOTECOUNT\", \"t7\".\"DOWNVOTECOUNT\", \"t7\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t21\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t21\".\"EXPR$0\" END AS \"FD_COL_7\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "FD_COL_7",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t77\".\"USERID\", \"t77\".\"DISPLAYNAME\", \"t77\".\"TOTALPOSTS\", \"t77\".\"TOTALSCORE\", \"t77\".\"UPVOTECOUNT\", \"t77\".\"DOWNVOTECOUNT\", \"t77\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t77\".\"TOTALSCORE\" >= 50 AND \"t77\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t77\".\"EXPR$0\" AS \"GOLDBADGES\", \"t77\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t47\".\"USERID\", \"t47\".\"DISPLAYNAME\", \"t47\".\"TOTALPOSTS\", \"t47\".\"TOTALSCORE\", \"t47\".\"UPVOTECOUNT\", \"t47\".\"DOWNVOTECOUNT\", \"t47\".\"AVGCOMMENTSPERPOST\", \"t47\".\"EXPR$0\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t46\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t46\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\") AS \"t47\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t56\".\"USERID\"\nFROM (SELECT MIN(\"t52\".\"Id\") AS \"USERID\", \"t52\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t52\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t52\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t52\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t52\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t51\".\"POSTID\", \"t51\".\"TITLE\", \"t51\".\"SCORE\", \"t51\".\"CREATIONDATE\", \"t51\".\"OWNERUSERID\", \"t51\".\"RAN\", \"t51\".\"COMMENTCOUNT\"\nFROM (SELECT \"t50\".\"Id\" AS \"POSTID\", \"t50\".\"Title\" AS \"TITLE\", \"t50\".\"Score\" AS \"SCORE\", \"t50\".\"CreationDate\" AS \"CREATIONDATE\", \"t50\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t50\".\"OwnerUserId\" ORDER BY \"t50\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t49\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t49\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t49\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t50\" ON \"t49\".\"PostId\" = \"t50\".\"Id\") AS \"t51\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t51\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t52\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t52\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t52\".\"Id\", \"t52\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t56\"\nLEFT JOIN (SELECT \"t66\".\"USERID\" AS \"UserId\", CASE WHEN \"t69\".\"EXPR$0\" IS NOT NULL THEN \"t69\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"USERID\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t60\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t61\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t65\"\nGROUP BY \"t65\".\"USERID\") AS \"t66\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t69\" ON \"t66\".\"USERID\" IS NOT DISTINCT FROM \"t69\".\"UserId\") AS \"t70\" ON \"t56\".\"USERID\" = \"t70\".\"UserId\"\nGROUP BY \"t56\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t47\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"USERID\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"s1\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"s1\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t77\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t77\".\"TOTALSCORE\" DESC NULLS FIRST, \"t77\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43788",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43788,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "OTHER" : 8,
            "JOIN" : 3,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "JOIN" : 35,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t62\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t62\".\"TOTALSCORE\" >= 50 AND \"t62\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t62\".\"EXPR$0\" AS \"GOLDBADGES\", \"t62\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t61\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t61\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t57\".\"USERID\" AS \"UserId\", CASE WHEN \"t60\".\"EXPR$0\" IS NOT NULL THEN \"t60\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\", \"t37\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t37\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t37\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t50\".\"USERID\"\nFROM (SELECT MIN(\"t46\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t45\".\"POSTID\", \"t45\".\"TITLE\", \"t45\".\"SCORE\", \"t45\".\"CREATIONDATE\", \"t45\".\"OWNERUSERID\", \"t45\".\"RAN\", \"t45\".\"COMMENTCOUNT\"\nFROM (SELECT \"t44\".\"Id\" AS \"POSTID\", \"t44\".\"Title\" AS \"TITLE\", \"t44\".\"Score\" AS \"SCORE\", \"t44\".\"CreationDate\" AS \"CREATIONDATE\", \"t44\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t44\".\"OwnerUserId\" ORDER BY \"t44\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t43\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t43\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t43\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t44\" ON \"t43\".\"PostId\" = \"t44\".\"Id\") AS \"t45\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t45\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t46\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t46\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t46\".\"Id\", \"t46\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t50\"\nGROUP BY \"t50\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t41\".\"USERID\" = \"t55\".\"UserId\"\nGROUP BY \"t41\".\"USERID\") AS \"t57\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t60\" ON \"t57\".\"USERID\" IS NOT DISTINCT FROM \"t60\".\"UserId\") AS \"t61\" ON \"t32\".\"USERID\" = \"t61\".\"UserId\") AS \"t62\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"s1\".\"USERID\", \"s1\".\"DISPLAYNAME\", \"s1\".\"TOTALPOSTS\", \"s1\".\"TOTALSCORE\", \"s1\".\"UPVOTECOUNT\", \"s1\".\"DOWNVOTECOUNT\", \"s1\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"s1\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t62\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t62\".\"TOTALSCORE\" DESC NULLS FIRST, \"t62\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43784",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43784,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 3,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "FILTER" : 22,
            "OTHER" : 59,
            "AGGREGATE" : 28,
            "JOIN" : 35,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t60\".\"USERID\", \"t60\".\"DISPLAYNAME\", \"t60\".\"TOTALPOSTS\", \"t60\".\"TOTALSCORE\", \"t60\".\"UPVOTECOUNT\", \"t60\".\"DOWNVOTECOUNT\", \"t60\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t60\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t60\".\"TOTALSCORE\" >= 50 AND \"t60\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t60\".\"EXPR$0\" AS \"GOLDBADGES\", \"t60\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t59\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t59\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t55\".\"USERID\" AS \"UserId\", CASE WHEN \"t58\".\"EXPR$0\" IS NOT NULL THEN \"t58\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"USERID\"\nFROM (SELECT MIN(\"t35\".\"Id\") AS \"USERID\", \"t35\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t35\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t35\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t34\".\"POSTID\", \"t34\".\"TITLE\", \"t34\".\"SCORE\", \"t34\".\"CREATIONDATE\", \"t34\".\"OWNERUSERID\", \"t34\".\"RAN\", \"t34\".\"COMMENTCOUNT\"\nFROM (SELECT \"t33\".\"Id\" AS \"POSTID\", \"t33\".\"Title\" AS \"TITLE\", \"t33\".\"Score\" AS \"SCORE\", \"t33\".\"CreationDate\" AS \"CREATIONDATE\", \"t33\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t33\".\"OwnerUserId\" ORDER BY \"t33\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t32\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t33\" ON \"t32\".\"PostId\" = \"t33\".\"Id\") AS \"t34\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t34\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t35\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t35\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t35\".\"Id\", \"t35\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t39\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t48\".\"USERID\"\nFROM (SELECT MIN(\"t44\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t43\".\"POSTID\", \"t43\".\"TITLE\", \"t43\".\"SCORE\", \"t43\".\"CREATIONDATE\", \"t43\".\"OWNERUSERID\", \"t43\".\"RAN\", \"t43\".\"COMMENTCOUNT\"\nFROM (SELECT \"t42\".\"Id\" AS \"POSTID\", \"t42\".\"Title\" AS \"TITLE\", \"t42\".\"Score\" AS \"SCORE\", \"t42\".\"CreationDate\" AS \"CREATIONDATE\", \"t42\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t42\".\"OwnerUserId\" ORDER BY \"t42\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t41\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t41\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t41\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t42\" ON \"t41\".\"PostId\" = \"t42\".\"Id\") AS \"t43\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t43\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t44\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t44\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t44\".\"Id\", \"t44\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t48\"\nGROUP BY \"t48\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t39\".\"USERID\" = \"t53\".\"UserId\"\nGROUP BY \"t39\".\"USERID\") AS \"t55\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t58\" ON \"t55\".\"USERID\" IS NOT DISTINCT FROM \"t58\".\"UserId\") AS \"t59\" ON \"t30\".\"USERID\" = \"t59\".\"UserId\") AS \"t60\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t60\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t60\".\"TOTALSCORE\" DESC NULLS FIRST, \"t60\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43782",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43782,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 3,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "OTHER" : 59,
            "JOIN" : 35,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t59\".\"USERID\", \"t59\".\"DISPLAYNAME\", \"t59\".\"TOTALPOSTS\", \"t59\".\"TOTALSCORE\", \"t59\".\"UPVOTECOUNT\", \"t59\".\"DOWNVOTECOUNT\", \"t59\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t59\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t59\".\"TOTALSCORE\" >= 50 AND \"t59\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t59\".\"EXPR$0\" AS \"GOLDBADGES\", \"t59\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t58\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t58\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t54\".\"USERID\" AS \"UserId\", CASE WHEN \"t57\".\"EXPR$0\" IS NOT NULL THEN \"t57\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"USERID\"\nFROM (SELECT MIN(\"t34\".\"Id\") AS \"USERID\", \"t34\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t34\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t34\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t33\".\"POSTID\", \"t33\".\"TITLE\", \"t33\".\"SCORE\", \"t33\".\"CREATIONDATE\", \"t33\".\"OWNERUSERID\", \"t33\".\"RAN\", \"t33\".\"COMMENTCOUNT\"\nFROM (SELECT \"t32\".\"Id\" AS \"POSTID\", \"t32\".\"Title\" AS \"TITLE\", \"t32\".\"Score\" AS \"SCORE\", \"t32\".\"CreationDate\" AS \"CREATIONDATE\", \"t32\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t32\".\"OwnerUserId\" ORDER BY \"t32\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t31\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t32\" ON \"t31\".\"PostId\" = \"t32\".\"Id\") AS \"t33\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t33\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t34\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t34\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t34\".\"Id\", \"t34\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t38\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"USERID\"\nFROM (SELECT MIN(\"t43\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t42\".\"POSTID\", \"t42\".\"TITLE\", \"t42\".\"SCORE\", \"t42\".\"CREATIONDATE\", \"t42\".\"OWNERUSERID\", \"t42\".\"RAN\", \"t42\".\"COMMENTCOUNT\"\nFROM (SELECT \"t41\".\"Id\" AS \"POSTID\", \"t41\".\"Title\" AS \"TITLE\", \"t41\".\"Score\" AS \"SCORE\", \"t41\".\"CreationDate\" AS \"CREATIONDATE\", \"t41\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t41\".\"OwnerUserId\" ORDER BY \"t41\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t40\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t40\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t40\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t41\" ON \"t40\".\"PostId\" = \"t41\".\"Id\") AS \"t42\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t42\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t43\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t43\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t43\".\"Id\", \"t43\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t47\"\nGROUP BY \"t47\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t38\".\"USERID\" = \"t52\".\"UserId\"\nGROUP BY \"t38\".\"USERID\") AS \"t54\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t57\" ON \"t54\".\"USERID\" IS NOT DISTINCT FROM \"t57\".\"UserId\") AS \"t58\" ON \"t29\".\"USERID\" = \"t58\".\"UserId\") AS \"t59\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\", \"DISPLAYNAME\", COUNT(DISTINCT \"Id0\") AS \"TOTALPOSTS\", SUM(\"Score\") AS \"TOTALSCORE\", SUM(\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(\"FD_COL_6\") AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t59\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t59\".\"TOTALSCORE\" DESC NULLS FIRST, \"t59\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43777",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43777,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 6,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "JOIN" : 36,
            "OTHER" : 60,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t58\".\"USERID\", \"t58\".\"DISPLAYNAME\", \"t58\".\"TOTALPOSTS\", \"t58\".\"TOTALSCORE\", \"t58\".\"UPVOTECOUNT\", \"t58\".\"DOWNVOTECOUNT\", \"t58\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t58\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t58\".\"TOTALSCORE\" >= 50 AND \"t58\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t58\".\"EXPR$0\" AS \"GOLDBADGES\", \"t58\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t57\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t57\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t53\".\"USERID\" AS \"UserId\", CASE WHEN \"t56\".\"EXPR$0\" IS NOT NULL THEN \"t56\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"USERID\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t32\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t33\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t41\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t42\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t37\".\"USERID\") AS \"t53\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t56\" ON \"t53\".\"USERID\" IS NOT DISTINCT FROM \"t56\".\"UserId\") AS \"t57\" ON \"t28\".\"USERID\" = \"t57\".\"UserId\") AS \"t58\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\", \"s1\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"s1\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"s1\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"s1\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t58\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t58\".\"TOTALSCORE\" DESC NULLS FIRST, \"t58\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43772",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43772,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 18,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t57\".\"USERID\", \"t57\".\"DISPLAYNAME\", \"t57\".\"TOTALPOSTS\", \"t57\".\"TOTALSCORE\", \"t57\".\"UPVOTECOUNT\", \"t57\".\"DOWNVOTECOUNT\", \"t57\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t57\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t57\".\"TOTALSCORE\" >= 50 AND \"t57\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t57\".\"EXPR$0\" AS \"GOLDBADGES\", \"t57\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t56\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t56\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"USERID\"\nFROM (SELECT MIN(\"t32\".\"Id\") AS \"USERID\", \"t32\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t32\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t32\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t31\".\"POSTID\", \"t31\".\"TITLE\", \"t31\".\"SCORE\", \"t31\".\"CREATIONDATE\", \"t31\".\"OWNERUSERID\", \"t31\".\"RAN\", \"t31\".\"COMMENTCOUNT\"\nFROM (SELECT \"t30\".\"Id\" AS \"POSTID\", \"t30\".\"Title\" AS \"TITLE\", \"t30\".\"Score\" AS \"SCORE\", \"t30\".\"CreationDate\" AS \"CREATIONDATE\", \"t30\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t30\".\"OwnerUserId\" ORDER BY \"t30\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t29\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t30\" ON \"t29\".\"PostId\" = \"t30\".\"Id\") AS \"t31\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t31\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t32\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t32\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t32\".\"Id\", \"t32\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t36\"\nLEFT JOIN (SELECT \"t46\".\"USERID\" AS \"UserId\", CASE WHEN \"t49\".\"EXPR$0\" IS NOT NULL THEN \"t49\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"USERID\"\nFROM (SELECT MIN(\"t41\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t40\".\"POSTID\", \"t40\".\"TITLE\", \"t40\".\"SCORE\", \"t40\".\"CREATIONDATE\", \"t40\".\"OWNERUSERID\", \"t40\".\"RAN\", \"t40\".\"COMMENTCOUNT\"\nFROM (SELECT \"t39\".\"Id\" AS \"POSTID\", \"t39\".\"Title\" AS \"TITLE\", \"t39\".\"Score\" AS \"SCORE\", \"t39\".\"CreationDate\" AS \"CREATIONDATE\", \"t39\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t39\".\"OwnerUserId\" ORDER BY \"t39\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t38\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t39\" ON \"t38\".\"PostId\" = \"t39\".\"Id\") AS \"t40\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t40\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t41\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t41\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t41\".\"Id\", \"t41\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t45\"\nGROUP BY \"t45\".\"USERID\") AS \"t46\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t49\" ON \"t46\".\"USERID\" IS NOT DISTINCT FROM \"t49\".\"UserId\") AS \"t50\" ON \"t36\".\"USERID\" = \"t50\".\"UserId\"\nGROUP BY \"t36\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t27\".\"USERID\" = \"t56\".\"UserId\") AS \"t57\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"s1\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t57\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t57\".\"TOTALSCORE\" DESC NULLS FIRST, \"t57\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43765",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43765,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"s1\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43763",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43763,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"t56\".\"Id\" AS \"POSTID\", \"t56\".\"Title\" AS \"TITLE\", \"t56\".\"Score\" AS \"SCORE\", \"t56\".\"CreationDate\" AS \"CREATIONDATE\", \"t56\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t56\".\"OwnerUserId\" ORDER BY \"t56\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t55\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t55\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t55\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t56\" ON \"t55\".\"PostId\" = \"t56\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43768",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43768,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t29\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t38\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t58\".\"Id\") AS \"USERID\", \"t58\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t58\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t58\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t57\".\"POSTID\", \"t57\".\"TITLE\", \"t57\".\"SCORE\", \"t57\".\"CREATIONDATE\", \"t57\".\"OWNERUSERID\", \"t57\".\"RAN\", \"t57\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN \"s1\" ON \"t56\".\"PostId\" = \"s1\".\"Id\") AS \"t57\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t57\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t58\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t58\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t58\".\"Id\", \"t58\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t62\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t62\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43829",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43829,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.698010705604928E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.3675225693451828E13,
        "transferEstimatedMs" : 5.2466393316705965E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 22,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "JOIN" : 4,
            "OTHER" : 11,
            "AGGREGATE" : 4,
            "FILTER" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 55,
            "JOIN" : 34,
            "AGGREGATE" : 26,
            "FILTER" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t8\".\"USERID\", \"t8\".\"USERID\") AS \"UserId\", CASE WHEN \"t11\".\"EXPR$0\" IS NOT NULL THEN \"t11\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\") AS \"t8\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t11\" ON \"t8\".\"USERID\" IS NOT DISTINCT FROM \"t11\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t67\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t67\".\"TOTALSCORE\" >= 50 AND \"t67\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t67\".\"EXPR$0\" AS \"GOLDBADGES\", \"t67\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t37\".\"USERID\", \"t37\".\"DISPLAYNAME\", \"t37\".\"TOTALPOSTS\", \"t37\".\"TOTALSCORE\", \"t37\".\"UPVOTECOUNT\", \"t37\".\"DOWNVOTECOUNT\", \"t37\".\"AVGCOMMENTSPERPOST\", \"t37\".\"EXPR$0\", CASE WHEN \"t66\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t66\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t36\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t36\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\", \"t18\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t18\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t18\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t18\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t18\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t17\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t18\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t22\"\nLEFT JOIN (SELECT \"t32\".\"USERID\" AS \"UserId\", CASE WHEN \"t35\".\"EXPR$0\" IS NOT NULL THEN \"t35\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT MIN(\"t27\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nGROUP BY \"t31\".\"USERID\") AS \"t32\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t35\" ON \"t32\".\"USERID\" IS NOT DISTINCT FROM \"t35\".\"UserId\") AS \"t36\" ON \"t22\".\"USERID\" = \"t36\".\"UserId\") AS \"t37\"\nLEFT JOIN (SELECT \"t62\".\"USERID\" AS \"UserId\", CASE WHEN \"t65\".\"EXPR$0\" IS NOT NULL THEN \"t65\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\", \"t42\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t42\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t42\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t42\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t42\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t41\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t42\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t46\"\nLEFT JOIN (SELECT \"t56\".\"USERID\" AS \"UserId\", CASE WHEN \"t59\".\"EXPR$0\" IS NOT NULL THEN \"t59\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t55\".\"USERID\"\nFROM (SELECT MIN(\"t51\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t50\".\"POSTID\", \"t50\".\"TITLE\", \"t50\".\"SCORE\", \"t50\".\"CREATIONDATE\", \"t50\".\"OWNERUSERID\", \"t50\".\"RAN\", \"t50\".\"COMMENTCOUNT\"\nFROM (SELECT \"t49\".\"Id\" AS \"POSTID\", \"t49\".\"Title\" AS \"TITLE\", \"t49\".\"Score\" AS \"SCORE\", \"t49\".\"CreationDate\" AS \"CREATIONDATE\", \"t49\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t49\".\"OwnerUserId\" ORDER BY \"t49\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t48\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t48\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t48\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t49\" ON \"t48\".\"PostId\" = \"t49\".\"Id\") AS \"t50\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t50\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t51\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t51\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t51\".\"Id\", \"t51\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t55\"\nGROUP BY \"t55\".\"USERID\") AS \"t56\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t59\" ON \"t56\".\"USERID\" IS NOT DISTINCT FROM \"t59\".\"UserId\") AS \"t60\" ON \"t46\".\"USERID\" = \"t60\".\"UserId\"\nGROUP BY \"t46\".\"USERID\") AS \"t62\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t65\" ON \"t62\".\"USERID\" IS NOT DISTINCT FROM \"t65\".\"UserId\") AS \"t66\" ON \"t37\".\"USERID\" = \"t66\".\"UserId\") AS \"t67\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t76\".\"USERID\", \"t76\".\"DISPLAYNAME\", \"t76\".\"TOTALPOSTS\", \"t76\".\"TOTALSCORE\", \"t76\".\"UPVOTECOUNT\", \"t76\".\"DOWNVOTECOUNT\", \"t76\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"s1\".\"FD_COL_1\" IS NULL THEN 0 ELSE \"s1\".\"FD_COL_1\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t72\".\"Id\") AS \"USERID\", \"t72\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t72\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t72\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t72\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t72\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t71\".\"POSTID\", \"t71\".\"TITLE\", \"t71\".\"SCORE\", \"t71\".\"CREATIONDATE\", \"t71\".\"OWNERUSERID\", \"t71\".\"RAN\", \"t71\".\"COMMENTCOUNT\"\nFROM (SELECT \"t70\".\"Id\" AS \"POSTID\", \"t70\".\"Title\" AS \"TITLE\", \"t70\".\"Score\" AS \"SCORE\", \"t70\".\"CreationDate\" AS \"CREATIONDATE\", \"t70\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t70\".\"OwnerUserId\" ORDER BY \"t70\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t69\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t69\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t69\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t70\" ON \"t69\".\"PostId\" = \"t70\".\"Id\") AS \"t71\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t71\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t72\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t72\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t72\".\"Id\", \"t72\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t76\"\nLEFT JOIN \"s1\" ON \"t76\".\"USERID\" = \"s1\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t67\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t67\".\"TOTALSCORE\" DESC NULLS FIRST, \"t67\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43818",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43818,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8302794.546081011,
        "transferEstimatedMs" : 162.19871464388137,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 16,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 3,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 142,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 27,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t63\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t63\".\"TOTALSCORE\" >= 50 AND \"t63\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t63\".\"EXPR$0\" AS \"GOLDBADGES\", \"t63\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t33\".\"USERID\", \"t33\".\"DISPLAYNAME\", \"t33\".\"TOTALPOSTS\", \"t33\".\"TOTALSCORE\", \"t33\".\"UPVOTECOUNT\", \"t33\".\"DOWNVOTECOUNT\", \"t33\".\"AVGCOMMENTSPERPOST\", \"t33\".\"EXPR$0\", CASE WHEN \"t62\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t62\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t18\".\"USERID\", \"t18\".\"DISPLAYNAME\", \"t18\".\"TOTALPOSTS\", \"t18\".\"TOTALSCORE\", \"t18\".\"UPVOTECOUNT\", \"t18\".\"DOWNVOTECOUNT\", \"t18\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t32\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t32\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\", \"t14\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t14\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t14\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nLEFT JOIN (SELECT \"t28\".\"USERID\" AS \"UserId\", CASE WHEN \"t31\".\"EXPR$0\" IS NOT NULL THEN \"t31\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t27\".\"USERID\"\nFROM (SELECT MIN(\"t23\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t22\".\"POSTID\", \"t22\".\"TITLE\", \"t22\".\"SCORE\", \"t22\".\"CREATIONDATE\", \"t22\".\"OWNERUSERID\", \"t22\".\"RAN\", \"t22\".\"COMMENTCOUNT\"\nFROM (SELECT \"t21\".\"Id\" AS \"POSTID\", \"t21\".\"Title\" AS \"TITLE\", \"t21\".\"Score\" AS \"SCORE\", \"t21\".\"CreationDate\" AS \"CREATIONDATE\", \"t21\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t21\".\"OwnerUserId\" ORDER BY \"t21\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t20\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t20\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t20\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t21\" ON \"t20\".\"PostId\" = \"t21\".\"Id\") AS \"t22\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t22\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t23\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t23\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t23\".\"Id\", \"t23\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t27\"\nGROUP BY \"t27\".\"USERID\") AS \"t28\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t31\" ON \"t28\".\"USERID\" IS NOT DISTINCT FROM \"t31\".\"UserId\") AS \"t32\" ON \"t18\".\"USERID\" = \"t32\".\"UserId\") AS \"t33\"\nLEFT JOIN (SELECT \"t58\".\"USERID\" AS \"UserId\", CASE WHEN \"t61\".\"EXPR$0\" IS NOT NULL THEN \"t61\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\", \"t38\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t38\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t38\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t51\".\"USERID\"\nFROM (SELECT MIN(\"t47\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t46\".\"POSTID\", \"t46\".\"TITLE\", \"t46\".\"SCORE\", \"t46\".\"CREATIONDATE\", \"t46\".\"OWNERUSERID\", \"t46\".\"RAN\", \"t46\".\"COMMENTCOUNT\"\nFROM (SELECT \"t45\".\"Id\" AS \"POSTID\", \"t45\".\"Title\" AS \"TITLE\", \"t45\".\"Score\" AS \"SCORE\", \"t45\".\"CreationDate\" AS \"CREATIONDATE\", \"t45\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t45\".\"OwnerUserId\" ORDER BY \"t45\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t44\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t44\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t44\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t45\" ON \"t44\".\"PostId\" = \"t45\".\"Id\") AS \"t46\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t46\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t47\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t47\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t47\".\"Id\", \"t47\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t51\"\nGROUP BY \"t51\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t42\".\"USERID\" = \"t56\".\"UserId\"\nGROUP BY \"t42\".\"USERID\") AS \"t58\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t61\" ON \"t58\".\"USERID\" IS NOT DISTINCT FROM \"t61\".\"UserId\") AS \"t62\" ON \"t33\".\"USERID\" = \"t62\".\"UserId\") AS \"t63\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t72\".\"USERID\", \"t72\".\"DISPLAYNAME\", \"t72\".\"TOTALPOSTS\", \"t72\".\"TOTALSCORE\", \"t72\".\"UPVOTECOUNT\", \"t72\".\"DOWNVOTECOUNT\", \"t72\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\", \"t68\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t68\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t68\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t68\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t68\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t68\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t72\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t72\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t63\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t63\".\"TOTALSCORE\" DESC NULLS FIRST, \"t63\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43816",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43816,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t62\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t62\".\"TOTALSCORE\" >= 50 AND \"t62\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t62\".\"EXPR$0\" AS \"GOLDBADGES\", \"t62\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t61\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t61\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t57\".\"USERID\" AS \"UserId\", CASE WHEN \"t60\".\"EXPR$0\" IS NOT NULL THEN \"t60\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\", \"t37\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t37\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t37\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t50\".\"USERID\"\nFROM (SELECT MIN(\"t46\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t45\".\"POSTID\", \"t45\".\"TITLE\", \"t45\".\"SCORE\", \"t45\".\"CREATIONDATE\", \"t45\".\"OWNERUSERID\", \"t45\".\"RAN\", \"t45\".\"COMMENTCOUNT\"\nFROM (SELECT \"t44\".\"Id\" AS \"POSTID\", \"t44\".\"Title\" AS \"TITLE\", \"t44\".\"Score\" AS \"SCORE\", \"t44\".\"CreationDate\" AS \"CREATIONDATE\", \"t44\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t44\".\"OwnerUserId\" ORDER BY \"t44\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t43\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t43\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t43\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t44\" ON \"t43\".\"PostId\" = \"t44\".\"Id\") AS \"t45\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t45\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t46\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t46\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t46\".\"Id\", \"t46\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t50\"\nGROUP BY \"t50\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t41\".\"USERID\" = \"t55\".\"UserId\"\nGROUP BY \"t41\".\"USERID\") AS \"t57\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t60\" ON \"t57\".\"USERID\" IS NOT DISTINCT FROM \"t60\".\"UserId\") AS \"t61\" ON \"t32\".\"USERID\" = \"t61\".\"UserId\") AS \"t62\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t71\".\"USERID\", \"t71\".\"DISPLAYNAME\", \"t71\".\"TOTALPOSTS\", \"t71\".\"TOTALSCORE\", \"t71\".\"UPVOTECOUNT\", \"t71\".\"DOWNVOTECOUNT\", \"t71\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\", \"t67\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t67\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t67\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t71\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t62\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t62\".\"TOTALSCORE\" DESC NULLS FIRST, \"t62\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43812",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43812,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t60\".\"USERID\", \"t60\".\"DISPLAYNAME\", \"t60\".\"TOTALPOSTS\", \"t60\".\"TOTALSCORE\", \"t60\".\"UPVOTECOUNT\", \"t60\".\"DOWNVOTECOUNT\", \"t60\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t60\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t60\".\"TOTALSCORE\" >= 50 AND \"t60\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t60\".\"EXPR$0\" AS \"GOLDBADGES\", \"t60\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t59\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t59\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t55\".\"USERID\" AS \"UserId\", CASE WHEN \"t58\".\"EXPR$0\" IS NOT NULL THEN \"t58\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"USERID\"\nFROM (SELECT MIN(\"t35\".\"Id\") AS \"USERID\", \"t35\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t35\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t35\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t34\".\"POSTID\", \"t34\".\"TITLE\", \"t34\".\"SCORE\", \"t34\".\"CREATIONDATE\", \"t34\".\"OWNERUSERID\", \"t34\".\"RAN\", \"t34\".\"COMMENTCOUNT\"\nFROM (SELECT \"t33\".\"Id\" AS \"POSTID\", \"t33\".\"Title\" AS \"TITLE\", \"t33\".\"Score\" AS \"SCORE\", \"t33\".\"CreationDate\" AS \"CREATIONDATE\", \"t33\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t33\".\"OwnerUserId\" ORDER BY \"t33\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t32\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t33\" ON \"t32\".\"PostId\" = \"t33\".\"Id\") AS \"t34\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t34\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t35\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t35\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t35\".\"Id\", \"t35\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t39\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t48\".\"USERID\"\nFROM (SELECT MIN(\"t44\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t43\".\"POSTID\", \"t43\".\"TITLE\", \"t43\".\"SCORE\", \"t43\".\"CREATIONDATE\", \"t43\".\"OWNERUSERID\", \"t43\".\"RAN\", \"t43\".\"COMMENTCOUNT\"\nFROM (SELECT \"t42\".\"Id\" AS \"POSTID\", \"t42\".\"Title\" AS \"TITLE\", \"t42\".\"Score\" AS \"SCORE\", \"t42\".\"CreationDate\" AS \"CREATIONDATE\", \"t42\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t42\".\"OwnerUserId\" ORDER BY \"t42\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t41\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t41\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t41\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t42\" ON \"t41\".\"PostId\" = \"t42\".\"Id\") AS \"t43\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t43\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t44\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t44\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t44\".\"Id\", \"t44\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t48\"\nGROUP BY \"t48\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t39\".\"USERID\" = \"t53\".\"UserId\"\nGROUP BY \"t39\".\"USERID\") AS \"t55\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t58\" ON \"t55\".\"USERID\" IS NOT DISTINCT FROM \"t58\".\"UserId\") AS \"t59\" ON \"t30\".\"USERID\" = \"t59\".\"UserId\") AS \"t60\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t69\".\"USERID\", \"t69\".\"DISPLAYNAME\", \"t69\".\"TOTALPOSTS\", \"t69\".\"TOTALSCORE\", \"t69\".\"UPVOTECOUNT\", \"t69\".\"DOWNVOTECOUNT\", \"t69\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t65\".\"Id\") AS \"USERID\", \"t65\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t65\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t65\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t64\".\"POSTID\", \"t64\".\"TITLE\", \"t64\".\"SCORE\", \"t64\".\"CREATIONDATE\", \"t64\".\"OWNERUSERID\", \"t64\".\"RAN\", \"t64\".\"COMMENTCOUNT\"\nFROM (SELECT \"t63\".\"Id\" AS \"POSTID\", \"t63\".\"Title\" AS \"TITLE\", \"t63\".\"Score\" AS \"SCORE\", \"t63\".\"CreationDate\" AS \"CREATIONDATE\", \"t63\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t63\".\"OwnerUserId\" ORDER BY \"t63\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t62\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t63\" ON \"t62\".\"PostId\" = \"t63\".\"Id\") AS \"t64\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t64\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t65\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t65\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t65\".\"Id\", \"t65\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t69\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0\nGROUP BY \"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t69\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t60\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t60\".\"TOTALSCORE\" DESC NULLS FIRST, \"t60\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43810",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43810,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "JOIN" : 3,
            "AGGREGATE" : 1,
            "OTHER" : 7,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t59\".\"USERID\", \"t59\".\"DISPLAYNAME\", \"t59\".\"TOTALPOSTS\", \"t59\".\"TOTALSCORE\", \"t59\".\"UPVOTECOUNT\", \"t59\".\"DOWNVOTECOUNT\", \"t59\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t59\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t59\".\"TOTALSCORE\" >= 50 AND \"t59\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t59\".\"EXPR$0\" AS \"GOLDBADGES\", \"t59\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t58\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t58\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t54\".\"USERID\" AS \"UserId\", CASE WHEN \"t57\".\"EXPR$0\" IS NOT NULL THEN \"t57\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"USERID\"\nFROM (SELECT MIN(\"t34\".\"Id\") AS \"USERID\", \"t34\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t34\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t34\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t33\".\"POSTID\", \"t33\".\"TITLE\", \"t33\".\"SCORE\", \"t33\".\"CREATIONDATE\", \"t33\".\"OWNERUSERID\", \"t33\".\"RAN\", \"t33\".\"COMMENTCOUNT\"\nFROM (SELECT \"t32\".\"Id\" AS \"POSTID\", \"t32\".\"Title\" AS \"TITLE\", \"t32\".\"Score\" AS \"SCORE\", \"t32\".\"CreationDate\" AS \"CREATIONDATE\", \"t32\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t32\".\"OwnerUserId\" ORDER BY \"t32\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t31\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t32\" ON \"t31\".\"PostId\" = \"t32\".\"Id\") AS \"t33\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t33\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t34\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t34\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t34\".\"Id\", \"t34\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t38\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"USERID\"\nFROM (SELECT MIN(\"t43\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t42\".\"POSTID\", \"t42\".\"TITLE\", \"t42\".\"SCORE\", \"t42\".\"CREATIONDATE\", \"t42\".\"OWNERUSERID\", \"t42\".\"RAN\", \"t42\".\"COMMENTCOUNT\"\nFROM (SELECT \"t41\".\"Id\" AS \"POSTID\", \"t41\".\"Title\" AS \"TITLE\", \"t41\".\"Score\" AS \"SCORE\", \"t41\".\"CreationDate\" AS \"CREATIONDATE\", \"t41\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t41\".\"OwnerUserId\" ORDER BY \"t41\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t40\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t40\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t40\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t41\" ON \"t40\".\"PostId\" = \"t41\".\"Id\") AS \"t42\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t42\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t43\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t43\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t43\".\"Id\", \"t43\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t47\"\nGROUP BY \"t47\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t38\".\"USERID\" = \"t52\".\"UserId\"\nGROUP BY \"t38\".\"USERID\") AS \"t54\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t57\" ON \"t54\".\"USERID\" IS NOT DISTINCT FROM \"t57\".\"UserId\") AS \"t58\" ON \"t29\".\"USERID\" = \"t58\".\"UserId\") AS \"t59\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t68\".\"USERID\", \"t68\".\"DISPLAYNAME\", \"t68\".\"TOTALPOSTS\", \"t68\".\"TOTALSCORE\", \"t68\".\"UPVOTECOUNT\", \"t68\".\"DOWNVOTECOUNT\", \"t68\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t64\".\"Id\") AS \"USERID\", \"t64\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t64\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t64\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t63\".\"POSTID\", \"t63\".\"TITLE\", \"t63\".\"SCORE\", \"t63\".\"CREATIONDATE\", \"t63\".\"OWNERUSERID\", \"t63\".\"RAN\", \"t63\".\"COMMENTCOUNT\"\nFROM (SELECT \"t62\".\"Id\" AS \"POSTID\", \"t62\".\"Title\" AS \"TITLE\", \"t62\".\"Score\" AS \"SCORE\", \"t62\".\"CreationDate\" AS \"CREATIONDATE\", \"t62\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t62\".\"OwnerUserId\" ORDER BY \"t62\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t61\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t62\" ON \"t61\".\"PostId\" = \"t62\".\"Id\") AS \"t63\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t63\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t64\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t64\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t64\".\"Id\", \"t64\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t68\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t71\"\nGROUP BY \"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t68\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t59\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t59\".\"TOTALSCORE\" DESC NULLS FIRST, \"t59\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43805",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43805,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "OTHER" : 6,
            "JOIN" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t58\".\"USERID\", \"t58\".\"DISPLAYNAME\", \"t58\".\"TOTALPOSTS\", \"t58\".\"TOTALSCORE\", \"t58\".\"UPVOTECOUNT\", \"t58\".\"DOWNVOTECOUNT\", \"t58\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t58\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t58\".\"TOTALSCORE\" >= 50 AND \"t58\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t58\".\"EXPR$0\" AS \"GOLDBADGES\", \"t58\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t57\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t57\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t53\".\"USERID\" AS \"UserId\", CASE WHEN \"t56\".\"EXPR$0\" IS NOT NULL THEN \"t56\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"USERID\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t32\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t33\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t41\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t42\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t37\".\"USERID\") AS \"t53\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t56\" ON \"t53\".\"USERID\" IS NOT DISTINCT FROM \"t56\".\"UserId\") AS \"t57\" ON \"t28\".\"USERID\" = \"t57\".\"UserId\") AS \"t58\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t63\".\"Id\") AS \"USERID\", \"t63\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t63\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t63\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t62\".\"POSTID\", \"t62\".\"TITLE\", \"t62\".\"SCORE\", \"t62\".\"CREATIONDATE\", \"t62\".\"OWNERUSERID\", \"t62\".\"RAN\", \"t62\".\"COMMENTCOUNT\"\nFROM (SELECT \"t61\".\"Id\" AS \"POSTID\", \"t61\".\"Title\" AS \"TITLE\", \"t61\".\"Score\" AS \"SCORE\", \"t61\".\"CreationDate\" AS \"CREATIONDATE\", \"t61\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t61\".\"OwnerUserId\" ORDER BY \"t61\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t60\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t61\" ON \"t60\".\"PostId\" = \"t61\".\"Id\") AS \"t62\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t62\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t63\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t63\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t63\".\"Id\", \"t63\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t67\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"s1\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t67\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t58\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t58\".\"TOTALSCORE\" DESC NULLS FIRST, \"t58\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43800",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43800,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 1,
            "OTHER" : 4
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t57\".\"USERID\", \"t57\".\"DISPLAYNAME\", \"t57\".\"TOTALPOSTS\", \"t57\".\"TOTALSCORE\", \"t57\".\"UPVOTECOUNT\", \"t57\".\"DOWNVOTECOUNT\", \"t57\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t57\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t57\".\"TOTALSCORE\" >= 50 AND \"t57\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t57\".\"EXPR$0\" AS \"GOLDBADGES\", \"t57\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t56\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t56\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"USERID\"\nFROM (SELECT MIN(\"t32\".\"Id\") AS \"USERID\", \"t32\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t32\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t32\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t31\".\"POSTID\", \"t31\".\"TITLE\", \"t31\".\"SCORE\", \"t31\".\"CREATIONDATE\", \"t31\".\"OWNERUSERID\", \"t31\".\"RAN\", \"t31\".\"COMMENTCOUNT\"\nFROM (SELECT \"t30\".\"Id\" AS \"POSTID\", \"t30\".\"Title\" AS \"TITLE\", \"t30\".\"Score\" AS \"SCORE\", \"t30\".\"CreationDate\" AS \"CREATIONDATE\", \"t30\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t30\".\"OwnerUserId\" ORDER BY \"t30\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t29\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t30\" ON \"t29\".\"PostId\" = \"t30\".\"Id\") AS \"t31\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t31\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t32\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t32\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t32\".\"Id\", \"t32\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t36\"\nLEFT JOIN (SELECT \"t46\".\"USERID\" AS \"UserId\", CASE WHEN \"t49\".\"EXPR$0\" IS NOT NULL THEN \"t49\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"USERID\"\nFROM (SELECT MIN(\"t41\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t40\".\"POSTID\", \"t40\".\"TITLE\", \"t40\".\"SCORE\", \"t40\".\"CREATIONDATE\", \"t40\".\"OWNERUSERID\", \"t40\".\"RAN\", \"t40\".\"COMMENTCOUNT\"\nFROM (SELECT \"t39\".\"Id\" AS \"POSTID\", \"t39\".\"Title\" AS \"TITLE\", \"t39\".\"Score\" AS \"SCORE\", \"t39\".\"CreationDate\" AS \"CREATIONDATE\", \"t39\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t39\".\"OwnerUserId\" ORDER BY \"t39\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t38\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t39\" ON \"t38\".\"PostId\" = \"t39\".\"Id\") AS \"t40\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t40\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t41\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t41\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t41\".\"Id\", \"t41\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t45\"\nGROUP BY \"t45\".\"USERID\") AS \"t46\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t49\" ON \"t46\".\"USERID\" IS NOT DISTINCT FROM \"t49\".\"UserId\") AS \"t50\" ON \"t36\".\"USERID\" = \"t50\".\"UserId\"\nGROUP BY \"t36\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t27\".\"USERID\" = \"t56\".\"UserId\") AS \"t57\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t66\".\"USERID\", \"t66\".\"DISPLAYNAME\", \"t66\".\"TOTALPOSTS\", \"t66\".\"TOTALSCORE\", \"t66\".\"UPVOTECOUNT\", \"t66\".\"DOWNVOTECOUNT\", \"t66\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t62\".\"Id\") AS \"USERID\", \"t62\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t62\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t62\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t61\".\"POSTID\", \"t61\".\"TITLE\", \"t61\".\"SCORE\", \"t61\".\"CREATIONDATE\", \"t61\".\"OWNERUSERID\", \"t61\".\"RAN\", \"t61\".\"COMMENTCOUNT\"\nFROM (SELECT \"t60\".\"Id\" AS \"POSTID\", \"t60\".\"Title\" AS \"TITLE\", \"t60\".\"Score\" AS \"SCORE\", \"t60\".\"CreationDate\" AS \"CREATIONDATE\", \"t60\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t60\".\"OwnerUserId\" ORDER BY \"t60\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t59\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t60\" ON \"t59\".\"PostId\" = \"t60\".\"Id\") AS \"t61\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t61\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t62\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t62\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t62\".\"Id\", \"t62\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t66\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"s1\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t66\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t57\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t57\".\"TOTALSCORE\" DESC NULLS FIRST, \"t57\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43793",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43793,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"s1\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t64\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43791",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43791,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 24,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t59\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t63\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43796",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43796,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t29\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t38\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t59\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t71\".\"USERID\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN \"s1\" ON \"t65\".\"PostId\" = \"s1\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nGROUP BY \"t71\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t63\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43825",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43825,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 13,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "AGGREGATE" : 1,
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t56\".\"USERID\", \"t56\".\"DISPLAYNAME\", \"t56\".\"TOTALPOSTS\", \"t56\".\"TOTALSCORE\", \"t56\".\"UPVOTECOUNT\", \"t56\".\"DOWNVOTECOUNT\", \"t56\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t56\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t56\".\"TOTALSCORE\" >= 50 AND \"t56\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t56\".\"EXPR$0\" AS \"GOLDBADGES\", \"t56\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t55\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t55\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"t48\".\"EXPR$0\" IS NOT NULL THEN \"t48\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t48\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"t48\".\"UserId\") AS \"t49\" ON \"t35\".\"USERID\" = \"t49\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t26\".\"USERID\" = \"t55\".\"UserId\") AS \"t56\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t65\".\"USERID\", \"t65\".\"DISPLAYNAME\", \"t65\".\"TOTALPOSTS\", \"t65\".\"TOTALSCORE\", \"t65\".\"UPVOTECOUNT\", \"t65\".\"DOWNVOTECOUNT\", \"t65\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\", \"t61\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t61\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t61\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t60\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t61\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t74\".\"USERID\"\nFROM (SELECT MIN(\"t70\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t69\".\"POSTID\", \"t69\".\"TITLE\", \"t69\".\"SCORE\", \"t69\".\"CREATIONDATE\", \"t69\".\"OWNERUSERID\", \"t69\".\"RAN\", \"t69\".\"COMMENTCOUNT\"\nFROM (SELECT \"t68\".\"Id\" AS \"POSTID\", \"t68\".\"Title\" AS \"TITLE\", \"t68\".\"Score\" AS \"SCORE\", \"t68\".\"CreationDate\" AS \"CREATIONDATE\", \"t68\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t68\".\"OwnerUserId\" ORDER BY \"t68\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t67\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t68\" ON \"t67\".\"PostId\" = \"t68\".\"Id\") AS \"t69\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t69\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t70\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t70\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t70\".\"Id\", \"t70\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t74\"\nGROUP BY \"t74\".\"USERID\") AS \"t75\"\nLEFT JOIN \"s1\" ON \"t75\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t76\" ON \"t65\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t56\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t56\".\"TOTALSCORE\" DESC NULLS FIRST, \"t56\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43823",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43823,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t75\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t64\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t77\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t77\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43919",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43919,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 9,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.3407776516701404E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 5.617866364008337E12,
        "transferEstimatedMs" : 2.1553558290969595E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 42,
          "maxDepth" : 20,
          "operatorKindCounts" : {
            "JOIN" : 9,
            "FILTER" : 6,
            "OTHER" : 19,
            "AGGREGATE" : 8
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 116,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 47,
            "JOIN" : 29,
            "AGGREGATE" : 22,
            "FILTER" : 17,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t23\".\"USERID\", \"t23\".\"USERID\") AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"\nGROUP BY \"t7\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t82\".\"USERID\", \"t82\".\"DISPLAYNAME\", \"t82\".\"TOTALPOSTS\", \"t82\".\"TOTALSCORE\", \"t82\".\"UPVOTECOUNT\", \"t82\".\"DOWNVOTECOUNT\", \"t82\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t82\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t82\".\"TOTALSCORE\" >= 50 AND \"t82\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t82\".\"EXPR$0\" AS \"GOLDBADGES\", \"t82\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t52\".\"USERID\", \"t52\".\"DISPLAYNAME\", \"t52\".\"TOTALPOSTS\", \"t52\".\"TOTALSCORE\", \"t52\".\"UPVOTECOUNT\", \"t52\".\"DOWNVOTECOUNT\", \"t52\".\"AVGCOMMENTSPERPOST\", \"t52\".\"EXPR$0\", CASE WHEN \"t81\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t81\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t37\".\"USERID\", \"t37\".\"DISPLAYNAME\", \"t37\".\"TOTALPOSTS\", \"t37\".\"TOTALSCORE\", \"t37\".\"UPVOTECOUNT\", \"t37\".\"DOWNVOTECOUNT\", \"t37\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t51\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t51\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t32\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t33\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t41\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t42\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\") AS \"t52\"\nLEFT JOIN (SELECT \"t77\".\"USERID\" AS \"UserId\", CASE WHEN \"t80\".\"EXPR$0\" IS NOT NULL THEN \"t80\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t61\".\"USERID\"\nFROM (SELECT MIN(\"t57\".\"Id\") AS \"USERID\", \"t57\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t57\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t57\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t56\".\"POSTID\", \"t56\".\"TITLE\", \"t56\".\"SCORE\", \"t56\".\"CREATIONDATE\", \"t56\".\"OWNERUSERID\", \"t56\".\"RAN\", \"t56\".\"COMMENTCOUNT\"\nFROM (SELECT \"t55\".\"Id\" AS \"POSTID\", \"t55\".\"Title\" AS \"TITLE\", \"t55\".\"Score\" AS \"SCORE\", \"t55\".\"CreationDate\" AS \"CREATIONDATE\", \"t55\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t55\".\"OwnerUserId\" ORDER BY \"t55\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t54\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t54\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t54\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t55\" ON \"t54\".\"PostId\" = \"t55\".\"Id\") AS \"t56\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t56\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t57\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t57\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t57\".\"Id\", \"t57\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t61\"\nLEFT JOIN (SELECT \"t71\".\"USERID\" AS \"UserId\", CASE WHEN \"t74\".\"EXPR$0\" IS NOT NULL THEN \"t74\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t70\".\"USERID\"\nFROM (SELECT MIN(\"t66\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t65\".\"POSTID\", \"t65\".\"TITLE\", \"t65\".\"SCORE\", \"t65\".\"CREATIONDATE\", \"t65\".\"OWNERUSERID\", \"t65\".\"RAN\", \"t65\".\"COMMENTCOUNT\"\nFROM (SELECT \"t64\".\"Id\" AS \"POSTID\", \"t64\".\"Title\" AS \"TITLE\", \"t64\".\"Score\" AS \"SCORE\", \"t64\".\"CreationDate\" AS \"CREATIONDATE\", \"t64\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t64\".\"OwnerUserId\" ORDER BY \"t64\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t63\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t64\" ON \"t63\".\"PostId\" = \"t64\".\"Id\") AS \"t65\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t65\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t66\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t66\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t66\".\"Id\", \"t66\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t70\"\nGROUP BY \"t70\".\"USERID\") AS \"t71\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t74\" ON \"t71\".\"USERID\" IS NOT DISTINCT FROM \"t74\".\"UserId\") AS \"t75\" ON \"t61\".\"USERID\" = \"t75\".\"UserId\"\nGROUP BY \"t61\".\"USERID\") AS \"t77\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t80\" ON \"t77\".\"USERID\" IS NOT DISTINCT FROM \"t80\".\"UserId\") AS \"t81\" ON \"t52\".\"USERID\" = \"t81\".\"UserId\") AS \"t82\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t106\".\"USERID\"\nFROM (SELECT \"t91\".\"USERID\", \"t91\".\"DISPLAYNAME\", \"t91\".\"TOTALPOSTS\", \"t91\".\"TOTALSCORE\", \"t91\".\"UPVOTECOUNT\", \"t91\".\"DOWNVOTECOUNT\", \"t91\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t105\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t105\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t87\".\"Id\") AS \"USERID\", \"t87\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t87\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t87\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t87\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t87\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t86\".\"POSTID\", \"t86\".\"TITLE\", \"t86\".\"SCORE\", \"t86\".\"CREATIONDATE\", \"t86\".\"OWNERUSERID\", \"t86\".\"RAN\", \"t86\".\"COMMENTCOUNT\"\nFROM (SELECT \"t85\".\"Id\" AS \"POSTID\", \"t85\".\"Title\" AS \"TITLE\", \"t85\".\"Score\" AS \"SCORE\", \"t85\".\"CreationDate\" AS \"CREATIONDATE\", \"t85\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t85\".\"OwnerUserId\" ORDER BY \"t85\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t84\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t85\" ON \"t84\".\"PostId\" = \"t85\".\"Id\") AS \"t86\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t86\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t87\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t87\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t87\".\"Id\", \"t87\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t91\"\nLEFT JOIN (SELECT \"t101\".\"USERID\" AS \"UserId\", CASE WHEN \"t104\".\"EXPR$0\" IS NOT NULL THEN \"t104\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t100\".\"USERID\"\nFROM (SELECT MIN(\"t96\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t95\".\"POSTID\", \"t95\".\"TITLE\", \"t95\".\"SCORE\", \"t95\".\"CREATIONDATE\", \"t95\".\"OWNERUSERID\", \"t95\".\"RAN\", \"t95\".\"COMMENTCOUNT\"\nFROM (SELECT \"t94\".\"Id\" AS \"POSTID\", \"t94\".\"Title\" AS \"TITLE\", \"t94\".\"Score\" AS \"SCORE\", \"t94\".\"CreationDate\" AS \"CREATIONDATE\", \"t94\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t94\".\"OwnerUserId\" ORDER BY \"t94\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t93\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t93\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t93\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t94\" ON \"t93\".\"PostId\" = \"t94\".\"Id\") AS \"t95\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t95\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t96\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t96\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t96\".\"Id\", \"t96\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t100\"\nGROUP BY \"t100\".\"USERID\") AS \"t101\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t104\" ON \"t101\".\"USERID\" IS NOT DISTINCT FROM \"t104\".\"UserId\") AS \"t105\" ON \"t91\".\"USERID\" = \"t105\".\"UserId\") AS \"t106\"\nLEFT JOIN \"s1\" ON \"t106\".\"USERID\" = \"s1\".\"UserId\"\nGROUP BY \"t106\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t82\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t82\".\"TOTALSCORE\" DESC NULLS FIRST, \"t82\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43908",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43908,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 426354.8482972674,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 3410838.786378139,
        "transferEstimatedMs" : 109.60994589861399,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 37,
          "maxDepth" : 18,
          "operatorKindCounts" : {
            "JOIN" : 8,
            "FILTER" : 5,
            "OTHER" : 17,
            "AGGREGATE" : 7
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 121,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "JOIN" : 30,
            "AGGREGATE" : 23,
            "FILTER" : 18,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t78\".\"USERID\", \"t78\".\"DISPLAYNAME\", \"t78\".\"TOTALPOSTS\", \"t78\".\"TOTALSCORE\", \"t78\".\"UPVOTECOUNT\", \"t78\".\"DOWNVOTECOUNT\", \"t78\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t78\".\"TOTALSCORE\" >= 50 AND \"t78\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t78\".\"EXPR$0\" AS \"GOLDBADGES\", \"t78\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t48\".\"USERID\", \"t48\".\"DISPLAYNAME\", \"t48\".\"TOTALPOSTS\", \"t48\".\"TOTALSCORE\", \"t48\".\"UPVOTECOUNT\", \"t48\".\"DOWNVOTECOUNT\", \"t48\".\"AVGCOMMENTSPERPOST\", \"t48\".\"EXPR$0\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t33\".\"USERID\", \"t33\".\"DISPLAYNAME\", \"t33\".\"TOTALPOSTS\", \"t33\".\"TOTALSCORE\", \"t33\".\"UPVOTECOUNT\", \"t33\".\"DOWNVOTECOUNT\", \"t33\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t47\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t47\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\") AS \"t48\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t57\".\"USERID\"\nFROM (SELECT MIN(\"t53\".\"Id\") AS \"USERID\", \"t53\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t53\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t53\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t53\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t53\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t52\".\"POSTID\", \"t52\".\"TITLE\", \"t52\".\"SCORE\", \"t52\".\"CREATIONDATE\", \"t52\".\"OWNERUSERID\", \"t52\".\"RAN\", \"t52\".\"COMMENTCOUNT\"\nFROM (SELECT \"t51\".\"Id\" AS \"POSTID\", \"t51\".\"Title\" AS \"TITLE\", \"t51\".\"Score\" AS \"SCORE\", \"t51\".\"CreationDate\" AS \"CREATIONDATE\", \"t51\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t51\".\"OwnerUserId\" ORDER BY \"t51\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t50\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t50\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t50\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t51\" ON \"t50\".\"PostId\" = \"t51\".\"Id\") AS \"t52\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t52\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t53\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t53\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t53\".\"Id\", \"t53\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t57\"\nLEFT JOIN (SELECT \"t67\".\"USERID\" AS \"UserId\", CASE WHEN \"t70\".\"EXPR$0\" IS NOT NULL THEN \"t70\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t66\".\"USERID\"\nFROM (SELECT MIN(\"t62\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t61\".\"POSTID\", \"t61\".\"TITLE\", \"t61\".\"SCORE\", \"t61\".\"CREATIONDATE\", \"t61\".\"OWNERUSERID\", \"t61\".\"RAN\", \"t61\".\"COMMENTCOUNT\"\nFROM (SELECT \"t60\".\"Id\" AS \"POSTID\", \"t60\".\"Title\" AS \"TITLE\", \"t60\".\"Score\" AS \"SCORE\", \"t60\".\"CreationDate\" AS \"CREATIONDATE\", \"t60\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t60\".\"OwnerUserId\" ORDER BY \"t60\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t59\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t60\" ON \"t59\".\"PostId\" = \"t60\".\"Id\") AS \"t61\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t61\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t62\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t62\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t62\".\"Id\", \"t62\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t66\"\nGROUP BY \"t66\".\"USERID\") AS \"t67\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t70\" ON \"t67\".\"USERID\" IS NOT DISTINCT FROM \"t70\".\"UserId\") AS \"t71\" ON \"t57\".\"USERID\" = \"t71\".\"UserId\"\nGROUP BY \"t57\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t48\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t102\".\"USERID\"\nFROM (SELECT \"t87\".\"USERID\", \"t87\".\"DISPLAYNAME\", \"t87\".\"TOTALPOSTS\", \"t87\".\"TOTALSCORE\", \"t87\".\"UPVOTECOUNT\", \"t87\".\"DOWNVOTECOUNT\", \"t87\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t101\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t101\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t83\".\"Id\") AS \"USERID\", \"t83\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t83\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t83\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t83\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t83\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t82\".\"POSTID\", \"t82\".\"TITLE\", \"t82\".\"SCORE\", \"t82\".\"CREATIONDATE\", \"t82\".\"OWNERUSERID\", \"t82\".\"RAN\", \"t82\".\"COMMENTCOUNT\"\nFROM (SELECT \"t81\".\"Id\" AS \"POSTID\", \"t81\".\"Title\" AS \"TITLE\", \"t81\".\"Score\" AS \"SCORE\", \"t81\".\"CreationDate\" AS \"CREATIONDATE\", \"t81\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t81\".\"OwnerUserId\" ORDER BY \"t81\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t80\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t80\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t80\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t81\" ON \"t80\".\"PostId\" = \"t81\".\"Id\") AS \"t82\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t82\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t83\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t83\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t83\".\"Id\", \"t83\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t87\"\nLEFT JOIN (SELECT \"t97\".\"USERID\" AS \"UserId\", CASE WHEN \"t100\".\"EXPR$0\" IS NOT NULL THEN \"t100\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t96\".\"USERID\"\nFROM (SELECT MIN(\"t92\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t91\".\"POSTID\", \"t91\".\"TITLE\", \"t91\".\"SCORE\", \"t91\".\"CREATIONDATE\", \"t91\".\"OWNERUSERID\", \"t91\".\"RAN\", \"t91\".\"COMMENTCOUNT\"\nFROM (SELECT \"t90\".\"Id\" AS \"POSTID\", \"t90\".\"Title\" AS \"TITLE\", \"t90\".\"Score\" AS \"SCORE\", \"t90\".\"CreationDate\" AS \"CREATIONDATE\", \"t90\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t90\".\"OwnerUserId\" ORDER BY \"t90\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t89\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t89\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t89\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t90\" ON \"t89\".\"PostId\" = \"t90\".\"Id\") AS \"t91\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t91\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t92\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t92\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t92\".\"Id\", \"t92\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t96\"\nGROUP BY \"t96\".\"USERID\") AS \"t97\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t100\" ON \"t97\".\"USERID\" IS NOT DISTINCT FROM \"t100\".\"UserId\") AS \"t101\" ON \"t87\".\"USERID\" = \"t101\".\"UserId\") AS \"t102\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t102\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t102\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t78\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t78\".\"TOTALSCORE\" DESC NULLS FIRST, \"t78\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43906",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43906,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 549021.9999990364,
        "cutRowSizeOutBytes" : 88.0,
        "cutOutputBytes" : 4.8313935999915205E7,
        "transferEstimatedMs" : 136.93151546151228,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 36,
          "maxDepth" : 17,
          "operatorKindCounts" : {
            "JOIN" : 8,
            "FILTER" : 5,
            "OTHER" : 17,
            "AGGREGATE" : 6
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 122,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 49,
            "JOIN" : 30,
            "AGGREGATE" : 24,
            "FILTER" : 18,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nLEFT JOIN (SELECT \"t17\".\"USERID\" AS \"UserId\", CASE WHEN \"t20\".\"EXPR$0\" IS NOT NULL THEN \"t20\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t16\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t12\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t11\".\"POSTID\", \"t11\".\"TITLE\", \"t11\".\"SCORE\", \"t11\".\"CREATIONDATE\", \"t11\".\"OWNERUSERID\", \"t11\".\"RAN\", \"t11\".\"COMMENTCOUNT\"\nFROM (SELECT \"t10\".\"Id\" AS \"POSTID\", \"t10\".\"Title\" AS \"TITLE\", \"t10\".\"Score\" AS \"SCORE\", \"t10\".\"CreationDate\" AS \"CREATIONDATE\", \"t10\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t10\".\"OwnerUserId\" ORDER BY \"t10\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t9\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t10\" ON \"t9\".\"PostId\" = \"t10\".\"Id\") AS \"t11\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t11\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t12\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t12\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t12\".\"Id\", \"t12\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t16\"\nGROUP BY \"t16\".\"USERID\") AS \"t17\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t20\" ON \"t17\".\"USERID\" IS NOT DISTINCT FROM \"t20\".\"UserId\") AS \"t21\" ON \"t7\".\"USERID\" = \"t21\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t77\".\"USERID\", \"t77\".\"DISPLAYNAME\", \"t77\".\"TOTALPOSTS\", \"t77\".\"TOTALSCORE\", \"t77\".\"UPVOTECOUNT\", \"t77\".\"DOWNVOTECOUNT\", \"t77\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t77\".\"TOTALSCORE\" >= 50 AND \"t77\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t77\".\"EXPR$0\" AS \"GOLDBADGES\", \"t77\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t47\".\"USERID\", \"t47\".\"DISPLAYNAME\", \"t47\".\"TOTALPOSTS\", \"t47\".\"TOTALSCORE\", \"t47\".\"UPVOTECOUNT\", \"t47\".\"DOWNVOTECOUNT\", \"t47\".\"AVGCOMMENTSPERPOST\", \"t47\".\"EXPR$0\", CASE WHEN \"t76\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t76\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t46\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t46\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t28\".\"Id\") AS \"USERID\", \"t28\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t28\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t28\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t27\".\"POSTID\", \"t27\".\"TITLE\", \"t27\".\"SCORE\", \"t27\".\"CREATIONDATE\", \"t27\".\"OWNERUSERID\", \"t27\".\"RAN\", \"t27\".\"COMMENTCOUNT\"\nFROM (SELECT \"t26\".\"Id\" AS \"POSTID\", \"t26\".\"Title\" AS \"TITLE\", \"t26\".\"Score\" AS \"SCORE\", \"t26\".\"CreationDate\" AS \"CREATIONDATE\", \"t26\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t26\".\"OwnerUserId\" ORDER BY \"t26\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t25\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t25\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t25\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t26\" ON \"t25\".\"PostId\" = \"t26\".\"Id\") AS \"t27\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t27\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t28\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t28\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t28\".\"Id\", \"t28\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t32\"\nLEFT JOIN (SELECT \"t42\".\"USERID\" AS \"UserId\", CASE WHEN \"t45\".\"EXPR$0\" IS NOT NULL THEN \"t45\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nGROUP BY \"t41\".\"USERID\") AS \"t42\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t45\" ON \"t42\".\"USERID\" IS NOT DISTINCT FROM \"t45\".\"UserId\") AS \"t46\" ON \"t32\".\"USERID\" = \"t46\".\"UserId\") AS \"t47\"\nLEFT JOIN (SELECT \"t72\".\"USERID\" AS \"UserId\", CASE WHEN \"t75\".\"EXPR$0\" IS NOT NULL THEN \"t75\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t56\".\"USERID\"\nFROM (SELECT MIN(\"t52\".\"Id\") AS \"USERID\", \"t52\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t52\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t52\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t52\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t52\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t51\".\"POSTID\", \"t51\".\"TITLE\", \"t51\".\"SCORE\", \"t51\".\"CREATIONDATE\", \"t51\".\"OWNERUSERID\", \"t51\".\"RAN\", \"t51\".\"COMMENTCOUNT\"\nFROM (SELECT \"t50\".\"Id\" AS \"POSTID\", \"t50\".\"Title\" AS \"TITLE\", \"t50\".\"Score\" AS \"SCORE\", \"t50\".\"CreationDate\" AS \"CREATIONDATE\", \"t50\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t50\".\"OwnerUserId\" ORDER BY \"t50\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t49\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t49\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t49\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t50\" ON \"t49\".\"PostId\" = \"t50\".\"Id\") AS \"t51\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t51\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t52\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t52\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t52\".\"Id\", \"t52\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t56\"\nLEFT JOIN (SELECT \"t66\".\"USERID\" AS \"UserId\", CASE WHEN \"t69\".\"EXPR$0\" IS NOT NULL THEN \"t69\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t65\".\"USERID\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t60\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t61\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t65\"\nGROUP BY \"t65\".\"USERID\") AS \"t66\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t69\" ON \"t66\".\"USERID\" IS NOT DISTINCT FROM \"t69\".\"UserId\") AS \"t70\" ON \"t56\".\"USERID\" = \"t70\".\"UserId\"\nGROUP BY \"t56\".\"USERID\") AS \"t72\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t75\" ON \"t72\".\"USERID\" IS NOT DISTINCT FROM \"t75\".\"UserId\") AS \"t76\" ON \"t47\".\"USERID\" = \"t76\".\"UserId\") AS \"t77\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t101\".\"USERID\"\nFROM (SELECT \"t86\".\"USERID\", \"t86\".\"DISPLAYNAME\", \"t86\".\"TOTALPOSTS\", \"t86\".\"TOTALSCORE\", \"t86\".\"UPVOTECOUNT\", \"t86\".\"DOWNVOTECOUNT\", \"t86\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t100\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t100\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\") AS \"t101\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t101\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t101\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t77\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t77\".\"TOTALSCORE\" DESC NULLS FIRST, \"t77\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43861",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43861,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "FILTER" : 2,
            "JOIN" : 3,
            "OTHER" : 8,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t62\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t62\".\"TOTALSCORE\" >= 50 AND \"t62\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t62\".\"EXPR$0\" AS \"GOLDBADGES\", \"t62\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t61\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t61\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t57\".\"USERID\" AS \"UserId\", CASE WHEN \"t60\".\"EXPR$0\" IS NOT NULL THEN \"t60\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\", \"t37\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t37\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t37\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t50\".\"USERID\"\nFROM (SELECT MIN(\"t46\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t45\".\"POSTID\", \"t45\".\"TITLE\", \"t45\".\"SCORE\", \"t45\".\"CREATIONDATE\", \"t45\".\"OWNERUSERID\", \"t45\".\"RAN\", \"t45\".\"COMMENTCOUNT\"\nFROM (SELECT \"t44\".\"Id\" AS \"POSTID\", \"t44\".\"Title\" AS \"TITLE\", \"t44\".\"Score\" AS \"SCORE\", \"t44\".\"CreationDate\" AS \"CREATIONDATE\", \"t44\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t44\".\"OwnerUserId\" ORDER BY \"t44\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t43\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t43\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t43\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t44\" ON \"t43\".\"PostId\" = \"t44\".\"Id\") AS \"t45\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t45\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t46\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t46\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t46\".\"Id\", \"t46\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t50\"\nGROUP BY \"t50\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t41\".\"USERID\" = \"t55\".\"UserId\"\nGROUP BY \"t41\".\"USERID\") AS \"t57\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t60\" ON \"t57\".\"USERID\" IS NOT DISTINCT FROM \"t60\".\"UserId\") AS \"t61\" ON \"t32\".\"USERID\" = \"t61\".\"UserId\") AS \"t62\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT \"t71\".\"USERID\", \"t71\".\"DISPLAYNAME\", \"t71\".\"TOTALPOSTS\", \"t71\".\"TOTALSCORE\", \"t71\".\"UPVOTECOUNT\", \"t71\".\"DOWNVOTECOUNT\", \"t71\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t85\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t85\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\", \"t67\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t67\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t67\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nLEFT JOIN (SELECT \"t81\".\"USERID\" AS \"UserId\", CASE WHEN \"t84\".\"EXPR$0\" IS NOT NULL THEN \"t84\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"USERID\"\nFROM (SELECT MIN(\"t76\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t75\".\"POSTID\", \"t75\".\"TITLE\", \"t75\".\"SCORE\", \"t75\".\"CREATIONDATE\", \"t75\".\"OWNERUSERID\", \"t75\".\"RAN\", \"t75\".\"COMMENTCOUNT\"\nFROM (SELECT \"t74\".\"Id\" AS \"POSTID\", \"t74\".\"Title\" AS \"TITLE\", \"t74\".\"Score\" AS \"SCORE\", \"t74\".\"CreationDate\" AS \"CREATIONDATE\", \"t74\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t74\".\"OwnerUserId\" ORDER BY \"t74\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t73\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t73\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t73\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t74\" ON \"t73\".\"PostId\" = \"t74\".\"Id\") AS \"t75\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t75\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t76\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t76\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t76\".\"Id\", \"t76\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t80\"\nGROUP BY \"t80\".\"USERID\") AS \"t81\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t84\" ON \"t81\".\"USERID\" IS NOT DISTINCT FROM \"t84\".\"UserId\") AS \"t85\" ON \"t71\".\"USERID\" = \"t85\".\"UserId\") AS \"t86\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"s1\".\"USERID\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"s1\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"s1\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t86\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t62\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t62\".\"TOTALSCORE\" DESC NULLS FIRST, \"t62\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43857",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43857,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t60\".\"USERID\", \"t60\".\"DISPLAYNAME\", \"t60\".\"TOTALPOSTS\", \"t60\".\"TOTALSCORE\", \"t60\".\"UPVOTECOUNT\", \"t60\".\"DOWNVOTECOUNT\", \"t60\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t60\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t60\".\"TOTALSCORE\" >= 50 AND \"t60\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t60\".\"EXPR$0\" AS \"GOLDBADGES\", \"t60\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t59\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t59\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t55\".\"USERID\" AS \"UserId\", CASE WHEN \"t58\".\"EXPR$0\" IS NOT NULL THEN \"t58\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"USERID\"\nFROM (SELECT MIN(\"t35\".\"Id\") AS \"USERID\", \"t35\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t35\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t35\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t34\".\"POSTID\", \"t34\".\"TITLE\", \"t34\".\"SCORE\", \"t34\".\"CREATIONDATE\", \"t34\".\"OWNERUSERID\", \"t34\".\"RAN\", \"t34\".\"COMMENTCOUNT\"\nFROM (SELECT \"t33\".\"Id\" AS \"POSTID\", \"t33\".\"Title\" AS \"TITLE\", \"t33\".\"Score\" AS \"SCORE\", \"t33\".\"CreationDate\" AS \"CREATIONDATE\", \"t33\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t33\".\"OwnerUserId\" ORDER BY \"t33\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t32\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t33\" ON \"t32\".\"PostId\" = \"t33\".\"Id\") AS \"t34\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t34\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t35\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t35\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t35\".\"Id\", \"t35\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t39\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t48\".\"USERID\"\nFROM (SELECT MIN(\"t44\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t43\".\"POSTID\", \"t43\".\"TITLE\", \"t43\".\"SCORE\", \"t43\".\"CREATIONDATE\", \"t43\".\"OWNERUSERID\", \"t43\".\"RAN\", \"t43\".\"COMMENTCOUNT\"\nFROM (SELECT \"t42\".\"Id\" AS \"POSTID\", \"t42\".\"Title\" AS \"TITLE\", \"t42\".\"Score\" AS \"SCORE\", \"t42\".\"CreationDate\" AS \"CREATIONDATE\", \"t42\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t42\".\"OwnerUserId\" ORDER BY \"t42\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t41\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t41\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t41\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t42\" ON \"t41\".\"PostId\" = \"t42\".\"Id\") AS \"t43\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t43\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t44\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t44\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t44\".\"Id\", \"t44\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t48\"\nGROUP BY \"t48\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t39\".\"USERID\" = \"t53\".\"UserId\"\nGROUP BY \"t39\".\"USERID\") AS \"t55\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t58\" ON \"t55\".\"USERID\" IS NOT DISTINCT FROM \"t58\".\"UserId\") AS \"t59\" ON \"t30\".\"USERID\" = \"t59\".\"UserId\") AS \"t60\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t84\".\"USERID\"\nFROM (SELECT \"t69\".\"USERID\", \"t69\".\"DISPLAYNAME\", \"t69\".\"TOTALPOSTS\", \"t69\".\"TOTALSCORE\", \"t69\".\"UPVOTECOUNT\", \"t69\".\"DOWNVOTECOUNT\", \"t69\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t83\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t83\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t65\".\"Id\") AS \"USERID\", \"t65\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t65\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t65\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t64\".\"POSTID\", \"t64\".\"TITLE\", \"t64\".\"SCORE\", \"t64\".\"CREATIONDATE\", \"t64\".\"OWNERUSERID\", \"t64\".\"RAN\", \"t64\".\"COMMENTCOUNT\"\nFROM (SELECT \"t63\".\"Id\" AS \"POSTID\", \"t63\".\"Title\" AS \"TITLE\", \"t63\".\"Score\" AS \"SCORE\", \"t63\".\"CreationDate\" AS \"CREATIONDATE\", \"t63\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t63\".\"OwnerUserId\" ORDER BY \"t63\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t62\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t63\" ON \"t62\".\"PostId\" = \"t63\".\"Id\") AS \"t64\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t64\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t65\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t65\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t65\".\"Id\", \"t65\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t69\"\nLEFT JOIN (SELECT \"t79\".\"USERID\" AS \"UserId\", CASE WHEN \"t82\".\"EXPR$0\" IS NOT NULL THEN \"t82\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT MIN(\"t74\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t73\".\"POSTID\", \"t73\".\"TITLE\", \"t73\".\"SCORE\", \"t73\".\"CREATIONDATE\", \"t73\".\"OWNERUSERID\", \"t73\".\"RAN\", \"t73\".\"COMMENTCOUNT\"\nFROM (SELECT \"t72\".\"Id\" AS \"POSTID\", \"t72\".\"Title\" AS \"TITLE\", \"t72\".\"Score\" AS \"SCORE\", \"t72\".\"CreationDate\" AS \"CREATIONDATE\", \"t72\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t72\".\"OwnerUserId\" ORDER BY \"t72\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t71\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t71\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t71\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t72\" ON \"t71\".\"PostId\" = \"t72\".\"Id\") AS \"t73\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t73\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t74\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t74\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t74\".\"Id\", \"t74\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t78\"\nGROUP BY \"t78\".\"USERID\") AS \"t79\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t82\" ON \"t79\".\"USERID\" IS NOT DISTINCT FROM \"t82\".\"UserId\") AS \"t83\" ON \"t69\".\"USERID\" = \"t83\".\"UserId\") AS \"t84\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT \"USERID\", \"DISPLAYNAME\", \"TOTALPOSTS\", \"TOTALSCORE\", \"UPVOTECOUNT\", \"DOWNVOTECOUNT\", \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t84\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t84\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t60\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t60\".\"TOTALSCORE\" DESC NULLS FIRST, \"t60\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43855",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43855,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 3,
            "OTHER" : 7,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t59\".\"USERID\", \"t59\".\"DISPLAYNAME\", \"t59\".\"TOTALPOSTS\", \"t59\".\"TOTALSCORE\", \"t59\".\"UPVOTECOUNT\", \"t59\".\"DOWNVOTECOUNT\", \"t59\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t59\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t59\".\"TOTALSCORE\" >= 50 AND \"t59\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t59\".\"EXPR$0\" AS \"GOLDBADGES\", \"t59\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t58\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t58\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t54\".\"USERID\" AS \"UserId\", CASE WHEN \"t57\".\"EXPR$0\" IS NOT NULL THEN \"t57\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"USERID\"\nFROM (SELECT MIN(\"t34\".\"Id\") AS \"USERID\", \"t34\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t34\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t34\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t33\".\"POSTID\", \"t33\".\"TITLE\", \"t33\".\"SCORE\", \"t33\".\"CREATIONDATE\", \"t33\".\"OWNERUSERID\", \"t33\".\"RAN\", \"t33\".\"COMMENTCOUNT\"\nFROM (SELECT \"t32\".\"Id\" AS \"POSTID\", \"t32\".\"Title\" AS \"TITLE\", \"t32\".\"Score\" AS \"SCORE\", \"t32\".\"CreationDate\" AS \"CREATIONDATE\", \"t32\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t32\".\"OwnerUserId\" ORDER BY \"t32\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t31\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t32\" ON \"t31\".\"PostId\" = \"t32\".\"Id\") AS \"t33\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t33\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t34\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t34\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t34\".\"Id\", \"t34\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t38\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"USERID\"\nFROM (SELECT MIN(\"t43\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t42\".\"POSTID\", \"t42\".\"TITLE\", \"t42\".\"SCORE\", \"t42\".\"CREATIONDATE\", \"t42\".\"OWNERUSERID\", \"t42\".\"RAN\", \"t42\".\"COMMENTCOUNT\"\nFROM (SELECT \"t41\".\"Id\" AS \"POSTID\", \"t41\".\"Title\" AS \"TITLE\", \"t41\".\"Score\" AS \"SCORE\", \"t41\".\"CreationDate\" AS \"CREATIONDATE\", \"t41\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t41\".\"OwnerUserId\" ORDER BY \"t41\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t40\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t40\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t40\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t41\" ON \"t40\".\"PostId\" = \"t41\".\"Id\") AS \"t42\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t42\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t43\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t43\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t43\".\"Id\", \"t43\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t47\"\nGROUP BY \"t47\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t38\".\"USERID\" = \"t52\".\"UserId\"\nGROUP BY \"t38\".\"USERID\") AS \"t54\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t57\" ON \"t54\".\"USERID\" IS NOT DISTINCT FROM \"t57\".\"UserId\") AS \"t58\" ON \"t29\".\"USERID\" = \"t58\".\"UserId\") AS \"t59\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t83\".\"USERID\"\nFROM (SELECT \"t68\".\"USERID\", \"t68\".\"DISPLAYNAME\", \"t68\".\"TOTALPOSTS\", \"t68\".\"TOTALSCORE\", \"t68\".\"UPVOTECOUNT\", \"t68\".\"DOWNVOTECOUNT\", \"t68\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t82\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t82\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t64\".\"Id\") AS \"USERID\", \"t64\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t64\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t64\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t63\".\"POSTID\", \"t63\".\"TITLE\", \"t63\".\"SCORE\", \"t63\".\"CREATIONDATE\", \"t63\".\"OWNERUSERID\", \"t63\".\"RAN\", \"t63\".\"COMMENTCOUNT\"\nFROM (SELECT \"t62\".\"Id\" AS \"POSTID\", \"t62\".\"Title\" AS \"TITLE\", \"t62\".\"Score\" AS \"SCORE\", \"t62\".\"CreationDate\" AS \"CREATIONDATE\", \"t62\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t62\".\"OwnerUserId\" ORDER BY \"t62\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t61\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t62\" ON \"t61\".\"PostId\" = \"t62\".\"Id\") AS \"t63\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t63\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t64\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t64\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t64\".\"Id\", \"t64\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t68\"\nLEFT JOIN (SELECT \"t78\".\"USERID\" AS \"UserId\", CASE WHEN \"t81\".\"EXPR$0\" IS NOT NULL THEN \"t81\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT MIN(\"t73\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t72\".\"POSTID\", \"t72\".\"TITLE\", \"t72\".\"SCORE\", \"t72\".\"CREATIONDATE\", \"t72\".\"OWNERUSERID\", \"t72\".\"RAN\", \"t72\".\"COMMENTCOUNT\"\nFROM (SELECT \"t71\".\"Id\" AS \"POSTID\", \"t71\".\"Title\" AS \"TITLE\", \"t71\".\"Score\" AS \"SCORE\", \"t71\".\"CreationDate\" AS \"CREATIONDATE\", \"t71\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t71\".\"OwnerUserId\" ORDER BY \"t71\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t70\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t70\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t70\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t71\" ON \"t70\".\"PostId\" = \"t71\".\"Id\") AS \"t72\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t72\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t73\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t73\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t73\".\"Id\", \"t73\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t77\"\nGROUP BY \"t77\".\"USERID\") AS \"t78\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t81\" ON \"t78\".\"USERID\" IS NOT DISTINCT FROM \"t81\".\"UserId\") AS \"t82\" ON \"t68\".\"USERID\" = \"t82\".\"UserId\") AS \"t83\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\", \"DISPLAYNAME\", COUNT(DISTINCT \"Id0\") AS \"TOTALPOSTS\", SUM(\"Score\") AS \"TOTALSCORE\", SUM(\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(\"FD_COL_6\") AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t83\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t83\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t59\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t59\".\"TOTALSCORE\" DESC NULLS FIRST, \"t59\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43850",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43850,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 2,
            "OTHER" : 6,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t58\".\"USERID\", \"t58\".\"DISPLAYNAME\", \"t58\".\"TOTALPOSTS\", \"t58\".\"TOTALSCORE\", \"t58\".\"UPVOTECOUNT\", \"t58\".\"DOWNVOTECOUNT\", \"t58\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t58\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t58\".\"TOTALSCORE\" >= 50 AND \"t58\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t58\".\"EXPR$0\" AS \"GOLDBADGES\", \"t58\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t57\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t57\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t53\".\"USERID\" AS \"UserId\", CASE WHEN \"t56\".\"EXPR$0\" IS NOT NULL THEN \"t56\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"USERID\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t32\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t33\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t41\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t42\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t37\".\"USERID\") AS \"t53\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t56\" ON \"t53\".\"USERID\" IS NOT DISTINCT FROM \"t56\".\"UserId\") AS \"t57\" ON \"t28\".\"USERID\" = \"t57\".\"UserId\") AS \"t58\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t82\".\"USERID\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t81\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t81\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t63\".\"Id\") AS \"USERID\", \"t63\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t63\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t63\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t62\".\"POSTID\", \"t62\".\"TITLE\", \"t62\".\"SCORE\", \"t62\".\"CREATIONDATE\", \"t62\".\"OWNERUSERID\", \"t62\".\"RAN\", \"t62\".\"COMMENTCOUNT\"\nFROM (SELECT \"t61\".\"Id\" AS \"POSTID\", \"t61\".\"Title\" AS \"TITLE\", \"t61\".\"Score\" AS \"SCORE\", \"t61\".\"CreationDate\" AS \"CREATIONDATE\", \"t61\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t61\".\"OwnerUserId\" ORDER BY \"t61\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t60\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t61\" ON \"t60\".\"PostId\" = \"t61\".\"Id\") AS \"t62\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t62\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t63\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t63\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t63\".\"Id\", \"t63\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t67\"\nLEFT JOIN (SELECT \"t77\".\"USERID\" AS \"UserId\", CASE WHEN \"t80\".\"EXPR$0\" IS NOT NULL THEN \"t80\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t76\".\"USERID\"\nFROM (SELECT MIN(\"t72\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t71\".\"POSTID\", \"t71\".\"TITLE\", \"t71\".\"SCORE\", \"t71\".\"CREATIONDATE\", \"t71\".\"OWNERUSERID\", \"t71\".\"RAN\", \"t71\".\"COMMENTCOUNT\"\nFROM (SELECT \"t70\".\"Id\" AS \"POSTID\", \"t70\".\"Title\" AS \"TITLE\", \"t70\".\"Score\" AS \"SCORE\", \"t70\".\"CreationDate\" AS \"CREATIONDATE\", \"t70\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t70\".\"OwnerUserId\" ORDER BY \"t70\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t69\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t69\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t69\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t70\" ON \"t69\".\"PostId\" = \"t70\".\"Id\") AS \"t71\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t71\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t72\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t72\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t72\".\"Id\", \"t72\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t76\"\nGROUP BY \"t76\".\"USERID\") AS \"t77\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t80\" ON \"t77\".\"USERID\" IS NOT DISTINCT FROM \"t80\".\"UserId\") AS \"t81\" ON \"t67\".\"USERID\" = \"t81\".\"UserId\") AS \"t82\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\", \"s1\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"s1\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"s1\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"s1\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t82\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t82\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t58\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t58\".\"TOTALSCORE\" DESC NULLS FIRST, \"t58\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43845",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43845,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 21,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "JOIN" : 1,
            "OTHER" : 4,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t57\".\"USERID\", \"t57\".\"DISPLAYNAME\", \"t57\".\"TOTALPOSTS\", \"t57\".\"TOTALSCORE\", \"t57\".\"UPVOTECOUNT\", \"t57\".\"DOWNVOTECOUNT\", \"t57\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t57\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t57\".\"TOTALSCORE\" >= 50 AND \"t57\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t57\".\"EXPR$0\" AS \"GOLDBADGES\", \"t57\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t56\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t56\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"USERID\"\nFROM (SELECT MIN(\"t32\".\"Id\") AS \"USERID\", \"t32\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t32\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t32\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t31\".\"POSTID\", \"t31\".\"TITLE\", \"t31\".\"SCORE\", \"t31\".\"CREATIONDATE\", \"t31\".\"OWNERUSERID\", \"t31\".\"RAN\", \"t31\".\"COMMENTCOUNT\"\nFROM (SELECT \"t30\".\"Id\" AS \"POSTID\", \"t30\".\"Title\" AS \"TITLE\", \"t30\".\"Score\" AS \"SCORE\", \"t30\".\"CreationDate\" AS \"CREATIONDATE\", \"t30\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t30\".\"OwnerUserId\" ORDER BY \"t30\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t29\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t30\" ON \"t29\".\"PostId\" = \"t30\".\"Id\") AS \"t31\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t31\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t32\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t32\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t32\".\"Id\", \"t32\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t36\"\nLEFT JOIN (SELECT \"t46\".\"USERID\" AS \"UserId\", CASE WHEN \"t49\".\"EXPR$0\" IS NOT NULL THEN \"t49\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"USERID\"\nFROM (SELECT MIN(\"t41\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t40\".\"POSTID\", \"t40\".\"TITLE\", \"t40\".\"SCORE\", \"t40\".\"CREATIONDATE\", \"t40\".\"OWNERUSERID\", \"t40\".\"RAN\", \"t40\".\"COMMENTCOUNT\"\nFROM (SELECT \"t39\".\"Id\" AS \"POSTID\", \"t39\".\"Title\" AS \"TITLE\", \"t39\".\"Score\" AS \"SCORE\", \"t39\".\"CreationDate\" AS \"CREATIONDATE\", \"t39\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t39\".\"OwnerUserId\" ORDER BY \"t39\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t38\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t39\" ON \"t38\".\"PostId\" = \"t39\".\"Id\") AS \"t40\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t40\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t41\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t41\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t41\".\"Id\", \"t41\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t45\"\nGROUP BY \"t45\".\"USERID\") AS \"t46\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t49\" ON \"t46\".\"USERID\" IS NOT DISTINCT FROM \"t49\".\"UserId\") AS \"t50\" ON \"t36\".\"USERID\" = \"t50\".\"UserId\"\nGROUP BY \"t36\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t27\".\"USERID\" = \"t56\".\"UserId\") AS \"t57\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t81\".\"USERID\"\nFROM (SELECT \"t66\".\"USERID\", \"t66\".\"DISPLAYNAME\", \"t66\".\"TOTALPOSTS\", \"t66\".\"TOTALSCORE\", \"t66\".\"UPVOTECOUNT\", \"t66\".\"DOWNVOTECOUNT\", \"t66\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t80\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t80\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t62\".\"Id\") AS \"USERID\", \"t62\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t62\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t62\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t61\".\"POSTID\", \"t61\".\"TITLE\", \"t61\".\"SCORE\", \"t61\".\"CREATIONDATE\", \"t61\".\"OWNERUSERID\", \"t61\".\"RAN\", \"t61\".\"COMMENTCOUNT\"\nFROM (SELECT \"t60\".\"Id\" AS \"POSTID\", \"t60\".\"Title\" AS \"TITLE\", \"t60\".\"Score\" AS \"SCORE\", \"t60\".\"CreationDate\" AS \"CREATIONDATE\", \"t60\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t60\".\"OwnerUserId\" ORDER BY \"t60\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t59\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t60\" ON \"t59\".\"PostId\" = \"t60\".\"Id\") AS \"t61\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t61\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t62\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t62\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t62\".\"Id\", \"t62\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t66\"\nLEFT JOIN (SELECT \"t76\".\"USERID\" AS \"UserId\", CASE WHEN \"t79\".\"EXPR$0\" IS NOT NULL THEN \"t79\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t75\".\"USERID\"\nFROM (SELECT MIN(\"t71\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t70\".\"POSTID\", \"t70\".\"TITLE\", \"t70\".\"SCORE\", \"t70\".\"CREATIONDATE\", \"t70\".\"OWNERUSERID\", \"t70\".\"RAN\", \"t70\".\"COMMENTCOUNT\"\nFROM (SELECT \"t69\".\"Id\" AS \"POSTID\", \"t69\".\"Title\" AS \"TITLE\", \"t69\".\"Score\" AS \"SCORE\", \"t69\".\"CreationDate\" AS \"CREATIONDATE\", \"t69\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t69\".\"OwnerUserId\" ORDER BY \"t69\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t68\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t68\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t68\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t69\" ON \"t68\".\"PostId\" = \"t69\".\"Id\") AS \"t70\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t70\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t71\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t71\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t71\".\"Id\", \"t71\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t75\"\nGROUP BY \"t75\".\"USERID\") AS \"t76\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t79\" ON \"t76\".\"USERID\" IS NOT DISTINCT FROM \"t79\".\"UserId\") AS \"t80\" ON \"t66\".\"USERID\" = \"t80\".\"UserId\") AS \"t81\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"s1\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t81\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t81\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t57\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t57\".\"TOTALSCORE\" DESC NULLS FIRST, \"t57\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43838",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43838,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t78\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t77\".\"EXPR$0\" IS NOT NULL THEN \"t77\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t77\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t77\".\"UserId\") AS \"t78\" ON \"t64\".\"USERID\" = \"t78\".\"UserId\") AS \"t79\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"s1\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t79\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t79\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43836",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43836,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 24,
        "cutNodeOperatorKind" : "OTHER",
        "cutOutputRows" : 7241822.0,
        "cutRowSizeOutBytes" : 223.73499120801367,
        "cutOutputBytes" : 1.6202489815E9,
        "transferEstimatedMs" : 1289.454665768858,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\"\nFROM \"Comments\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t5\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t29\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t59\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t72\".\"USERID\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t68\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t72\"\nGROUP BY \"t72\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t63\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"t80\".\"Id\" AS \"POSTID\", \"t80\".\"Title\" AS \"TITLE\", \"t80\".\"Score\" AS \"SCORE\", \"t80\".\"CreationDate\" AS \"CREATIONDATE\", \"t80\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t80\".\"OwnerUserId\" ORDER BY \"t80\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t79\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t79\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"s1\"\nGROUP BY \"PostId\") AS \"t79\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t80\" ON \"t79\".\"PostId\" = \"t80\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t78\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t78\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43841",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43841,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 23,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "FILTER" : 1,
            "OTHER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t29\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t38\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t59\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t72\".\"USERID\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t68\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t72\"\nGROUP BY \"t72\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t63\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT MIN(\"t82\".\"Id\") AS \"USERID\", \"t82\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t82\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t82\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t81\".\"POSTID\", \"t81\".\"TITLE\", \"t81\".\"SCORE\", \"t81\".\"CREATIONDATE\", \"t81\".\"OWNERUSERID\", \"t81\".\"RAN\", \"t81\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t80\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t80\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t80\"\nRIGHT JOIN \"s1\" ON \"t80\".\"PostId\" = \"s1\".\"Id\") AS \"t81\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t81\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t82\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t82\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t82\".\"Id\", \"t82\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t86\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t86\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t78\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t78\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43902",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43902,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 14,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5.698010705604928E11,
        "cutRowSizeOutBytes" : 24.0,
        "cutOutputBytes" : 1.3675225693451828E13,
        "transferEstimatedMs" : 5.2466393316705965E7,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 22,
          "maxDepth" : 15,
          "operatorKindCounts" : {
            "OTHER" : 11,
            "JOIN" : 4,
            "AGGREGATE" : 4,
            "FILTER" : 3
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 136,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 55,
            "JOIN" : 34,
            "AGGREGATE" : 26,
            "FILTER" : 20,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t8\".\"USERID\", \"t8\".\"USERID\") AS \"UserId\", CASE WHEN \"t11\".\"EXPR$0\" IS NOT NULL THEN \"t11\".\"EXPR$0\" ELSE 0 END AS \"FD_COL_1\"\nFROM (SELECT \"t7\".\"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\") AS \"t8\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t11\" ON \"t8\".\"USERID\" IS NOT DISTINCT FROM \"t11\".\"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t67\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t67\".\"TOTALSCORE\" >= 50 AND \"t67\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t67\".\"EXPR$0\" AS \"GOLDBADGES\", \"t67\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t37\".\"USERID\", \"t37\".\"DISPLAYNAME\", \"t37\".\"TOTALPOSTS\", \"t37\".\"TOTALSCORE\", \"t37\".\"UPVOTECOUNT\", \"t37\".\"DOWNVOTECOUNT\", \"t37\".\"AVGCOMMENTSPERPOST\", \"t37\".\"EXPR$0\", CASE WHEN \"t66\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t66\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t22\".\"USERID\", \"t22\".\"DISPLAYNAME\", \"t22\".\"TOTALPOSTS\", \"t22\".\"TOTALSCORE\", \"t22\".\"UPVOTECOUNT\", \"t22\".\"DOWNVOTECOUNT\", \"t22\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t36\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t36\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\", \"t18\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t18\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t18\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t18\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t18\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t17\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t18\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t22\"\nLEFT JOIN (SELECT \"t32\".\"USERID\" AS \"UserId\", CASE WHEN \"t35\".\"EXPR$0\" IS NOT NULL THEN \"t35\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t31\".\"USERID\"\nFROM (SELECT MIN(\"t27\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t26\".\"POSTID\", \"t26\".\"TITLE\", \"t26\".\"SCORE\", \"t26\".\"CREATIONDATE\", \"t26\".\"OWNERUSERID\", \"t26\".\"RAN\", \"t26\".\"COMMENTCOUNT\"\nFROM (SELECT \"t25\".\"Id\" AS \"POSTID\", \"t25\".\"Title\" AS \"TITLE\", \"t25\".\"Score\" AS \"SCORE\", \"t25\".\"CreationDate\" AS \"CREATIONDATE\", \"t25\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t25\".\"OwnerUserId\" ORDER BY \"t25\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t24\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t24\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t24\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t25\" ON \"t24\".\"PostId\" = \"t25\".\"Id\") AS \"t26\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t26\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t27\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t27\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t27\".\"Id\", \"t27\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t31\"\nGROUP BY \"t31\".\"USERID\") AS \"t32\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t35\" ON \"t32\".\"USERID\" IS NOT DISTINCT FROM \"t35\".\"UserId\") AS \"t36\" ON \"t22\".\"USERID\" = \"t36\".\"UserId\") AS \"t37\"\nLEFT JOIN (SELECT \"t62\".\"USERID\" AS \"UserId\", CASE WHEN \"t65\".\"EXPR$0\" IS NOT NULL THEN \"t65\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\", \"t42\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t42\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t42\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t42\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t42\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t41\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t42\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t46\"\nLEFT JOIN (SELECT \"t56\".\"USERID\" AS \"UserId\", CASE WHEN \"t59\".\"EXPR$0\" IS NOT NULL THEN \"t59\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t55\".\"USERID\"\nFROM (SELECT MIN(\"t51\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t50\".\"POSTID\", \"t50\".\"TITLE\", \"t50\".\"SCORE\", \"t50\".\"CREATIONDATE\", \"t50\".\"OWNERUSERID\", \"t50\".\"RAN\", \"t50\".\"COMMENTCOUNT\"\nFROM (SELECT \"t49\".\"Id\" AS \"POSTID\", \"t49\".\"Title\" AS \"TITLE\", \"t49\".\"Score\" AS \"SCORE\", \"t49\".\"CreationDate\" AS \"CREATIONDATE\", \"t49\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t49\".\"OwnerUserId\" ORDER BY \"t49\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t48\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t48\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t48\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t49\" ON \"t48\".\"PostId\" = \"t49\".\"Id\") AS \"t50\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t50\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t51\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t51\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t51\".\"Id\", \"t51\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t55\"\nGROUP BY \"t55\".\"USERID\") AS \"t56\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t59\" ON \"t56\".\"USERID\" IS NOT DISTINCT FROM \"t59\".\"UserId\") AS \"t60\" ON \"t46\".\"USERID\" = \"t60\".\"UserId\"\nGROUP BY \"t46\".\"USERID\") AS \"t62\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t65\" ON \"t62\".\"USERID\" IS NOT DISTINCT FROM \"t65\".\"UserId\") AS \"t66\" ON \"t37\".\"USERID\" = \"t66\".\"UserId\") AS \"t67\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t91\".\"USERID\"\nFROM (SELECT \"t76\".\"USERID\", \"t76\".\"DISPLAYNAME\", \"t76\".\"TOTALPOSTS\", \"t76\".\"TOTALSCORE\", \"t76\".\"UPVOTECOUNT\", \"t76\".\"DOWNVOTECOUNT\", \"t76\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t90\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t90\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t72\".\"Id\") AS \"USERID\", \"t72\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t72\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t72\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t72\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t72\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t71\".\"POSTID\", \"t71\".\"TITLE\", \"t71\".\"SCORE\", \"t71\".\"CREATIONDATE\", \"t71\".\"OWNERUSERID\", \"t71\".\"RAN\", \"t71\".\"COMMENTCOUNT\"\nFROM (SELECT \"t70\".\"Id\" AS \"POSTID\", \"t70\".\"Title\" AS \"TITLE\", \"t70\".\"Score\" AS \"SCORE\", \"t70\".\"CreationDate\" AS \"CREATIONDATE\", \"t70\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t70\".\"OwnerUserId\" ORDER BY \"t70\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t69\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t69\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t69\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t70\" ON \"t69\".\"PostId\" = \"t70\".\"Id\") AS \"t71\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t71\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t72\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t72\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t72\".\"Id\", \"t72\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t76\"\nLEFT JOIN (SELECT \"t86\".\"USERID\" AS \"UserId\", CASE WHEN \"t89\".\"EXPR$0\" IS NOT NULL THEN \"t89\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t85\".\"USERID\"\nFROM (SELECT MIN(\"t81\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t80\".\"POSTID\", \"t80\".\"TITLE\", \"t80\".\"SCORE\", \"t80\".\"CREATIONDATE\", \"t80\".\"OWNERUSERID\", \"t80\".\"RAN\", \"t80\".\"COMMENTCOUNT\"\nFROM (SELECT \"t79\".\"Id\" AS \"POSTID\", \"t79\".\"Title\" AS \"TITLE\", \"t79\".\"Score\" AS \"SCORE\", \"t79\".\"CreationDate\" AS \"CREATIONDATE\", \"t79\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t79\".\"OwnerUserId\" ORDER BY \"t79\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t78\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t78\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t78\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t79\" ON \"t78\".\"PostId\" = \"t79\".\"Id\") AS \"t80\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t80\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t81\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t81\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t81\".\"Id\", \"t81\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t85\"\nGROUP BY \"t85\".\"USERID\") AS \"t86\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t89\" ON \"t86\".\"USERID\" IS NOT DISTINCT FROM \"t89\".\"UserId\") AS \"t90\" ON \"t76\".\"USERID\" = \"t90\".\"UserId\") AS \"t91\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t100\".\"USERID\"\nFROM (SELECT MIN(\"t96\".\"Id\") AS \"USERID\", \"t96\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t96\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t96\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t96\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t96\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t95\".\"POSTID\", \"t95\".\"TITLE\", \"t95\".\"SCORE\", \"t95\".\"CREATIONDATE\", \"t95\".\"OWNERUSERID\", \"t95\".\"RAN\", \"t95\".\"COMMENTCOUNT\"\nFROM (SELECT \"t94\".\"Id\" AS \"POSTID\", \"t94\".\"Title\" AS \"TITLE\", \"t94\".\"Score\" AS \"SCORE\", \"t94\".\"CreationDate\" AS \"CREATIONDATE\", \"t94\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t94\".\"OwnerUserId\" ORDER BY \"t94\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t93\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t93\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t93\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t94\" ON \"t93\".\"PostId\" = \"t94\".\"Id\") AS \"t95\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t95\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t96\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t96\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t96\".\"Id\", \"t96\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t100\"\nLEFT JOIN \"s1\" ON \"t100\".\"USERID\" = \"s1\".\"UserId\"\nGROUP BY \"t100\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t91\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t91\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t67\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t67\".\"TOTALSCORE\" DESC NULLS FIRST, \"t67\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43891",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43891,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 8.0,
        "cutOutputBytes" : 8302794.546081011,
        "transferEstimatedMs" : 162.19871464388137,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 16,
          "maxDepth" : 13,
          "operatorKindCounts" : {
            "OTHER" : 8,
            "JOIN" : 3,
            "AGGREGATE" : 3,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 142,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 27,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t7\".\"USERID\", \"t7\".\"USERID\") AS \"USERID\"\nFROM (SELECT ANY_VALUE(\"t3\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t7\"\nGROUP BY \"t7\".\"USERID\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t63\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t63\".\"TOTALSCORE\" >= 50 AND \"t63\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t63\".\"EXPR$0\" AS \"GOLDBADGES\", \"t63\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t33\".\"USERID\", \"t33\".\"DISPLAYNAME\", \"t33\".\"TOTALPOSTS\", \"t33\".\"TOTALSCORE\", \"t33\".\"UPVOTECOUNT\", \"t33\".\"DOWNVOTECOUNT\", \"t33\".\"AVGCOMMENTSPERPOST\", \"t33\".\"EXPR$0\", CASE WHEN \"t62\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t62\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t18\".\"USERID\", \"t18\".\"DISPLAYNAME\", \"t18\".\"TOTALPOSTS\", \"t18\".\"TOTALSCORE\", \"t18\".\"UPVOTECOUNT\", \"t18\".\"DOWNVOTECOUNT\", \"t18\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t32\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t32\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\", \"t14\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t14\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t14\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t14\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t18\"\nLEFT JOIN (SELECT \"t28\".\"USERID\" AS \"UserId\", CASE WHEN \"t31\".\"EXPR$0\" IS NOT NULL THEN \"t31\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t27\".\"USERID\"\nFROM (SELECT MIN(\"t23\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t22\".\"POSTID\", \"t22\".\"TITLE\", \"t22\".\"SCORE\", \"t22\".\"CREATIONDATE\", \"t22\".\"OWNERUSERID\", \"t22\".\"RAN\", \"t22\".\"COMMENTCOUNT\"\nFROM (SELECT \"t21\".\"Id\" AS \"POSTID\", \"t21\".\"Title\" AS \"TITLE\", \"t21\".\"Score\" AS \"SCORE\", \"t21\".\"CreationDate\" AS \"CREATIONDATE\", \"t21\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t21\".\"OwnerUserId\" ORDER BY \"t21\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t20\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t20\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t20\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t21\" ON \"t20\".\"PostId\" = \"t21\".\"Id\") AS \"t22\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t22\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t23\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t23\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t23\".\"Id\", \"t23\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t27\"\nGROUP BY \"t27\".\"USERID\") AS \"t28\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t31\" ON \"t28\".\"USERID\" IS NOT DISTINCT FROM \"t31\".\"UserId\") AS \"t32\" ON \"t18\".\"USERID\" = \"t32\".\"UserId\") AS \"t33\"\nLEFT JOIN (SELECT \"t58\".\"USERID\" AS \"UserId\", CASE WHEN \"t61\".\"EXPR$0\" IS NOT NULL THEN \"t61\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\", \"t38\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t38\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t38\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t38\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t42\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t51\".\"USERID\"\nFROM (SELECT MIN(\"t47\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t46\".\"POSTID\", \"t46\".\"TITLE\", \"t46\".\"SCORE\", \"t46\".\"CREATIONDATE\", \"t46\".\"OWNERUSERID\", \"t46\".\"RAN\", \"t46\".\"COMMENTCOUNT\"\nFROM (SELECT \"t45\".\"Id\" AS \"POSTID\", \"t45\".\"Title\" AS \"TITLE\", \"t45\".\"Score\" AS \"SCORE\", \"t45\".\"CreationDate\" AS \"CREATIONDATE\", \"t45\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t45\".\"OwnerUserId\" ORDER BY \"t45\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t44\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t44\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t44\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t45\" ON \"t44\".\"PostId\" = \"t45\".\"Id\") AS \"t46\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t46\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t47\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t47\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t47\".\"Id\", \"t47\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t51\"\nGROUP BY \"t51\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t42\".\"USERID\" = \"t56\".\"UserId\"\nGROUP BY \"t42\".\"USERID\") AS \"t58\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t61\" ON \"t58\".\"USERID\" IS NOT DISTINCT FROM \"t61\".\"UserId\") AS \"t62\" ON \"t33\".\"USERID\" = \"t62\".\"UserId\") AS \"t63\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t87\".\"USERID\"\nFROM (SELECT \"t72\".\"USERID\", \"t72\".\"DISPLAYNAME\", \"t72\".\"TOTALPOSTS\", \"t72\".\"TOTALSCORE\", \"t72\".\"UPVOTECOUNT\", \"t72\".\"DOWNVOTECOUNT\", \"t72\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t86\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t86\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\", \"t68\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t68\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t68\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t68\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t68\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t68\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t72\"\nLEFT JOIN (SELECT \"t82\".\"USERID\" AS \"UserId\", CASE WHEN \"t85\".\"EXPR$0\" IS NOT NULL THEN \"t85\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t81\".\"USERID\"\nFROM (SELECT MIN(\"t77\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t76\".\"POSTID\", \"t76\".\"TITLE\", \"t76\".\"SCORE\", \"t76\".\"CREATIONDATE\", \"t76\".\"OWNERUSERID\", \"t76\".\"RAN\", \"t76\".\"COMMENTCOUNT\"\nFROM (SELECT \"t75\".\"Id\" AS \"POSTID\", \"t75\".\"Title\" AS \"TITLE\", \"t75\".\"Score\" AS \"SCORE\", \"t75\".\"CreationDate\" AS \"CREATIONDATE\", \"t75\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t75\".\"OwnerUserId\" ORDER BY \"t75\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t74\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t74\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t74\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t75\" ON \"t74\".\"PostId\" = \"t75\".\"Id\") AS \"t76\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t76\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t77\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t77\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t77\".\"Id\", \"t77\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t81\"\nGROUP BY \"t81\".\"USERID\") AS \"t82\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t85\" ON \"t82\".\"USERID\" IS NOT DISTINCT FROM \"t85\".\"UserId\") AS \"t86\" ON \"t72\".\"USERID\" = \"t86\".\"UserId\") AS \"t87\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t96\".\"USERID\"\nFROM (SELECT MIN(\"t92\".\"Id\") AS \"USERID\", \"t92\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t92\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t92\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t92\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t92\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t91\".\"POSTID\", \"t91\".\"TITLE\", \"t91\".\"SCORE\", \"t91\".\"CREATIONDATE\", \"t91\".\"OWNERUSERID\", \"t91\".\"RAN\", \"t91\".\"COMMENTCOUNT\"\nFROM (SELECT \"t90\".\"Id\" AS \"POSTID\", \"t90\".\"Title\" AS \"TITLE\", \"t90\".\"Score\" AS \"SCORE\", \"t90\".\"CreationDate\" AS \"CREATIONDATE\", \"t90\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t90\".\"OwnerUserId\" ORDER BY \"t90\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t89\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t89\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t89\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t90\" ON \"t89\".\"PostId\" = \"t90\".\"Id\") AS \"t91\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t91\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t92\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t92\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t92\".\"Id\", \"t92\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t96\"\nLEFT JOIN (SELECT \"s1\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM \"s1\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"s1\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t96\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t96\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t87\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t87\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t63\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t63\".\"TOTALSCORE\" DESC NULLS FIRST, \"t63\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43889",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43889,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1.0,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 64.0,
        "transferEstimatedMs" : 73.0046923021309,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 15,
          "maxDepth" : 12,
          "operatorKindCounts" : {
            "OTHER" : 8,
            "JOIN" : 3,
            "AGGREGATE" : 2,
            "FILTER" : 2
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 143,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 58,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 21,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(ANY_VALUE(\"t3\".\"Id\"), ANY_VALUE(\"t3\".\"Id\")) AS \"USERID\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0",
        "inputs" : { },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t62\".\"USERID\", \"t62\".\"DISPLAYNAME\", \"t62\".\"TOTALPOSTS\", \"t62\".\"TOTALSCORE\", \"t62\".\"UPVOTECOUNT\", \"t62\".\"DOWNVOTECOUNT\", \"t62\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t62\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t62\".\"TOTALSCORE\" >= 50 AND \"t62\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t62\".\"EXPR$0\" AS \"GOLDBADGES\", \"t62\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t32\".\"USERID\", \"t32\".\"DISPLAYNAME\", \"t32\".\"TOTALPOSTS\", \"t32\".\"TOTALSCORE\", \"t32\".\"UPVOTECOUNT\", \"t32\".\"DOWNVOTECOUNT\", \"t32\".\"AVGCOMMENTSPERPOST\", \"t32\".\"EXPR$0\", CASE WHEN \"t61\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t61\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t17\".\"USERID\", \"t17\".\"DISPLAYNAME\", \"t17\".\"TOTALPOSTS\", \"t17\".\"TOTALSCORE\", \"t17\".\"UPVOTECOUNT\", \"t17\".\"DOWNVOTECOUNT\", \"t17\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t31\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t31\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t13\".\"Id\") AS \"USERID\", \"t13\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t13\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t13\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t12\".\"POSTID\", \"t12\".\"TITLE\", \"t12\".\"SCORE\", \"t12\".\"CREATIONDATE\", \"t12\".\"OWNERUSERID\", \"t12\".\"RAN\", \"t12\".\"COMMENTCOUNT\"\nFROM (SELECT \"t11\".\"Id\" AS \"POSTID\", \"t11\".\"Title\" AS \"TITLE\", \"t11\".\"Score\" AS \"SCORE\", \"t11\".\"CreationDate\" AS \"CREATIONDATE\", \"t11\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t11\".\"OwnerUserId\" ORDER BY \"t11\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t10\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t11\" ON \"t10\".\"PostId\" = \"t11\".\"Id\") AS \"t12\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t12\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t13\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t13\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t13\".\"Id\", \"t13\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t17\"\nLEFT JOIN (SELECT \"t27\".\"USERID\" AS \"UserId\", CASE WHEN \"t30\".\"EXPR$0\" IS NOT NULL THEN \"t30\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t26\".\"USERID\"\nFROM (SELECT MIN(\"t22\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t21\".\"POSTID\", \"t21\".\"TITLE\", \"t21\".\"SCORE\", \"t21\".\"CREATIONDATE\", \"t21\".\"OWNERUSERID\", \"t21\".\"RAN\", \"t21\".\"COMMENTCOUNT\"\nFROM (SELECT \"t20\".\"Id\" AS \"POSTID\", \"t20\".\"Title\" AS \"TITLE\", \"t20\".\"Score\" AS \"SCORE\", \"t20\".\"CreationDate\" AS \"CREATIONDATE\", \"t20\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t20\".\"OwnerUserId\" ORDER BY \"t20\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t19\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t19\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t19\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t20\" ON \"t19\".\"PostId\" = \"t20\".\"Id\") AS \"t21\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t21\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t22\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t22\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t22\".\"Id\", \"t22\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t26\"\nGROUP BY \"t26\".\"USERID\") AS \"t27\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t30\" ON \"t27\".\"USERID\" IS NOT DISTINCT FROM \"t30\".\"UserId\") AS \"t31\" ON \"t17\".\"USERID\" = \"t31\".\"UserId\") AS \"t32\"\nLEFT JOIN (SELECT \"t57\".\"USERID\" AS \"UserId\", CASE WHEN \"t60\".\"EXPR$0\" IS NOT NULL THEN \"t60\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t41\".\"USERID\"\nFROM (SELECT MIN(\"t37\".\"Id\") AS \"USERID\", \"t37\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t37\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t37\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t36\".\"POSTID\", \"t36\".\"TITLE\", \"t36\".\"SCORE\", \"t36\".\"CREATIONDATE\", \"t36\".\"OWNERUSERID\", \"t36\".\"RAN\", \"t36\".\"COMMENTCOUNT\"\nFROM (SELECT \"t35\".\"Id\" AS \"POSTID\", \"t35\".\"Title\" AS \"TITLE\", \"t35\".\"Score\" AS \"SCORE\", \"t35\".\"CreationDate\" AS \"CREATIONDATE\", \"t35\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t35\".\"OwnerUserId\" ORDER BY \"t35\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t34\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t35\" ON \"t34\".\"PostId\" = \"t35\".\"Id\") AS \"t36\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t36\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t37\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t37\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t37\".\"Id\", \"t37\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t41\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t50\".\"USERID\"\nFROM (SELECT MIN(\"t46\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t45\".\"POSTID\", \"t45\".\"TITLE\", \"t45\".\"SCORE\", \"t45\".\"CREATIONDATE\", \"t45\".\"OWNERUSERID\", \"t45\".\"RAN\", \"t45\".\"COMMENTCOUNT\"\nFROM (SELECT \"t44\".\"Id\" AS \"POSTID\", \"t44\".\"Title\" AS \"TITLE\", \"t44\".\"Score\" AS \"SCORE\", \"t44\".\"CreationDate\" AS \"CREATIONDATE\", \"t44\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t44\".\"OwnerUserId\" ORDER BY \"t44\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t43\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t43\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t43\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t44\" ON \"t43\".\"PostId\" = \"t44\".\"Id\") AS \"t45\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t45\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t46\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t46\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t46\".\"Id\", \"t46\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t50\"\nGROUP BY \"t50\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t41\".\"USERID\" = \"t55\".\"UserId\"\nGROUP BY \"t41\".\"USERID\") AS \"t57\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t60\" ON \"t57\".\"USERID\" IS NOT DISTINCT FROM \"t60\".\"UserId\") AS \"t61\" ON \"t32\".\"USERID\" = \"t61\".\"UserId\") AS \"t62\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t86\".\"USERID\"\nFROM (SELECT \"t71\".\"USERID\", \"t71\".\"DISPLAYNAME\", \"t71\".\"TOTALPOSTS\", \"t71\".\"TOTALSCORE\", \"t71\".\"UPVOTECOUNT\", \"t71\".\"DOWNVOTECOUNT\", \"t71\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t85\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t85\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t67\".\"Id\") AS \"USERID\", \"t67\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t67\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t67\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t66\".\"POSTID\", \"t66\".\"TITLE\", \"t66\".\"SCORE\", \"t66\".\"CREATIONDATE\", \"t66\".\"OWNERUSERID\", \"t66\".\"RAN\", \"t66\".\"COMMENTCOUNT\"\nFROM (SELECT \"t65\".\"Id\" AS \"POSTID\", \"t65\".\"Title\" AS \"TITLE\", \"t65\".\"Score\" AS \"SCORE\", \"t65\".\"CreationDate\" AS \"CREATIONDATE\", \"t65\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t65\".\"OwnerUserId\" ORDER BY \"t65\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t64\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t65\" ON \"t64\".\"PostId\" = \"t65\".\"Id\") AS \"t66\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t66\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t67\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t67\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t67\".\"Id\", \"t67\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t71\"\nLEFT JOIN (SELECT \"t81\".\"USERID\" AS \"UserId\", CASE WHEN \"t84\".\"EXPR$0\" IS NOT NULL THEN \"t84\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"USERID\"\nFROM (SELECT MIN(\"t76\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t75\".\"POSTID\", \"t75\".\"TITLE\", \"t75\".\"SCORE\", \"t75\".\"CREATIONDATE\", \"t75\".\"OWNERUSERID\", \"t75\".\"RAN\", \"t75\".\"COMMENTCOUNT\"\nFROM (SELECT \"t74\".\"Id\" AS \"POSTID\", \"t74\".\"Title\" AS \"TITLE\", \"t74\".\"Score\" AS \"SCORE\", \"t74\".\"CreationDate\" AS \"CREATIONDATE\", \"t74\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t74\".\"OwnerUserId\" ORDER BY \"t74\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t73\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t73\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t73\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t74\" ON \"t73\".\"PostId\" = \"t74\".\"Id\") AS \"t75\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t75\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t76\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t76\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t76\".\"Id\", \"t76\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t80\"\nGROUP BY \"t80\".\"USERID\") AS \"t81\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t84\" ON \"t81\".\"USERID\" IS NOT DISTINCT FROM \"t84\".\"UserId\") AS \"t85\" ON \"t71\".\"USERID\" = \"t85\".\"UserId\") AS \"t86\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\", \"t91\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t91\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t91\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t91\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t91\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t88\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"t88\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nGROUP BY \"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t95\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t95\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t86\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t86\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t62\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t62\".\"TOTALSCORE\" DESC NULLS FIRST, \"t62\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43885",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43885,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 19,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 1037849.3182601264,
        "cutRowSizeOutBytes" : 64.0,
        "cutOutputBytes" : 6.642235636864809E7,
        "transferEstimatedMs" : 184.33788904030834,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 13,
          "maxDepth" : 10,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 3,
            "AGGREGATE" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 145,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 28,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", ANY_VALUE(\"t3\".\"Id\") AS \"USERID\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t3\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t3\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t3\".\"Id\", \"t3\".\"DisplayName\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t60\".\"USERID\", \"t60\".\"DISPLAYNAME\", \"t60\".\"TOTALPOSTS\", \"t60\".\"TOTALSCORE\", \"t60\".\"UPVOTECOUNT\", \"t60\".\"DOWNVOTECOUNT\", \"t60\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t60\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t60\".\"TOTALSCORE\" >= 50 AND \"t60\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t60\".\"EXPR$0\" AS \"GOLDBADGES\", \"t60\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t30\".\"USERID\", \"t30\".\"DISPLAYNAME\", \"t30\".\"TOTALPOSTS\", \"t30\".\"TOTALSCORE\", \"t30\".\"UPVOTECOUNT\", \"t30\".\"DOWNVOTECOUNT\", \"t30\".\"AVGCOMMENTSPERPOST\", \"t30\".\"EXPR$0\", CASE WHEN \"t59\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t59\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t15\".\"USERID\", \"t15\".\"DISPLAYNAME\", \"t15\".\"TOTALPOSTS\", \"t15\".\"TOTALSCORE\", \"t15\".\"UPVOTECOUNT\", \"t15\".\"DOWNVOTECOUNT\", \"t15\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t29\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t29\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t11\".\"Id\") AS \"USERID\", \"t11\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t11\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t11\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t10\".\"POSTID\", \"t10\".\"TITLE\", \"t10\".\"SCORE\", \"t10\".\"CREATIONDATE\", \"t10\".\"OWNERUSERID\", \"t10\".\"RAN\", \"t10\".\"COMMENTCOUNT\"\nFROM (SELECT \"t9\".\"Id\" AS \"POSTID\", \"t9\".\"Title\" AS \"TITLE\", \"t9\".\"Score\" AS \"SCORE\", \"t9\".\"CreationDate\" AS \"CREATIONDATE\", \"t9\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t9\".\"OwnerUserId\" ORDER BY \"t9\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t8\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t9\" ON \"t8\".\"PostId\" = \"t9\".\"Id\") AS \"t10\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t10\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t11\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t11\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t11\".\"Id\", \"t11\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t15\"\nLEFT JOIN (SELECT \"t25\".\"USERID\" AS \"UserId\", CASE WHEN \"t28\".\"EXPR$0\" IS NOT NULL THEN \"t28\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t24\".\"USERID\"\nFROM (SELECT MIN(\"t20\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t19\".\"POSTID\", \"t19\".\"TITLE\", \"t19\".\"SCORE\", \"t19\".\"CREATIONDATE\", \"t19\".\"OWNERUSERID\", \"t19\".\"RAN\", \"t19\".\"COMMENTCOUNT\"\nFROM (SELECT \"t18\".\"Id\" AS \"POSTID\", \"t18\".\"Title\" AS \"TITLE\", \"t18\".\"Score\" AS \"SCORE\", \"t18\".\"CreationDate\" AS \"CREATIONDATE\", \"t18\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t18\".\"OwnerUserId\" ORDER BY \"t18\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t17\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t17\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t17\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t18\" ON \"t17\".\"PostId\" = \"t18\".\"Id\") AS \"t19\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t19\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t20\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t20\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t20\".\"Id\", \"t20\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t24\"\nGROUP BY \"t24\".\"USERID\") AS \"t25\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t28\" ON \"t25\".\"USERID\" IS NOT DISTINCT FROM \"t28\".\"UserId\") AS \"t29\" ON \"t15\".\"USERID\" = \"t29\".\"UserId\") AS \"t30\"\nLEFT JOIN (SELECT \"t55\".\"USERID\" AS \"UserId\", CASE WHEN \"t58\".\"EXPR$0\" IS NOT NULL THEN \"t58\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t39\".\"USERID\"\nFROM (SELECT MIN(\"t35\".\"Id\") AS \"USERID\", \"t35\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t35\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t35\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t34\".\"POSTID\", \"t34\".\"TITLE\", \"t34\".\"SCORE\", \"t34\".\"CREATIONDATE\", \"t34\".\"OWNERUSERID\", \"t34\".\"RAN\", \"t34\".\"COMMENTCOUNT\"\nFROM (SELECT \"t33\".\"Id\" AS \"POSTID\", \"t33\".\"Title\" AS \"TITLE\", \"t33\".\"Score\" AS \"SCORE\", \"t33\".\"CreationDate\" AS \"CREATIONDATE\", \"t33\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t33\".\"OwnerUserId\" ORDER BY \"t33\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t32\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t33\" ON \"t32\".\"PostId\" = \"t33\".\"Id\") AS \"t34\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t34\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t35\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t35\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t35\".\"Id\", \"t35\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t39\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t48\".\"USERID\"\nFROM (SELECT MIN(\"t44\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t43\".\"POSTID\", \"t43\".\"TITLE\", \"t43\".\"SCORE\", \"t43\".\"CREATIONDATE\", \"t43\".\"OWNERUSERID\", \"t43\".\"RAN\", \"t43\".\"COMMENTCOUNT\"\nFROM (SELECT \"t42\".\"Id\" AS \"POSTID\", \"t42\".\"Title\" AS \"TITLE\", \"t42\".\"Score\" AS \"SCORE\", \"t42\".\"CreationDate\" AS \"CREATIONDATE\", \"t42\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t42\".\"OwnerUserId\" ORDER BY \"t42\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t41\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t41\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t41\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t42\" ON \"t41\".\"PostId\" = \"t42\".\"Id\") AS \"t43\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t43\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t44\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t44\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t44\".\"Id\", \"t44\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t48\"\nGROUP BY \"t48\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t39\".\"USERID\" = \"t53\".\"UserId\"\nGROUP BY \"t39\".\"USERID\") AS \"t55\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t58\" ON \"t55\".\"USERID\" IS NOT DISTINCT FROM \"t58\".\"UserId\") AS \"t59\" ON \"t30\".\"USERID\" = \"t59\".\"UserId\") AS \"t60\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t84\".\"USERID\"\nFROM (SELECT \"t69\".\"USERID\", \"t69\".\"DISPLAYNAME\", \"t69\".\"TOTALPOSTS\", \"t69\".\"TOTALSCORE\", \"t69\".\"UPVOTECOUNT\", \"t69\".\"DOWNVOTECOUNT\", \"t69\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t83\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t83\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t65\".\"Id\") AS \"USERID\", \"t65\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t65\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t65\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t64\".\"POSTID\", \"t64\".\"TITLE\", \"t64\".\"SCORE\", \"t64\".\"CREATIONDATE\", \"t64\".\"OWNERUSERID\", \"t64\".\"RAN\", \"t64\".\"COMMENTCOUNT\"\nFROM (SELECT \"t63\".\"Id\" AS \"POSTID\", \"t63\".\"Title\" AS \"TITLE\", \"t63\".\"Score\" AS \"SCORE\", \"t63\".\"CreationDate\" AS \"CREATIONDATE\", \"t63\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t63\".\"OwnerUserId\" ORDER BY \"t63\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t62\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t63\" ON \"t62\".\"PostId\" = \"t63\".\"Id\") AS \"t64\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t64\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t65\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t65\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t65\".\"Id\", \"t65\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t69\"\nLEFT JOIN (SELECT \"t79\".\"USERID\" AS \"UserId\", CASE WHEN \"t82\".\"EXPR$0\" IS NOT NULL THEN \"t82\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT MIN(\"t74\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t73\".\"POSTID\", \"t73\".\"TITLE\", \"t73\".\"SCORE\", \"t73\".\"CREATIONDATE\", \"t73\".\"OWNERUSERID\", \"t73\".\"RAN\", \"t73\".\"COMMENTCOUNT\"\nFROM (SELECT \"t72\".\"Id\" AS \"POSTID\", \"t72\".\"Title\" AS \"TITLE\", \"t72\".\"Score\" AS \"SCORE\", \"t72\".\"CreationDate\" AS \"CREATIONDATE\", \"t72\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t72\".\"OwnerUserId\" ORDER BY \"t72\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t71\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t71\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t71\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t72\" ON \"t71\".\"PostId\" = \"t72\".\"Id\") AS \"t73\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t73\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t74\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t74\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t74\".\"Id\", \"t74\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t78\"\nGROUP BY \"t78\".\"USERID\") AS \"t79\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t82\" ON \"t79\".\"USERID\" IS NOT DISTINCT FROM \"t82\".\"UserId\") AS \"t83\" ON \"t69\".\"USERID\" = \"t83\".\"UserId\") AS \"t84\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t93\".\"USERID\"\nFROM (SELECT MIN(\"t89\".\"Id\") AS \"USERID\", \"t89\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t89\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t89\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t89\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t89\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t88\".\"POSTID\", \"t88\".\"TITLE\", \"t88\".\"SCORE\", \"t88\".\"CREATIONDATE\", \"t88\".\"OWNERUSERID\", \"t88\".\"RAN\", \"t88\".\"COMMENTCOUNT\"\nFROM (SELECT \"t87\".\"Id\" AS \"POSTID\", \"t87\".\"Title\" AS \"TITLE\", \"t87\".\"Score\" AS \"SCORE\", \"t87\".\"CreationDate\" AS \"CREATIONDATE\", \"t87\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t87\".\"OwnerUserId\" ORDER BY \"t87\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t86\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t86\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t86\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t87\" ON \"t86\".\"PostId\" = \"t87\".\"Id\") AS \"t88\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t88\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t89\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t89\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t89\".\"Id\", \"t89\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t93\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM \"s1\"\nWHERE \"TOTALPOSTS\" > 0\nGROUP BY \"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t93\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t93\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t84\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t84\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t60\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t60\".\"TOTALSCORE\" DESC NULLS FIRST, \"t60\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43883",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43883,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 20,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 2.099455021752675E7,
        "cutRowSizeOutBytes" : 2585.501439503228,
        "cutOutputBytes" : 5.428143980913822E10,
        "transferEstimatedMs" : 22437.36664422913,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 12,
          "maxDepth" : 9,
          "operatorKindCounts" : {
            "OTHER" : 7,
            "JOIN" : 3,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 146,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 59,
            "JOIN" : 35,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t3\".\"Id\", \"t3\".\"Id\") AS \"Id\", \"t3\".\"DisplayName\" AS \"DISPLAYNAME\", \"Posts0\".\"Id\" AS \"Id0\", \"Posts0\".\"Score\", \"t3\".\"UpVotes\", \"t3\".\"DownVotes\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"FD_COL_6\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t3\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t3\".\"Id\" = \"Posts0\".\"OwnerUserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "Id0",
          "type" : "INTEGER"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_6",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t59\".\"USERID\", \"t59\".\"DISPLAYNAME\", \"t59\".\"TOTALPOSTS\", \"t59\".\"TOTALSCORE\", \"t59\".\"UPVOTECOUNT\", \"t59\".\"DOWNVOTECOUNT\", \"t59\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t59\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t59\".\"TOTALSCORE\" >= 50 AND \"t59\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t59\".\"EXPR$0\" AS \"GOLDBADGES\", \"t59\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t29\".\"USERID\", \"t29\".\"DISPLAYNAME\", \"t29\".\"TOTALPOSTS\", \"t29\".\"TOTALSCORE\", \"t29\".\"UPVOTECOUNT\", \"t29\".\"DOWNVOTECOUNT\", \"t29\".\"AVGCOMMENTSPERPOST\", \"t29\".\"EXPR$0\", CASE WHEN \"t58\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t58\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t14\".\"USERID\", \"t14\".\"DISPLAYNAME\", \"t14\".\"TOTALPOSTS\", \"t14\".\"TOTALSCORE\", \"t14\".\"UPVOTECOUNT\", \"t14\".\"DOWNVOTECOUNT\", \"t14\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t28\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t28\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t10\".\"Id\") AS \"USERID\", \"t10\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts2\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts2\".\"Score\") AS \"TOTALSCORE\", SUM(\"t10\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t10\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t10\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t10\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t9\".\"POSTID\", \"t9\".\"TITLE\", \"t9\".\"SCORE\", \"t9\".\"CREATIONDATE\", \"t9\".\"OWNERUSERID\", \"t9\".\"RAN\", \"t9\".\"COMMENTCOUNT\"\nFROM (SELECT \"t8\".\"Id\" AS \"POSTID\", \"t8\".\"Title\" AS \"TITLE\", \"t8\".\"Score\" AS \"SCORE\", \"t8\".\"CreationDate\" AS \"CREATIONDATE\", \"t8\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t8\".\"OwnerUserId\" ORDER BY \"t8\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t7\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t8\" ON \"t7\".\"PostId\" = \"t8\".\"Id\") AS \"t9\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t9\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t10\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t10\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t10\".\"Id\", \"t10\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t14\"\nLEFT JOIN (SELECT \"t24\".\"USERID\" AS \"UserId\", CASE WHEN \"t27\".\"EXPR$0\" IS NOT NULL THEN \"t27\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t23\".\"USERID\"\nFROM (SELECT MIN(\"t19\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t18\".\"POSTID\", \"t18\".\"TITLE\", \"t18\".\"SCORE\", \"t18\".\"CREATIONDATE\", \"t18\".\"OWNERUSERID\", \"t18\".\"RAN\", \"t18\".\"COMMENTCOUNT\"\nFROM (SELECT \"t17\".\"Id\" AS \"POSTID\", \"t17\".\"Title\" AS \"TITLE\", \"t17\".\"Score\" AS \"SCORE\", \"t17\".\"CreationDate\" AS \"CREATIONDATE\", \"t17\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t17\".\"OwnerUserId\" ORDER BY \"t17\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t16\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t16\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t16\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t17\" ON \"t16\".\"PostId\" = \"t17\".\"Id\") AS \"t18\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t18\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t19\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t19\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t19\".\"Id\", \"t19\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t23\"\nGROUP BY \"t23\".\"USERID\") AS \"t24\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t27\" ON \"t24\".\"USERID\" IS NOT DISTINCT FROM \"t27\".\"UserId\") AS \"t28\" ON \"t14\".\"USERID\" = \"t28\".\"UserId\") AS \"t29\"\nLEFT JOIN (SELECT \"t54\".\"USERID\" AS \"UserId\", CASE WHEN \"t57\".\"EXPR$0\" IS NOT NULL THEN \"t57\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t38\".\"USERID\"\nFROM (SELECT MIN(\"t34\".\"Id\") AS \"USERID\", \"t34\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts6\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts6\".\"Score\") AS \"TOTALSCORE\", SUM(\"t34\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t34\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t34\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t34\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t33\".\"POSTID\", \"t33\".\"TITLE\", \"t33\".\"SCORE\", \"t33\".\"CREATIONDATE\", \"t33\".\"OWNERUSERID\", \"t33\".\"RAN\", \"t33\".\"COMMENTCOUNT\"\nFROM (SELECT \"t32\".\"Id\" AS \"POSTID\", \"t32\".\"Title\" AS \"TITLE\", \"t32\".\"Score\" AS \"SCORE\", \"t32\".\"CreationDate\" AS \"CREATIONDATE\", \"t32\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t32\".\"OwnerUserId\" ORDER BY \"t32\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t31\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t32\" ON \"t31\".\"PostId\" = \"t32\".\"Id\") AS \"t33\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t33\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t34\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t34\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t34\".\"Id\", \"t34\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t38\"\nLEFT JOIN (SELECT \"t48\".\"USERID\" AS \"UserId\", CASE WHEN \"t51\".\"EXPR$0\" IS NOT NULL THEN \"t51\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t47\".\"USERID\"\nFROM (SELECT MIN(\"t43\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t42\".\"POSTID\", \"t42\".\"TITLE\", \"t42\".\"SCORE\", \"t42\".\"CREATIONDATE\", \"t42\".\"OWNERUSERID\", \"t42\".\"RAN\", \"t42\".\"COMMENTCOUNT\"\nFROM (SELECT \"t41\".\"Id\" AS \"POSTID\", \"t41\".\"Title\" AS \"TITLE\", \"t41\".\"Score\" AS \"SCORE\", \"t41\".\"CreationDate\" AS \"CREATIONDATE\", \"t41\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t41\".\"OwnerUserId\" ORDER BY \"t41\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t40\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t40\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t40\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t41\" ON \"t40\".\"PostId\" = \"t41\".\"Id\") AS \"t42\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t42\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t43\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t43\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t43\".\"Id\", \"t43\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t47\"\nGROUP BY \"t47\".\"USERID\") AS \"t48\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t51\" ON \"t48\".\"USERID\" IS NOT DISTINCT FROM \"t51\".\"UserId\") AS \"t52\" ON \"t38\".\"USERID\" = \"t52\".\"UserId\"\nGROUP BY \"t38\".\"USERID\") AS \"t54\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t57\" ON \"t54\".\"USERID\" IS NOT DISTINCT FROM \"t57\".\"UserId\") AS \"t58\" ON \"t29\".\"USERID\" = \"t58\".\"UserId\") AS \"t59\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t83\".\"USERID\"\nFROM (SELECT \"t68\".\"USERID\", \"t68\".\"DISPLAYNAME\", \"t68\".\"TOTALPOSTS\", \"t68\".\"TOTALSCORE\", \"t68\".\"UPVOTECOUNT\", \"t68\".\"DOWNVOTECOUNT\", \"t68\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t82\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t82\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t64\".\"Id\") AS \"USERID\", \"t64\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts10\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts10\".\"Score\") AS \"TOTALSCORE\", SUM(\"t64\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t64\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t64\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t64\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t63\".\"POSTID\", \"t63\".\"TITLE\", \"t63\".\"SCORE\", \"t63\".\"CREATIONDATE\", \"t63\".\"OWNERUSERID\", \"t63\".\"RAN\", \"t63\".\"COMMENTCOUNT\"\nFROM (SELECT \"t62\".\"Id\" AS \"POSTID\", \"t62\".\"Title\" AS \"TITLE\", \"t62\".\"Score\" AS \"SCORE\", \"t62\".\"CreationDate\" AS \"CREATIONDATE\", \"t62\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t62\".\"OwnerUserId\" ORDER BY \"t62\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t61\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t62\" ON \"t61\".\"PostId\" = \"t62\".\"Id\") AS \"t63\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t63\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t64\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t64\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t64\".\"Id\", \"t64\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t68\"\nLEFT JOIN (SELECT \"t78\".\"USERID\" AS \"UserId\", CASE WHEN \"t81\".\"EXPR$0\" IS NOT NULL THEN \"t81\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t77\".\"USERID\"\nFROM (SELECT MIN(\"t73\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t72\".\"POSTID\", \"t72\".\"TITLE\", \"t72\".\"SCORE\", \"t72\".\"CREATIONDATE\", \"t72\".\"OWNERUSERID\", \"t72\".\"RAN\", \"t72\".\"COMMENTCOUNT\"\nFROM (SELECT \"t71\".\"Id\" AS \"POSTID\", \"t71\".\"Title\" AS \"TITLE\", \"t71\".\"Score\" AS \"SCORE\", \"t71\".\"CreationDate\" AS \"CREATIONDATE\", \"t71\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t71\".\"OwnerUserId\" ORDER BY \"t71\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t70\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t70\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t70\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t71\" ON \"t70\".\"PostId\" = \"t71\".\"Id\") AS \"t72\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t72\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t73\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t73\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t73\".\"Id\", \"t73\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t77\"\nGROUP BY \"t77\".\"USERID\") AS \"t78\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t81\" ON \"t78\".\"USERID\" IS NOT DISTINCT FROM \"t81\".\"UserId\") AS \"t82\" ON \"t68\".\"USERID\" = \"t82\".\"UserId\") AS \"t83\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t92\".\"USERID\"\nFROM (SELECT MIN(\"t88\".\"Id\") AS \"USERID\", \"t88\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts14\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts14\".\"Score\") AS \"TOTALSCORE\", SUM(\"t88\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t88\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t88\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t88\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t87\".\"POSTID\", \"t87\".\"TITLE\", \"t87\".\"SCORE\", \"t87\".\"CREATIONDATE\", \"t87\".\"OWNERUSERID\", \"t87\".\"RAN\", \"t87\".\"COMMENTCOUNT\"\nFROM (SELECT \"t86\".\"Id\" AS \"POSTID\", \"t86\".\"Title\" AS \"TITLE\", \"t86\".\"Score\" AS \"SCORE\", \"t86\".\"CreationDate\" AS \"CREATIONDATE\", \"t86\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t86\".\"OwnerUserId\" ORDER BY \"t86\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t85\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t85\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t85\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t86\" ON \"t85\".\"PostId\" = \"t86\".\"Id\") AS \"t87\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t87\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t88\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t88\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t88\".\"Id\", \"t88\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t92\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"USERID\"\nFROM (SELECT MIN(\"Id\") AS \"USERID\"\nFROM \"s1\"\nGROUP BY \"Id\", \"DISPLAYNAME\"\nHAVING COUNT(DISTINCT \"Id0\") > 0) AS \"t95\"\nGROUP BY \"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t92\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t92\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t83\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t83\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t59\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t59\".\"TOTALSCORE\" DESC NULLS FIRST, \"t59\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43878",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43878,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 22,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 5110824.110281965,
        "cutRowSizeOutBytes" : 1374.8196475779976,
        "cutOutputBytes" : 7.026461402130983E9,
        "transferEstimatedMs" : 3167.5796968515597,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 10,
          "maxDepth" : 7,
          "operatorKindCounts" : {
            "OTHER" : 6,
            "JOIN" : 2,
            "AGGREGATE" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 148,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 60,
            "JOIN" : 36,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Users\".\"Id\", \"Users\".\"Id\") AS \"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t2\".\"POSTID\", \"t2\".\"TITLE\", \"t2\".\"SCORE\", \"t2\".\"CREATIONDATE\" AS \"CREATIONDATE_\", \"t2\".\"OWNERUSERID\", \"t2\".\"RAN\", \"t2\".\"COMMENTCOUNT\"\nFROM (SELECT \"t1\".\"Id\" AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\") AS \"t2\"\nRIGHT JOIN \"Users\" ON \"t2\".\"OWNERUSERID\" = \"Users\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "Reputation",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "DisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastAccessDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "WebsiteUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "Location",
          "type" : "VARCHAR"
        }, {
          "name" : "AboutMe",
          "type" : "VARCHAR"
        }, {
          "name" : "Views",
          "type" : "INTEGER"
        }, {
          "name" : "UpVotes",
          "type" : "INTEGER"
        }, {
          "name" : "DownVotes",
          "type" : "INTEGER"
        }, {
          "name" : "ProfileImageUrl",
          "type" : "VARCHAR"
        }, {
          "name" : "AccountId",
          "type" : "INTEGER"
        }, {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE_",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t58\".\"USERID\", \"t58\".\"DISPLAYNAME\", \"t58\".\"TOTALPOSTS\", \"t58\".\"TOTALSCORE\", \"t58\".\"UPVOTECOUNT\", \"t58\".\"DOWNVOTECOUNT\", \"t58\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t58\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t58\".\"TOTALSCORE\" >= 50 AND \"t58\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t58\".\"EXPR$0\" AS \"GOLDBADGES\", \"t58\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t28\".\"USERID\", \"t28\".\"DISPLAYNAME\", \"t28\".\"TOTALPOSTS\", \"t28\".\"TOTALSCORE\", \"t28\".\"UPVOTECOUNT\", \"t28\".\"DOWNVOTECOUNT\", \"t28\".\"AVGCOMMENTSPERPOST\", \"t28\".\"EXPR$0\", CASE WHEN \"t57\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t57\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t13\".\"USERID\", \"t13\".\"DISPLAYNAME\", \"t13\".\"TOTALPOSTS\", \"t13\".\"TOTALSCORE\", \"t13\".\"UPVOTECOUNT\", \"t13\".\"DOWNVOTECOUNT\", \"t13\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t27\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t27\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t9\".\"Id\") AS \"USERID\", \"t9\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t9\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t9\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t9\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t9\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t8\".\"POSTID\", \"t8\".\"TITLE\", \"t8\".\"SCORE\", \"t8\".\"CREATIONDATE\", \"t8\".\"OWNERUSERID\", \"t8\".\"RAN\", \"t8\".\"COMMENTCOUNT\"\nFROM (SELECT \"t7\".\"Id\" AS \"POSTID\", \"t7\".\"Title\" AS \"TITLE\", \"t7\".\"Score\" AS \"SCORE\", \"t7\".\"CreationDate\" AS \"CREATIONDATE\", \"t7\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t7\".\"OwnerUserId\" ORDER BY \"t7\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t6\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t7\" ON \"t6\".\"PostId\" = \"t7\".\"Id\") AS \"t8\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t8\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t9\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t9\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t9\".\"Id\", \"t9\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t13\"\nLEFT JOIN (SELECT \"t23\".\"USERID\" AS \"UserId\", CASE WHEN \"t26\".\"EXPR$0\" IS NOT NULL THEN \"t26\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t22\".\"USERID\"\nFROM (SELECT MIN(\"t18\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t17\".\"POSTID\", \"t17\".\"TITLE\", \"t17\".\"SCORE\", \"t17\".\"CREATIONDATE\", \"t17\".\"OWNERUSERID\", \"t17\".\"RAN\", \"t17\".\"COMMENTCOUNT\"\nFROM (SELECT \"t16\".\"Id\" AS \"POSTID\", \"t16\".\"Title\" AS \"TITLE\", \"t16\".\"Score\" AS \"SCORE\", \"t16\".\"CreationDate\" AS \"CREATIONDATE\", \"t16\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t16\".\"OwnerUserId\" ORDER BY \"t16\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t15\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t15\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t15\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t16\" ON \"t15\".\"PostId\" = \"t16\".\"Id\") AS \"t17\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t17\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t18\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t18\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t18\".\"Id\", \"t18\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t22\"\nGROUP BY \"t22\".\"USERID\") AS \"t23\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t26\" ON \"t23\".\"USERID\" IS NOT DISTINCT FROM \"t26\".\"UserId\") AS \"t27\" ON \"t13\".\"USERID\" = \"t27\".\"UserId\") AS \"t28\"\nLEFT JOIN (SELECT \"t53\".\"USERID\" AS \"UserId\", CASE WHEN \"t56\".\"EXPR$0\" IS NOT NULL THEN \"t56\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t37\".\"USERID\"\nFROM (SELECT MIN(\"t33\".\"Id\") AS \"USERID\", \"t33\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t33\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t33\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t33\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t33\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t32\".\"POSTID\", \"t32\".\"TITLE\", \"t32\".\"SCORE\", \"t32\".\"CREATIONDATE\", \"t32\".\"OWNERUSERID\", \"t32\".\"RAN\", \"t32\".\"COMMENTCOUNT\"\nFROM (SELECT \"t31\".\"Id\" AS \"POSTID\", \"t31\".\"Title\" AS \"TITLE\", \"t31\".\"Score\" AS \"SCORE\", \"t31\".\"CreationDate\" AS \"CREATIONDATE\", \"t31\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t31\".\"OwnerUserId\" ORDER BY \"t31\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t30\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t31\" ON \"t30\".\"PostId\" = \"t31\".\"Id\") AS \"t32\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t32\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t33\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t33\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t33\".\"Id\", \"t33\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t37\"\nLEFT JOIN (SELECT \"t47\".\"USERID\" AS \"UserId\", CASE WHEN \"t50\".\"EXPR$0\" IS NOT NULL THEN \"t50\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t46\".\"USERID\"\nFROM (SELECT MIN(\"t42\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t41\".\"POSTID\", \"t41\".\"TITLE\", \"t41\".\"SCORE\", \"t41\".\"CREATIONDATE\", \"t41\".\"OWNERUSERID\", \"t41\".\"RAN\", \"t41\".\"COMMENTCOUNT\"\nFROM (SELECT \"t40\".\"Id\" AS \"POSTID\", \"t40\".\"Title\" AS \"TITLE\", \"t40\".\"Score\" AS \"SCORE\", \"t40\".\"CreationDate\" AS \"CREATIONDATE\", \"t40\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t40\".\"OwnerUserId\" ORDER BY \"t40\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t39\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t39\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t39\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t40\" ON \"t39\".\"PostId\" = \"t40\".\"Id\") AS \"t41\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t41\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t42\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t42\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t42\".\"Id\", \"t42\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t46\"\nGROUP BY \"t46\".\"USERID\") AS \"t47\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t50\" ON \"t47\".\"USERID\" IS NOT DISTINCT FROM \"t50\".\"UserId\") AS \"t51\" ON \"t37\".\"USERID\" = \"t51\".\"UserId\"\nGROUP BY \"t37\".\"USERID\") AS \"t53\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t56\" ON \"t53\".\"USERID\" IS NOT DISTINCT FROM \"t56\".\"UserId\") AS \"t57\" ON \"t28\".\"USERID\" = \"t57\".\"UserId\") AS \"t58\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t82\".\"USERID\"\nFROM (SELECT \"t67\".\"USERID\", \"t67\".\"DISPLAYNAME\", \"t67\".\"TOTALPOSTS\", \"t67\".\"TOTALSCORE\", \"t67\".\"UPVOTECOUNT\", \"t67\".\"DOWNVOTECOUNT\", \"t67\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t81\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t81\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t63\".\"Id\") AS \"USERID\", \"t63\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t63\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t63\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t63\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t63\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t62\".\"POSTID\", \"t62\".\"TITLE\", \"t62\".\"SCORE\", \"t62\".\"CREATIONDATE\", \"t62\".\"OWNERUSERID\", \"t62\".\"RAN\", \"t62\".\"COMMENTCOUNT\"\nFROM (SELECT \"t61\".\"Id\" AS \"POSTID\", \"t61\".\"Title\" AS \"TITLE\", \"t61\".\"Score\" AS \"SCORE\", \"t61\".\"CreationDate\" AS \"CREATIONDATE\", \"t61\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t61\".\"OwnerUserId\" ORDER BY \"t61\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t60\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t61\" ON \"t60\".\"PostId\" = \"t61\".\"Id\") AS \"t62\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t62\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t63\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t63\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t63\".\"Id\", \"t63\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t67\"\nLEFT JOIN (SELECT \"t77\".\"USERID\" AS \"UserId\", CASE WHEN \"t80\".\"EXPR$0\" IS NOT NULL THEN \"t80\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t76\".\"USERID\"\nFROM (SELECT MIN(\"t72\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t71\".\"POSTID\", \"t71\".\"TITLE\", \"t71\".\"SCORE\", \"t71\".\"CREATIONDATE\", \"t71\".\"OWNERUSERID\", \"t71\".\"RAN\", \"t71\".\"COMMENTCOUNT\"\nFROM (SELECT \"t70\".\"Id\" AS \"POSTID\", \"t70\".\"Title\" AS \"TITLE\", \"t70\".\"Score\" AS \"SCORE\", \"t70\".\"CreationDate\" AS \"CREATIONDATE\", \"t70\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t70\".\"OwnerUserId\" ORDER BY \"t70\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t69\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t69\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t69\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t70\" ON \"t69\".\"PostId\" = \"t70\".\"Id\") AS \"t71\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t71\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t72\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t72\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t72\".\"Id\", \"t72\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t76\"\nGROUP BY \"t76\".\"USERID\") AS \"t77\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t80\" ON \"t77\".\"USERID\" IS NOT DISTINCT FROM \"t80\".\"UserId\") AS \"t81\" ON \"t67\".\"USERID\" = \"t81\".\"UserId\") AS \"t82\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t91\".\"USERID\"\nFROM (SELECT MIN(\"t87\".\"Id\") AS \"USERID\", \"t87\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts13\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts13\".\"Score\") AS \"TOTALSCORE\", SUM(\"t87\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t87\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t87\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t87\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t86\".\"POSTID\", \"t86\".\"TITLE\", \"t86\".\"SCORE\", \"t86\".\"CREATIONDATE\", \"t86\".\"OWNERUSERID\", \"t86\".\"RAN\", \"t86\".\"COMMENTCOUNT\"\nFROM (SELECT \"t85\".\"Id\" AS \"POSTID\", \"t85\".\"Title\" AS \"TITLE\", \"t85\".\"Score\" AS \"SCORE\", \"t85\".\"CreationDate\" AS \"CREATIONDATE\", \"t85\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t85\".\"OwnerUserId\" ORDER BY \"t85\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t84\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t85\" ON \"t84\".\"PostId\" = \"t85\".\"Id\") AS \"t86\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t86\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t87\"\nLEFT JOIN \"Posts\" AS \"Posts13\" ON \"t87\".\"Id\" = \"Posts13\".\"OwnerUserId\"\nGROUP BY \"t87\".\"Id\", \"t87\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts13\".\"Id\") > 0) AS \"t91\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"s1\".\"Id\") AS \"USERID\"\nFROM \"s1\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"s1\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"s1\".\"Id\", \"s1\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t91\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t91\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t82\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t82\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t58\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t58\".\"TOTALSCORE\" DESC NULLS FIRST, \"t58\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43873",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43873,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 24,
        "cutNodeOperatorKind" : "JOIN",
        "cutOutputRows" : 3850115.110281965,
        "cutRowSizeOutBytes" : 1226.6817919252305,
        "cutOutputBytes" : 4.722866102599088E9,
        "transferEstimatedMs" : 2187.761672442505,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 7,
          "maxDepth" : 5,
          "operatorKindCounts" : {
            "OTHER" : 4,
            "AGGREGATE" : 1,
            "FILTER" : 1,
            "JOIN" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 151,
          "maxDepth" : 26,
          "operatorKindCounts" : {
            "OTHER" : 62,
            "JOIN" : 37,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"t1\".\"Id\", \"t1\".\"Id\") AS \"POSTID\", \"t1\".\"Title\" AS \"TITLE\", \"t1\".\"Score\" AS \"SCORE\", \"t1\".\"CreationDate\" AS \"CREATIONDATE\", \"t1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t1\".\"OwnerUserId\" ORDER BY \"t1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t0\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t0\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t0\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t1\" ON \"t0\".\"PostId\" = \"t1\".\"Id\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "POSTID",
          "type" : "INTEGER"
        }, {
          "name" : "TITLE",
          "type" : "VARCHAR"
        }, {
          "name" : "SCORE",
          "type" : "INTEGER"
        }, {
          "name" : "CREATIONDATE",
          "type" : "TIMESTAMP"
        }, {
          "name" : "OWNERUSERID",
          "type" : "INTEGER"
        }, {
          "name" : "RAN",
          "type" : "BIGINT"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t57\".\"USERID\", \"t57\".\"DISPLAYNAME\", \"t57\".\"TOTALPOSTS\", \"t57\".\"TOTALSCORE\", \"t57\".\"UPVOTECOUNT\", \"t57\".\"DOWNVOTECOUNT\", \"t57\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t57\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t57\".\"TOTALSCORE\" >= 50 AND \"t57\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t57\".\"EXPR$0\" AS \"GOLDBADGES\", \"t57\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t27\".\"USERID\", \"t27\".\"DISPLAYNAME\", \"t27\".\"TOTALPOSTS\", \"t27\".\"TOTALSCORE\", \"t27\".\"UPVOTECOUNT\", \"t27\".\"DOWNVOTECOUNT\", \"t27\".\"AVGCOMMENTSPERPOST\", \"t27\".\"EXPR$0\", CASE WHEN \"t56\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t56\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t12\".\"USERID\", \"t12\".\"DISPLAYNAME\", \"t12\".\"TOTALPOSTS\", \"t12\".\"TOTALSCORE\", \"t12\".\"UPVOTECOUNT\", \"t12\".\"DOWNVOTECOUNT\", \"t12\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t26\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t26\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t8\".\"Id\") AS \"USERID\", \"t8\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t8\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t8\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t8\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t8\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t7\".\"POSTID\", \"t7\".\"TITLE\", \"t7\".\"SCORE\", \"t7\".\"CREATIONDATE\", \"t7\".\"OWNERUSERID\", \"t7\".\"RAN\", \"t7\".\"COMMENTCOUNT\"\nFROM (SELECT \"t6\".\"Id\" AS \"POSTID\", \"t6\".\"Title\" AS \"TITLE\", \"t6\".\"Score\" AS \"SCORE\", \"t6\".\"CreationDate\" AS \"CREATIONDATE\", \"t6\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t6\".\"OwnerUserId\" ORDER BY \"t6\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t5\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t6\" ON \"t5\".\"PostId\" = \"t6\".\"Id\") AS \"t7\"\nRIGHT JOIN \"Users\" ON \"t7\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t8\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t8\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t8\".\"Id\", \"t8\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t12\"\nLEFT JOIN (SELECT \"t22\".\"USERID\" AS \"UserId\", CASE WHEN \"t25\".\"EXPR$0\" IS NOT NULL THEN \"t25\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t21\".\"USERID\"\nFROM (SELECT MIN(\"t17\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t16\".\"POSTID\", \"t16\".\"TITLE\", \"t16\".\"SCORE\", \"t16\".\"CREATIONDATE\", \"t16\".\"OWNERUSERID\", \"t16\".\"RAN\", \"t16\".\"COMMENTCOUNT\"\nFROM (SELECT \"t15\".\"Id\" AS \"POSTID\", \"t15\".\"Title\" AS \"TITLE\", \"t15\".\"Score\" AS \"SCORE\", \"t15\".\"CreationDate\" AS \"CREATIONDATE\", \"t15\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t15\".\"OwnerUserId\" ORDER BY \"t15\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t14\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t14\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t14\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t15\" ON \"t14\".\"PostId\" = \"t15\".\"Id\") AS \"t16\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t16\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t17\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t17\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t17\".\"Id\", \"t17\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t21\"\nGROUP BY \"t21\".\"USERID\") AS \"t22\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t25\" ON \"t22\".\"USERID\" IS NOT DISTINCT FROM \"t25\".\"UserId\") AS \"t26\" ON \"t12\".\"USERID\" = \"t26\".\"UserId\") AS \"t27\"\nLEFT JOIN (SELECT \"t52\".\"USERID\" AS \"UserId\", CASE WHEN \"t55\".\"EXPR$0\" IS NOT NULL THEN \"t55\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t36\".\"USERID\"\nFROM (SELECT MIN(\"t32\".\"Id\") AS \"USERID\", \"t32\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t32\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t32\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t32\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t32\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t31\".\"POSTID\", \"t31\".\"TITLE\", \"t31\".\"SCORE\", \"t31\".\"CREATIONDATE\", \"t31\".\"OWNERUSERID\", \"t31\".\"RAN\", \"t31\".\"COMMENTCOUNT\"\nFROM (SELECT \"t30\".\"Id\" AS \"POSTID\", \"t30\".\"Title\" AS \"TITLE\", \"t30\".\"Score\" AS \"SCORE\", \"t30\".\"CreationDate\" AS \"CREATIONDATE\", \"t30\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t30\".\"OwnerUserId\" ORDER BY \"t30\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t29\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t30\" ON \"t29\".\"PostId\" = \"t30\".\"Id\") AS \"t31\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t31\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t32\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t32\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t32\".\"Id\", \"t32\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t36\"\nLEFT JOIN (SELECT \"t46\".\"USERID\" AS \"UserId\", CASE WHEN \"t49\".\"EXPR$0\" IS NOT NULL THEN \"t49\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t45\".\"USERID\"\nFROM (SELECT MIN(\"t41\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t40\".\"POSTID\", \"t40\".\"TITLE\", \"t40\".\"SCORE\", \"t40\".\"CREATIONDATE\", \"t40\".\"OWNERUSERID\", \"t40\".\"RAN\", \"t40\".\"COMMENTCOUNT\"\nFROM (SELECT \"t39\".\"Id\" AS \"POSTID\", \"t39\".\"Title\" AS \"TITLE\", \"t39\".\"Score\" AS \"SCORE\", \"t39\".\"CreationDate\" AS \"CREATIONDATE\", \"t39\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t39\".\"OwnerUserId\" ORDER BY \"t39\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t38\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t38\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t38\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t39\" ON \"t38\".\"PostId\" = \"t39\".\"Id\") AS \"t40\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t40\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t41\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t41\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t41\".\"Id\", \"t41\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t45\"\nGROUP BY \"t45\".\"USERID\") AS \"t46\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t49\" ON \"t46\".\"USERID\" IS NOT DISTINCT FROM \"t49\".\"UserId\") AS \"t50\" ON \"t36\".\"USERID\" = \"t50\".\"UserId\"\nGROUP BY \"t36\".\"USERID\") AS \"t52\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t55\" ON \"t52\".\"USERID\" IS NOT DISTINCT FROM \"t55\".\"UserId\") AS \"t56\" ON \"t27\".\"USERID\" = \"t56\".\"UserId\") AS \"t57\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t81\".\"USERID\"\nFROM (SELECT \"t66\".\"USERID\", \"t66\".\"DISPLAYNAME\", \"t66\".\"TOTALPOSTS\", \"t66\".\"TOTALSCORE\", \"t66\".\"UPVOTECOUNT\", \"t66\".\"DOWNVOTECOUNT\", \"t66\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t80\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t80\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t62\".\"Id\") AS \"USERID\", \"t62\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t62\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t62\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t62\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t62\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t61\".\"POSTID\", \"t61\".\"TITLE\", \"t61\".\"SCORE\", \"t61\".\"CREATIONDATE\", \"t61\".\"OWNERUSERID\", \"t61\".\"RAN\", \"t61\".\"COMMENTCOUNT\"\nFROM (SELECT \"t60\".\"Id\" AS \"POSTID\", \"t60\".\"Title\" AS \"TITLE\", \"t60\".\"Score\" AS \"SCORE\", \"t60\".\"CreationDate\" AS \"CREATIONDATE\", \"t60\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t60\".\"OwnerUserId\" ORDER BY \"t60\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t59\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t60\" ON \"t59\".\"PostId\" = \"t60\".\"Id\") AS \"t61\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t61\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t62\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t62\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t62\".\"Id\", \"t62\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t66\"\nLEFT JOIN (SELECT \"t76\".\"USERID\" AS \"UserId\", CASE WHEN \"t79\".\"EXPR$0\" IS NOT NULL THEN \"t79\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t75\".\"USERID\"\nFROM (SELECT MIN(\"t71\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t70\".\"POSTID\", \"t70\".\"TITLE\", \"t70\".\"SCORE\", \"t70\".\"CREATIONDATE\", \"t70\".\"OWNERUSERID\", \"t70\".\"RAN\", \"t70\".\"COMMENTCOUNT\"\nFROM (SELECT \"t69\".\"Id\" AS \"POSTID\", \"t69\".\"Title\" AS \"TITLE\", \"t69\".\"Score\" AS \"SCORE\", \"t69\".\"CreationDate\" AS \"CREATIONDATE\", \"t69\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t69\".\"OwnerUserId\" ORDER BY \"t69\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t68\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t68\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t68\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t69\" ON \"t68\".\"PostId\" = \"t69\".\"Id\") AS \"t70\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t70\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t71\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t71\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t71\".\"Id\", \"t71\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t75\"\nGROUP BY \"t75\".\"USERID\") AS \"t76\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t79\" ON \"t76\".\"USERID\" IS NOT DISTINCT FROM \"t79\".\"UserId\") AS \"t80\" ON \"t66\".\"USERID\" = \"t80\".\"UserId\") AS \"t81\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t90\".\"USERID\"\nFROM (SELECT MIN(\"t86\".\"Id\") AS \"USERID\", \"t86\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts13\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts13\".\"Score\") AS \"TOTALSCORE\", SUM(\"t86\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t86\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t86\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t86\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t85\".\"POSTID\", \"t85\".\"TITLE\", \"t85\".\"SCORE\", \"t85\".\"CREATIONDATE\", \"t85\".\"OWNERUSERID\", \"t85\".\"RAN\", \"t85\".\"COMMENTCOUNT\"\nFROM (SELECT \"t84\".\"Id\" AS \"POSTID\", \"t84\".\"Title\" AS \"TITLE\", \"t84\".\"Score\" AS \"SCORE\", \"t84\".\"CreationDate\" AS \"CREATIONDATE\", \"t84\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t84\".\"OwnerUserId\" ORDER BY \"t84\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t83\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t83\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t83\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t84\" ON \"t83\".\"PostId\" = \"t84\".\"Id\") AS \"t85\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t85\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t86\"\nLEFT JOIN \"Posts\" AS \"Posts13\" ON \"t86\".\"Id\" = \"Posts13\".\"OwnerUserId\"\nGROUP BY \"t86\".\"Id\", \"t86\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts13\".\"Id\") > 0) AS \"t90\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"s1\".\"POSTID\", \"s1\".\"TITLE\", \"s1\".\"SCORE\", \"s1\".\"CREATIONDATE\", \"s1\".\"OWNERUSERID\", \"s1\".\"RAN\", \"s1\".\"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"s1\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t90\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t90\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t81\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t81\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t57\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t57\".\"TOTALSCORE\" DESC NULLS FIRST, \"t57\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43866",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43866,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 26,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 2163672.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 3.4618752E7,
        "transferEstimatedMs" : 265.60397975547744,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 28,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 23,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"PostId\", \"PostId\") AS \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "PostId",
          "type" : "INTEGER"
        }, {
          "name" : "COMMENTCOUNT",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t78\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t77\".\"EXPR$0\" IS NOT NULL THEN \"t77\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t77\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t77\".\"UserId\") AS \"t78\" ON \"t64\".\"USERID\" = \"t78\".\"UserId\") AS \"t79\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t88\".\"USERID\"\nFROM (SELECT MIN(\"t84\".\"Id\") AS \"USERID\", \"t84\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t84\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t84\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t83\".\"POSTID\", \"t83\".\"TITLE\", \"t83\".\"SCORE\", \"t83\".\"CREATIONDATE\", \"t83\".\"OWNERUSERID\", \"t83\".\"RAN\", \"t83\".\"COMMENTCOUNT\"\nFROM (SELECT \"t82\".\"Id\" AS \"POSTID\", \"t82\".\"Title\" AS \"TITLE\", \"t82\".\"Score\" AS \"SCORE\", \"t82\".\"CreationDate\" AS \"CREATIONDATE\", \"t82\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t82\".\"OwnerUserId\" ORDER BY \"t82\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t81\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t82\" ON \"t81\".\"PostId\" = \"t82\".\"Id\") AS \"t83\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t83\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t84\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t84\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t84\".\"Id\", \"t84\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t88\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"t89\".\"Id\" AS \"POSTID\", \"t89\".\"Title\" AS \"TITLE\", \"t89\".\"Score\" AS \"SCORE\", \"t89\".\"CreationDate\" AS \"CREATIONDATE\", \"t89\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t89\".\"OwnerUserId\" ORDER BY \"t89\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"s1\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"s1\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM \"s1\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t89\" ON \"s1\".\"PostId\" = \"t89\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t88\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t88\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t79\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t79\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43869",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43869,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 26,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 1925058.0,
        "cutRowSizeOutBytes" : 1210.6817919252305,
        "cutOutputBytes" : 2.3306326690000005E9,
        "transferEstimatedMs" : 1119.3021535881928,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 2,
          "maxDepth" : 2,
          "operatorKindCounts" : {
            "OTHER" : 1,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 156,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 65,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"Id\", \"Id\") AS \"Id\", \"PostTypeId\", \"AcceptedAnswerId\", \"ParentId\", \"CreationDate\", \"Score\", \"ViewCount\", \"Body\", \"OwnerUserId\", \"OwnerDisplayName\", \"LastEditorUserId\", \"LastEditorDisplayName\", \"LastEditDate\", \"LastActivityDate\", \"Title\", \"Tags\", \"AnswerCount\", \"CommentCount\", \"FavoriteCount\", \"ClosedDate\", \"CommunityOwnedDate\", \"ContentLicense\"\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)",
        "inputs" : { },
        "schema" : [ {
          "name" : "Id",
          "type" : "INTEGER"
        }, {
          "name" : "PostTypeId",
          "type" : "SMALLINT"
        }, {
          "name" : "AcceptedAnswerId",
          "type" : "INTEGER"
        }, {
          "name" : "ParentId",
          "type" : "INTEGER"
        }, {
          "name" : "CreationDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Score",
          "type" : "INTEGER"
        }, {
          "name" : "ViewCount",
          "type" : "INTEGER"
        }, {
          "name" : "Body",
          "type" : "VARCHAR"
        }, {
          "name" : "OwnerUserId",
          "type" : "INTEGER"
        }, {
          "name" : "OwnerDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditorUserId",
          "type" : "INTEGER"
        }, {
          "name" : "LastEditorDisplayName",
          "type" : "VARCHAR"
        }, {
          "name" : "LastEditDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "LastActivityDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "Title",
          "type" : "VARCHAR"
        }, {
          "name" : "Tags",
          "type" : "VARCHAR"
        }, {
          "name" : "AnswerCount",
          "type" : "INTEGER"
        }, {
          "name" : "CommentCount",
          "type" : "INTEGER"
        }, {
          "name" : "FavoriteCount",
          "type" : "INTEGER"
        }, {
          "name" : "ClosedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "CommunityOwnedDate",
          "type" : "TIMESTAMP"
        }, {
          "name" : "ContentLicense",
          "type" : "VARCHAR"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t54\".\"USERID\", \"t54\".\"DISPLAYNAME\", \"t54\".\"TOTALPOSTS\", \"t54\".\"TOTALSCORE\", \"t54\".\"UPVOTECOUNT\", \"t54\".\"DOWNVOTECOUNT\", \"t54\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t54\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t54\".\"TOTALSCORE\" >= 50 AND \"t54\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t54\".\"EXPR$0\" AS \"GOLDBADGES\", \"t54\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t24\".\"USERID\", \"t24\".\"DISPLAYNAME\", \"t24\".\"TOTALPOSTS\", \"t24\".\"TOTALSCORE\", \"t24\".\"UPVOTECOUNT\", \"t24\".\"DOWNVOTECOUNT\", \"t24\".\"AVGCOMMENTSPERPOST\", \"t24\".\"EXPR$0\", CASE WHEN \"t53\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t53\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t9\".\"USERID\", \"t9\".\"DISPLAYNAME\", \"t9\".\"TOTALPOSTS\", \"t9\".\"TOTALSCORE\", \"t9\".\"UPVOTECOUNT\", \"t9\".\"DOWNVOTECOUNT\", \"t9\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t23\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t23\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t5\".\"Id\") AS \"USERID\", \"t5\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts1\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts1\".\"Score\") AS \"TOTALSCORE\", SUM(\"t5\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t5\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t5\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t5\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t4\".\"POSTID\", \"t4\".\"TITLE\", \"t4\".\"SCORE\", \"t4\".\"CREATIONDATE\", \"t4\".\"OWNERUSERID\", \"t4\".\"RAN\", \"t4\".\"COMMENTCOUNT\"\nFROM (SELECT \"t3\".\"Id\" AS \"POSTID\", \"t3\".\"Title\" AS \"TITLE\", \"t3\".\"Score\" AS \"SCORE\", \"t3\".\"CreationDate\" AS \"CREATIONDATE\", \"t3\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t3\".\"OwnerUserId\" ORDER BY \"t3\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t2\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t2\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t2\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t3\" ON \"t2\".\"PostId\" = \"t3\".\"Id\") AS \"t4\"\nRIGHT JOIN \"Users\" ON \"t4\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t5\"\nLEFT JOIN \"Posts\" AS \"Posts1\" ON \"t5\".\"Id\" = \"Posts1\".\"OwnerUserId\"\nGROUP BY \"t5\".\"Id\", \"t5\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts1\".\"Id\") > 0) AS \"t9\"\nLEFT JOIN (SELECT \"t19\".\"USERID\" AS \"UserId\", CASE WHEN \"t22\".\"EXPR$0\" IS NOT NULL THEN \"t22\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t18\".\"USERID\"\nFROM (SELECT MIN(\"t14\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t13\".\"POSTID\", \"t13\".\"TITLE\", \"t13\".\"SCORE\", \"t13\".\"CREATIONDATE\", \"t13\".\"OWNERUSERID\", \"t13\".\"RAN\", \"t13\".\"COMMENTCOUNT\"\nFROM (SELECT \"t12\".\"Id\" AS \"POSTID\", \"t12\".\"Title\" AS \"TITLE\", \"t12\".\"Score\" AS \"SCORE\", \"t12\".\"CreationDate\" AS \"CREATIONDATE\", \"t12\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t12\".\"OwnerUserId\" ORDER BY \"t12\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t11\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t11\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t11\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t12\" ON \"t11\".\"PostId\" = \"t12\".\"Id\") AS \"t13\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t13\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t14\"\nLEFT JOIN \"Posts\" AS \"Posts3\" ON \"t14\".\"Id\" = \"Posts3\".\"OwnerUserId\"\nGROUP BY \"t14\".\"Id\", \"t14\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts3\".\"Id\") > 0) AS \"t18\"\nGROUP BY \"t18\".\"USERID\") AS \"t19\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t22\" ON \"t19\".\"USERID\" IS NOT DISTINCT FROM \"t22\".\"UserId\") AS \"t23\" ON \"t9\".\"USERID\" = \"t23\".\"UserId\") AS \"t24\"\nLEFT JOIN (SELECT \"t49\".\"USERID\" AS \"UserId\", CASE WHEN \"t52\".\"EXPR$0\" IS NOT NULL THEN \"t52\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t33\".\"USERID\"\nFROM (SELECT MIN(\"t29\".\"Id\") AS \"USERID\", \"t29\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts5\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts5\".\"Score\") AS \"TOTALSCORE\", SUM(\"t29\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t29\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t29\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t29\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t28\".\"POSTID\", \"t28\".\"TITLE\", \"t28\".\"SCORE\", \"t28\".\"CREATIONDATE\", \"t28\".\"OWNERUSERID\", \"t28\".\"RAN\", \"t28\".\"COMMENTCOUNT\"\nFROM (SELECT \"t27\".\"Id\" AS \"POSTID\", \"t27\".\"Title\" AS \"TITLE\", \"t27\".\"Score\" AS \"SCORE\", \"t27\".\"CreationDate\" AS \"CREATIONDATE\", \"t27\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t27\".\"OwnerUserId\" ORDER BY \"t27\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t26\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t26\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t26\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t27\" ON \"t26\".\"PostId\" = \"t27\".\"Id\") AS \"t28\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t28\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t29\"\nLEFT JOIN \"Posts\" AS \"Posts5\" ON \"t29\".\"Id\" = \"Posts5\".\"OwnerUserId\"\nGROUP BY \"t29\".\"Id\", \"t29\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts5\".\"Id\") > 0) AS \"t33\"\nLEFT JOIN (SELECT \"t43\".\"USERID\" AS \"UserId\", CASE WHEN \"t46\".\"EXPR$0\" IS NOT NULL THEN \"t46\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t42\".\"USERID\"\nFROM (SELECT MIN(\"t38\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t37\".\"POSTID\", \"t37\".\"TITLE\", \"t37\".\"SCORE\", \"t37\".\"CREATIONDATE\", \"t37\".\"OWNERUSERID\", \"t37\".\"RAN\", \"t37\".\"COMMENTCOUNT\"\nFROM (SELECT \"t36\".\"Id\" AS \"POSTID\", \"t36\".\"Title\" AS \"TITLE\", \"t36\".\"Score\" AS \"SCORE\", \"t36\".\"CreationDate\" AS \"CREATIONDATE\", \"t36\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t36\".\"OwnerUserId\" ORDER BY \"t36\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t35\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t35\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t35\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t36\" ON \"t35\".\"PostId\" = \"t36\".\"Id\") AS \"t37\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t37\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t38\"\nLEFT JOIN \"Posts\" AS \"Posts7\" ON \"t38\".\"Id\" = \"Posts7\".\"OwnerUserId\"\nGROUP BY \"t38\".\"Id\", \"t38\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts7\".\"Id\") > 0) AS \"t42\"\nGROUP BY \"t42\".\"USERID\") AS \"t43\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t46\" ON \"t43\".\"USERID\" IS NOT DISTINCT FROM \"t46\".\"UserId\") AS \"t47\" ON \"t33\".\"USERID\" = \"t47\".\"UserId\"\nGROUP BY \"t33\".\"USERID\") AS \"t49\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t52\" ON \"t49\".\"USERID\" IS NOT DISTINCT FROM \"t52\".\"UserId\") AS \"t53\" ON \"t24\".\"USERID\" = \"t53\".\"UserId\") AS \"t54\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t78\".\"USERID\"\nFROM (SELECT \"t63\".\"USERID\", \"t63\".\"DISPLAYNAME\", \"t63\".\"TOTALPOSTS\", \"t63\".\"TOTALSCORE\", \"t63\".\"UPVOTECOUNT\", \"t63\".\"DOWNVOTECOUNT\", \"t63\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t77\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t77\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t59\".\"Id\") AS \"USERID\", \"t59\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts9\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts9\".\"Score\") AS \"TOTALSCORE\", SUM(\"t59\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t59\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t59\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t59\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t58\".\"POSTID\", \"t58\".\"TITLE\", \"t58\".\"SCORE\", \"t58\".\"CREATIONDATE\", \"t58\".\"OWNERUSERID\", \"t58\".\"RAN\", \"t58\".\"COMMENTCOUNT\"\nFROM (SELECT \"t57\".\"Id\" AS \"POSTID\", \"t57\".\"Title\" AS \"TITLE\", \"t57\".\"Score\" AS \"SCORE\", \"t57\".\"CreationDate\" AS \"CREATIONDATE\", \"t57\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t57\".\"OwnerUserId\" ORDER BY \"t57\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t56\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t56\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t56\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t57\" ON \"t56\".\"PostId\" = \"t57\".\"Id\") AS \"t58\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t58\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t59\"\nLEFT JOIN \"Posts\" AS \"Posts9\" ON \"t59\".\"Id\" = \"Posts9\".\"OwnerUserId\"\nGROUP BY \"t59\".\"Id\", \"t59\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts9\".\"Id\") > 0) AS \"t63\"\nLEFT JOIN (SELECT \"t73\".\"USERID\" AS \"UserId\", CASE WHEN \"t76\".\"EXPR$0\" IS NOT NULL THEN \"t76\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t72\".\"USERID\"\nFROM (SELECT MIN(\"t68\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t67\".\"POSTID\", \"t67\".\"TITLE\", \"t67\".\"SCORE\", \"t67\".\"CREATIONDATE\", \"t67\".\"OWNERUSERID\", \"t67\".\"RAN\", \"t67\".\"COMMENTCOUNT\"\nFROM (SELECT \"t66\".\"Id\" AS \"POSTID\", \"t66\".\"Title\" AS \"TITLE\", \"t66\".\"Score\" AS \"SCORE\", \"t66\".\"CreationDate\" AS \"CREATIONDATE\", \"t66\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t66\".\"OwnerUserId\" ORDER BY \"t66\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t65\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t65\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t65\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t66\" ON \"t65\".\"PostId\" = \"t66\".\"Id\") AS \"t67\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t67\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t68\"\nLEFT JOIN \"Posts\" AS \"Posts11\" ON \"t68\".\"Id\" = \"Posts11\".\"OwnerUserId\"\nGROUP BY \"t68\".\"Id\", \"t68\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts11\".\"Id\") > 0) AS \"t72\"\nGROUP BY \"t72\".\"USERID\") AS \"t73\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t76\" ON \"t73\".\"USERID\" IS NOT DISTINCT FROM \"t76\".\"UserId\") AS \"t77\" ON \"t63\".\"USERID\" = \"t77\".\"UserId\") AS \"t78\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t87\".\"USERID\"\nFROM (SELECT MIN(\"t83\".\"Id\") AS \"USERID\", \"t83\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts13\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts13\".\"Score\") AS \"TOTALSCORE\", SUM(\"t83\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t83\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t83\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t83\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t82\".\"POSTID\", \"t82\".\"TITLE\", \"t82\".\"SCORE\", \"t82\".\"CREATIONDATE\", \"t82\".\"OWNERUSERID\", \"t82\".\"RAN\", \"t82\".\"COMMENTCOUNT\"\nFROM (SELECT \"t81\".\"Id\" AS \"POSTID\", \"t81\".\"Title\" AS \"TITLE\", \"t81\".\"Score\" AS \"SCORE\", \"t81\".\"CreationDate\" AS \"CREATIONDATE\", \"t81\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t81\".\"OwnerUserId\" ORDER BY \"t81\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t80\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t80\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t80\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t81\" ON \"t80\".\"PostId\" = \"t81\".\"Id\") AS \"t82\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t82\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t83\"\nLEFT JOIN \"Posts\" AS \"Posts13\" ON \"t83\".\"Id\" = \"Posts13\".\"OwnerUserId\"\nGROUP BY \"t83\".\"Id\", \"t83\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts13\".\"Id\") > 0) AS \"t87\"\nLEFT JOIN (SELECT \"t96\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t95\".\"USERID\"\nFROM (SELECT MIN(\"t91\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t90\".\"POSTID\", \"t90\".\"TITLE\", \"t90\".\"SCORE\", \"t90\".\"CREATIONDATE\", \"t90\".\"OWNERUSERID\", \"t90\".\"RAN\", \"t90\".\"COMMENTCOUNT\"\nFROM (SELECT \"s1\".\"Id\" AS \"POSTID\", \"s1\".\"Title\" AS \"TITLE\", \"s1\".\"Score\" AS \"SCORE\", \"s1\".\"CreationDate\" AS \"CREATIONDATE\", \"s1\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"s1\".\"OwnerUserId\" ORDER BY \"s1\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t89\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t89\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t89\"\nRIGHT JOIN \"s1\" ON \"t89\".\"PostId\" = \"s1\".\"Id\") AS \"t90\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t90\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t91\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t91\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t91\".\"Id\", \"t91\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t95\"\nGROUP BY \"t95\".\"USERID\") AS \"t96\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t99\" ON \"t96\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t87\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t87\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t78\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t78\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t54\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t54\".\"TOTALSCORE\" DESC NULLS FIRST, \"t54\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43898",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43898,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 16,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t56\".\"USERID\", \"t56\".\"DISPLAYNAME\", \"t56\".\"TOTALPOSTS\", \"t56\".\"TOTALSCORE\", \"t56\".\"UPVOTECOUNT\", \"t56\".\"DOWNVOTECOUNT\", \"t56\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t56\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t56\".\"TOTALSCORE\" >= 50 AND \"t56\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t56\".\"EXPR$0\" AS \"GOLDBADGES\", \"t56\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t55\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t55\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"t48\".\"EXPR$0\" IS NOT NULL THEN \"t48\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t48\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"t48\".\"UserId\") AS \"t49\" ON \"t35\".\"USERID\" = \"t49\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t26\".\"USERID\" = \"t55\".\"UserId\") AS \"t56\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"USERID\"\nFROM (SELECT \"t65\".\"USERID\", \"t65\".\"DISPLAYNAME\", \"t65\".\"TOTALPOSTS\", \"t65\".\"TOTALSCORE\", \"t65\".\"UPVOTECOUNT\", \"t65\".\"DOWNVOTECOUNT\", \"t65\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t79\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t79\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\", \"t61\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t61\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t61\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t60\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t61\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"USERID\" AS \"UserId\", CASE WHEN \"t78\".\"EXPR$0\" IS NOT NULL THEN \"t78\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t74\".\"USERID\"\nFROM (SELECT MIN(\"t70\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t69\".\"POSTID\", \"t69\".\"TITLE\", \"t69\".\"SCORE\", \"t69\".\"CREATIONDATE\", \"t69\".\"OWNERUSERID\", \"t69\".\"RAN\", \"t69\".\"COMMENTCOUNT\"\nFROM (SELECT \"t68\".\"Id\" AS \"POSTID\", \"t68\".\"Title\" AS \"TITLE\", \"t68\".\"Score\" AS \"SCORE\", \"t68\".\"CreationDate\" AS \"CREATIONDATE\", \"t68\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t68\".\"OwnerUserId\" ORDER BY \"t68\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t67\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t68\" ON \"t67\".\"PostId\" = \"t68\".\"Id\") AS \"t69\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t69\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t70\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t70\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t70\".\"Id\", \"t70\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t74\"\nGROUP BY \"t74\".\"USERID\") AS \"t75\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t78\" ON \"t75\".\"USERID\" IS NOT DISTINCT FROM \"t78\".\"UserId\") AS \"t79\" ON \"t65\".\"USERID\" = \"t79\".\"UserId\") AS \"t80\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t89\".\"USERID\"\nFROM (SELECT MIN(\"t85\".\"Id\") AS \"USERID\", \"t85\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t85\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t85\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t85\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t85\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t84\".\"POSTID\", \"t84\".\"TITLE\", \"t84\".\"SCORE\", \"t84\".\"CREATIONDATE\", \"t84\".\"OWNERUSERID\", \"t84\".\"RAN\", \"t84\".\"COMMENTCOUNT\"\nFROM (SELECT \"t83\".\"Id\" AS \"POSTID\", \"t83\".\"Title\" AS \"TITLE\", \"t83\".\"Score\" AS \"SCORE\", \"t83\".\"CreationDate\" AS \"CREATIONDATE\", \"t83\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t83\".\"OwnerUserId\" ORDER BY \"t83\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t82\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t83\" ON \"t82\".\"PostId\" = \"t83\".\"Id\") AS \"t84\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t84\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t85\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t85\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t85\".\"Id\", \"t85\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t89\"\nLEFT JOIN (SELECT \"t99\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t98\".\"USERID\"\nFROM (SELECT MIN(\"t94\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t93\".\"POSTID\", \"t93\".\"TITLE\", \"t93\".\"SCORE\", \"t93\".\"CREATIONDATE\", \"t93\".\"OWNERUSERID\", \"t93\".\"RAN\", \"t93\".\"COMMENTCOUNT\"\nFROM (SELECT \"t92\".\"Id\" AS \"POSTID\", \"t92\".\"Title\" AS \"TITLE\", \"t92\".\"Score\" AS \"SCORE\", \"t92\".\"CreationDate\" AS \"CREATIONDATE\", \"t92\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t92\".\"OwnerUserId\" ORDER BY \"t92\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t91\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t91\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t91\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t92\" ON \"t91\".\"PostId\" = \"t92\".\"Id\") AS \"t93\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t93\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t94\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t94\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t94\".\"Id\", \"t94\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t98\"\nGROUP BY \"t98\".\"USERID\") AS \"t99\"\nLEFT JOIN \"s1\" ON \"t99\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t100\" ON \"t89\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t89\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t80\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t80\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t56\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t56\".\"TOTALSCORE\" DESC NULLS FIRST, \"t56\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43896",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43896,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 17,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t78\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t77\".\"EXPR$0\" IS NOT NULL THEN \"t77\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t77\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t77\".\"UserId\") AS \"t78\" ON \"t64\".\"USERID\" = \"t78\".\"UserId\") AS \"t79\"\nLEFT JOIN (SELECT \"t102\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t88\".\"USERID\"\nFROM (SELECT MIN(\"t84\".\"Id\") AS \"USERID\", \"t84\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t84\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t84\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t83\".\"POSTID\", \"t83\".\"TITLE\", \"t83\".\"SCORE\", \"t83\".\"CREATIONDATE\", \"t83\".\"OWNERUSERID\", \"t83\".\"RAN\", \"t83\".\"COMMENTCOUNT\"\nFROM (SELECT \"t82\".\"Id\" AS \"POSTID\", \"t82\".\"Title\" AS \"TITLE\", \"t82\".\"Score\" AS \"SCORE\", \"t82\".\"CreationDate\" AS \"CREATIONDATE\", \"t82\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t82\".\"OwnerUserId\" ORDER BY \"t82\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t81\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t82\" ON \"t81\".\"PostId\" = \"t82\".\"Id\") AS \"t83\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t83\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t84\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t84\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t84\".\"Id\", \"t84\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t88\"\nLEFT JOIN (SELECT \"t98\".\"USERID\" AS \"UserId\", CASE WHEN \"t99\".\"EXPR$0\" IS NOT NULL THEN \"t99\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t97\".\"USERID\"\nFROM (SELECT MIN(\"t93\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t92\".\"POSTID\", \"t92\".\"TITLE\", \"t92\".\"SCORE\", \"t92\".\"CREATIONDATE\", \"t92\".\"OWNERUSERID\", \"t92\".\"RAN\", \"t92\".\"COMMENTCOUNT\"\nFROM (SELECT \"t91\".\"Id\" AS \"POSTID\", \"t91\".\"Title\" AS \"TITLE\", \"t91\".\"Score\" AS \"SCORE\", \"t91\".\"CreationDate\" AS \"CREATIONDATE\", \"t91\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t91\".\"OwnerUserId\" ORDER BY \"t91\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t90\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t90\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t90\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t91\" ON \"t90\".\"PostId\" = \"t91\".\"Id\") AS \"t92\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t92\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t93\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t93\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t93\".\"Id\", \"t93\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t97\"\nGROUP BY \"t97\".\"USERID\") AS \"t98\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t99\" ON \"t98\".\"USERID\" IS NOT DISTINCT FROM \"t99\".\"UserId\") AS \"t100\" ON \"t88\".\"USERID\" = \"t100\".\"UserId\"\nGROUP BY \"t88\".\"USERID\") AS \"t102\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t105\" ON \"t102\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t79\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t79\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43915",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43915,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 11,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t56\".\"USERID\", \"t56\".\"DISPLAYNAME\", \"t56\".\"TOTALPOSTS\", \"t56\".\"TOTALSCORE\", \"t56\".\"UPVOTECOUNT\", \"t56\".\"DOWNVOTECOUNT\", \"t56\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t56\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t56\".\"TOTALSCORE\" >= 50 AND \"t56\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t56\".\"EXPR$0\" AS \"GOLDBADGES\", \"t56\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t55\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t55\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"t48\".\"EXPR$0\" IS NOT NULL THEN \"t48\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t48\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"t48\".\"UserId\") AS \"t49\" ON \"t35\".\"USERID\" = \"t49\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t26\".\"USERID\" = \"t55\".\"UserId\") AS \"t56\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"USERID\"\nFROM (SELECT \"t65\".\"USERID\", \"t65\".\"DISPLAYNAME\", \"t65\".\"TOTALPOSTS\", \"t65\".\"TOTALSCORE\", \"t65\".\"UPVOTECOUNT\", \"t65\".\"DOWNVOTECOUNT\", \"t65\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t79\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t79\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\", \"t61\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t61\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t61\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t60\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t61\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"USERID\" AS \"UserId\", CASE WHEN \"t78\".\"EXPR$0\" IS NOT NULL THEN \"t78\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t74\".\"USERID\"\nFROM (SELECT MIN(\"t70\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t69\".\"POSTID\", \"t69\".\"TITLE\", \"t69\".\"SCORE\", \"t69\".\"CREATIONDATE\", \"t69\".\"OWNERUSERID\", \"t69\".\"RAN\", \"t69\".\"COMMENTCOUNT\"\nFROM (SELECT \"t68\".\"Id\" AS \"POSTID\", \"t68\".\"Title\" AS \"TITLE\", \"t68\".\"Score\" AS \"SCORE\", \"t68\".\"CreationDate\" AS \"CREATIONDATE\", \"t68\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t68\".\"OwnerUserId\" ORDER BY \"t68\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t67\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t68\" ON \"t67\".\"PostId\" = \"t68\".\"Id\") AS \"t69\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t69\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t70\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t70\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t70\".\"Id\", \"t70\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t74\"\nGROUP BY \"t74\".\"USERID\") AS \"t75\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t78\" ON \"t75\".\"USERID\" IS NOT DISTINCT FROM \"t78\".\"UserId\") AS \"t79\" ON \"t65\".\"USERID\" = \"t79\".\"UserId\") AS \"t80\"\nLEFT JOIN (SELECT \"t105\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t89\".\"USERID\"\nFROM (SELECT MIN(\"t85\".\"Id\") AS \"USERID\", \"t85\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t85\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t85\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t85\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t85\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t84\".\"POSTID\", \"t84\".\"TITLE\", \"t84\".\"SCORE\", \"t84\".\"CREATIONDATE\", \"t84\".\"OWNERUSERID\", \"t84\".\"RAN\", \"t84\".\"COMMENTCOUNT\"\nFROM (SELECT \"t83\".\"Id\" AS \"POSTID\", \"t83\".\"Title\" AS \"TITLE\", \"t83\".\"Score\" AS \"SCORE\", \"t83\".\"CreationDate\" AS \"CREATIONDATE\", \"t83\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t83\".\"OwnerUserId\" ORDER BY \"t83\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t82\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t83\" ON \"t82\".\"PostId\" = \"t83\".\"Id\") AS \"t84\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t84\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t85\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t85\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t85\".\"Id\", \"t85\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t89\"\nLEFT JOIN (SELECT \"t99\".\"USERID\" AS \"UserId\", CASE WHEN \"t102\".\"EXPR$0\" IS NOT NULL THEN \"t102\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t98\".\"USERID\"\nFROM (SELECT MIN(\"t94\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t93\".\"POSTID\", \"t93\".\"TITLE\", \"t93\".\"SCORE\", \"t93\".\"CREATIONDATE\", \"t93\".\"OWNERUSERID\", \"t93\".\"RAN\", \"t93\".\"COMMENTCOUNT\"\nFROM (SELECT \"t92\".\"Id\" AS \"POSTID\", \"t92\".\"Title\" AS \"TITLE\", \"t92\".\"Score\" AS \"SCORE\", \"t92\".\"CreationDate\" AS \"CREATIONDATE\", \"t92\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t92\".\"OwnerUserId\" ORDER BY \"t92\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t91\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t91\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t91\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t92\" ON \"t91\".\"PostId\" = \"t92\".\"Id\") AS \"t93\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t93\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t94\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t94\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t94\".\"Id\", \"t94\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t98\"\nGROUP BY \"t98\".\"USERID\") AS \"t99\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t102\" ON \"t99\".\"USERID\" IS NOT DISTINCT FROM \"t102\".\"UserId\") AS \"t103\" ON \"t89\".\"USERID\" = \"t103\".\"UserId\"\nGROUP BY \"t89\".\"USERID\") AS \"t105\"\nLEFT JOIN \"s1\" ON \"t105\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t106\" ON \"t80\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t80\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t56\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t56\".\"TOTALSCORE\" DESC NULLS FIRST, \"t56\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43913",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43913,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 12,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t108\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t78\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t77\".\"EXPR$0\" IS NOT NULL THEN \"t77\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t77\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t77\".\"UserId\") AS \"t78\" ON \"t64\".\"USERID\" = \"t78\".\"UserId\") AS \"t79\"\nLEFT JOIN (SELECT \"t104\".\"USERID\" AS \"UserId\", CASE WHEN \"t105\".\"EXPR$0\" IS NOT NULL THEN \"t105\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t88\".\"USERID\"\nFROM (SELECT MIN(\"t84\".\"Id\") AS \"USERID\", \"t84\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t84\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t84\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t83\".\"POSTID\", \"t83\".\"TITLE\", \"t83\".\"SCORE\", \"t83\".\"CREATIONDATE\", \"t83\".\"OWNERUSERID\", \"t83\".\"RAN\", \"t83\".\"COMMENTCOUNT\"\nFROM (SELECT \"t82\".\"Id\" AS \"POSTID\", \"t82\".\"Title\" AS \"TITLE\", \"t82\".\"Score\" AS \"SCORE\", \"t82\".\"CreationDate\" AS \"CREATIONDATE\", \"t82\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t82\".\"OwnerUserId\" ORDER BY \"t82\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t81\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t82\" ON \"t81\".\"PostId\" = \"t82\".\"Id\") AS \"t83\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t83\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t84\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t84\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t84\".\"Id\", \"t84\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t88\"\nLEFT JOIN (SELECT \"t98\".\"USERID\" AS \"UserId\", CASE WHEN \"t101\".\"EXPR$0\" IS NOT NULL THEN \"t101\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t97\".\"USERID\"\nFROM (SELECT MIN(\"t93\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t92\".\"POSTID\", \"t92\".\"TITLE\", \"t92\".\"SCORE\", \"t92\".\"CREATIONDATE\", \"t92\".\"OWNERUSERID\", \"t92\".\"RAN\", \"t92\".\"COMMENTCOUNT\"\nFROM (SELECT \"t91\".\"Id\" AS \"POSTID\", \"t91\".\"Title\" AS \"TITLE\", \"t91\".\"Score\" AS \"SCORE\", \"t91\".\"CreationDate\" AS \"CREATIONDATE\", \"t91\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t91\".\"OwnerUserId\" ORDER BY \"t91\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t90\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t90\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t90\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t91\" ON \"t90\".\"PostId\" = \"t91\".\"Id\") AS \"t92\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t92\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t93\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t93\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t93\".\"Id\", \"t93\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t97\"\nGROUP BY \"t97\".\"USERID\") AS \"t98\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t101\" ON \"t98\".\"USERID\" IS NOT DISTINCT FROM \"t101\".\"UserId\") AS \"t102\" ON \"t88\".\"USERID\" = \"t102\".\"UserId\"\nGROUP BY \"t88\".\"USERID\") AS \"t104\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t105\" ON \"t104\".\"USERID\" IS NOT DISTINCT FROM \"t105\".\"UserId\") AS \"t106\" ON \"t79\".\"USERID\" = \"t106\".\"UserId\"\nGROUP BY \"t79\".\"USERID\") AS \"t108\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\") AS \"t111\" ON \"t108\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43932",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43932,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 6,
        "cutNodeOperatorKind" : "AGGREGATE",
        "cutOutputRows" : 549021.0,
        "cutRowSizeOutBytes" : 16.0,
        "cutOutputBytes" : 8784336.0,
        "transferEstimatedMs" : 121.83649546890098,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 4,
          "maxDepth" : 4,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1,
            "AGGREGATE" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 154,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 29,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\", COUNT(*) AS \"FD_COL_1\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3\nGROUP BY \"UserId\"",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        }, {
          "name" : "FD_COL_1",
          "type" : "BIGINT"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t56\".\"USERID\", \"t56\".\"DISPLAYNAME\", \"t56\".\"TOTALPOSTS\", \"t56\".\"TOTALSCORE\", \"t56\".\"UPVOTECOUNT\", \"t56\".\"DOWNVOTECOUNT\", \"t56\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t56\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t56\".\"TOTALSCORE\" >= 50 AND \"t56\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t56\".\"EXPR$0\" AS \"GOLDBADGES\", \"t56\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t26\".\"USERID\", \"t26\".\"DISPLAYNAME\", \"t26\".\"TOTALPOSTS\", \"t26\".\"TOTALSCORE\", \"t26\".\"UPVOTECOUNT\", \"t26\".\"DOWNVOTECOUNT\", \"t26\".\"AVGCOMMENTSPERPOST\", \"t26\".\"EXPR$0\", CASE WHEN \"t55\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t55\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t11\".\"USERID\", \"t11\".\"DISPLAYNAME\", \"t11\".\"TOTALPOSTS\", \"t11\".\"TOTALSCORE\", \"t11\".\"UPVOTECOUNT\", \"t11\".\"DOWNVOTECOUNT\", \"t11\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t25\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t25\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t7\".\"Id\") AS \"USERID\", \"t7\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t7\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t7\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t7\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t7\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t6\".\"POSTID\", \"t6\".\"TITLE\", \"t6\".\"SCORE\", \"t6\".\"CREATIONDATE\", \"t6\".\"OWNERUSERID\", \"t6\".\"RAN\", \"t6\".\"COMMENTCOUNT\"\nFROM (SELECT \"t5\".\"Id\" AS \"POSTID\", \"t5\".\"Title\" AS \"TITLE\", \"t5\".\"Score\" AS \"SCORE\", \"t5\".\"CreationDate\" AS \"CREATIONDATE\", \"t5\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t5\".\"OwnerUserId\" ORDER BY \"t5\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t4\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t4\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t4\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t5\" ON \"t4\".\"PostId\" = \"t5\".\"Id\") AS \"t6\"\nRIGHT JOIN \"Users\" ON \"t6\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t7\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t7\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t7\".\"Id\", \"t7\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t11\"\nLEFT JOIN (SELECT \"t21\".\"USERID\" AS \"UserId\", CASE WHEN \"t24\".\"EXPR$0\" IS NOT NULL THEN \"t24\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t20\".\"USERID\"\nFROM (SELECT MIN(\"t16\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t15\".\"POSTID\", \"t15\".\"TITLE\", \"t15\".\"SCORE\", \"t15\".\"CREATIONDATE\", \"t15\".\"OWNERUSERID\", \"t15\".\"RAN\", \"t15\".\"COMMENTCOUNT\"\nFROM (SELECT \"t14\".\"Id\" AS \"POSTID\", \"t14\".\"Title\" AS \"TITLE\", \"t14\".\"Score\" AS \"SCORE\", \"t14\".\"CreationDate\" AS \"CREATIONDATE\", \"t14\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t14\".\"OwnerUserId\" ORDER BY \"t14\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t13\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t13\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t13\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t14\" ON \"t13\".\"PostId\" = \"t14\".\"Id\") AS \"t15\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t15\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t16\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t16\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t16\".\"Id\", \"t16\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t20\"\nGROUP BY \"t20\".\"USERID\") AS \"t21\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t24\" ON \"t21\".\"USERID\" IS NOT DISTINCT FROM \"t24\".\"UserId\") AS \"t25\" ON \"t11\".\"USERID\" = \"t25\".\"UserId\") AS \"t26\"\nLEFT JOIN (SELECT \"t51\".\"USERID\" AS \"UserId\", CASE WHEN \"t54\".\"EXPR$0\" IS NOT NULL THEN \"t54\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t35\".\"USERID\"\nFROM (SELECT MIN(\"t31\".\"Id\") AS \"USERID\", \"t31\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t31\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t31\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t31\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t31\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t30\".\"POSTID\", \"t30\".\"TITLE\", \"t30\".\"SCORE\", \"t30\".\"CREATIONDATE\", \"t30\".\"OWNERUSERID\", \"t30\".\"RAN\", \"t30\".\"COMMENTCOUNT\"\nFROM (SELECT \"t29\".\"Id\" AS \"POSTID\", \"t29\".\"Title\" AS \"TITLE\", \"t29\".\"Score\" AS \"SCORE\", \"t29\".\"CreationDate\" AS \"CREATIONDATE\", \"t29\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t29\".\"OwnerUserId\" ORDER BY \"t29\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t28\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t28\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t28\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t29\" ON \"t28\".\"PostId\" = \"t29\".\"Id\") AS \"t30\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t30\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t31\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t31\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t31\".\"Id\", \"t31\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t35\"\nLEFT JOIN (SELECT \"t45\".\"USERID\" AS \"UserId\", CASE WHEN \"t48\".\"EXPR$0\" IS NOT NULL THEN \"t48\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t44\".\"USERID\"\nFROM (SELECT MIN(\"t40\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t39\".\"POSTID\", \"t39\".\"TITLE\", \"t39\".\"SCORE\", \"t39\".\"CREATIONDATE\", \"t39\".\"OWNERUSERID\", \"t39\".\"RAN\", \"t39\".\"COMMENTCOUNT\"\nFROM (SELECT \"t38\".\"Id\" AS \"POSTID\", \"t38\".\"Title\" AS \"TITLE\", \"t38\".\"Score\" AS \"SCORE\", \"t38\".\"CreationDate\" AS \"CREATIONDATE\", \"t38\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t38\".\"OwnerUserId\" ORDER BY \"t38\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t37\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t37\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t37\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t38\" ON \"t37\".\"PostId\" = \"t38\".\"Id\") AS \"t39\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t39\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t40\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t40\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t40\".\"Id\", \"t40\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t44\"\nGROUP BY \"t44\".\"USERID\") AS \"t45\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t48\" ON \"t45\".\"USERID\" IS NOT DISTINCT FROM \"t48\".\"UserId\") AS \"t49\" ON \"t35\".\"USERID\" = \"t49\".\"UserId\"\nGROUP BY \"t35\".\"USERID\") AS \"t51\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t54\" ON \"t51\".\"USERID\" IS NOT DISTINCT FROM \"t54\".\"UserId\") AS \"t55\" ON \"t26\".\"USERID\" = \"t55\".\"UserId\") AS \"t56\"\nLEFT JOIN (SELECT \"t111\".\"USERID\" AS \"UserId\", CASE WHEN \"s1\".\"FD_COL_1\" IS NOT NULL THEN \"s1\".\"FD_COL_1\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t80\".\"USERID\"\nFROM (SELECT \"t65\".\"USERID\", \"t65\".\"DISPLAYNAME\", \"t65\".\"TOTALPOSTS\", \"t65\".\"TOTALSCORE\", \"t65\".\"UPVOTECOUNT\", \"t65\".\"DOWNVOTECOUNT\", \"t65\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t79\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t79\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t61\".\"Id\") AS \"USERID\", \"t61\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t61\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t61\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t61\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t61\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t60\".\"POSTID\", \"t60\".\"TITLE\", \"t60\".\"SCORE\", \"t60\".\"CREATIONDATE\", \"t60\".\"OWNERUSERID\", \"t60\".\"RAN\", \"t60\".\"COMMENTCOUNT\"\nFROM (SELECT \"t59\".\"Id\" AS \"POSTID\", \"t59\".\"Title\" AS \"TITLE\", \"t59\".\"Score\" AS \"SCORE\", \"t59\".\"CreationDate\" AS \"CREATIONDATE\", \"t59\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t59\".\"OwnerUserId\" ORDER BY \"t59\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t58\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t58\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t58\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t59\" ON \"t58\".\"PostId\" = \"t59\".\"Id\") AS \"t60\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t60\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t61\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t61\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t61\".\"Id\", \"t61\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t65\"\nLEFT JOIN (SELECT \"t75\".\"USERID\" AS \"UserId\", CASE WHEN \"t78\".\"EXPR$0\" IS NOT NULL THEN \"t78\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t74\".\"USERID\"\nFROM (SELECT MIN(\"t70\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t69\".\"POSTID\", \"t69\".\"TITLE\", \"t69\".\"SCORE\", \"t69\".\"CREATIONDATE\", \"t69\".\"OWNERUSERID\", \"t69\".\"RAN\", \"t69\".\"COMMENTCOUNT\"\nFROM (SELECT \"t68\".\"Id\" AS \"POSTID\", \"t68\".\"Title\" AS \"TITLE\", \"t68\".\"Score\" AS \"SCORE\", \"t68\".\"CreationDate\" AS \"CREATIONDATE\", \"t68\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t68\".\"OwnerUserId\" ORDER BY \"t68\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t67\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t67\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t67\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t68\" ON \"t67\".\"PostId\" = \"t68\".\"Id\") AS \"t69\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t69\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t70\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t70\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t70\".\"Id\", \"t70\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t74\"\nGROUP BY \"t74\".\"USERID\") AS \"t75\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t78\" ON \"t75\".\"USERID\" IS NOT DISTINCT FROM \"t78\".\"UserId\") AS \"t79\" ON \"t65\".\"USERID\" = \"t79\".\"UserId\") AS \"t80\"\nLEFT JOIN (SELECT \"t105\".\"USERID\" AS \"UserId\", CASE WHEN \"t108\".\"EXPR$0\" IS NOT NULL THEN \"t108\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t89\".\"USERID\"\nFROM (SELECT MIN(\"t85\".\"Id\") AS \"USERID\", \"t85\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t85\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t85\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t85\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t85\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t84\".\"POSTID\", \"t84\".\"TITLE\", \"t84\".\"SCORE\", \"t84\".\"CREATIONDATE\", \"t84\".\"OWNERUSERID\", \"t84\".\"RAN\", \"t84\".\"COMMENTCOUNT\"\nFROM (SELECT \"t83\".\"Id\" AS \"POSTID\", \"t83\".\"Title\" AS \"TITLE\", \"t83\".\"Score\" AS \"SCORE\", \"t83\".\"CreationDate\" AS \"CREATIONDATE\", \"t83\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t83\".\"OwnerUserId\" ORDER BY \"t83\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t82\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t82\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t82\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t83\" ON \"t82\".\"PostId\" = \"t83\".\"Id\") AS \"t84\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t84\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t85\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t85\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t85\".\"Id\", \"t85\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t89\"\nLEFT JOIN (SELECT \"t99\".\"USERID\" AS \"UserId\", CASE WHEN \"t102\".\"EXPR$0\" IS NOT NULL THEN \"t102\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t98\".\"USERID\"\nFROM (SELECT MIN(\"t94\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t93\".\"POSTID\", \"t93\".\"TITLE\", \"t93\".\"SCORE\", \"t93\".\"CREATIONDATE\", \"t93\".\"OWNERUSERID\", \"t93\".\"RAN\", \"t93\".\"COMMENTCOUNT\"\nFROM (SELECT \"t92\".\"Id\" AS \"POSTID\", \"t92\".\"Title\" AS \"TITLE\", \"t92\".\"Score\" AS \"SCORE\", \"t92\".\"CreationDate\" AS \"CREATIONDATE\", \"t92\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t92\".\"OwnerUserId\" ORDER BY \"t92\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t91\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t91\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t91\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t92\" ON \"t91\".\"PostId\" = \"t92\".\"Id\") AS \"t93\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t93\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t94\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t94\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t94\".\"Id\", \"t94\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t98\"\nGROUP BY \"t98\".\"USERID\") AS \"t99\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t102\" ON \"t99\".\"USERID\" IS NOT DISTINCT FROM \"t102\".\"UserId\") AS \"t103\" ON \"t89\".\"USERID\" = \"t103\".\"UserId\"\nGROUP BY \"t89\".\"USERID\") AS \"t105\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t108\" ON \"t105\".\"USERID\" IS NOT DISTINCT FROM \"t108\".\"UserId\") AS \"t109\" ON \"t80\".\"USERID\" = \"t109\".\"UserId\"\nGROUP BY \"t80\".\"USERID\") AS \"t111\"\nLEFT JOIN \"s1\" ON \"t111\".\"USERID\" IS NOT DISTINCT FROM \"s1\".\"UserId\") AS \"t112\" ON \"t56\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t56\".\"TOTALSCORE\" DESC NULLS FIRST, \"t56\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  }, {
    "planId" : "cut_43930",
    "dpSummary" : {
      "hasCut" : true,
      "cutNodeId" : 43930,
      "q1Engine" : "duckdb",
      "q2Engine" : "datafusion",
      "costAllDuckdb" : 2.96033284298688E7,
      "costAllDatafusion" : 5404447.622810792,
      "chosenCost" : -1.0
    },
    "analysis" : {
      "pipeline" : {
        "runId" : "so_optim_withTransfer",
        "doOptimize" : true,
        "metadataProvider" : "custom",
        "dpMode" : "MAX",
        "transferExtraConstantMs" : 0.0,
        "transferCoeffs" : {
          "duckdb" : {
            "aMs" : 62.297202312292534,
            "bMsPerRow" : 1.9855075008663652E-4,
            "cMsPerRowSizeByte" : 0.0,
            "dMsPerOutputByte" : 9.37543642726493E-7
          },
          "datafusion" : {
            "aMs" : 72.934497671158,
            "bMsPerRow" : 8.296144368777564E-5,
            "cMsPerRowSizeByte" : 0.0010951149669102135,
            "dMsPerOutputByte" : 3.7986948397307897E-7
          }
        },
        "decorrelatedPlanSha256" : "2efe38999ee7acb4c50a6bc0ac7322e368fbd237deecbef595d15b0e690475ff",
        "cutPolicy" : "DP",
        "randomSeed" : 1770162173403,
        "schemaName" : "STACK"
      },
      "planStats" : {
        "totalNodes" : 193,
        "maxDepth" : 28,
        "operatorKindCounts" : {
          "OTHER" : 66,
          "JOIN" : 38,
          "AGGREGATE" : 30,
          "FILTER" : 23,
          "SORT" : 1
        },
        "rootOutputRows" : 100.0,
        "rootRowSizeOutBytes" : 136.0
      },
      "cut" : {
        "cutDepth" : 7,
        "cutNodeOperatorKind" : "FILTER",
        "cutOutputRows" : 773908.0,
        "cutRowSizeOutBytes" : 31.00815299320677,
        "cutOutputBytes" : 2.3997457666666664E7,
        "transferEstimatedMs" : 146.28888198561864,
        "q1Stats" : {
          "engine" : "duckdb",
          "nodeCount" : 3,
          "maxDepth" : 3,
          "operatorKindCounts" : {
            "OTHER" : 2,
            "FILTER" : 1
          }
        },
        "q2Stats" : {
          "engine" : "datafusion",
          "nodeCount" : 155,
          "maxDepth" : 29,
          "operatorKindCounts" : {
            "OTHER" : 64,
            "JOIN" : 38,
            "AGGREGATE" : 30,
            "FILTER" : 22,
            "SORT" : 1
          }
        }
      }
    },
    "dag" : {
      "finalNodeId" : "q2",
      "nodes" : [ {
        "id" : "q1",
        "engine" : "duckdb",
        "sql" : "SELECT COALESCE(\"UserId\", \"UserId\") AS \"UserId\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 3",
        "inputs" : { },
        "schema" : [ {
          "name" : "UserId",
          "type" : "INTEGER"
        } ]
      }, {
        "id" : "q2",
        "engine" : "datafusion",
        "sql" : "SELECT COALESCE(\"t115\".\"USERID\", \"t115\".\"USERID\") AS \"USERID\", \"t115\".\"DISPLAYNAME\", \"t115\".\"TOTALPOSTS\", \"t115\".\"TOTALSCORE\", \"t115\".\"UPVOTECOUNT\", \"t115\".\"DOWNVOTECOUNT\", \"t115\".\"AVGCOMMENTSPERPOST\", \"t115\".\"SCORECATEGORY\", \"t115\".\"GOLDBADGES\", \"t115\".\"SILVERBADGES\", \"t115\".\"BRONZEBADGES\"\nFROM (SELECT \"t55\".\"USERID\", \"t55\".\"DISPLAYNAME\", \"t55\".\"TOTALPOSTS\", \"t55\".\"TOTALSCORE\", \"t55\".\"UPVOTECOUNT\", \"t55\".\"DOWNVOTECOUNT\", \"t55\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t55\".\"TOTALSCORE\" > 100 THEN 'High Scorer  ' WHEN \"t55\".\"TOTALSCORE\" >= 50 AND \"t55\".\"TOTALSCORE\" <= 100 THEN 'Medium Scorer' ELSE 'Low Scorer   ' END AS \"SCORECATEGORY\", \"t55\".\"EXPR$0\" AS \"GOLDBADGES\", \"t55\".\"EXPR$08\" AS \"SILVERBADGES\", CASE WHEN \"t112\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t112\".\"EXPR$0\" END AS \"BRONZEBADGES\"\nFROM (SELECT \"t25\".\"USERID\", \"t25\".\"DISPLAYNAME\", \"t25\".\"TOTALPOSTS\", \"t25\".\"TOTALSCORE\", \"t25\".\"UPVOTECOUNT\", \"t25\".\"DOWNVOTECOUNT\", \"t25\".\"AVGCOMMENTSPERPOST\", \"t25\".\"EXPR$0\", CASE WHEN \"t54\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t54\".\"EXPR$0\" END AS \"EXPR$08\"\nFROM (SELECT \"t10\".\"USERID\", \"t10\".\"DISPLAYNAME\", \"t10\".\"TOTALPOSTS\", \"t10\".\"TOTALSCORE\", \"t10\".\"UPVOTECOUNT\", \"t10\".\"DOWNVOTECOUNT\", \"t10\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t24\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t24\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t6\".\"Id\") AS \"USERID\", \"t6\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts0\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts0\".\"Score\") AS \"TOTALSCORE\", SUM(\"t6\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t6\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t6\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t6\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users\".\"Id\", \"Users\".\"Reputation\", \"Users\".\"CreationDate\", \"Users\".\"DisplayName\", \"Users\".\"LastAccessDate\", \"Users\".\"WebsiteUrl\", \"Users\".\"Location\", \"Users\".\"AboutMe\", \"Users\".\"Views\", \"Users\".\"UpVotes\", \"Users\".\"DownVotes\", \"Users\".\"ProfileImageUrl\", \"Users\".\"AccountId\", \"t5\".\"POSTID\", \"t5\".\"TITLE\", \"t5\".\"SCORE\", \"t5\".\"CREATIONDATE\", \"t5\".\"OWNERUSERID\", \"t5\".\"RAN\", \"t5\".\"COMMENTCOUNT\"\nFROM (SELECT \"t4\".\"Id\" AS \"POSTID\", \"t4\".\"Title\" AS \"TITLE\", \"t4\".\"Score\" AS \"SCORE\", \"t4\".\"CreationDate\" AS \"CREATIONDATE\", \"t4\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t4\".\"OwnerUserId\" ORDER BY \"t4\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t3\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t3\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t3\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t4\" ON \"t3\".\"PostId\" = \"t4\".\"Id\") AS \"t5\"\nRIGHT JOIN \"Users\" ON \"t5\".\"OWNERUSERID\" = \"Users\".\"Id\") AS \"t6\"\nLEFT JOIN \"Posts\" AS \"Posts0\" ON \"t6\".\"Id\" = \"Posts0\".\"OwnerUserId\"\nGROUP BY \"t6\".\"Id\", \"t6\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts0\".\"Id\") > 0) AS \"t10\"\nLEFT JOIN (SELECT \"t20\".\"USERID\" AS \"UserId\", CASE WHEN \"t23\".\"EXPR$0\" IS NOT NULL THEN \"t23\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t19\".\"USERID\"\nFROM (SELECT MIN(\"t15\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users0\".\"Id\", \"Users0\".\"Reputation\", \"Users0\".\"CreationDate\", \"Users0\".\"DisplayName\", \"Users0\".\"LastAccessDate\", \"Users0\".\"WebsiteUrl\", \"Users0\".\"Location\", \"Users0\".\"AboutMe\", \"Users0\".\"Views\", \"Users0\".\"UpVotes\", \"Users0\".\"DownVotes\", \"Users0\".\"ProfileImageUrl\", \"Users0\".\"AccountId\", \"t14\".\"POSTID\", \"t14\".\"TITLE\", \"t14\".\"SCORE\", \"t14\".\"CREATIONDATE\", \"t14\".\"OWNERUSERID\", \"t14\".\"RAN\", \"t14\".\"COMMENTCOUNT\"\nFROM (SELECT \"t13\".\"Id\" AS \"POSTID\", \"t13\".\"Title\" AS \"TITLE\", \"t13\".\"Score\" AS \"SCORE\", \"t13\".\"CreationDate\" AS \"CREATIONDATE\", \"t13\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t13\".\"OwnerUserId\" ORDER BY \"t13\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t12\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t12\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t12\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t13\" ON \"t12\".\"PostId\" = \"t13\".\"Id\") AS \"t14\"\nRIGHT JOIN \"Users\" AS \"Users0\" ON \"t14\".\"OWNERUSERID\" = \"Users0\".\"Id\") AS \"t15\"\nLEFT JOIN \"Posts\" AS \"Posts2\" ON \"t15\".\"Id\" = \"Posts2\".\"OwnerUserId\"\nGROUP BY \"t15\".\"Id\", \"t15\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts2\".\"Id\") > 0) AS \"t19\"\nGROUP BY \"t19\".\"USERID\") AS \"t20\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t23\" ON \"t20\".\"USERID\" IS NOT DISTINCT FROM \"t23\".\"UserId\") AS \"t24\" ON \"t10\".\"USERID\" = \"t24\".\"UserId\") AS \"t25\"\nLEFT JOIN (SELECT \"t50\".\"USERID\" AS \"UserId\", CASE WHEN \"t53\".\"EXPR$0\" IS NOT NULL THEN \"t53\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t34\".\"USERID\"\nFROM (SELECT MIN(\"t30\".\"Id\") AS \"USERID\", \"t30\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts4\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts4\".\"Score\") AS \"TOTALSCORE\", SUM(\"t30\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t30\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t30\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t30\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users1\".\"Id\", \"Users1\".\"Reputation\", \"Users1\".\"CreationDate\", \"Users1\".\"DisplayName\", \"Users1\".\"LastAccessDate\", \"Users1\".\"WebsiteUrl\", \"Users1\".\"Location\", \"Users1\".\"AboutMe\", \"Users1\".\"Views\", \"Users1\".\"UpVotes\", \"Users1\".\"DownVotes\", \"Users1\".\"ProfileImageUrl\", \"Users1\".\"AccountId\", \"t29\".\"POSTID\", \"t29\".\"TITLE\", \"t29\".\"SCORE\", \"t29\".\"CREATIONDATE\", \"t29\".\"OWNERUSERID\", \"t29\".\"RAN\", \"t29\".\"COMMENTCOUNT\"\nFROM (SELECT \"t28\".\"Id\" AS \"POSTID\", \"t28\".\"Title\" AS \"TITLE\", \"t28\".\"Score\" AS \"SCORE\", \"t28\".\"CreationDate\" AS \"CREATIONDATE\", \"t28\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t28\".\"OwnerUserId\" ORDER BY \"t28\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t27\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t27\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t27\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t28\" ON \"t27\".\"PostId\" = \"t28\".\"Id\") AS \"t29\"\nRIGHT JOIN \"Users\" AS \"Users1\" ON \"t29\".\"OWNERUSERID\" = \"Users1\".\"Id\") AS \"t30\"\nLEFT JOIN \"Posts\" AS \"Posts4\" ON \"t30\".\"Id\" = \"Posts4\".\"OwnerUserId\"\nGROUP BY \"t30\".\"Id\", \"t30\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts4\".\"Id\") > 0) AS \"t34\"\nLEFT JOIN (SELECT \"t44\".\"USERID\" AS \"UserId\", CASE WHEN \"t47\".\"EXPR$0\" IS NOT NULL THEN \"t47\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t43\".\"USERID\"\nFROM (SELECT MIN(\"t39\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users2\".\"Id\", \"Users2\".\"Reputation\", \"Users2\".\"CreationDate\", \"Users2\".\"DisplayName\", \"Users2\".\"LastAccessDate\", \"Users2\".\"WebsiteUrl\", \"Users2\".\"Location\", \"Users2\".\"AboutMe\", \"Users2\".\"Views\", \"Users2\".\"UpVotes\", \"Users2\".\"DownVotes\", \"Users2\".\"ProfileImageUrl\", \"Users2\".\"AccountId\", \"t38\".\"POSTID\", \"t38\".\"TITLE\", \"t38\".\"SCORE\", \"t38\".\"CREATIONDATE\", \"t38\".\"OWNERUSERID\", \"t38\".\"RAN\", \"t38\".\"COMMENTCOUNT\"\nFROM (SELECT \"t37\".\"Id\" AS \"POSTID\", \"t37\".\"Title\" AS \"TITLE\", \"t37\".\"Score\" AS \"SCORE\", \"t37\".\"CreationDate\" AS \"CREATIONDATE\", \"t37\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t37\".\"OwnerUserId\" ORDER BY \"t37\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t36\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t36\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t36\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t37\" ON \"t36\".\"PostId\" = \"t37\".\"Id\") AS \"t38\"\nRIGHT JOIN \"Users\" AS \"Users2\" ON \"t38\".\"OWNERUSERID\" = \"Users2\".\"Id\") AS \"t39\"\nLEFT JOIN \"Posts\" AS \"Posts6\" ON \"t39\".\"Id\" = \"Posts6\".\"OwnerUserId\"\nGROUP BY \"t39\".\"Id\", \"t39\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts6\".\"Id\") > 0) AS \"t43\"\nGROUP BY \"t43\".\"USERID\") AS \"t44\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t47\" ON \"t44\".\"USERID\" IS NOT DISTINCT FROM \"t47\".\"UserId\") AS \"t48\" ON \"t34\".\"USERID\" = \"t48\".\"UserId\"\nGROUP BY \"t34\".\"USERID\") AS \"t50\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t53\" ON \"t50\".\"USERID\" IS NOT DISTINCT FROM \"t53\".\"UserId\") AS \"t54\" ON \"t25\".\"USERID\" = \"t54\".\"UserId\") AS \"t55\"\nLEFT JOIN (SELECT \"t110\".\"USERID\" AS \"UserId\", CASE WHEN \"t111\".\"EXPR$0\" IS NOT NULL THEN \"t111\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t79\".\"USERID\"\nFROM (SELECT \"t64\".\"USERID\", \"t64\".\"DISPLAYNAME\", \"t64\".\"TOTALPOSTS\", \"t64\".\"TOTALSCORE\", \"t64\".\"UPVOTECOUNT\", \"t64\".\"DOWNVOTECOUNT\", \"t64\".\"AVGCOMMENTSPERPOST\", CASE WHEN \"t78\".\"EXPR$0\" IS NULL THEN 0 ELSE \"t78\".\"EXPR$0\" END AS \"EXPR$0\"\nFROM (SELECT MIN(\"t60\".\"Id\") AS \"USERID\", \"t60\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts8\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts8\".\"Score\") AS \"TOTALSCORE\", SUM(\"t60\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t60\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t60\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t60\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users3\".\"Id\", \"Users3\".\"Reputation\", \"Users3\".\"CreationDate\", \"Users3\".\"DisplayName\", \"Users3\".\"LastAccessDate\", \"Users3\".\"WebsiteUrl\", \"Users3\".\"Location\", \"Users3\".\"AboutMe\", \"Users3\".\"Views\", \"Users3\".\"UpVotes\", \"Users3\".\"DownVotes\", \"Users3\".\"ProfileImageUrl\", \"Users3\".\"AccountId\", \"t59\".\"POSTID\", \"t59\".\"TITLE\", \"t59\".\"SCORE\", \"t59\".\"CREATIONDATE\", \"t59\".\"OWNERUSERID\", \"t59\".\"RAN\", \"t59\".\"COMMENTCOUNT\"\nFROM (SELECT \"t58\".\"Id\" AS \"POSTID\", \"t58\".\"Title\" AS \"TITLE\", \"t58\".\"Score\" AS \"SCORE\", \"t58\".\"CreationDate\" AS \"CREATIONDATE\", \"t58\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t58\".\"OwnerUserId\" ORDER BY \"t58\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t57\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t57\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t57\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t58\" ON \"t57\".\"PostId\" = \"t58\".\"Id\") AS \"t59\"\nRIGHT JOIN \"Users\" AS \"Users3\" ON \"t59\".\"OWNERUSERID\" = \"Users3\".\"Id\") AS \"t60\"\nLEFT JOIN \"Posts\" AS \"Posts8\" ON \"t60\".\"Id\" = \"Posts8\".\"OwnerUserId\"\nGROUP BY \"t60\".\"Id\", \"t60\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts8\".\"Id\") > 0) AS \"t64\"\nLEFT JOIN (SELECT \"t74\".\"USERID\" AS \"UserId\", CASE WHEN \"t77\".\"EXPR$0\" IS NOT NULL THEN \"t77\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t73\".\"USERID\"\nFROM (SELECT MIN(\"t69\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users4\".\"Id\", \"Users4\".\"Reputation\", \"Users4\".\"CreationDate\", \"Users4\".\"DisplayName\", \"Users4\".\"LastAccessDate\", \"Users4\".\"WebsiteUrl\", \"Users4\".\"Location\", \"Users4\".\"AboutMe\", \"Users4\".\"Views\", \"Users4\".\"UpVotes\", \"Users4\".\"DownVotes\", \"Users4\".\"ProfileImageUrl\", \"Users4\".\"AccountId\", \"t68\".\"POSTID\", \"t68\".\"TITLE\", \"t68\".\"SCORE\", \"t68\".\"CREATIONDATE\", \"t68\".\"OWNERUSERID\", \"t68\".\"RAN\", \"t68\".\"COMMENTCOUNT\"\nFROM (SELECT \"t67\".\"Id\" AS \"POSTID\", \"t67\".\"Title\" AS \"TITLE\", \"t67\".\"Score\" AS \"SCORE\", \"t67\".\"CreationDate\" AS \"CREATIONDATE\", \"t67\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t67\".\"OwnerUserId\" ORDER BY \"t67\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t66\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t66\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t66\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t67\" ON \"t66\".\"PostId\" = \"t67\".\"Id\") AS \"t68\"\nRIGHT JOIN \"Users\" AS \"Users4\" ON \"t68\".\"OWNERUSERID\" = \"Users4\".\"Id\") AS \"t69\"\nLEFT JOIN \"Posts\" AS \"Posts10\" ON \"t69\".\"Id\" = \"Posts10\".\"OwnerUserId\"\nGROUP BY \"t69\".\"Id\", \"t69\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts10\".\"Id\") > 0) AS \"t73\"\nGROUP BY \"t73\".\"USERID\") AS \"t74\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t77\" ON \"t74\".\"USERID\" IS NOT DISTINCT FROM \"t77\".\"UserId\") AS \"t78\" ON \"t64\".\"USERID\" = \"t78\".\"UserId\") AS \"t79\"\nLEFT JOIN (SELECT \"t104\".\"USERID\" AS \"UserId\", CASE WHEN \"t107\".\"EXPR$0\" IS NOT NULL THEN \"t107\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t88\".\"USERID\"\nFROM (SELECT MIN(\"t84\".\"Id\") AS \"USERID\", \"t84\".\"DisplayName\" AS \"DISPLAYNAME\", COUNT(DISTINCT \"Posts12\".\"Id\") AS \"TOTALPOSTS\", SUM(\"Posts12\".\"Score\") AS \"TOTALSCORE\", SUM(\"t84\".\"UpVotes\") AS \"UPVOTECOUNT\", SUM(\"t84\".\"DownVotes\") AS \"DOWNVOTECOUNT\", AVG(CASE WHEN \"t84\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t84\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END) AS \"AVGCOMMENTSPERPOST\"\nFROM (SELECT \"Users5\".\"Id\", \"Users5\".\"Reputation\", \"Users5\".\"CreationDate\", \"Users5\".\"DisplayName\", \"Users5\".\"LastAccessDate\", \"Users5\".\"WebsiteUrl\", \"Users5\".\"Location\", \"Users5\".\"AboutMe\", \"Users5\".\"Views\", \"Users5\".\"UpVotes\", \"Users5\".\"DownVotes\", \"Users5\".\"ProfileImageUrl\", \"Users5\".\"AccountId\", \"t83\".\"POSTID\", \"t83\".\"TITLE\", \"t83\".\"SCORE\", \"t83\".\"CREATIONDATE\", \"t83\".\"OWNERUSERID\", \"t83\".\"RAN\", \"t83\".\"COMMENTCOUNT\"\nFROM (SELECT \"t82\".\"Id\" AS \"POSTID\", \"t82\".\"Title\" AS \"TITLE\", \"t82\".\"Score\" AS \"SCORE\", \"t82\".\"CreationDate\" AS \"CREATIONDATE\", \"t82\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t82\".\"OwnerUserId\" ORDER BY \"t82\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t81\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t81\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t81\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t82\" ON \"t81\".\"PostId\" = \"t82\".\"Id\") AS \"t83\"\nRIGHT JOIN \"Users\" AS \"Users5\" ON \"t83\".\"OWNERUSERID\" = \"Users5\".\"Id\") AS \"t84\"\nLEFT JOIN \"Posts\" AS \"Posts12\" ON \"t84\".\"Id\" = \"Posts12\".\"OwnerUserId\"\nGROUP BY \"t84\".\"Id\", \"t84\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts12\".\"Id\") > 0) AS \"t88\"\nLEFT JOIN (SELECT \"t98\".\"USERID\" AS \"UserId\", CASE WHEN \"t101\".\"EXPR$0\" IS NOT NULL THEN \"t101\".\"EXPR$0\" ELSE 0 END AS \"EXPR$0\"\nFROM (SELECT \"t97\".\"USERID\"\nFROM (SELECT MIN(\"t93\".\"Id\") AS \"USERID\"\nFROM (SELECT \"Users6\".\"Id\", \"Users6\".\"Reputation\", \"Users6\".\"CreationDate\", \"Users6\".\"DisplayName\", \"Users6\".\"LastAccessDate\", \"Users6\".\"WebsiteUrl\", \"Users6\".\"Location\", \"Users6\".\"AboutMe\", \"Users6\".\"Views\", \"Users6\".\"UpVotes\", \"Users6\".\"DownVotes\", \"Users6\".\"ProfileImageUrl\", \"Users6\".\"AccountId\", \"t92\".\"POSTID\", \"t92\".\"TITLE\", \"t92\".\"SCORE\", \"t92\".\"CREATIONDATE\", \"t92\".\"OWNERUSERID\", \"t92\".\"RAN\", \"t92\".\"COMMENTCOUNT\"\nFROM (SELECT \"t91\".\"Id\" AS \"POSTID\", \"t91\".\"Title\" AS \"TITLE\", \"t91\".\"Score\" AS \"SCORE\", \"t91\".\"CreationDate\" AS \"CREATIONDATE\", \"t91\".\"OwnerUserId\" AS \"OWNERUSERID\", RANK() OVER (PARTITION BY \"t91\".\"OwnerUserId\" ORDER BY \"t91\".\"Score\" DESC NULLS FIRST) AS \"RAN\", CASE WHEN \"t90\".\"COMMENTCOUNT\" IS NOT NULL THEN CAST(\"t90\".\"COMMENTCOUNT\" AS BIGINT) ELSE 0 END AS \"COMMENTCOUNT\"\nFROM (SELECT \"PostId\", COUNT(*) AS \"COMMENTCOUNT\"\nFROM \"Comments\"\nGROUP BY \"PostId\") AS \"t90\"\nRIGHT JOIN (SELECT *\nFROM \"Posts\"\nWHERE \"CreationDate\" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)) AS \"t91\" ON \"t90\".\"PostId\" = \"t91\".\"Id\") AS \"t92\"\nRIGHT JOIN \"Users\" AS \"Users6\" ON \"t92\".\"OWNERUSERID\" = \"Users6\".\"Id\") AS \"t93\"\nLEFT JOIN \"Posts\" AS \"Posts14\" ON \"t93\".\"Id\" = \"Posts14\".\"OwnerUserId\"\nGROUP BY \"t93\".\"Id\", \"t93\".\"DisplayName\"\nHAVING COUNT(DISTINCT \"Posts14\".\"Id\") > 0) AS \"t97\"\nGROUP BY \"t97\".\"USERID\") AS \"t98\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 1\nGROUP BY \"UserId\") AS \"t101\" ON \"t98\".\"USERID\" IS NOT DISTINCT FROM \"t101\".\"UserId\") AS \"t102\" ON \"t88\".\"USERID\" = \"t102\".\"UserId\"\nGROUP BY \"t88\".\"USERID\") AS \"t104\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"Badges\"\nWHERE CAST(\"Class\" AS INTEGER) = 2\nGROUP BY \"UserId\") AS \"t107\" ON \"t104\".\"USERID\" IS NOT DISTINCT FROM \"t107\".\"UserId\") AS \"t108\" ON \"t79\".\"USERID\" = \"t108\".\"UserId\"\nGROUP BY \"t79\".\"USERID\") AS \"t110\"\nLEFT JOIN (SELECT \"UserId\", COUNT(*) AS \"EXPR$0\"\nFROM \"s1\"\nGROUP BY \"UserId\") AS \"t111\" ON \"t110\".\"USERID\" IS NOT DISTINCT FROM \"t111\".\"UserId\") AS \"t112\" ON \"t55\".\"USERID\" = \"t112\".\"UserId\"\nORDER BY \"t55\".\"TOTALSCORE\" DESC NULLS FIRST, \"t55\".\"DISPLAYNAME\"\nOFFSET 0 ROWS\nLIMIT 100) AS \"t115\"",
        "inputs" : {
          "s1" : "q1"
        },
        "schema" : [ {
          "name" : "USERID",
          "type" : "INTEGER"
        }, {
          "name" : "DISPLAYNAME",
          "type" : "VARCHAR"
        }, {
          "name" : "TOTALPOSTS",
          "type" : "BIGINT"
        }, {
          "name" : "TOTALSCORE",
          "type" : "INTEGER"
        }, {
          "name" : "UPVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "DOWNVOTECOUNT",
          "type" : "INTEGER"
        }, {
          "name" : "AVGCOMMENTSPERPOST",
          "type" : "BIGINT"
        }, {
          "name" : "SCORECATEGORY",
          "type" : "CHAR"
        }, {
          "name" : "GOLDBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "SILVERBADGES",
          "type" : "BIGINT"
        }, {
          "name" : "BRONZEBADGES",
          "type" : "BIGINT"
        } ]
      } ]
    }
  } ]
}