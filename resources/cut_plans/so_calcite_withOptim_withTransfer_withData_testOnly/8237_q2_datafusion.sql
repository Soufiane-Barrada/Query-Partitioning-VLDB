SELECT COALESCE("t13"."USERID", "t13"."USERID") AS "USERID", "t13"."DISPLAYNAME", "t13"."POSTCOUNT", "t13"."QUESTIONCOUNT", "t13"."ANSWERCOUNT", "t13"."UPVOTECOUNT", "t13"."DOWNVOTECOUNT", "t13"."BADGECOUNT", "t13"."GOLDBADGES", "t13"."SILVERBADGES", "t13"."BRONZEBADGES", "t13"."TOTALPOSTS", "t13"."AVGCOMMENTSPERPOST", "t13"."MAXVIEWS", "t13"."FIRSTPOSTDATE", "t13"."LASTPOSTDATE"
FROM (SELECT "t9"."USERID", "t9"."DISPLAYNAME", "t9"."POSTCOUNT", "t9"."QUESTIONCOUNT", "t9"."ANSWERCOUNT", "t9"."UPVOTECOUNT", "t9"."DOWNVOTECOUNT", "t11"."BADGECOUNT", "t11"."GOLDBADGES", "t11"."SILVERBADGES", "t11"."BRONZEBADGES", "s1"."TOTALPOSTS", "s1"."AVGCOMMENTSPERPOST", "s1"."MAXVIEWS", "s1"."FIRSTPOSTDATE", "s1"."LASTPOSTDATE"
FROM (SELECT ANY_VALUE("t6"."Id") AS "USERID", "t6"."DisplayName" AS "DISPLAYNAME", COUNT(DISTINCT "t6"."Id0") AS "POSTCOUNT", SUM(CASE WHEN CAST("t6"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONCOUNT", SUM(CASE WHEN CAST("t6"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERCOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTECOUNT"
FROM "STACK"."Votes"
RIGHT JOIN (SELECT "Users"."Id", "Users"."Reputation", "Users"."CreationDate", "Users"."DisplayName", "Users"."LastAccessDate", "Users"."WebsiteUrl", "Users"."Location", "Users"."AboutMe", "Users"."Views", "Users"."UpVotes", "Users"."DownVotes", "Users"."ProfileImageUrl", "Users"."AccountId", "Posts1"."Id" AS "Id0", "Posts1"."PostTypeId", "Posts1"."AcceptedAnswerId", "Posts1"."ParentId", "Posts1"."CreationDate" AS "CreationDate0", "Posts1"."Score", "Posts1"."ViewCount", "Posts1"."Body", "Posts1"."OwnerUserId", "Posts1"."OwnerDisplayName", "Posts1"."LastEditorUserId", "Posts1"."LastEditorDisplayName", "Posts1"."LastEditDate", "Posts1"."LastActivityDate", "Posts1"."Title", "Posts1"."Tags", "Posts1"."AnswerCount", "Posts1"."CommentCount", "Posts1"."FavoriteCount", "Posts1"."ClosedDate", "Posts1"."CommunityOwnedDate", "Posts1"."ContentLicense"
FROM "STACK"."Posts" AS "Posts1"
RIGHT JOIN "STACK"."Users" ON "Posts1"."OwnerUserId" = "Users"."Id") AS "t6" ON "Votes"."PostId" = "t6"."Id0"
GROUP BY "t6"."Id", "t6"."DisplayName") AS "t9"
LEFT JOIN (SELECT "UserId" AS "USERID", COUNT(*) AS "BADGECOUNT", SUM(CASE WHEN CAST("Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES"
FROM "STACK"."Badges"
GROUP BY "UserId") AS "t11" ON "t9"."USERID" = "t11"."USERID"
LEFT JOIN "s1" ON "t9"."USERID" = "s1"."OWNERUSERID"
ORDER BY "t9"."POSTCOUNT" DESC NULLS FIRST, "t9"."UPVOTECOUNT" DESC NULLS FIRST
FETCH NEXT 100 ROWS ONLY) AS "t13"