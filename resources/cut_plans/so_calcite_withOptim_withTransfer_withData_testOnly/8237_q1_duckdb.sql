SELECT COALESCE("Posts"."OwnerUserId", "Posts"."OwnerUserId") AS "OWNERUSERID", COUNT(DISTINCT "Posts"."Id") AS "TOTALPOSTS", AVG(CASE WHEN CASE WHEN "t2"."EXPR$0" IS NULL THEN 0 ELSE "t2"."EXPR$0" END IS NOT NULL THEN CAST(CASE WHEN "t2"."EXPR$0" IS NULL THEN 0 ELSE "t2"."EXPR$0" END AS BIGINT) ELSE 0 END) AS "AVGCOMMENTSPERPOST", MAX("Posts"."ViewCount") AS "MAXVIEWS", MIN("Posts"."CreationDate") AS "FIRSTPOSTDATE", MAX("Posts"."CreationDate") AS "LASTPOSTDATE"
FROM "STACK"."Posts"
LEFT JOIN (SELECT "t"."Id" AS "PostId", CASE WHEN "t1"."EXPR$0" IS NOT NULL THEN "t1"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM (SELECT "Id"
FROM "STACK"."Posts") AS "t"
LEFT JOIN (SELECT "PostId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Comments"
GROUP BY "PostId") AS "t1" ON "t"."Id" IS NOT DISTINCT FROM "t1"."PostId") AS "t2" ON "Posts"."Id" = "t2"."PostId"
GROUP BY "Posts"."OwnerUserId"