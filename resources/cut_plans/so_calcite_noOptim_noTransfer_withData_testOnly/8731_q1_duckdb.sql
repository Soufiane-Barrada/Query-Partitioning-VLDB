SELECT COALESCE("Users"."DisplayName", "Users"."DisplayName") AS "DISPLAYNAME", "Users"."Reputation" AS "REPUTATION", "t1"."BADGECOUNT", "t3"."POSTCOUNT", "t3"."QUESTIONCOUNT", "t3"."ANSWERCOUNT", "t3"."TOTALVIEWS", "t5"."EDITCOUNT", "t5"."TITLEANDBODYEDITS"
FROM "STACK"."Users"
LEFT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", COUNT("Badges"."Id") AS "BADGECOUNT"
FROM "STACK"."Users" AS "Users0"
LEFT JOIN "STACK"."Badges" ON "Users0"."Id" = "Badges"."UserId"
GROUP BY "Users0"."Id") AS "t1" ON "Users"."Id" = "t1"."USERID"
LEFT JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(*) AS "POSTCOUNT", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONCOUNT", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t3" ON "Users"."Id" = "t3"."OWNERUSERID"
LEFT JOIN (SELECT "UserId" AS "USERID", COUNT(*) AS "EDITCOUNT", SUM(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (4, 5, 6) THEN 1 ELSE 0 END) AS "TITLEANDBODYEDITS"
FROM "STACK"."PostHistory"
GROUP BY "UserId") AS "t5" ON "Users"."Id" = "t5"."USERID"
WHERE "Users"."Reputation" > 1000