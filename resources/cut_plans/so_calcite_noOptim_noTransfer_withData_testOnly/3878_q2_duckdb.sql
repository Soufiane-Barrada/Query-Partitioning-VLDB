SELECT COALESCE("t6"."DISPLAYNAME", "t6"."DISPLAYNAME") AS "USERNAME", "t8"."QUESTIONCOUNT", "t8"."ANSWERCOUNT", "t8"."TOTALVIEWS", "t8"."TOTALSCORE", "s1"."TITLE" AS "RECENTPOSTTITLE", "s1"."POSTSTATUS", "t10"."CLOSEREASON", "t10"."CLOSEDATE", "t10"."CLOSEDBY"
FROM (SELECT "t2"."ID", "t2"."DISPLAYNAME", "t2"."REPUTATION"
FROM (SELECT "Id" AS "ID", "DisplayName" AS "DISPLAYNAME", "Reputation" AS "REPUTATION", ROW_NUMBER() OVER (ORDER BY "Reputation" DESC NULLS FIRST) AS "RANKING"
FROM "STACK"."Users") AS "t2"
INNER JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t4" ON "t2"."ID" = "t4"."OWNERUSERID"
WHERE "t4"."QUESTIONCOUNT" + "t4"."ANSWERCOUNT" > 10) AS "t6"
LEFT JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t8" ON "t6"."ID" = "t8"."OWNERUSERID"
LEFT JOIN "s1" ON "t8"."OWNERUSERID" = "s1"."ID"
LEFT JOIN (SELECT "PostHistory"."PostId" AS "POSTID", "PostHistory"."Comment" AS "CLOSEREASON", "PostHistory"."CreationDate" AS "CLOSEDATE", "Users0"."DisplayName" AS "CLOSEDBY"
FROM "STACK"."PostHistory"
INNER JOIN "STACK"."Users" AS "Users0" ON "PostHistory"."UserId" = "Users0"."Id"
WHERE CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) = 10) AS "t10" ON "s1"."ID" = "t10"."POSTID"
WHERE "t8"."TOTALVIEWS" > 1000
ORDER BY "t8"."TOTALSCORE" DESC NULLS FIRST, "t8"."TOTALVIEWS" DESC NULLS FIRST