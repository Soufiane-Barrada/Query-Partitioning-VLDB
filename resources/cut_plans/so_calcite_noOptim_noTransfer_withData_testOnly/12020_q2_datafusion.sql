SELECT COALESCE("t4"."POSTTYPEID", "t4"."POSTTYPEID") AS "POSTTYPEID", "t4"."POSTCOUNT", "t4"."AVGSCORE", "t4"."TOTALVIEWS", "t4"."TOTALANSWERS", "t4"."TOTALCOMMENTS", "t4"."TOTALFAVORITES", "t4"."LASTPOSTDATE", SUM("t6"."TOTALPOSTS") AS "TOTALUSERPOSTS", AVG("t6"."REPUTATION") AS "AVGUSERREPUTATION", SUM("t6"."TOTALUPVOTES") AS "TOTALUSERUPVOTES", SUM("t6"."TOTALDOWNVOTES") AS "TOTALUSERDOWNVOTES"
FROM (SELECT "PostTypeId" AS "POSTTYPEID", COUNT(*) AS "POSTCOUNT", AVG("Score") AS "AVGSCORE", SUM("ViewCount") AS "TOTALVIEWS", SUM("AnswerCount") AS "TOTALANSWERS", SUM("CommentCount") AS "TOTALCOMMENTS", SUM("FavoriteCount") AS "TOTALFAVORITES", MAX("CreationDate") AS "LASTPOSTDATE", COUNT(*) > 0 AS "$f8"
FROM "STACK"."Posts"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)
GROUP BY "PostTypeId") AS "t4"
INNER JOIN (SELECT ANY_VALUE("Id") AS "USERID", "REPUTATION", COUNT(DISTINCT "Id0") AS "TOTALPOSTS", SUM("FD_COL_3") AS "TOTALUPVOTES", SUM("FD_COL_4") AS "TOTALDOWNVOTES"
FROM "s1"
GROUP BY "Id", "REPUTATION") AS "t6" ON "t4"."$f8"
GROUP BY "t4"."POSTTYPEID", "t4"."POSTCOUNT", "t4"."AVGSCORE", "t4"."TOTALVIEWS", "t4"."TOTALANSWERS", "t4"."TOTALCOMMENTS", "t4"."TOTALFAVORITES", "t4"."LASTPOSTDATE"
ORDER BY "t4"."POSTTYPEID"