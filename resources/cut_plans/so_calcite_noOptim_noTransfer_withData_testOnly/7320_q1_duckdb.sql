SELECT COALESCE("USERID", "USERID") AS "USERID", "DISPLAYNAME", "REPUTATION", "UPVOTES", "DOWNVOTES", "USERTOTALPOSTS", "AVERAGESCORE", "TIMESCLOSED", "TIMESREOPENED", "HOTQUESTIONCHANGES"
FROM (SELECT "Users0"."Id" AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", "Users0"."Reputation" AS "REPUTATION", "t1"."UPVOTES", "t1"."DOWNVOTES", "t3"."TOTALPOSTS" AS "USERTOTALPOSTS", "t3"."AVERAGESCORE", "t3"."TIMESCLOSED", "t3"."TIMESREOPENED", "t3"."HOTQUESTIONCHANGES"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", "Users"."DisplayName" AS "DISPLAYNAME", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES", COUNT(DISTINCT "Posts"."Id") AS "TOTALPOSTS"
FROM "STACK"."Users"
LEFT JOIN "STACK"."Votes" ON "Users"."Id" = "Votes"."UserId"
LEFT JOIN "STACK"."Posts" ON "Votes"."PostId" = "Posts"."Id"
GROUP BY "Users"."Id", "Users"."DisplayName") AS "t1"
INNER JOIN (SELECT "Posts0"."OwnerUserId" AS "OWNERUSERID", COUNT(*) AS "TOTALPOSTS", AVG("Posts0"."Score") AS "AVERAGESCORE", SUM(CASE WHEN CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) = 10 THEN 1 ELSE 0 END) AS "TIMESCLOSED", SUM(CASE WHEN CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) = 11 THEN 1 ELSE 0 END) AS "TIMESREOPENED", SUM(CASE WHEN CAST("PostHistory"."PostHistoryTypeId" AS INTEGER) IN (52, 53) THEN 1 ELSE 0 END) AS "HOTQUESTIONCHANGES"
FROM "STACK"."Posts" AS "Posts0"
LEFT JOIN "STACK"."PostHistory" ON "Posts0"."Id" = "PostHistory"."PostId"
GROUP BY "Posts0"."OwnerUserId") AS "t3" ON "t1"."USERID" = "t3"."OWNERUSERID"
INNER JOIN "STACK"."Users" AS "Users0" ON "t3"."OWNERUSERID" = "Users0"."Id") AS "t4"
WHERE "t4"."REPUTATION" > 1000