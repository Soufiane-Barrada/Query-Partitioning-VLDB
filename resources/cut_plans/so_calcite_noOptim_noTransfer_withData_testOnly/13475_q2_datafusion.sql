SELECT COALESCE("POSTTYPE", "POSTTYPE") AS "POSTTYPE", "TOTALPOSTS", "TOTALVOTES", "TOTALUSERS", "VOTESPERPOST", "USERSPERPOST"
FROM (SELECT ANY_VALUE("Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", COUNT(DISTINCT "UserId") AS "TOTALVOTES", COUNT(DISTINCT "Id2") AS "TOTALUSERS", CAST(COUNT(DISTINCT "UserId") AS DECIMAL(19, 1)) / CASE WHEN COUNT(*) = 0 THEN NULL ELSE COUNT(*) END AS "VOTESPERPOST", CAST(COUNT(DISTINCT "Id2") AS DECIMAL(19, 1)) / CASE WHEN COUNT(*) = 0 THEN NULL ELSE COUNT(*) END AS "USERSPERPOST"
FROM "s1"
GROUP BY "Name"
ORDER BY 2 DESC NULLS FIRST) AS "t3"