SELECT COALESCE("t6"."POSTTYPE", "t6"."POSTTYPE") AS "POSTTYPE", "t6"."TOTALPOSTS", "t6"."AVGCOMMENTS", "t6"."AVGVOTES", "t6"."AVGOWNERREPUTATION"
FROM (SELECT ANY_VALUE("PostTypes"."Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", AVG("t2"."COMMENTCOUNT") AS "AVGCOMMENTS", AVG("t2"."VOTECOUNT") AS "AVGVOTES", AVG("t2"."AVGUSERREPUTATION") AS "AVGOWNERREPUTATION"
FROM (SELECT ANY_VALUE("Id") AS "POSTID", "POSTTYPEID", "CREATIONDATE", COUNT("FD_COL_3") AS "COMMENTCOUNT", COUNT("Id1") AS "VOTECOUNT", AVG("Reputation") AS "AVGUSERREPUTATION"
FROM "s1"
GROUP BY "Id", "POSTTYPEID", "CREATIONDATE") AS "t2"
INNER JOIN "STACK"."PostTypes" ON "t2"."POSTTYPEID" = "PostTypes"."Id"
GROUP BY "PostTypes"."Name"
ORDER BY 2 DESC NULLS FIRST) AS "t6"