SELECT COALESCE("t6"."POSTID", "t6"."POSTID") AS "POSTID", "t6"."TITLE", "t6"."SCORE", "t6"."VIEWCOUNT", "t6"."ANSWERCOUNT", "t8"."CLOSEREOPENCOUNT", "t8"."DELETEUNDELETECOUNT", "t8"."LASTEDITED", CASE WHEN "t8"."CLOSEREOPENCOUNT" > 2 THEN 'Frequently Closed/Reopened' ELSE 'Rarely Closed/Reopened    ' END AS "CLOSURESTATUS"
FROM (SELECT "s1"."POSTID", "s1"."TITLE", "s1"."SCORE", "s1"."VIEWCOUNT", "s1"."ANSWERCOUNT", "t4"."BADGECOUNT"
FROM "s1"
INNER JOIN (SELECT ANY_VALUE("Users"."Id") AS "USERID", "Users"."DisplayName" AS "DISPLAYNAME", COUNT(DISTINCT "Badges"."Id") AS "BADGECOUNT"
FROM "STACK"."Users"
LEFT JOIN "STACK"."Badges" ON "Users"."Id" = "Badges"."UserId"
GROUP BY "Users"."Id", "Users"."DisplayName") AS "t4" ON "s1"."OWNERUSERID" = "t4"."USERID"
WHERE "s1"."SCORE" > 10 AND "t4"."BADGECOUNT" > 5) AS "t6"
INNER JOIN (SELECT "PostId" AS "POSTID", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (10, 11) THEN 1 ELSE NULL END) AS "CLOSEREOPENCOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (12, 13) THEN 1 ELSE NULL END) AS "DELETEUNDELETECOUNT", MAX("CreationDate") AS "LASTEDITED"
FROM "STACK"."PostHistory"
GROUP BY "PostId") AS "t8" ON "t6"."POSTID" = "t8"."POSTID"
ORDER BY "t6"."SCORE" DESC NULLS FIRST, "t6"."VIEWCOUNT" DESC NULLS FIRST