SELECT COALESCE("t15"."USERNAME", "t15"."USERNAME") AS "USERNAME", "t15"."QUESTIONCOUNT", "t15"."ANSWERCOUNT", "t15"."TOTALVIEWS", "t15"."TOTALSCORE", "t15"."RECENTPOSTTITLE", "t15"."POSTSTATUS", "t15"."CLOSEREASON", "t15"."CLOSEDATE", "t15"."CLOSEDBY"
FROM (SELECT "t13"."DISPLAYNAME" AS "USERNAME", "t13"."QUESTIONCOUNT", "t13"."ANSWERCOUNT", "t13"."TOTALVIEWS", "t13"."TOTALSCORE", "t13"."TITLE" AS "RECENTPOSTTITLE", "t13"."POSTSTATUS", "t3"."CLOSEREASON", "t3"."CLOSEDATE", "t3"."CLOSEDBY"
FROM (SELECT "t2"."PostId" AS "POSTID", "t2"."Comment" AS "CLOSEREASON", "t2"."CreationDate" AS "CLOSEDATE", "Users"."DisplayName" AS "CLOSEDBY"
FROM (SELECT *
FROM "STACK"."PostHistory"
WHERE CAST("PostHistoryTypeId" AS INTEGER) = 10) AS "t2"
INNER JOIN "STACK"."Users" ON "t2"."UserId" = "Users"."Id") AS "t3"
RIGHT JOIN (SELECT "t12"."ID", "t12"."DISPLAYNAME", "t12"."REPUTATION", "t12"."OWNERUSERID", "t12"."QUESTIONCOUNT", "t12"."ANSWERCOUNT", "t12"."TOTALVIEWS", "t12"."TOTALSCORE", "s1"."ID" AS "ID0", "s1"."TITLE", "s1"."CREATIONDATE", "s1"."POSTSTATUS"
FROM "s1"
RIGHT JOIN (SELECT "t8"."ID", "t8"."DISPLAYNAME", "t8"."REPUTATION", CAST("t11"."OWNERUSERID" AS INTEGER) AS "OWNERUSERID", CAST("t11"."QUESTIONCOUNT" AS BIGINT) AS "QUESTIONCOUNT", CAST("t11"."ANSWERCOUNT" AS BIGINT) AS "ANSWERCOUNT", CAST("t11"."TOTALVIEWS" AS INTEGER) AS "TOTALVIEWS", CAST("t11"."TOTALSCORE" AS INTEGER) AS "TOTALSCORE"
FROM (SELECT "t7"."ID", "t7"."DISPLAYNAME", "t7"."REPUTATION"
FROM (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) + COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) > 10) AS "t6"
INNER JOIN (SELECT "Id" AS "ID", "DisplayName" AS "DISPLAYNAME", "Reputation" AS "REPUTATION", ROW_NUMBER() OVER (ORDER BY "Reputation" DESC NULLS FIRST) AS "RANKING"
FROM "STACK"."Users") AS "t7" ON "t6"."OWNERUSERID" = "t7"."ID") AS "t8"
INNER JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "TOTALVIEWS", SUM("Score") AS "TOTALSCORE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING SUM("ViewCount") > 1000) AS "t11" ON "t8"."ID" = "t11"."OWNERUSERID") AS "t12" ON "s1"."ID" = "t12"."OWNERUSERID") AS "t13" ON "t3"."POSTID" = "t13"."ID0"
ORDER BY "t13"."TOTALSCORE" DESC NULLS FIRST, "t13"."TOTALVIEWS" DESC NULLS FIRST) AS "t15"