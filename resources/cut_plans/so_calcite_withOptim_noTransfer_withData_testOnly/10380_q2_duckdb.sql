SELECT COALESCE("t3"."POSTTYPE", "t3"."POSTTYPE") AS "POSTTYPE", "t3"."TOTALPOSTS", "t3"."TOTALVIEWS", "t3"."AVERAGESCORE", "t3"."UNIQUEUSERS", "t3"."TOTALQUESTIONS", "t3"."TOTALANSWERS", "t3"."TOTALTAGWIKIS", "t3"."TOTALCLOSEDPOSTS", "t3"."AVERAGEUSERREPUTATION"
FROM (SELECT "PostTypes"."Name", ANY_VALUE("PostTypes"."Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", SUM("s1"."ViewCount") AS "TOTALVIEWS", AVG("s1"."Score") AS "AVERAGESCORE", COUNT(DISTINCT "s1"."OwnerUserId") AS "UNIQUEUSERS", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "TOTALQUESTIONS", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "TOTALANSWERS", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 4 THEN 1 ELSE 0 END) AS "TOTALTAGWIKIS", SUM(CASE WHEN CAST("s1"."PostTypeId" AS INTEGER) = 10 THEN 1 ELSE 0 END) AS "TOTALCLOSEDPOSTS", AVG("Users"."Reputation") AS "AVERAGEUSERREPUTATION"
FROM "STACK"."PostTypes"
INNER JOIN ("STACK"."Users" INNER JOIN "s1" ON "Users"."Id" = "s1"."OwnerUserId") ON "PostTypes"."Id" = "s1"."PostTypeId"
GROUP BY "PostTypes"."Name"
ORDER BY 3 DESC NULLS FIRST) AS "t3"