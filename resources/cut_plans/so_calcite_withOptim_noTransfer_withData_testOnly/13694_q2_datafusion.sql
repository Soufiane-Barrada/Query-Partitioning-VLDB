SELECT COALESCE("USERID", "USERID") AS "USERID", "DISPLAYNAME", "POSTCOUNT", "TOTALSCORE", "TOTALVIEWS", "QUESTIONCOUNT", "ANSWERCOUNT", "TOTALCOMMENTS"
FROM (SELECT ANY_VALUE("Id") AS "USERID", "DISPLAYNAME", COUNT("Id0") AS "POSTCOUNT", CASE WHEN SUM("Score") IS NOT NULL THEN CAST(SUM("Score") AS INTEGER) ELSE 0 END AS "TOTALSCORE", CASE WHEN SUM("ViewCount") IS NOT NULL THEN CAST(SUM("ViewCount") AS INTEGER) ELSE 0 END AS "TOTALVIEWS", SUM("FD_COL_5") AS "QUESTIONCOUNT", SUM("FD_COL_6") AS "ANSWERCOUNT", CASE WHEN SUM("CommentCount") IS NOT NULL THEN CAST(SUM("CommentCount") AS INTEGER) ELSE 0 END AS "TOTALCOMMENTS"
FROM "s1"
GROUP BY "Id", "DISPLAYNAME"
ORDER BY 4 DESC NULLS FIRST, 3 DESC NULLS FIRST) AS "t3"