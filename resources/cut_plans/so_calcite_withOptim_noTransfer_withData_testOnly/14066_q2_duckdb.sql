SELECT COALESCE("t2"."QUESTIONID", "t2"."QUESTIONID") AS "QUESTIONID", "t2"."QUESTIONSCORE", "t2"."QUESTIONVIEWS", "t2"."ANSWERCOUNT", CASE WHEN "t2"."$f7" IS NOT NULL THEN CAST("t2"."$f7" AS INTEGER) ELSE 0 END AS "AVERAGEANSWERSCORE", CASE WHEN "t2"."$f8" IS NOT NULL THEN CAST("t2"."$f8" AS INTEGER) ELSE 0 END AS "AVERAGEANSWERVIEWS"
FROM (SELECT "s1"."Id" AS "Id0", "s1"."Score" AS "Score0", "s1"."ViewCount" AS "ViewCount0", ANY_VALUE("s1"."Id") AS "QUESTIONID", ANY_VALUE("s1"."Score") AS "QUESTIONSCORE", ANY_VALUE("s1"."ViewCount") AS "QUESTIONVIEWS", COUNT("Posts0"."Id") AS "ANSWERCOUNT", AVG("Posts0"."Score") AS "$f7", AVG("Posts0"."ViewCount") AS "$f8"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "s1" ON "Posts0"."ParentId" = "s1"."Id"
GROUP BY "s1"."Id", "s1"."Score", "s1"."ViewCount"
ORDER BY 4) AS "t2"