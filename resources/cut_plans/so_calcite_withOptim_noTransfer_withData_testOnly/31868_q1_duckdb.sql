SELECT COALESCE("t7"."USERID", "t7"."USERID") AS "USERID", "t7"."DISPLAYNAME", "t7"."POSTCOUNT" AS "TOTALPOSTS", CASE WHEN "t7"."VOTECOUNT" IS NOT NULL THEN CAST("t7"."VOTECOUNT" AS BIGINT) ELSE 0 END AS "TOTALVOTES", CASE WHEN "t7"."UPVOTES" IS NOT NULL THEN CAST("t7"."UPVOTES" AS INTEGER) ELSE 0 END AS "TOTALUPVOTES", CASE WHEN "t7"."DOWNVOTES" IS NOT NULL THEN CAST("t7"."DOWNVOTES" AS INTEGER) ELSE 0 END AS "TOTALDOWNVOTES", CASE WHEN "t0"."BADGECOUNT" IS NOT NULL THEN CAST("t0"."BADGECOUNT" AS BIGINT) ELSE 0 END AS "TOTALBADGES", CASE WHEN "t0"."HIGHESTBADGELEVEL" IS NOT NULL THEN CAST("t0"."HIGHESTBADGELEVEL" AS INTEGER) ELSE 0 END AS "HIGHESTBADGELEVEL", CASE WHEN CAST("t0"."HIGHESTBADGELEVEL" AS INTEGER) = 1 THEN 'Gold    ' WHEN CAST("t0"."HIGHESTBADGELEVEL" AS INTEGER) = 2 THEN 'Silver  ' WHEN CAST("t0"."HIGHESTBADGELEVEL" AS INTEGER) = 3 THEN 'Bronze  ' ELSE 'No Badge' END AS "BADGELEVELDESCRIPTION"
FROM (SELECT ANY_VALUE("Users"."Id") AS "USERID", COUNT("Badges"."Id") AS "BADGECOUNT", MAX("Badges"."Class") AS "HIGHESTBADGELEVEL"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id"
GROUP BY "Users"."Id") AS "t0"
RIGHT JOIN (SELECT "t6"."USERID", "t6"."DISPLAYNAME", "t6"."POSTCOUNT", "t6"."USERRANK", "t3"."POSTID", "t3"."VOTECOUNT", "t3"."UPVOTES", "t3"."DOWNVOTES"
FROM (SELECT ANY_VALUE("Posts"."Id") AS "POSTID", COUNT("Votes"."Id") AS "VOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."Votes"
RIGHT JOIN "STACK"."Posts" ON "Votes"."PostId" = "Posts"."Id"
GROUP BY "Posts"."Id") AS "t3"
RIGHT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", COUNT("Posts0"."Id") AS "POSTCOUNT", RANK() OVER (ORDER BY COUNT("Posts0"."Id") DESC NULLS FIRST) AS "USERRANK"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Posts0"."OwnerUserId" = "Users0"."Id"
GROUP BY "Users0"."Id", "Users0"."DisplayName"
HAVING COUNT("Posts0"."Id") > 0) AS "t6" ON "t3"."POSTID" = "t6"."USERID") AS "t7" ON "t0"."USERID" = "t7"."USERID"