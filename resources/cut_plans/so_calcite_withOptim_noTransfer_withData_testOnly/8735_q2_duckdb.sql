SELECT COALESCE("t10"."POSTID", "t10"."POSTID") AS "POSTID", "t10"."TITLE", "t10"."POSTCREATIONDATE", "t10"."OWNERDISPLAYNAME", "t10"."COMMENTCOUNT", "t10"."ANSWERCOUNT", "t10"."UPVOTES", "t10"."DOWNVOTES", "t10"."CLOSECOUNT", "t10"."REOPENCOUNT", "t10"."DELETECOUNT", "t10"."UNDELETECOUNT"
FROM (SELECT "t6"."POSTID", "t6"."TITLE", "t6"."POSTCREATIONDATE", "t6"."OWNERDISPLAYNAME", "t6"."COMMENTCOUNT", "t6"."ANSWERCOUNT", "t6"."UPVOTES", "t6"."DOWNVOTES", CASE WHEN "t8"."CLOSECOUNT" IS NOT NULL THEN CAST("t8"."CLOSECOUNT" AS BIGINT) ELSE 0 END AS "CLOSECOUNT", CASE WHEN "t8"."REOPENCOUNT" IS NOT NULL THEN CAST("t8"."REOPENCOUNT" AS BIGINT) ELSE 0 END AS "REOPENCOUNT", CASE WHEN "t8"."DELETECOUNT" IS NOT NULL THEN CAST("t8"."DELETECOUNT" AS BIGINT) ELSE 0 END AS "DELETECOUNT", CASE WHEN "t8"."UNDELETECOUNT" IS NOT NULL THEN CAST("t8"."UNDELETECOUNT" AS BIGINT) ELSE 0 END AS "UNDELETECOUNT"
FROM (SELECT ANY_VALUE("t3"."Id") AS "POSTID", "t3"."Title" AS "TITLE", ANY_VALUE("t3"."CreationDate") AS "POSTCREATIONDATE", "t3"."OwnerUserId" AS "OWNERUSERID", ANY_VALUE("Users"."DisplayName") AS "OWNERDISPLAYNAME", COUNT(CASE WHEN "t3"."Id0" IS NOT NULL THEN 1 ELSE NULL END) AS "COMMENTCOUNT", COUNT(CASE WHEN "t3"."Id1" IS NOT NULL THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM(CASE WHEN CAST("t3"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN CAST("t3"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."Users"
INNER JOIN (SELECT "t2"."Id", "t2"."PostTypeId", "t2"."AcceptedAnswerId", "t2"."ParentId", "t2"."CreationDate", "t2"."Score", "t2"."ViewCount", "t2"."Body", "t2"."OwnerUserId", "t2"."OwnerDisplayName", "t2"."LastEditorUserId", "t2"."LastEditorDisplayName", "t2"."LastEditDate", "t2"."LastActivityDate", "t2"."Title", "t2"."Tags", "t2"."AnswerCount", "t2"."CommentCount", "t2"."FavoriteCount", "t2"."ClosedDate", "t2"."CommunityOwnedDate", "t2"."ContentLicense", "t2"."Id0", "t2"."PostId", "t2"."Score0", "t2"."Text", "t2"."CreationDate0", "t2"."UserDisplayName", "t2"."UserId", "t2"."ContentLicense0", "t2"."Id1", "t2"."PostTypeId0", "t2"."AcceptedAnswerId0", "t2"."ParentId0", "t2"."CreationDate1", "t2"."Score1", "t2"."ViewCount0", "t2"."Body0", "t2"."OwnerUserId0", "t2"."OwnerDisplayName0", "t2"."LastEditorUserId0", "t2"."LastEditorDisplayName0", "t2"."LastEditDate0", "t2"."LastActivityDate0", "t2"."Title0", "t2"."Tags0", "t2"."AnswerCount0", "t2"."CommentCount0", "t2"."FavoriteCount0", "t2"."ClosedDate0", "t2"."CommunityOwnedDate0", "t2"."ContentLicense1", "Votes"."Id" AS "Id2", "Votes"."PostId" AS "PostId0", "Votes"."VoteTypeId", "Votes"."UserId" AS "UserId0", "Votes"."CreationDate" AS "CreationDate2", "Votes"."BountyAmount"
FROM "STACK"."Votes"
RIGHT JOIN (SELECT "t1"."Id", "t1"."PostTypeId", "t1"."AcceptedAnswerId", "t1"."ParentId", "t1"."CreationDate", "t1"."Score", "t1"."ViewCount", "t1"."Body", "t1"."OwnerUserId", "t1"."OwnerDisplayName", "t1"."LastEditorUserId", "t1"."LastEditorDisplayName", "t1"."LastEditDate", "t1"."LastActivityDate", "t1"."Title", "t1"."Tags", "t1"."AnswerCount", "t1"."CommentCount", "t1"."FavoriteCount", "t1"."ClosedDate", "t1"."CommunityOwnedDate", "t1"."ContentLicense", "t1"."Id0", "t1"."PostId", "t1"."Score0", "t1"."Text", "t1"."CreationDate0", "t1"."UserDisplayName", "t1"."UserId", "t1"."ContentLicense0", "Posts0"."Id" AS "Id1", "Posts0"."PostTypeId" AS "PostTypeId0", "Posts0"."AcceptedAnswerId" AS "AcceptedAnswerId0", "Posts0"."ParentId" AS "ParentId0", "Posts0"."CreationDate" AS "CreationDate1", "Posts0"."Score" AS "Score1", "Posts0"."ViewCount" AS "ViewCount0", "Posts0"."Body" AS "Body0", "Posts0"."OwnerUserId" AS "OwnerUserId0", "Posts0"."OwnerDisplayName" AS "OwnerDisplayName0", "Posts0"."LastEditorUserId" AS "LastEditorUserId0", "Posts0"."LastEditorDisplayName" AS "LastEditorDisplayName0", "Posts0"."LastEditDate" AS "LastEditDate0", "Posts0"."LastActivityDate" AS "LastActivityDate0", "Posts0"."Title" AS "Title0", "Posts0"."Tags" AS "Tags0", "Posts0"."AnswerCount" AS "AnswerCount0", "Posts0"."CommentCount" AS "CommentCount0", "Posts0"."FavoriteCount" AS "FavoriteCount0", "Posts0"."ClosedDate" AS "ClosedDate0", "Posts0"."CommunityOwnedDate" AS "CommunityOwnedDate0", "Posts0"."ContentLicense" AS "ContentLicense1"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN (SELECT "s1"."Id", "s1"."PostTypeId", "s1"."AcceptedAnswerId", "s1"."ParentId", "s1"."CreationDate", "s1"."Score", "s1"."ViewCount", "s1"."Body", "s1"."OwnerUserId", "s1"."OwnerDisplayName", "s1"."LastEditorUserId", "s1"."LastEditorDisplayName", "s1"."LastEditDate", "s1"."LastActivityDate", "s1"."Title", "s1"."Tags", "s1"."AnswerCount", "s1"."CommentCount", "s1"."FavoriteCount", "s1"."ClosedDate", "s1"."CommunityOwnedDate", "s1"."ContentLicense", "Comments"."Id" AS "Id0", "Comments"."PostId", "Comments"."Score" AS "Score0", "Comments"."Text", "Comments"."CreationDate" AS "CreationDate0", "Comments"."UserDisplayName", "Comments"."UserId", "Comments"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments"
RIGHT JOIN "s1" ON "Comments"."PostId" = "s1"."Id") AS "t1" ON "Posts0"."ParentId" = "t1"."Id") AS "t2" ON "Votes"."PostId" = "t2"."Id") AS "t3" ON "Users"."Id" = "t3"."OwnerUserId"
GROUP BY "t3"."Id", "t3"."Title", "t3"."CreationDate", "t3"."OwnerUserId", "Users"."DisplayName") AS "t6"
LEFT JOIN (SELECT "PostId" AS "POSTID", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 10 THEN 1 ELSE NULL END) AS "CLOSECOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 11 THEN 1 ELSE NULL END) AS "REOPENCOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 12 THEN 1 ELSE NULL END) AS "DELETECOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 13 THEN 1 ELSE NULL END) AS "UNDELETECOUNT"
FROM "STACK"."PostHistory"
GROUP BY "PostId") AS "t8" ON "t6"."POSTID" = "t8"."POSTID"
ORDER BY "t6"."UPVOTES" DESC NULLS FIRST, "t6"."COMMENTCOUNT" DESC NULLS FIRST) AS "t10"