SELECT COALESCE("DISPLAYNAME", "DISPLAYNAME") AS "DISPLAYNAME", "REPUTATION", "TOTALUPVOTES", "TOTALDOWNVOTES", "TOTALQUESTIONS", "TOTALANSWERS", "AVGSCORE", "TOTALVIEWS", "ENGAGEMENTCATEGORY"
FROM (SELECT "DISPLAYNAME", "REPUTATION", "TOTALUPVOTES", "TOTALDOWNVOTES", "TOTALQUESTIONS", "TOTALANSWERS", "AVGSCORE", "TOTALVIEWS", CASE WHEN "TOTALANSWERS" > "TOTALQUESTIONS" THEN 'High Answer Rate   ' WHEN "TOTALUPVOTES" > "TOTALDOWNVOTES" THEN 'Positive Engagement' ELSE 'Needs Improvement  ' END AS "ENGAGEMENTCATEGORY"
FROM "s1"
ORDER BY "REPUTATION" DESC NULLS FIRST, "TOTALUPVOTES" DESC NULLS FIRST) AS "t7"