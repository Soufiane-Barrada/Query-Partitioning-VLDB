SELECT COALESCE("t7"."USERID", "t7"."USERID") AS "USERID", "t7"."REPUTATION", "t7"."POSTCOUNT", "t7"."COMMENTCOUNT", "t7"."BADGECOUNT", "t7"."TOTALVOTES", "t7"."UPVOTES", "t7"."DOWNVOTES"
FROM (SELECT "t5"."USERID", "t5"."REPUTATION", "t5"."POSTCOUNT", "t5"."COMMENTCOUNT", "t5"."BADGECOUNT", CASE WHEN "t3"."VOTECOUNT" IS NOT NULL THEN CAST("t3"."VOTECOUNT" AS BIGINT) ELSE 0 END AS "TOTALVOTES", CASE WHEN "t3"."UPVOTES" IS NOT NULL THEN CAST("t3"."UPVOTES" AS INTEGER) ELSE 0 END AS "UPVOTES", CASE WHEN "t3"."DOWNVOTES" IS NOT NULL THEN CAST("t3"."DOWNVOTES" AS INTEGER) ELSE 0 END AS "DOWNVOTES"
FROM (SELECT "Votes"."UserId" AS "USERID", COUNT(*) AS "VOTECOUNT", SUM(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END) AS "UPVOTES", SUM(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END) AS "DOWNVOTES"
FROM "STACK"."VoteTypes"
INNER JOIN "STACK"."Votes" ON "VoteTypes"."Id" = "Votes"."VoteTypeId"
GROUP BY "Votes"."UserId") AS "t3"
RIGHT JOIN (SELECT ANY_VALUE("Id") AS "USERID", "Reputation" AS "REPUTATION", COUNT("Id0") AS "POSTCOUNT", COUNT("Id1") AS "COMMENTCOUNT", COUNT("Id2") AS "BADGECOUNT"
FROM "s1"
GROUP BY "Id", "Reputation") AS "t5" ON "t3"."USERID" = "t5"."USERID"
ORDER BY "t5"."REPUTATION" DESC NULLS FIRST
FETCH NEXT 100 ROWS ONLY) AS "t7"