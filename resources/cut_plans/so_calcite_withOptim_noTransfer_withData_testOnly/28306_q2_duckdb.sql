SELECT COALESCE("t13"."TAGNAME", "t13"."TAGNAME") AS "TAGNAME", "t13"."POSTCOUNT", "t13"."QUESTIONCOUNT", "t13"."ANSWERCOUNT", "t13"."AVGVIEWCOUNT", "t13"."AVGSCORE", "t13"."RECENTPOSTDATE", "t13"."ACTIVEUSER", "t13"."TOTALUPVOTES", "t13"."TOTALDOWNVOTES", "t13"."TOTALCOMMENTS", "t13"."TOTALBADGES", "t13"."TOTALPOSTS", "t13"."POSITIVEPOSTS", "t13"."POPULARPOSTS"
FROM (SELECT "t11"."TAGNAME", "t11"."POSTCOUNT", "t11"."QUESTIONCOUNT", "t11"."ANSWERCOUNT", "t11"."AVGVIEWCOUNT", "t11"."AVGSCORE", "t11"."RECENTPOSTDATE", "t11"."DISPLAYNAME" AS "ACTIVEUSER", "t11"."TOTALUPVOTES", "t11"."TOTALDOWNVOTES", "t11"."TOTALCOMMENTS", "t11"."TOTALBADGES", "t4"."TOTALPOSTS", "t4"."POSITIVEPOSTS", "t4"."POPULARPOSTS"
FROM (SELECT "OwnerDisplayName" AS "OWNERDISPLAYNAME", COUNT(*) AS "TOTALPOSTS", SUM(CASE WHEN "Score" > 0 THEN 1 ELSE 0 END) AS "POSITIVEPOSTS", SUM(CASE WHEN "ViewCount" > 100 THEN 1 ELSE 0 END) AS "POPULARPOSTS", COUNT(*) > 5 AS "$f4"
FROM "STACK"."Posts"
GROUP BY "OwnerDisplayName"
HAVING COUNT(*) > 5) AS "t4",
(SELECT "t5"."TAGNAME", "t5"."POSTCOUNT", "t5"."QUESTIONCOUNT", "t5"."ANSWERCOUNT", "t5"."AVGVIEWCOUNT", "t5"."AVGSCORE", "t5"."RECENTPOSTDATE", "t10"."DISPLAYNAME", "t10"."TOTALUPVOTES", "t10"."TOTALDOWNVOTES", "t10"."TOTALCOMMENTS", "t10"."TOTALBADGES"
FROM (SELECT "TAGNAME", COUNT(DISTINCT "Id0") AS "POSTCOUNT", SUM("FD_COL_2") AS "QUESTIONCOUNT", SUM("FD_COL_3") AS "ANSWERCOUNT", AVG("ViewCount") AS "AVGVIEWCOUNT", AVG("Score") AS "AVGSCORE", MAX("CreationDate") AS "RECENTPOSTDATE"
FROM "s1"
GROUP BY "TAGNAME") AS "t5",
(SELECT "t6"."DisplayName" AS "DISPLAYNAME", SUM(CASE WHEN CAST("t6"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "TOTALUPVOTES", SUM(CASE WHEN CAST("t6"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "TOTALDOWNVOTES", SUM(CASE WHEN "Comments"."Id" IS NOT NULL THEN 1 ELSE 0 END) AS "TOTALCOMMENTS", SUM(CASE WHEN "Badges"."Id" IS NOT NULL THEN 1 ELSE 0 END) AS "TOTALBADGES", SUM(CASE WHEN CAST("t6"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) > 0 AS "$f5"
FROM (SELECT "Users"."Id", "Users"."Reputation", "Users"."CreationDate", "Users"."DisplayName", "Users"."LastAccessDate", "Users"."WebsiteUrl", "Users"."Location", "Users"."AboutMe", "Users"."Views", "Users"."UpVotes", "Users"."DownVotes", "Users"."ProfileImageUrl", "Users"."AccountId", "Votes"."Id" AS "Id0", "Votes"."PostId", "Votes"."VoteTypeId", "Votes"."UserId", "Votes"."CreationDate" AS "CreationDate0", "Votes"."BountyAmount"
FROM "STACK"."Votes"
RIGHT JOIN "STACK"."Users" ON "Votes"."UserId" = "Users"."Id") AS "t6"
LEFT JOIN "STACK"."Comments" ON "t6"."Id" = "Comments"."UserId"
LEFT JOIN "STACK"."Badges" ON "t6"."Id" = "Badges"."UserId"
GROUP BY "t6"."DisplayName"
HAVING SUM(CASE WHEN CAST("t6"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) > 0) AS "t10") AS "t11"
ORDER BY "t11"."POSTCOUNT" DESC NULLS FIRST, "t11"."TOTALUPVOTES" DESC NULLS FIRST, "t4"."TOTALPOSTS" DESC NULLS FIRST) AS "t13"