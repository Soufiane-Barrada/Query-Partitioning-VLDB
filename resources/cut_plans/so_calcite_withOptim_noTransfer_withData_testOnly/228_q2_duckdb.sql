SELECT COALESCE("t14"."DISPLAYNAME", "t14"."DISPLAYNAME") AS "DISPLAYNAME", "t14"."REPUTATIONLEVEL", "t14"."TOTALPOSTS", "t14"."TOTALQUESTIONS", "t14"."TOTALANSWERS", "t14"."RECENTUPVOTES", "t14"."RECENTCLOSEVOTES"
FROM (SELECT "t12"."DISPLAYNAME", "t12"."REPUTATIONLEVEL", "t12"."TOTALPOSTS", "t12"."TOTALQUESTIONS", "t12"."TOTALANSWERS", CASE WHEN "t12"."UPVOTES" IS NOT NULL THEN CAST("t12"."UPVOTES" AS BIGINT) ELSE 0 END AS "RECENTUPVOTES", CASE WHEN "t3"."CLOSEVOTES" IS NOT NULL THEN CAST("t3"."CLOSEVOTES" AS BIGINT) ELSE 0 END AS "RECENTCLOSEVOTES"
FROM (SELECT "UserId", COUNT(*) AS "CLOSEVOTES"
FROM "STACK"."PostHistory"
WHERE CAST("PostHistoryTypeId" AS INTEGER) = 10
GROUP BY "UserId") AS "t3"
RIGHT JOIN (SELECT "t11"."DISPLAYNAME", "t11"."REPUTATIONLEVEL", "t11"."TOTALPOSTS", "t11"."TOTALQUESTIONS", "t11"."TOTALANSWERS", "t11"."LASTACTIVITYDATE", "t11"."OWNERUSERID", "s1"."OwnerUserId" AS "OWNERUSERID0", "s1"."UPVOTES"
FROM "s1"
RIGHT JOIN (SELECT "t8"."DISPLAYNAME", "t8"."REPUTATIONLEVEL", "t6"."TOTALPOSTS", "t6"."TOTALQUESTIONS", "t6"."TOTALANSWERS", "t10"."LASTACTIVITYDATE", "t8"."ID" AS "OWNERUSERID"
FROM (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(*) AS "TOTALPOSTS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "TOTALQUESTIONS", SUM(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "TOTALANSWERS"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING COUNT(*) > 5) AS "t6"
INNER JOIN ((SELECT "Id" AS "ID", "DisplayName" AS "DISPLAYNAME", "Reputation" AS "REPUTATION", CASE WHEN "Reputation" >= 1000 THEN 'High  ' WHEN "Reputation" >= 100 THEN 'Medium' ELSE 'Low   ' END AS "REPUTATIONLEVEL"
FROM "STACK"."Users"
WHERE CASE WHEN "Reputation" >= 1000 THEN 'High  ' WHEN "Reputation" >= 100 THEN 'Medium' ELSE 'Low   ' END = 'High  ') AS "t8" INNER JOIN (SELECT "OwnerUserId", MAX("LastActivityDate") AS "LASTACTIVITYDATE"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId"
HAVING MAX("LastActivityDate") >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '30' DAY)) AS "t10" ON "t8"."ID" = "t10"."OwnerUserId") ON "t6"."OWNERUSERID" = "t8"."ID") AS "t11" ON "s1"."OwnerUserId" = "t11"."OWNERUSERID") AS "t12" ON "t3"."UserId" = "t12"."OWNERUSERID"
ORDER BY "t12"."TOTALPOSTS" DESC NULLS FIRST, "t12"."REPUTATIONLEVEL") AS "t14"