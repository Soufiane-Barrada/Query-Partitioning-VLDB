SELECT COALESCE("t7"."USERID", "t7"."USERID") AS "USERID", "t7"."DISPLAYNAME", "t7"."PERFORMANCESCORE", "t14"."USERID" AS "USERID0", "t14"."DISPLAYNAME" AS "DISPLAYNAME0", "t14"."BADGECOUNT", "t14"."QUESTIONCOUNT", "t14"."ANSWERCOUNT", "t14"."TOTALVIEWS", "t14"."AVGSCORE"
FROM (SELECT "Users"."Id" AS "USERID", "Users"."DisplayName" AS "DISPLAYNAME", AVG(CASE WHEN "t3"."$f3" IS NOT NULL THEN CAST("t3"."$f3" AS INTEGER) ELSE 0 END) + SUM(CASE WHEN "t1"."TOTALBADGES" IS NOT NULL THEN CAST("t1"."TOTALBADGES" AS BIGINT) ELSE 0 END) AS "PERFORMANCESCORE"
FROM "STACK"."Users"
LEFT JOIN (SELECT ANY_VALUE("Users0"."Id") AS "USERID", "Users0"."DisplayName" AS "DISPLAYNAME", COUNT("Badges"."Id") AS "TOTALBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Badges"."UserId" = "Users0"."Id"
GROUP BY "Users0"."Id", "Users0"."DisplayName") AS "t1" ON "Users"."Id" = "t1"."USERID"
LEFT JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "$f3", AVG("Score") AS "$f4"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t3" ON "Users"."Id" = "t3"."OWNERUSERID"
GROUP BY "Users"."Id", "Users"."DisplayName"
ORDER BY 3 DESC NULLS FIRST
FETCH NEXT 10 ROWS ONLY) AS "t7"
INNER JOIN (SELECT "Users1"."Id" AS "USERID", "Users1"."DisplayName" AS "DISPLAYNAME", CASE WHEN "t10"."TOTALBADGES" IS NOT NULL THEN CAST("t10"."TOTALBADGES" AS BIGINT) ELSE 0 END AS "BADGECOUNT", CASE WHEN "t12"."QUESTIONCOUNT" IS NOT NULL THEN CAST("t12"."QUESTIONCOUNT" AS BIGINT) ELSE 0 END AS "QUESTIONCOUNT", CASE WHEN "t12"."ANSWERCOUNT" IS NOT NULL THEN CAST("t12"."ANSWERCOUNT" AS BIGINT) ELSE 0 END AS "ANSWERCOUNT", CASE WHEN "t12"."$f3" IS NOT NULL THEN CAST("t12"."$f3" AS INTEGER) ELSE 0 END AS "TOTALVIEWS", CASE WHEN "t12"."$f4" IS NOT NULL THEN CAST("t12"."$f4" AS INTEGER) ELSE 0 END AS "AVGSCORE"
FROM "STACK"."Users" AS "Users1"
LEFT JOIN (SELECT ANY_VALUE("Users2"."Id") AS "USERID", "Users2"."DisplayName" AS "DISPLAYNAME", COUNT("Badges0"."Id") AS "TOTALBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES"
FROM "STACK"."Badges" AS "Badges0"
RIGHT JOIN "STACK"."Users" AS "Users2" ON "Badges0"."UserId" = "Users2"."Id"
GROUP BY "Users2"."Id", "Users2"."DisplayName") AS "t10" ON "Users1"."Id" = "t10"."USERID"
LEFT JOIN (SELECT "OwnerUserId" AS "OWNERUSERID", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 1 THEN 1 ELSE NULL END) AS "QUESTIONCOUNT", COUNT(CASE WHEN CAST("PostTypeId" AS INTEGER) = 2 THEN 1 ELSE NULL END) AS "ANSWERCOUNT", SUM("ViewCount") AS "$f3", AVG("Score") AS "$f4"
FROM "STACK"."Posts"
GROUP BY "OwnerUserId") AS "t12" ON "Users1"."Id" = "t12"."OWNERUSERID"
WHERE CASE WHEN "t12"."QUESTIONCOUNT" IS NOT NULL THEN CAST("t12"."QUESTIONCOUNT" AS BIGINT) ELSE 0 END > 10 AND (CASE WHEN "t12"."ANSWERCOUNT" IS NOT NULL THEN CAST("t12"."ANSWERCOUNT" AS BIGINT) ELSE 0 END > 5 OR CASE WHEN "t10"."TOTALBADGES" IS NOT NULL THEN CAST("t10"."TOTALBADGES" AS BIGINT) ELSE 0 END > 5)) AS "t14" ON "t7"."USERID" = "t14"."USERID"