SELECT COALESCE("t5"."POSTID", "t5"."POSTID") AS "POSTID", "t5"."TITLE", "t5"."CREATIONDATE", "t5"."SCORE", "t5"."VIEWCOUNT", "t5"."OWNERDISPLAYNAME", "t5"."VOTECOUNT", "t5"."COMMENTCOUNT", "t5"."UPVOTES", "t5"."DOWNVOTES"
FROM (SELECT ANY_VALUE("t1"."Id") AS "POSTID", "t1"."Title" AS "TITLE", "t1"."CreationDate" AS "CREATIONDATE", "t1"."Score" AS "SCORE", "t1"."ViewCount" AS "VIEWCOUNT", ANY_VALUE("t1"."DisplayName") AS "OWNERDISPLAYNAME", COUNT("t1"."Id1") AS "VOTECOUNT", COUNT("Comments"."Id") AS "COMMENTCOUNT", CASE WHEN CASE WHEN ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) = 0 THEN FALSE ELSE ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) IS NOT NULL END THEN CAST(CASE WHEN ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) = 0 THEN NULL ELSE ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'UpMod' THEN 1 ELSE 0 END), 2) END AS INTEGER) ELSE 0 END AS "UPVOTES", CASE WHEN CASE WHEN ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) = 0 THEN FALSE ELSE ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) IS NOT NULL END THEN CAST(CASE WHEN ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) = 0 THEN NULL ELSE ROUND(AVG(CASE WHEN "VoteTypes"."Name" = 'DownMod' THEN 1 ELSE 0 END), 2) END AS INTEGER) ELSE 0 END AS "DOWNVOTES"
FROM (SELECT "s1"."Id", "s1"."PostTypeId", "s1"."AcceptedAnswerId", "s1"."ParentId", "s1"."CreationDate", "s1"."Score", "s1"."ViewCount", "s1"."Body", "s1"."OwnerUserId", "s1"."OwnerDisplayName", "s1"."LastEditorUserId", "s1"."LastEditorDisplayName", "s1"."LastEditDate", "s1"."LastActivityDate", "s1"."Title", "s1"."Tags", "s1"."AnswerCount", "s1"."CommentCount", "s1"."FavoriteCount", "s1"."ClosedDate", "s1"."CommunityOwnedDate", "s1"."ContentLicense", "Users"."Id" AS "Id0", "Users"."Reputation", "Users"."CreationDate" AS "CreationDate0", "Users"."DisplayName", "Users"."LastAccessDate", "Users"."WebsiteUrl", "Users"."Location", "Users"."AboutMe", "Users"."Views", "Users"."UpVotes", "Users"."DownVotes", "Users"."ProfileImageUrl", "Users"."AccountId", "Votes"."Id" AS "Id1", "Votes"."PostId", "Votes"."VoteTypeId", "Votes"."UserId", "Votes"."CreationDate" AS "CreationDate1", "Votes"."BountyAmount"
FROM "STACK"."Votes"
RIGHT JOIN ("s1" INNER JOIN "STACK"."Users" ON "s1"."OwnerUserId" = "Users"."Id") ON "Votes"."PostId" = "s1"."Id") AS "t1"
LEFT JOIN "STACK"."VoteTypes" ON "t1"."VoteTypeId" = "VoteTypes"."Id"
LEFT JOIN "STACK"."Comments" ON "t1"."Id" = "Comments"."PostId"
GROUP BY "t1"."Id", "t1"."Title", "t1"."CreationDate", "t1"."Score", "t1"."ViewCount", "t1"."DisplayName"
ORDER BY "t1"."CreationDate" DESC NULLS FIRST) AS "t5"