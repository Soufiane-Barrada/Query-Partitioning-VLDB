SELECT COALESCE("POSTTYPE", "POSTTYPE") AS "POSTTYPE", "TOTALPOSTS", "TOTALVOTES", "TOTALUSERS", CAST("TOTALVOTES" AS DECIMAL(19, 1)) / CASE WHEN "TOTALPOSTS" = 0 THEN NULL ELSE "TOTALPOSTS" END AS "VOTESPERPOST", CAST("TOTALUSERS" AS DECIMAL(19, 1)) / CASE WHEN "TOTALPOSTS" = 0 THEN NULL ELSE "TOTALPOSTS" END AS "USERSPERPOST"
FROM (SELECT "Name", ANY_VALUE("Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", COUNT(DISTINCT "UserId") AS "TOTALVOTES", COUNT(DISTINCT "Id2") AS "TOTALUSERS"
FROM "s1"
GROUP BY "Name"
ORDER BY 3 DESC NULLS FIRST) AS "t2"