SELECT COALESCE("t9"."POSTID", "t9"."POSTID") AS "POSTID", "t9"."TITLE", "t9"."COMMENTCOUNT", "t9"."UPVOTECOUNT", "t9"."DOWNVOTECOUNT", "t9"."CREATIONDATE", "t9"."LASTACTIVITYDATE", "t9"."VIEWCOUNT", "t9"."SCORE", "t9"."ANSWERCOUNT", "t9"."USERID", "t9"."DISPLAYNAME", "t9"."BADGECOUNT", "t9"."AVERAGEREPUTATION", "t9"."TOTALVIEWS", "t9"."TOTALSCORE"
FROM (SELECT "t7"."POSTID", "t7"."TITLE", "t7"."COMMENTCOUNT", "t7"."UPVOTECOUNT", "t7"."DOWNVOTECOUNT", "t7"."CREATIONDATE", "t7"."LASTACTIVITYDATE", "t7"."VIEWCOUNT", "t7"."SCORE", "t7"."ANSWERCOUNT", "t3"."USERID", "t3"."DISPLAYNAME", "t3"."BADGECOUNT", "t3"."AVERAGEREPUTATION", "t3"."TOTALVIEWS", "t3"."TOTALSCORE"
FROM (SELECT ANY_VALUE("t1"."Id") AS "USERID", "t1"."DisplayName" AS "DISPLAYNAME", COUNT("t1"."Id0") AS "BADGECOUNT", AVG("t1"."Reputation") AS "AVERAGEREPUTATION", SUM("Posts0"."ViewCount") AS "TOTALVIEWS", SUM("Posts0"."Score") AS "TOTALSCORE"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN (SELECT "Users"."Id", "Users"."Reputation", "Users"."CreationDate", "Users"."DisplayName", "Users"."LastAccessDate", "Users"."WebsiteUrl", "Users"."Location", "Users"."AboutMe", "Users"."Views", "Users"."UpVotes", "Users"."DownVotes", "Users"."ProfileImageUrl", "Users"."AccountId", "Badges"."Id" AS "Id0", "Badges"."UserId", "Badges"."Name", "Badges"."Date", "Badges"."Class", "Badges"."TagBased"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id") AS "t1" ON "Posts0"."OwnerUserId" = "t1"."Id"
GROUP BY "t1"."Id", "t1"."DisplayName") AS "t3"
INNER JOIN (SELECT ANY_VALUE("t4"."Id") AS "POSTID", "t4"."Title" AS "TITLE", COUNT("t4"."Id0") AS "COMMENTCOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "UPVOTECOUNT", SUM(CASE WHEN CAST("Votes"."VoteTypeId" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "DOWNVOTECOUNT", "t4"."CreationDate" AS "CREATIONDATE", "t4"."LastActivityDate" AS "LASTACTIVITYDATE", "t4"."ViewCount" AS "VIEWCOUNT", "t4"."Score" AS "SCORE", "t4"."AnswerCount" AS "ANSWERCOUNT"
FROM "STACK"."Votes"
RIGHT JOIN (SELECT "s1"."Id", "s1"."PostTypeId", "s1"."AcceptedAnswerId", "s1"."ParentId", "s1"."CreationDate", "s1"."Score", "s1"."ViewCount", "s1"."Body", "s1"."OwnerUserId", "s1"."OwnerDisplayName", "s1"."LastEditorUserId", "s1"."LastEditorDisplayName", "s1"."LastEditDate", "s1"."LastActivityDate", "s1"."Title", "s1"."Tags", "s1"."AnswerCount", "s1"."CommentCount", "s1"."FavoriteCount", "s1"."ClosedDate", "s1"."CommunityOwnedDate", "s1"."ContentLicense", "Comments"."Id" AS "Id0", "Comments"."PostId", "Comments"."Score" AS "Score0", "Comments"."Text", "Comments"."CreationDate" AS "CreationDate0", "Comments"."UserDisplayName", "Comments"."UserId", "Comments"."ContentLicense" AS "ContentLicense0"
FROM "STACK"."Comments"
RIGHT JOIN "s1" ON "Comments"."PostId" = "s1"."Id") AS "t4" ON "Votes"."PostId" = "t4"."Id"
GROUP BY "t4"."Id", "t4"."Title", "t4"."CreationDate", "t4"."LastActivityDate", "t4"."ViewCount", "t4"."Score", "t4"."AnswerCount") AS "t7" ON "t3"."USERID" = "t7"."POSTID"
ORDER BY "t7"."SCORE" DESC NULLS FIRST) AS "t9"