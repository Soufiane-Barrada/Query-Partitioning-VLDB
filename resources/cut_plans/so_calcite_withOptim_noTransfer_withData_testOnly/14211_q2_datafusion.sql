SELECT COALESCE("t5"."POSTID", "t5"."POSTID") AS "POSTID", "t5"."POSTTYPEID", "t5"."CREATIONDATE", "t5"."SCORE", "t5"."VIEWCOUNT", "t5"."ANSWERCOUNT", "t5"."TOTALCOMMENTCOUNT", "t5"."FAVORITECOUNT", "t5"."OWNERREPUTATION", "t5"."REVISIONCOUNT", "t5"."LASTEDITDATE", "t5"."CLOSEDPOSTS", "t5"."REOPENEDPOSTS"
FROM (SELECT "t3"."POSTID", "t3"."POSTTYPEID", "t3"."CREATIONDATE", "t3"."SCORE", "t3"."VIEWCOUNT", "t3"."ANSWERCOUNT", "t3"."TOTALCOMMENTCOUNT", "t3"."FAVORITECOUNT", "t3"."OWNERREPUTATION", "t1"."REVISIONCOUNT", "t1"."LASTEDITDATE", "t1"."CLOSEDPOSTS", "t1"."REOPENEDPOSTS"
FROM (SELECT "PostId" AS "POSTID", COUNT(*) AS "REVISIONCOUNT", MAX("CreationDate") AS "LASTEDITDATE", MAX(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 10 THEN 1 ELSE 0 END) AS "CLOSEDPOSTS", MAX(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) = 11 THEN 1 ELSE 0 END) AS "REOPENEDPOSTS"
FROM "STACK"."PostHistory"
GROUP BY "PostId") AS "t1"
RIGHT JOIN (SELECT ANY_VALUE("Id") AS "POSTID", "PostTypeId" AS "POSTTYPEID", "CreationDate" AS "CREATIONDATE", "Score" AS "SCORE", "ViewCount" AS "VIEWCOUNT", "AnswerCount" AS "ANSWERCOUNT", "CommentCount" AS "COMMENTCOUNT", "FavoriteCount" AS "FAVORITECOUNT", ANY_VALUE("Reputation") AS "OWNERREPUTATION", COUNT("Id1") AS "TOTALCOMMENTCOUNT", AVG("VoteTypeId") AS "AVGVOTETYPE"
FROM "s1"
GROUP BY "Id", "PostTypeId", "CreationDate", "Score", "ViewCount", "AnswerCount", "CommentCount", "FavoriteCount", "Reputation") AS "t3" ON "t1"."POSTID" = "t3"."POSTID"
ORDER BY "t3"."CREATIONDATE" DESC NULLS FIRST
FETCH NEXT 100 ROWS ONLY) AS "t5"