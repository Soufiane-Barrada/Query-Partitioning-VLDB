SELECT COALESCE("POSTTYPE", "POSTTYPE") AS "POSTTYPE", "TOTALPOSTS", "TOTALSCORE", "TOTALVIEWS", "TOTALUPVOTES", "TOTALDOWNVOTES", "AVGSCOREPERPOST", "AVGVIEWSPERPOST"
FROM (SELECT "POSTTYPE", "TOTALPOSTS", "FD_COL_3" AS "TOTALSCORE", "FD_COL_4" AS "TOTALVIEWS", "FD_COL_5" AS "TOTALUPVOTES", "FD_COL_6" AS "TOTALDOWNVOTES", ROUND(CAST("FD_COL_3" AS DECIMAL(12, 1)) / CASE WHEN "TOTALPOSTS" = 0 THEN NULL ELSE "TOTALPOSTS" END, 2) AS "AVGSCOREPERPOST", ROUND(CAST("FD_COL_4" AS DECIMAL(12, 1)) / CASE WHEN "TOTALPOSTS" = 0 THEN NULL ELSE "TOTALPOSTS" END, 2) AS "AVGVIEWSPERPOST"
FROM "s1"
ORDER BY "TOTALPOSTS" DESC NULLS FIRST) AS "t3"