SELECT COALESCE("t2"."POSTTYPE", "t2"."POSTTYPE") AS "POSTTYPE", "t2"."TOTALPOSTS", "t2"."POSITIVESCOREDPOSTS", "t2"."TOTALVIEWS", "t2"."AVERAGESCORE", "t2"."AVERAGEANSWERCOUNT", "t2"."AVERAGECOMMENTCOUNT", "t2"."UNIQUEPOSTOWNERS", "t2"."AVERAGEUSERREPUTATION"
FROM (SELECT "PostTypes"."Name", ANY_VALUE("PostTypes"."Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", SUM(CASE WHEN "s1"."Score" > 0 THEN 1 ELSE 0 END) AS "POSITIVESCOREDPOSTS", SUM("s1"."ViewCount") AS "TOTALVIEWS", AVG("s1"."Score") AS "AVERAGESCORE", AVG("s1"."AnswerCount") AS "AVERAGEANSWERCOUNT", AVG("s1"."CommentCount") AS "AVERAGECOMMENTCOUNT", COUNT(DISTINCT "s1"."OwnerUserId") AS "UNIQUEPOSTOWNERS", AVG("s1"."Reputation") AS "AVERAGEUSERREPUTATION"
FROM "STACK"."PostTypes"
INNER JOIN "s1" ON "PostTypes"."Id" = "s1"."PostTypeId"
GROUP BY "PostTypes"."Name"
ORDER BY 3 DESC NULLS FIRST) AS "t2"