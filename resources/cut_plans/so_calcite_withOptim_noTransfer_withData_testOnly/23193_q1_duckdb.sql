SELECT COALESCE("Users"."Id", "Users"."Id") AS "Id", "Users"."Reputation", "Users"."CreationDate", "Users"."DisplayName", "Users"."LastAccessDate", "Users"."WebsiteUrl", "Users"."Location", "Users"."AboutMe", "Users"."Views", "Users"."UpVotes", "Users"."DownVotes", "Users"."ProfileImageUrl", "Users"."AccountId", "t3"."USERID", "t3"."REPUTATION" AS "REPUTATION_", "t3"."TOTALPOSTS", "t3"."QUESTIONSCOUNT", "t3"."ANSWERSCOUNT", "t3"."GOLDBADGES", "t3"."SILVERBADGES", "t3"."BRONZEBADGES", "t3"."QUESTIONRATIO", "t3"."ANSWERRATIO", CASE WHEN "t13"."EXPR$0" IS NULL THEN 0 ELSE "t13"."EXPR$0" END AS "FD_COL_23"
FROM "STACK"."Users"
INNER JOIN (SELECT ANY_VALUE("t"."Id") AS "USERID", "t"."Reputation" AS "REPUTATION", COUNT(DISTINCT "t"."Id0") AS "TOTALPOSTS", SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONSCOUNT", SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERSCOUNT", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES", CASE WHEN COUNT(DISTINCT "t"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t"."Id0") END AS "QUESTIONRATIO", CASE WHEN COUNT(DISTINCT "t"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t"."Id0") END AS "ANSWERRATIO"
FROM (SELECT "Users0"."Id", "Users0"."Reputation", "Users0"."CreationDate", "Users0"."DisplayName", "Users0"."LastAccessDate", "Users0"."WebsiteUrl", "Users0"."Location", "Users0"."AboutMe", "Users0"."Views", "Users0"."UpVotes", "Users0"."DownVotes", "Users0"."ProfileImageUrl", "Users0"."AccountId", "Posts"."Id" AS "Id0", "Posts"."PostTypeId", "Posts"."AcceptedAnswerId", "Posts"."ParentId", "Posts"."CreationDate" AS "CreationDate0", "Posts"."Score", "Posts"."ViewCount", "Posts"."Body", "Posts"."OwnerUserId", "Posts"."OwnerDisplayName", "Posts"."LastEditorUserId", "Posts"."LastEditorDisplayName", "Posts"."LastEditDate", "Posts"."LastActivityDate", "Posts"."Title", "Posts"."Tags", "Posts"."AnswerCount", "Posts"."CommentCount", "Posts"."FavoriteCount", "Posts"."ClosedDate", "Posts"."CommunityOwnedDate", "Posts"."ContentLicense"
FROM "STACK"."Posts"
RIGHT JOIN "STACK"."Users" AS "Users0" ON "Posts"."OwnerUserId" = "Users0"."Id") AS "t"
LEFT JOIN "STACK"."Badges" ON "t"."Id" = "Badges"."UserId"
GROUP BY "t"."Id", "t"."Reputation"
HAVING (CASE WHEN COUNT(DISTINCT "t"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t"."Id0") END > 5E-1 OR CASE WHEN COUNT(DISTINCT "t"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t"."Id0") END > 5E-1) AND SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) > 0) AS "t3" ON "Users"."Id" = "t3"."USERID"
LEFT JOIN (SELECT "t9"."Id" AS "UserId", CASE WHEN "t12"."EXPR$0" IS NOT NULL THEN "t12"."EXPR$0" ELSE 0 END AS "EXPR$0"
FROM (SELECT "Users1"."Id"
FROM "STACK"."Users" AS "Users1"
INNER JOIN (SELECT ANY_VALUE("t4"."Id") AS "USERID", "t4"."Reputation" AS "REPUTATION", COUNT(DISTINCT "t4"."Id0") AS "TOTALPOSTS", SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "QUESTIONSCOUNT", SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "ANSWERSCOUNT", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS "GOLDBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS "SILVERBADGES", SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) AS "BRONZEBADGES", CASE WHEN COUNT(DISTINCT "t4"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t4"."Id0") END AS "QUESTIONRATIO", CASE WHEN COUNT(DISTINCT "t4"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t4"."Id0") END AS "ANSWERRATIO"
FROM (SELECT "Users2"."Id", "Users2"."Reputation", "Users2"."CreationDate", "Users2"."DisplayName", "Users2"."LastAccessDate", "Users2"."WebsiteUrl", "Users2"."Location", "Users2"."AboutMe", "Users2"."Views", "Users2"."UpVotes", "Users2"."DownVotes", "Users2"."ProfileImageUrl", "Users2"."AccountId", "Posts0"."Id" AS "Id0", "Posts0"."PostTypeId", "Posts0"."AcceptedAnswerId", "Posts0"."ParentId", "Posts0"."CreationDate" AS "CreationDate0", "Posts0"."Score", "Posts0"."ViewCount", "Posts0"."Body", "Posts0"."OwnerUserId", "Posts0"."OwnerDisplayName", "Posts0"."LastEditorUserId", "Posts0"."LastEditorDisplayName", "Posts0"."LastEditDate", "Posts0"."LastActivityDate", "Posts0"."Title", "Posts0"."Tags", "Posts0"."AnswerCount", "Posts0"."CommentCount", "Posts0"."FavoriteCount", "Posts0"."ClosedDate", "Posts0"."CommunityOwnedDate", "Posts0"."ContentLicense"
FROM "STACK"."Posts" AS "Posts0"
RIGHT JOIN "STACK"."Users" AS "Users2" ON "Posts0"."OwnerUserId" = "Users2"."Id") AS "t4"
LEFT JOIN "STACK"."Badges" AS "Badges0" ON "t4"."Id" = "Badges0"."UserId"
GROUP BY "t4"."Id", "t4"."Reputation"
HAVING (CASE WHEN COUNT(DISTINCT "t4"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t4"."Id0") END > 5E-1 OR CASE WHEN COUNT(DISTINCT "t4"."Id0") = 0 THEN 0E0 ELSE CAST(SUM(CASE WHEN CAST("t4"."PostTypeId" AS INTEGER) = 2 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(DISTINCT "t4"."Id0") END > 5E-1) AND SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 1 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 2 THEN 1 ELSE 0 END) + SUM(CASE WHEN CAST("Badges0"."Class" AS INTEGER) = 3 THEN 1 ELSE 0 END) > 0) AS "t8" ON "Users1"."Id" = "t8"."USERID"
GROUP BY "Users1"."Id") AS "t9"
LEFT JOIN (SELECT "UserId", COUNT(*) AS "EXPR$0"
FROM "STACK"."Votes"
WHERE "CreationDate" >= (TIMESTAMP '2024-10-01 12:34:56' - INTERVAL '1' YEAR)
GROUP BY "UserId") AS "t12" ON "t9"."Id" IS NOT DISTINCT FROM "t12"."UserId") AS "t13" ON "Users"."Id" = "t13"."UserId"