SELECT COALESCE("t10"."POSTID", "t10"."POSTID") AS "POSTID", "t10"."TITLE", "t10"."SCORE", "t10"."VIEWCOUNT", "t10"."ANSWERCOUNT", "t10"."CLOSEREOPENCOUNT", "t10"."DELETEUNDELETECOUNT", "t10"."LASTEDITED", "t10"."CLOSURESTATUS"
FROM (SELECT "t6"."POSTID", "t6"."TITLE", "t6"."SCORE", "t6"."VIEWCOUNT", "t6"."ANSWERCOUNT", "t8"."CLOSEREOPENCOUNT", "t8"."DELETEUNDELETECOUNT", "t8"."LASTEDITED", CASE WHEN "t8"."CLOSEREOPENCOUNT" > 2 THEN 'Frequently Closed/Reopened' ELSE 'Rarely Closed/Reopened    ' END AS "CLOSURESTATUS"
FROM (SELECT "s1"."POSTID", "s1"."TITLE", "s1"."SCORE", "s1"."VIEWCOUNT", "s1"."ANSWERCOUNT", "t5"."BADGECOUNT"
FROM "s1"
INNER JOIN (SELECT ANY_VALUE("Users"."Id") AS "USERID", "Users"."DisplayName" AS "DISPLAYNAME", COUNT(DISTINCT "Badges"."Id") AS "BADGECOUNT"
FROM "STACK"."Badges"
RIGHT JOIN "STACK"."Users" ON "Badges"."UserId" = "Users"."Id"
GROUP BY "Users"."Id", "Users"."DisplayName"
HAVING COUNT(DISTINCT "Badges"."Id") > 5) AS "t5" ON "s1"."OWNERUSERID" = "t5"."USERID") AS "t6"
INNER JOIN (SELECT "PostId" AS "POSTID", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (10, 11) THEN 1 ELSE NULL END) AS "CLOSEREOPENCOUNT", COUNT(CASE WHEN CAST("PostHistoryTypeId" AS INTEGER) IN (12, 13) THEN 1 ELSE NULL END) AS "DELETEUNDELETECOUNT", MAX("CreationDate") AS "LASTEDITED"
FROM "STACK"."PostHistory"
GROUP BY "PostId") AS "t8" ON "t6"."POSTID" = "t8"."POSTID"
ORDER BY "t6"."SCORE" DESC NULLS FIRST, "t6"."VIEWCOUNT" DESC NULLS FIRST) AS "t10"