SELECT COALESCE("t6"."POSTTYPE", "t6"."POSTTYPE") AS "POSTTYPE", "t6"."TOTALPOSTS", "t6"."AVGCOMMENTS", "t6"."AVGVOTES", "t6"."AVGOWNERREPUTATION"
FROM (SELECT "PostTypes"."Name", ANY_VALUE("PostTypes"."Name") AS "POSTTYPE", COUNT(*) AS "TOTALPOSTS", AVG("t4"."COMMENTCOUNT") AS "AVGCOMMENTS", AVG("t4"."VOTECOUNT") AS "AVGVOTES", AVG("t4"."AVGUSERREPUTATION") AS "AVGOWNERREPUTATION"
FROM "STACK"."PostTypes"
INNER JOIN (SELECT ANY_VALUE("Id") AS "POSTID", "POSTTYPEID", "CREATIONDATE", COUNT("FD_COL_3") AS "COMMENTCOUNT", COUNT("Id1") AS "VOTECOUNT", AVG("Reputation") AS "AVGUSERREPUTATION"
FROM "s1"
GROUP BY "Id", "POSTTYPEID", "CREATIONDATE") AS "t4" ON "PostTypes"."Id" = "t4"."POSTTYPEID"
GROUP BY "PostTypes"."Name"
ORDER BY 3 DESC NULLS FIRST) AS "t6"